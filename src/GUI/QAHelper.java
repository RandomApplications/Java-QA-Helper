/*
 *
 * MIT License
 *
 * Copyright (c) 2018 PCs for People
 * Copyright (c) 2018-2024 Free Geek
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 */

 /*
 * App Icon is “Robot Face” from Twemoji (https://twemoji.twitter.com/) by Twitter (https://twitter.com)
 * Licensed under CC-BY 4.0 (https://creativecommons.org/licenses/by/4.0/)
 */
package GUI;

import Utilities.*;
import com.formdev.flatlaf.*;
import com.formdev.flatlaf.util.UIScale;
import java.awt.*;
import java.awt.datatransfer.StringSelection;
import java.awt.desktop.AboutEvent;
import java.awt.event.KeyEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.font.TextAttribute;
import java.io.*;
import java.net.URI;
import java.net.URISyntaxException;
import java.net.URLEncoder;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.text.NumberFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Objects;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import javax.sound.sampled.*;
import javax.swing.*;
import javax.swing.text.MaskFormatter;
import javax.swing.text.NumberFormatter;
import javax.swing.text.StyleContext;

/**
 * CHANGE LOG
 *
 * @author Stefani Monson (of PCs for People) & Pico Mitchell (of Free Geek)
 *
 * 1/2/2018 - Changed substring of serial for MAC from 30 to 24 so that it returns the entire serial number instead of last 6 digits. - SMM
 *
 * 1/29/2018 - Fixed the dmidecode command to run properly when determining the product name and serial number of the computer. - SMM
 *
 * 12/06/2018 - 1/16/2019 - Changed so so much. - Pico
 *
 * 1/17/2018 - 3/18/2019 - Added hardware testing and made everything even better. - Pico
 *
 * 8/12/2019 - Started adding Windows support. - Pico
 *
 */
public class QAHelper extends javax.swing.JFrame {

    // TODO: REMEMBER TO UPDATE VERSION WHEN CHANGES ARE MADE (Format is Year.Month.Day-Revision)
    // Version is stored in separate "qa-helper-version.txt" for easy extraction from other scripts and is loaded in QAHelper().
    String appVersion = "N/A";

    // ENVIRONMENT DETECTION SETUP - These are set in QAHelper()
    boolean isLinux = false;
    boolean isLinuxMATE = false;
    boolean isLinuxLiveBoot = false;
    boolean isLinuxBootedFromNetwork = false;
    boolean isLinuxBootedToRAM = false;
    boolean isLinuxUbiquityMode = false;
    boolean isLinuxFirstLaunch = false;

    boolean isMacOS = false;
    boolean isMacOSsierraOrNewer = false;
    boolean isMacOSmojaveOrNewer = false;
    boolean isMacTestBoot = false;

    boolean isWindows = false;
    boolean isWindows11 = false;
    boolean isWindowsPE = false; // Windows Preinstallation Environment
    boolean isWindowsRE = false; // Windows Recovery Environment (which we now use instead of WinPE and has more features like Audio and Wi-Fi)

    //VARIABLE DECLARATIONS
    boolean actionsEnabled = true;
    boolean isFirstLoad = true;
    String username = "N/A";
    String pid = "N/A";
    boolean isReloading = false;
    static boolean isTestMode = false;
    boolean gotTestModeFromLog = false;
    boolean isLoggedIn = false;
    boolean hideLoginAndTasks = false;
    boolean forceShowScreenKeyboardAndMouseTests = false;
    String lastStatus = "UNKNOWN STATUS";
    String displayPrice = "";
    boolean isSold = false;

    boolean isCPUverified = false;
    boolean isDriveHealthVerified = false;
    boolean isDiscDriveVerified = false;
    boolean isInternetVerified = false;
    boolean isScreenVerified = false;
    boolean isAudioVerified = false;
    boolean isMicrophoneVerified = false;
    boolean isCameraVerified = false;
    boolean isKeyboardVerified = false;
    boolean isMouseVerified = false;

    boolean isBIOSverified = false;
    boolean isPortsVerified = false;
    boolean isDriversVerified = false;
    boolean isUpdatesVerified = false;
    boolean isWindowsActivationVerified = false;
    boolean isRemoteManagementVerified = false;

    int speakerTestCount = 0;
    int headphoneTestCount = 0;

    boolean didSolidColorsScreenTest = false;
    boolean didTouchscreenTest = false;

    String linuxBuildInfoPath = "/usr/local/share/build-info/";
    String macBuildInfoPath = "/Users/Shared/Build Info/";
    String windowsBuildInfoPath = "\\Install\\"; // TODO: Choose a better Windows folder at some point.
    String helperLogFilePath = linuxBuildInfoPath + "qa-helper-log.txt"; // This will get changed in QAHelper() after we know if we're running on Linux or Mac

    long pidDashKeyTypedMillis = 0;
    long pidLastDigitAfterDashKeyTypedMillis = 0;
    String lastPIDscannedOrConfirmed = "";

    long ignoreWindowMovesUntilTime = 0;
    boolean windowMoved = false;
    String keyboardTesterURL = "https://www.keyboardtester.com/tester.html";
    static String adminPassword = "*UNKNOWN*";
    static String adminPasswordQuotedForShell = "'" + adminPassword + "'";
    static GetComputerSpecs computerSpecs;
    QAHelper qaHelperWindow = this;
    QALoadingWindow loadingWindow = new QALoadingWindow();
    PIDHistoryWindow historyWindow;
    QACreditsWindow creditsWindow = new QACreditsWindow();
    PCsCRMManager PCsCRMManager = new PCsCRMManager();

    private PrivateStrings privateStrings = new PrivateStrings();
    String configPassword = privateStrings.getConfigPassword();

    float defaultTextSize = 13;

    // These default colors will be overridden with colors from the selected FlatLaf theme.
    // These default colors are from the Twemoji solid color squares.
    Color defaultColor = Color.BLACK;

    Color verifiedColor = new java.awt.Color(94, 173, 236); // Blue
    String verifiedColorHTML = "#" + Integer.toHexString(verifiedColor.getRGB()).substring(2);

    Color successColor = new java.awt.Color(123, 176, 93); // Green
    String successColorHTML = "#" + Integer.toHexString(successColor.getRGB()).substring(2);

    Color warningColor = new java.awt.Color(240, 143, 38); // Orange
    String warningColorHTML = "#" + Integer.toHexString(warningColor.getRGB()).substring(2);

    Color errorColor = new java.awt.Color(216, 48, 72); // Red
    String errorColorHTML = "#" + Integer.toHexString(errorColor.getRGB()).substring(2);

    Color attentionColor = new java.awt.Color(169, 144, 212); // Purple
    String attentionColorHTML = "#" + Integer.toHexString(attentionColor.getRGB()).substring(2);

    boolean themeUpdated = false;

    /**
     * @param args the command line arguments
     * @throws java.lang.Exception
     */
    public static void main(String args[]) throws Exception {
        final boolean isMacOS = System.getProperty("os.name").startsWith("Mac OS X") || System.getProperty("os.name").startsWith("macOS");
        final boolean isLinux = System.getProperty("os.name").startsWith("Linux");
        final boolean isWindows = System.getProperty("os.name").startsWith("Windows");

        if (isMacOS) {
            System.setProperty("apple.awt.application.name", "QA Helper"); // To not show "QAHelper" class name in App menu.
            System.setProperty("apple.laf.useScreenMenuBar", "true");
            System.setProperty("apple.awt.application.appearance", "system"); // Allow titlebar to change to match light/dark mode (https://github.com/JFormDesigner/FlatLaf/commit/3facbc0900d4330b9aadc44077d3f7fb7e686074#diff-6178310587a0e4e1bf1132df43249c4f95d84e7b7e30d4762918c9d8bcfe1851).
        }

        boolean shouldSetSystemLookAndFeel = false; // This is here just for easy debugging.

        if (!shouldSetSystemLookAndFeel) {
            boolean osIsDarkMode = false;

            if (isMacOS) {
                String[] macOSversionParts = System.getProperty("os.version").replaceAll("[^0-9.]", "").split("\\.");
                if ((Integer.parseInt(macOSversionParts[0]) >= 11) || (Integer.parseInt(macOSversionParts[1]) >= 14)) {
                    osIsDarkMode = new CommandReader(new String[]{"/usr/bin/defaults", "read", "NSGlobalDomain", "AppleInterfaceStyle"}).getFirstOutputLine().toLowerCase().equals("dark");
                }
            } else if (isLinux) {
                String cinnamonGtkThemeName = new CommandReader(new String[]{"/usr/bin/gsettings", "get", "org.cinnamon.desktop.interface", "gtk-theme"}).getFirstOutputLine().toLowerCase();
                osIsDarkMode = (cinnamonGtkThemeName.contains("-dark") && !cinnamonGtkThemeName.contains("-darker"));
            } else if (isWindows) {
                osIsDarkMode = !new CommandReader(new String[]{"\\Windows\\System32\\reg.exe", "query", "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize", "/v", "AppsUseLightTheme"}).getFirstOutputLineContaining("0x0").isEmpty();
            }

            try {
                FlatLaf defaultLaf = (osIsDarkMode ? new FlatDarkLaf() : new FlatLightLaf());
                UIManager.setLookAndFeel(isMacOS ? (osIsDarkMode ? new com.formdev.flatlaf.themes.FlatMacDarkLaf() : new com.formdev.flatlaf.themes.FlatMacLightLaf()) : defaultLaf);

                // All FlatLaf options:
                //  https://github.com/JFormDesigner/FlatLaf/tree/main/flatlaf-theme-editor/src/main/resources/com/formdev/flatlaf/themeeditor/FlatLafUIKeys.txt
                //  https://github.com/JFormDesigner/FlatLaf/tree/main/flatlaf-core/src/main/resources/com/formdev/flatlaf
                UIManager.put("ScrollPane.smoothScrolling", true);
                UIManager.put("TabbedPane.tabAreaAlignment", "fill");
                UIManager.put("TabbedPane.showTabSeparators", true);
                UIManager.put("Button.minimumWidth", 0); // Allow buttons to get smaller than the default minimum of 72px wide when font size is reduced. (https://github.com/JFormDesigner/FlatLaf/blob/fb44c8fbe4ea607a644670946e56897323e2eac1/flatlaf-core/src/main/resources/com/formdev/flatlaf/FlatLaf.properties#L159)
                UIManager.put("Button.default.boldText", false); // To not bold button text on focus with FlatDarkLaf theme (or FlatMac themes).
                UIManager.put("Button.defaultButtonFollowsFocus", true); // So that Enter key works properly to select focused button across all platforms (even macOS where Enter/Return never worked for focused button).
                UIManager.put("OptionPane.maxCharactersPerLine", Integer.MAX_VALUE); // Don't want FlatLaf to wrap our lines since line breaks were all set intentionally before using FlatLaf.
                UIManager.put("OptionPane.isYesLast", !isWindows); // FlatLaf properly sets isYesLast as true for macOS and false for Windows, but also sets false for Linux when it should actually be true for Linux Mint.
                UIManager.put("OptionPane.sameSizeButtons", false);
                UIManager.put("PasswordField.showCapsLock", true);
                UIManager.put("PasswordField.showRevealButton", true);

                Font defaultFont = (Font) UIManager.get("defaultFont");
                if (isMacOS) {
                    // When using the FlatMac themes along with "Button.defaultButtonFollowsFocus" being set to "true" (which offers great functionality),
                    // the bright blue highlighted default button moving around the window looks bad to me, but the rest of the "FlatMac" theme changes are good.
                    // So, set the following theme values to the default values from the non-Mac themes to continue using the default FlatLaf button style with the FlatMac themes.
                    // These values were determined by seeing what was changed by comparing these dumps: https://github.com/JFormDesigner/FlatLaf/tree/main/flatlaf-testing/dumps/uidefaults
                    String[] resetUIDefaults = new String[]{"Component.focusWidth", "Component.innerFocusWidth", "Component.innerOutlineWidth",
                        "Button.default.borderWidth", "Button.default.foreground", "Button.default.background", "Button.default.focusedBackground"};
                    for (String thisUIDefault : resetUIDefaults) {
                        UIManager.put(thisUIDefault, defaultLaf.getDefaults().get(thisUIDefault));
                    }

                    // Copying font setting technique from https://github.com/JFormDesigner/FlatLaf/blob/3a784375d087c0e19903c77eb2936400cf38712e/flatlaf-core/src/main/java/com/formdev/flatlaf/FlatLaf.java#L495
                    // Set "Helvetica Neue" as font on all macOS versions for consistency (FlatLaf already uses it for Catalina). NOTE: This is still required even with new FlatMac theme.
                    // Would rather use system font of ".AppleSystemUIFont" or ".SF NS Text" but both have issues with Kerning and Tracking (letter spacing).
                    // Basically the San Francisco system fonts just look too wide. 
                    // https://github.com/JFormDesigner/FlatLaf/blob/3a784375d087c0e19903c77eb2936400cf38712e/flatlaf-core/src/main/java/com/formdev/flatlaf/FlatLaf.java#L442
                    // Related info about this issue: https://github.com/weisJ/darklaf/issues/128
                    if ((defaultFont == null) || !defaultFont.getFamily().equals("Helvetica Neue")) {
                        defaultFont = StyleContext.getDefaultStyleContext().getFont("Helvetica Neue", ((defaultFont == null) ? Font.PLAIN : defaultFont.getStyle()), ((defaultFont == null) ? 13 : defaultFont.getSize()));
                    }
                } else if (isWindows) {
                    UIManager.put("TitlePane.unifiedBackground", false); // I think the window looks better with a different color title bar on Windows (especially when menus are included in the titlebar).

                    if (!new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(Get-CimInstance Win32_OperatingSystem -Property Caption).Caption"}).getFirstOutputLineContaining("Windows 11").isEmpty()) {
                        // Make the buttons slightly more rounded on Windows 11 to match the new button style.
                        UIManager.put("Button.arc", 8);
                        UIManager.put("Component.arc", 8);
                        UIManager.put("CheckBox.arc", 8);
                    } else {
                        // Square buttons on Windows 10 (but not Windows 11) to look a little more native. (https://www.formdev.com/flatlaf/customizing/#corners)
                        UIManager.put("Button.arc", 0);
                        UIManager.put("Component.arc", 0);
                        UIManager.put("CheckBox.arc", 0);
                    }

                    // No longer need any Decorations or Font changes for WinPE, since they are now built in to FlatLaf: https://github.com/JFormDesigner/FlatLaf/issues/279
                } else if (isLinux) {
                    // Unified title and toolbar can now be enabled on Linux as of FlatLaf 2.1: https://github.com/JFormDesigner/FlatLaf/releases/tag/2.1
                    JFrame.setDefaultLookAndFeelDecorated(true);
                    // DO NOT use window decorations for JDialog since decorated windows don't get shadows and the dialogs on top of the main window with no shadow looks weird.
                    // TODO: Re-asses that decision if decorated windows get proper shadows in the future.

                    UIManager.put("TitlePane.unifiedBackground", false); // I think the window looks better with a different color title bar on Linux (especially when menus are included in the titlebar).
                }

                if (defaultFont != null) {
                    UIManager.put("defaultFont", defaultFont);
                }
            } catch (UnsupportedLookAndFeelException ex) {
                shouldSetSystemLookAndFeel = true;
            }
        }

        if (shouldSetSystemLookAndFeel) {
            System.setProperty("jdk.gtk.version", "2.2"); // Java 11 and newer defaults to GTK 3 which looks bad for some reason (still looks bad with Java 15). Setting to GTK 2.2 must be done before getSystemLookAndFeelClassName()

            String lookAndFeel = UIManager.getSystemLookAndFeelClassName();

            if (!lookAndFeel.contains(".apple") && !lookAndFeel.contains(".gtk") && !lookAndFeel.contains(".windows")) {
                String backupLookAndFeel = lookAndFeel;

                for (UIManager.LookAndFeelInfo thisLookAndFeelInfo : UIManager.getInstalledLookAndFeels()) {
                    String thisLookAndFeelClassName = thisLookAndFeelInfo.getClassName();

                    if (thisLookAndFeelClassName.contains(".gtk")) {
                        lookAndFeel = thisLookAndFeelClassName;
                    } else if (thisLookAndFeelClassName.contains(".nimbus")) {
                        backupLookAndFeel = thisLookAndFeelClassName;
                    }
                }

                if (!lookAndFeel.contains(".gtk")) {
                    lookAndFeel = backupLookAndFeel;
                }
            }

            UIManager.setLookAndFeel(lookAndFeel);
        }

        java.awt.EventQueue.invokeLater(() -> {
            int multipleInstanceMinimum = (isMacOS ? 0 : 1);

            try {
                boolean multipleInstancesRunning;
                if (isWindows) {
                    multipleInstancesRunning = new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(Get-CimInstance Win32_Process -Filter \\\"Name LIKE 'java%.exe' AND CommandLine LIKE '%QA_Helper.jar%'\\\" -Property Name,CommandLine).CommandLine"}).getOutputLines().length > multipleInstanceMinimum;
                } else {
                    // GUI.QAHelper catches when it's run from NetBeans, QA_Helper.jar catches when the .jar is launched, /QA Helper.app catches when the Mac app is run. Ignore any non-java or non-"QA Helper.app" processes to ignore sudo launches or bash scripts (such as when auto-updating), etc.
                    multipleInstancesRunning = new CommandReader(new String[]{"/usr/bin/pgrep", "-fl", "(GUI.QAHelper|QA_Helper.jar|/QA Helper.app)"}).getOutputLinesContaining((isMacOS ? new String[]{"QA Helper.app/Contents/MacOS/QA Helper", "/java"} : new String[]{" java"})).length > multipleInstanceMinimum;
                }

                if (multipleInstancesRunning) {
                    if (isMacOS) {
                        // Show alert instead of focusing on macOS because it's better when I'm debugging and it's also more complicated to focus the running instance when it may not be a .app
                        JOptionPane.showMessageDialog(null, "<html><b>Only one instance of <i>QA Helper</i> is allowed to run at a time.</b></html>", "QA Helper  —  Launch Error", JOptionPane.ERROR_MESSAGE);
                    } else {
                        try {
                            Runtime.getRuntime().exec((isWindows
                                    // Based On: https://stackoverflow.com/a/58548853
                                    // This new method is much better than the previous AppActivate method, but still also do the AppActive method since it seems to maybe not work as well on Windows 11.
                                    ? new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$focusWindowFunctionTypes = Add-Type -PassThru -Name FocusWindow -MemberDefinition @'\n"
                                        + "[DllImport(\\\"user32.dll\\\")] public static extern bool SetForegroundWindow(IntPtr hWnd);\n"
                                        + "[DllImport(\\\"user32.dll\\\")] public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);\n"
                                        + "[DllImport(\\\"user32.dll\\\")] public static extern bool IsIconic(IntPtr hWnd);\n"
                                        + "'@\n"
                                        + "$qaHelperPID = (Get-CimInstance Win32_Process -Filter \\\"Name LIKE 'java%.exe' AND CommandLine LIKE '%QA_Helper.jar%'\\\" -Property ProcessId).ProcessId\n"
                                        + "if ($qaHelperPID) {\n"
                                        + "$qaHelperWindowHandle = (Get-Process | Where-Object Id -eq $qaHelperPID).MainWindowHandle\n"
                                        + "if ($qaHelperWindowHandle) {\n"
                                        + "$focusWindowFunctionTypes::SetForegroundWindow($qaHelperWindowHandle) | Out-Null\n"
                                        + "if ($focusWindowFunctionTypes::IsIconic($qaHelperWindowHandle)) {\n"
                                        + "$focusWindowFunctionTypes::ShowWindow($qaHelperWindowHandle, 9) | Out-Null\n"
                                        + "}\n"
                                        + "}\n"
                                        + "}\n"
                                        + "$WshellScript = (New-Object -ComObject Wscript.Shell); if (-not $WshellScript.AppActivate('QA Helper')) { $WshellScript.AppActivate('QA Helper  —  Loading') }"
                                    }
                                    : new String[]{"/bin/sh", "-c", "/usr/bin/wmctrl -Fa 'QA Helper' || /usr/bin/wmctrl -Fa 'QA Helper  —  Loading'"})).waitFor();
                        } catch (IOException | InterruptedException focusQAHelperException) {
                            System.out.println("focusQAHelperException: " + focusQAHelperException);
                        }
                    }

                    System.exit(0);
                } else {
                    // TODO: THIS ISSUE WAS ACTUALLY CAUSED BY METAL RENDERING BECOMING DEFAULT ON JAVA 19
//                    if (isMacOS && System.getProperty("java.version").startsWith("19")) {
//                        // NOTE: Starting with Java 19 on macOS, if the window is loaded when the screen is asleep, it will not have any contents displayed within it.
//                        // The buttons will still work, but nothing I seem to do will get the window to properly display it's contents once this happens.
//                        // I've narrowed this to a new issue in Java 19 and replicated it with other JAR applets as well (that both do and don't use FlatLaf, so it's not a FlatLaf issue) and seen that it doesn't happen when run with Java 18.
//                        // So, as a workaround, detect if the screen is asleep and attempt to wake the screen with "caffeinate" before loading the window.
//                        // If for some reason "caffeinate" doesn't work and the screen doesn't wake, then this loop will just wait until the screen has been been woken up manually before loading the window.
//                        // TODO: Re-test if this hacky workaround is still needed in Java 20+
//
//                        while (new CommandReader(new String[]{"/usr/bin/osascript", "-l", "JavaScript", "-e", "ObjC.import('CoreGraphics'); $.CGDisplayIsActive($.CGMainDisplayID())"}).getFirstOutputLine().equals("0")) {
//                            try {
//                                Runtime.getRuntime().exec(new String[]{"/usr/bin/caffeinate", "-ut", "1"}).waitFor(); // Wait for the 1 second "caffeinate" timeout so the screen is fully awake before continuing,
//                                TimeUnit.SECONDS.sleep(1); // AND ALSO sleep an extra second to really be sure the screen is awake before loading the window.
//                            } catch (IOException | InterruptedException wakeMacUpException) {
//                                if (isTestMode) {
//                                    System.out.println("wakeMacUpException: " + wakeMacUpException);
//                                }
//                            }
//                        }
//                    }

                    new QAHelper();
                }
            } catch (Exception loadException) {
                System.out.println("loadException: " + loadException);
                //System.out.println("Printing loadException Stack Trace:");
                //loadException.printStackTrace();

                JOptionPane.showMessageDialog(null, "<html><b>Error Loading <i>QA Helper</i></b></html>", "QA Helper  —  Load Error", JOptionPane.ERROR_MESSAGE);
                System.exit(0);
            }
        });

        Runtime.getRuntime().addShutdownHook(new Thread() {
            @Override
            public void run() {
                if (System.getProperty("os.name").startsWith("Linux")) {
                    // Be sure to kill acpi_listen on Linux even if not fully loaded since it is launched right on launch.
                    try {
                        Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "acpi_listen"});
                    } catch (IOException quitAcpiListenException) {
                        if (isTestMode) {
                            System.out.println("quitAcpiListenException: " + quitAcpiListenException);
                        }
                    }

                    if (new File("/tmp/qa_helper-acpi_listener.txt").exists()) {
                        new File("/tmp/qa_helper-acpi_listener.txt").delete();
                    }
                }

                if (computerSpecs != null) {
                    // Don't need to bother quitting anything if we're still in first load.

                    if (System.getProperty("os.name").startsWith("Linux")) {
                        String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "yes"});
                        } catch (IOException quitYesException) {
                            if (isTestMode) {
                                System.out.println("quitYesException: " + quitYesException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/killall stress-ng"});
                        } catch (IOException quitStressNgException) {
                            if (isTestMode) {
                                System.out.println("quitStressNgException: " + quitStressNgException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/killall stress-ng-cpu"});
                        } catch (IOException quitStressNgCpuException) {
                            if (isTestMode) {
                                System.out.println("quitStressNgCpuException: " + quitStressNgCpuException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/killall mate-system-monitor"});
                        } catch (IOException quitMateSystemMonitorException) {
                            if (isTestMode) {
                                System.out.println("quitMateSystemMonitorException: " + quitMateSystemMonitorException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/killall gnome-system-monitor"});
                        } catch (IOException quitGnomeSystemMonitorException) {
                            if (isTestMode) {
                                System.out.println("quitGnomeSystemMonitorException: " + quitGnomeSystemMonitorException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "aplay"});
                        } catch (IOException quitAplayException) {
                            if (isTestMode) {
                                System.out.println("quitAplayException: " + quitAplayException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "paplay"});
                        } catch (IOException quitPaplayException) {
                            if (isTestMode) {
                                System.out.println("quitPaplayException: " + quitPaplayException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "arecord"});
                        } catch (IOException quitArecordException) {
                            if (isTestMode) {
                                System.out.println("quitArecordException: " + quitArecordException);
                            }
                        }

                        try {
                            File micTestRecordingFile = new File(System.getProperty("java.io.tmpdir"), "qa_helper-mic_test.wav");
                            if (micTestRecordingFile.exists()) {
                                micTestRecordingFile.delete();
                            }
                        } catch (Exception deleteRecordingException) {
                            if (isTestMode) {
                                System.out.println("deleteRecordingException: " + deleteRecordingException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "cheese"});
                        } catch (IOException quitCheeseException) {
                            if (isTestMode) {
                                System.out.println("quitCheeseException: " + quitCheeseException);
                            }
                        }
                    } else if (System.getProperty("os.name").startsWith("Mac OS X") || System.getProperty("os.name").startsWith("macOS")) {
                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "yes"});
                        } catch (IOException quitYesException) {
                            if (isTestMode) {
                                System.out.println("quitYesException: " + quitYesException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "caffeinate"});
                        } catch (IOException quitCaffeinateException) {
                            if (isTestMode) {
                                System.out.println("quitCaffeinateException: " + quitCaffeinateException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "afplay"});
                        } catch (IOException quitAfplayException) {
                            if (isTestMode) {
                                System.out.println("quitAfplayException: " + quitAfplayException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "with timeout of 1 second", "-e", "tell application id \"com.apple.PhotoBooth\" to quit", "-e", "end timeout"}).waitFor();
                        } catch (IOException | InterruptedException quitPhotoBoothException) {
                            if (isTestMode) {
                                System.out.println("quitPhotoBoothException: " + quitPhotoBoothException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "with timeout of 1 second", "-e", "tell application id \"com.apple.QuickTimePlayerX\" to quit", "-e", "end timeout"}).waitFor();
                        } catch (IOException | InterruptedException quitQuickTimeException) {
                            if (isTestMode) {
                                System.out.println("quitQuickTimeException: " + quitQuickTimeException);
                            }
                        }
                    } else if (System.getProperty("os.name").startsWith("Windows")) {
                        boolean isWindowsPE = ((new File("\\Windows\\System32\\startnet.cmd").exists() || new File("\\Windows\\System32\\winpeshl.ini").exists()) && !new CommandReader(new String[]{"\\Windows\\System32\\reg.exe", "query", "HKLM\\SYSTEM\\Setup", "/v", "FactoryPreInstallInProgress"}).getFirstOutputLineContaining("0x1").isEmpty());

                        try {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Get-CimInstance Win32_Process -Filter \\\"Name = 'powershell.exe' AND CommandLine LIKE '%<# QA Helper CPU Stress Test #>%'\\\" | Invoke-CimMethod -Name Terminate"}).waitFor();
                        } catch (IOException | InterruptedException quitPowershellStressException) {
                            if (isTestMode) {
                                System.out.println("quitPowershellStressException: " + quitPowershellStressException);
                            }
                        }

                        try {
                            // taskkill does not exist in WinPE (unless it has been manually copied in) and will always exist in full Windows, no need to make it hard a requirement when I can just use PowerShell (PowerShell just takes longer so we'll still use taskkill when it's available).
                            if (!isWindowsPE || new File("\\Windows\\System32\\taskkill.exe").exists()) {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", (new File("\\Install\\Diagnostic Tools\\OpenHardwareMonitor\\OpenHardwareMonitor.exe").exists() ? "OpenHardwareMonitor.exe" : (isWindowsPE ? "Taskmgr.exe" : "perfmon.exe")), "/t"}).waitFor(); // Even though we launch resmon.exe the running executable is perfmon.exe
                            } else {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Process -Name " + (new File("\\Install\\Diagnostic Tools\\OpenHardwareMonitor\\OpenHardwareMonitor.exe").exists() ? "OpenHardwareMonitor" : "Taskmgr")}).waitFor();
                            }
                        } catch (IOException | InterruptedException quitTaskManagerException) {
                            if (isTestMode) {
                                System.out.println("quitTaskManagerException: " + quitTaskManagerException);
                            }
                        }

                        if (!isWindowsPE) {
                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$WscriptShell = New-Object -ComObject Wscript.Shell; if ($WscriptShell.AppActivate('Sound')) { $WscriptShell.SendKeys('%{F4}') }; Start-Sleep -Milliseconds 500; if ($WscriptShell.AppActivate('Sound')) { $WscriptShell.SendKeys('%{F4}') }"}).waitFor(); // Try closing Sound window twice in case the Properties windows is open.
                            } catch (IOException | InterruptedException quitRecordingPropertiesException) {
                                if (isTestMode) {
                                    System.out.println("quitRecordingPropertiesException: " + quitRecordingPropertiesException);
                                }
                            }

                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", "SndVol.exe", "/t"}).waitFor();
                            } catch (IOException | InterruptedException quitSoundMixerException) {
                                if (isTestMode) {
                                    System.out.println("quitSoundMixerException: " + quitSoundMixerException);
                                }
                            }

                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/fi", "WINDOWTITLE eq Camera", "/t"}).waitFor();
                            } catch (IOException | InterruptedException quitCameraAppException) {
                                if (isTestMode) {
                                    System.out.println("quitCameraAppException: " + quitCameraAppException);
                                }
                            }
                        }
                    }
                }

                if (System.getProperty("os.name").startsWith("Mac OS X") || System.getProperty("os.name").startsWith("macOS")) {
                    // De-quarantine apps even if we didn't finish loading.
                    try {
                        String launchPath = new File(QAHelper.class.getProtectionDomain().getCodeSource().getLocation().toURI()).getPath();

                        if (launchPath.contains("/AppTranslocation/") || !new CommandReader(new String[]{"/usr/bin/xattr", launchPath}).getFirstOutputLineContaining("com.apple.quarantine").isEmpty()) {
                            String[] appPaths = new CommandReader(new String[]{"/usr/bin/mdfind", "kMDItemCFBundleIdentifier = org.freegeek.QA-Helper"}).getOutputLines();

                            if (appPaths.length > 0) {
                                ArrayList<String> appleScriptQuotedAppPaths = new ArrayList<>();
                                for (String thisAppPath : appPaths) {
                                    appleScriptQuotedAppPaths.add("(quoted form of \"" + thisAppPath.replace("\\", "\\\\").replace("\"", "\\\"") + "\")");
                                }

                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript",
                                    "-e", "delay 0.5",
                                    "-e", "repeat while (application \"" + launchPath.replace("\\", "\\\\").replace("\"", "\\\"") + "\" is running)",
                                    "-e", "delay 0.5",
                                    "-e", "end repeat",
                                    "-e", "try",
                                    "-e", "do shell script \"/usr/bin/xattr -drs com.apple.quarantine \" & " + String.join(" & \" \" & ", appleScriptQuotedAppPaths),
                                    "-e", "end try"});
                            }
                        }
                    } catch (URISyntaxException | IOException deQuarantineAppsException) {
                        if (isTestMode) {
                            System.out.println("deQuarantineAppsException: " + deQuarantineAppsException);
                        }
                    }
                }
            }
        });
    }

    /**
     * Creates new form QAHelper
     *
     * @throws java.lang.Exception
     */
    public QAHelper() throws Exception {
        isLinux = System.getProperty("os.name").startsWith("Linux");
        isMacOS = System.getProperty("os.name").startsWith("Mac OS X") || System.getProperty("os.name").startsWith("macOS");
        isWindows = System.getProperty("os.name").startsWith("Windows");

        if (isLinux) {
            if (new File("/usr/bin/ibus-daemon").exists()) { // NOTE: "ibus-daemon" WILL BE INSTALLED/RUNNING ON MINT BY DEFAULT ONLY GETS INSTALLED WHEN ZOOM IS INSTALLED AND IT'S NOW INSTALLED BY DEFAULT ON OUR CUSTOM MINT IMAGES.
                try {
                    // On Linux, when "ibus-deamon" is installed (which gets pre-installed in our custom images as part of the "ibus" dependency for Zoom), the keyboard could become unresponsive in QA Helper (or any Java app) if dialog boxes are opened and closed too rapidly.
                    // This would happen sporadically when some technicians would hit enter rapidly to quickly verify the bottom row tasks that had already performed which rapidly opens and closes dialog boxes.
                    // After lots of investigation and testing, I determined the issue was specific to opening and closing dialog boxes and not related to keys being hit rapidly and would happen across every version of Java that I tested and did not have to do with FlatLaf.
                    // With more investigation, I traced the issue back to "ibus-daemon" (thanks to https://youtrack.jetbrains.com/issue/IDEA-23472) and found that simply reloading it at least once after boot seems to make this issue never happen.
                    // I'm not sure why it is that the issue would only happen with the "ibus-deamon" instance that loaded on boot, but always reloading "ibus-daemon" when QA Helper launches successfully avoids the issue while nothing else I tried worked.

                    Runtime.getRuntime().exec(new String[]{"/usr/bin/ibus-daemon", "-rd"});
                } catch (IOException ibusDaemonReloadException) {
                    System.out.println("ibusDaemonReloadException: " + ibusDaemonReloadException);
                }
            }

            String linuxIssue = new CommandReader(new String[]{"/usr/bin/lsb_release", "-ds"}).getFirstOutputLine();
            String desktopSession = System.getenv("DESKTOP_SESSION");

            if (!linuxIssue.startsWith("Linux Mint") || (desktopSession != null && !desktopSession.equals("cinnamon") && !desktopSession.equals("mate"))) {
                playAlertSound("error");
                String[] linuxWarningDialogButtons = new String[]{"Continue", "Quit"};
                int linuxWarningDialogReturn = JOptionPane.showOptionDialog(null, "<html><b>This version of <i>QA Helper</i> only supports <i>Linux Mint</i> with either the <u>Cinnamon</u> or <u>MATE</u> desktop environment.</b><br/><br/><i>If you continue, some things may not work correctly or may not work at all.</i></html>", "QA Helper  —  Linux Warning", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, null, linuxWarningDialogButtons, linuxWarningDialogButtons[0]);
                if (linuxWarningDialogReturn == JOptionPane.NO_OPTION || linuxWarningDialogReturn == -1) {
                    System.exit(0);
                }
            }

            isLinuxMATE = new File("/usr/bin/mate-terminal").exists();

            if (new File("/proc/cmdline").exists()) {
                try {
                    List<String> linuxBootArguments = Arrays.asList(String.join(" ", Files.readAllLines(Paths.get("/proc/cmdline"), StandardCharsets.UTF_8)).split(" "));
                    isLinuxLiveBoot = linuxBootArguments.contains("boot=casper");
                    isLinuxBootedToRAM = (linuxBootArguments.contains("toram"));
                    isLinuxBootedFromNetwork = ((linuxBootArguments.contains("netboot=nfs") || linuxBootArguments.contains("netboot=cifs")) && !isLinuxBootedToRAM);
                    isLinuxUbiquityMode = (linuxBootArguments.contains("automatic-ubiquity") || linuxBootArguments.contains("only-ubiquity"));
                } catch (IOException getLinuxBootArgsException) {
                    System.out.println("getLinuxBootArgsException: " + getLinuxBootArgsException);
                }
            }

            isLinuxFirstLaunch = !new File(System.getProperty("user.home") + "/.local/qa-helper/flags/launched-before.flag").exists();

            try {
                // Start up acpi_listen for reliable headphone plugged in detection.
                Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "/usr/bin/acpi_listen > /tmp/qa_helper-acpi_listener.txt & disown"});
            } catch (IOException acpiListenException) {
                System.out.println("acpiListenException: " + acpiListenException);
            }
        } else if (isMacOS) {
            Desktop.getDesktop().setAboutHandler((AboutEvent aboutEvent) -> {
                creditsWindow.showCreditsWindow();
            });

            try {
                // Need to check if is macOS Sierra or newer to know if can support QA Helpers built with Java 17 and newer.

                String macOSversion = System.getProperty("os.version"); // This is enough for the basic version check even though is does not show the full version on Big Sur (11.5.2 shows as just 11.5).

                String[] versionParts = macOSversion.replaceAll("[^0-9.]", "").split("\\.");

                if ((versionParts.length >= 2 && versionParts[0].equals("10") && Integer.parseInt(versionParts[1]) >= 14)
                        || (versionParts.length >= 1 && Integer.parseInt(versionParts[0]) >= 11)) {
                    isMacOSmojaveOrNewer = true;
                }

                if (isMacOSmojaveOrNewer || (versionParts.length >= 2 && versionParts[0].equals("10") && Integer.parseInt(versionParts[1]) >= 12)) {
                    isMacOSsierraOrNewer = true;
                }
            } catch (NumberFormatException checkMacOSversionException) {
                // Ignore Error
            }

            isMacTestBoot = (new File("/Applications/Test Boot Setup.app").exists() && new File("/Users/Staff").exists() && new File("/Users/Tester").exists());

            // Set Touch Bar settings to NOT be "App Controls" for QA Helper because Java alert buttons don't show in the Touch Bar anyway and fullControlStrip is better for a full Touch Bar test during Keyboard Test.
            if (new CommandReader(new String[]{"/usr/bin/defaults", "read", "com.apple.touchbar.agent", "PresentationModePerApp"}).getFirstOutputLineContaining("\"org.freegeek.QA-Helper\" = fullControlStrip;").isEmpty()) {
                try {
                    Runtime.getRuntime().exec(new String[]{"/usr/bin/defaults", "write", "com.apple.touchbar.agent", "PresentationModePerApp", "-dict-add", "org.freegeek.QA-Helper", "fullControlStrip"}).waitFor();
                } catch (IOException | InterruptedException setTouchBarPresentationModePerAppException) {
                    System.out.println("setTouchBarPresentationModePerAppException: " + setTouchBarPresentationModePerAppException);
                }
            }

            // Always killall ControlStrip even if PresentationModePerApp was set on a previous launch
            // because for some reason the setting won't take effect until the app loses and regains focus,
            // or if I just go ahead and killall ControlStrip right away.
            try {
                Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "ControlStrip"});
            } catch (IOException restartControlStripException) {
                System.out.println("restartControlStripException: " + restartControlStripException);
            }
        } else if (isWindows) {
            if (!System.getProperty("os.name").startsWith("Windows 10") && !System.getProperty("os.name").startsWith("Windows 11")) {
                playAlertSound("error");
                String[] windowsWarningDialogButtons = new String[]{"Continue", "Quit"};
                int windowsWarningDialogReturn = JOptionPane.showOptionDialog(null, "<html><b>This version of <i>QA Helper</i> does not support versions of <i>Windows</i> other than <u>Windows 10</u> or <u>Windows 11</u>.</b><br/><br/><i>If you continue, some things may not work correctly or may not work at all.</i></html>", "QA Helper  —  Windows Warning", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, null, windowsWarningDialogButtons, windowsWarningDialogButtons[0]);
                if (windowsWarningDialogReturn == JOptionPane.NO_OPTION || windowsWarningDialogReturn == -1) {
                    System.exit(0);
                }
            }

            isWindows11 = (!new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(Get-CimInstance Win32_OperatingSystem -Property Caption).Caption"}).getFirstOutputLineContaining("Windows 11").isEmpty());
            isWindowsPE = ((new File("\\Windows\\System32\\startnet.cmd").exists() || new File("\\Windows\\System32\\winpeshl.ini").exists()) && !new CommandReader(new String[]{"\\Windows\\System32\\reg.exe", "query", "HKLM\\SYSTEM\\Setup", "/v", "FactoryPreInstallInProgress"}).getFirstOutputLineContaining("0x1").isEmpty());
            isWindowsRE = (isWindowsPE && new File("\\sources\\recovery\\RecEnv.exe").exists());

            try {
                if (new File(System.getProperty("java.io.tmpdir"), "qa_helper-update_finisher.cmd").exists()) {
                    new File(System.getProperty("java.io.tmpdir"), "qa_helper-update_finisher.cmd").delete();
                }

                if (new File(System.getProperty("java.io.tmpdir"), "qa-helper_update-finisher.cmd").exists()) { // OLD naming format
                    new File(System.getProperty("java.io.tmpdir"), "qa-helper_update-finisher.cmd").delete();
                }
            } catch (Exception deleteTempAutoUpdaterCmdException) {
                System.out.println("deleteTempAutoUpdaterCmdException: " + deleteTempAutoUpdaterCmdException);
            }
        }

        initComponents();

        setAlwaysOnTop(isWindowsPE);

        try {
            appVersion = new BufferedReader(new InputStreamReader(this.getClass().getResource("/Resources/qa-helper-version.txt").openStream())).readLine();
            lblVersion.setText("<html><b>Version:</b> " + appVersion + "</html>");
        } catch (NullPointerException | IOException loadVersionException) {
            lblVersion.setText("");
        }

        qaHelperWindow.addWindowListener(new WindowAdapter() {
            @Override
            public void windowActivated(WindowEvent windowEvent) {
                if (!isWindowsPE && !isLinuxUbiquityMode) {
                    // This isn't very efficient (since it will get called excessively), but will help keep dark/light theme in sync with OS when changed.

                    String currentLookAndFeelName = UIManager.getLookAndFeel().getName();
                    if (currentLookAndFeelName.startsWith("FlatLaf")) {
                        boolean osIsDarkMode = false;

                        if (isMacOS) {
                            String[] macOSversionParts = System.getProperty("os.version").replaceAll("[^0-9.]", "").split("\\.");
                            if ((Integer.parseInt(macOSversionParts[0]) >= 11) || (Integer.parseInt(macOSversionParts[1]) >= 14)) {
                                osIsDarkMode = new CommandReader(new String[]{"/usr/bin/defaults", "read", "NSGlobalDomain", "AppleInterfaceStyle"}).getFirstOutputLine().toLowerCase().equals("dark");
                            }
                        } else if (isLinux) {
                            String cinnamonGtkThemeName = new CommandReader(new String[]{"/usr/bin/gsettings", "get", "org.cinnamon.desktop.interface", "gtk-theme"}).getFirstOutputLine().toLowerCase();
                            osIsDarkMode = (cinnamonGtkThemeName.contains("-dark") && !cinnamonGtkThemeName.contains("-darker"));
                        } else if (isWindows) {
                            osIsDarkMode = !new CommandReader(new String[]{"\\Windows\\System32\\reg.exe", "query", "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize", "/v", "AppsUseLightTheme"}).getFirstOutputLineContaining("0x0").isEmpty();
                        }

                        if (osIsDarkMode != currentLookAndFeelName.endsWith(" Dark")) {
                            try {
                                FlatLaf defaultLaf = (osIsDarkMode ? new FlatDarkLaf() : new FlatLightLaf());

                                if (isMacOS) {
                                    UIManager.setLookAndFeel(osIsDarkMode ? new com.formdev.flatlaf.themes.FlatMacDarkLaf() : new com.formdev.flatlaf.themes.FlatMacLightLaf());

                                    // When using the FlatMac themes along with "Button.defaultButtonFollowsFocus" being set to "true" (which offers great functionality),
                                    // the bright blue highlighted default button moving around the window looks bad to me, but the rest of the "FlatMac" theme changes are good.
                                    // So, set the following theme values to the default values from the non-Mac themes to continue using the default FlatLaf button style with the FlatMac themes.
                                    // These values were determined by seeing what was changed by comparing these dumps: https://github.com/JFormDesigner/FlatLaf/tree/main/flatlaf-testing/dumps/uidefaults
                                    String[] resetUIDefaults = new String[]{"Component.focusWidth", "Component.innerFocusWidth", "Component.innerOutlineWidth",
                                        "Button.default.borderWidth", "Button.default.foreground", "Button.default.background", "Button.default.focusedBackground"};
                                    for (String thisUIDefault : resetUIDefaults) {
                                        UIManager.put(thisUIDefault, defaultLaf.getDefaults().get(thisUIDefault));
                                    }
                                } else {
                                    UIManager.setLookAndFeel(defaultLaf);
                                }

                                themeUpdated = true;

                                displayComputerSpecs();
                            } catch (UnsupportedLookAndFeelException updateFlatLafThemeException) {
                                if (isTestMode) {
                                    System.out.println("updateFlatLafThemeException: " + updateFlatLafThemeException);
                                }
                            }
                        }
                    }
                }
            }
        });

        reload();
    }

    private void setActionsEnabled(boolean shouldEnable) {
        setActionsEnabled(shouldEnable, true);
    }

    private void setActionsEnabled(boolean shouldEnable, boolean shouldFocusWindow) {
        // Do not want to use setEnabled() for the whole frame because that makes the window unfocusable and unmovable on Windows.

        actionsEnabled = shouldEnable;

        if (txtUsername.isVisible()) {
            txtUsername.setEnabled(shouldEnable);
        }

        if (pswPassword.isVisible()) {
            pswPassword.setEnabled(shouldEnable);
        }

        if (txtPID.isVisible()) {
            txtPID.setEnabled(shouldEnable);
        }

        if (shouldEnable && shouldFocusWindow) {
            focusWindow();
        }
    }

    private void focusWindow() {
        setVisible(true);
        setState(Frame.NORMAL);
        toFront();

        try {
            Desktop.getDesktop().requestForeground(true);
        } catch (Exception requestForegroundException) {
            //if (isTestMode) System.out.println("requestForegroundException: " + requestForegroundException); // Don't show this cuz never works and just litters when actually debugging.

            if (!isWindows || !isWindowsPE) { // No need to for this extra focus in WinPE since it's always on top. Also, it causes some disruption because of its delay in running after being called when QA Helper may have since ICONIFIED itself. 
                try {
                    Runtime.getRuntime().exec((isWindows
                            // Based On: https://stackoverflow.com/a/58548853
                            // This new method is much better than the previous AppActivate method, but still also do the AppActive method since it seems to maybe not work as well on Windows 11.
                            ? new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$focusWindowFunctionTypes = Add-Type -PassThru -Name FocusWindow -MemberDefinition @'\n"
                                + "[DllImport(\\\"user32.dll\\\")] public static extern bool SetForegroundWindow(IntPtr hWnd);\n"
                                + "[DllImport(\\\"user32.dll\\\")] public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);\n"
                                + "[DllImport(\\\"user32.dll\\\")] public static extern bool IsIconic(IntPtr hWnd);\n"
                                + "'@\n"
                                + "$qaHelperPID = (Get-CimInstance Win32_Process -Filter \\\"Name LIKE 'java%.exe' AND CommandLine LIKE '%QA_Helper.jar%'\\\" -Property ProcessId).ProcessId\n"
                                + "if ($qaHelperPID) {\n"
                                + "$qaHelperWindowHandle = (Get-Process | Where-Object Id -eq $qaHelperPID).MainWindowHandle\n"
                                + "if ($qaHelperWindowHandle) {\n"
                                + "$focusWindowFunctionTypes::SetForegroundWindow($qaHelperWindowHandle) | Out-Null\n"
                                + "if ($focusWindowFunctionTypes::IsIconic($qaHelperWindowHandle)) {\n"
                                + "$focusWindowFunctionTypes::ShowWindow($qaHelperWindowHandle, 9) | Out-Null\n"
                                + "}\n"
                                + "}\n"
                                + "}\n"
                                + "$WshellScript = (New-Object -ComObject Wscript.Shell); if (-not $WshellScript.AppActivate('QA Helper')) { $WshellScript.AppActivate('QA Helper  —  Loading') }"
                            }
                            : (isLinux
                                    ? new String[]{"/bin/sh", "-c", "/usr/bin/wmctrl -Fa 'QA Helper' || /usr/bin/wmctrl -Fa 'QA Helper  —  Loading'"}
                            : new String[]{"/usr/bin/osascript", "-e", "if (application id \"org.freegeek.QA-Helper\" is running) then tell application id \"org.freegeek.QA-Helper\" to activate"}))
                    );
                } catch (IOException focusQAHelperException) {
                    if (isTestMode) {
                        System.out.println("focusQAHelperException: " + focusQAHelperException);
                    }
                }
            }
        }
    }

    private void logDebugSpecs(String action) {
        if (computerSpecs != null) {
            try {
                if (isTestMode) {
                    action = "TEST MODE - " + action;
                }

                // TODO: Do in Java. Eventually.
                if (isWindows) {
                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command",
                        "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12, [Net.SecurityProtocolType]::Ssl3;"
                        + "Invoke-RestMethod -Uri " + privateStrings.logSpecsURL() + " -TimeoutSec 15 -Method POST -Body @{"
                        + "action='" + action + "';"
                        + "pid='" + pid + "';"
                        + "user='" + username + "';"
                        + "brand='" + computerSpecs.getFullBrand() + "';"
                        + "model='" + computerSpecs.getFullModel() + "';"
                        + "serial='" + computerSpecs.getFullSerial() + "';"
                        + "os='" + computerSpecs.getFullOS() + "';"
                        + "chassis='" + computerSpecs.getChassisType() + "';"
                        + "cpu='" + computerSpecs.getFullCPU() + "';"
                        + "ram='" + computerSpecs.getFullRAM() + "';"
                        + "battery='" + computerSpecs.getBatteryCapacity() + "';"
                        + "storage='" + computerSpecs.getFullStorage() + "';"
                        + "gpu='" + computerSpecs.getFullGPU() + "';"
                        + "audio='" + computerSpecs.getFullAudio() + "';"
                        + "wireless='" + computerSpecs.getWireless() + "';"
                        + "screen='" + computerSpecs.getFullScreenSize() + "';"
                        + "disc_drive='" + computerSpecs.getFullDiscDrive() + "';"
                        + "mac='" + computerSpecs.getEthernetMAC() + "';"
                        + "version='" + appVersion + "';"
                        + "}"
                    });
                } else {
                    // Putting quotes around the post arguments is bad for some reason. They quotes get escaped and included in the keys and values
                    Runtime.getRuntime().exec(new String[]{"/usr/bin/curl", "--connect-timeout", "5", "-sfL", privateStrings.logSpecsURL(),
                        "--data-urlencode", "action=" + action,
                        "--data-urlencode", "pid=" + pid,
                        "--data-urlencode", "user=" + username,
                        "--data-urlencode", "brand=" + computerSpecs.getFullBrand(),
                        "--data-urlencode", "model=" + computerSpecs.getFullModel(),
                        "--data-urlencode", "serial=" + computerSpecs.getFullSerial(),
                        "--data-urlencode", "os=" + computerSpecs.getFullOS(),
                        "--data-urlencode", "chassis=" + computerSpecs.getChassisType(),
                        "--data-urlencode", "cpu=" + computerSpecs.getFullCPU(),
                        "--data-urlencode", "ram=" + computerSpecs.getFullRAM(),
                        "--data-urlencode", "battery=" + computerSpecs.getBatteryCapacity(),
                        "--data-urlencode", "storage=" + computerSpecs.getFullStorage(),
                        "--data-urlencode", "gpu=" + computerSpecs.getFullGPU(),
                        "--data-urlencode", "audio=" + computerSpecs.getFullAudio(),
                        "--data-urlencode", "wireless=" + computerSpecs.getWireless(),
                        "--data-urlencode", "screen=" + computerSpecs.getFullScreenSize(),
                        "--data-urlencode", "disc_drive=" + computerSpecs.getFullDiscDrive(),
                        "--data-urlencode", "mac=" + computerSpecs.getEthernetMAC(),
                        "--data-urlencode", "version=" + appVersion});
                }
            } catch (IOException logDebugSpecsException) {
                if (isTestMode) {
                    System.out.println("logDebugSpecsException: " + logDebugSpecsException);
                }
            }
        }
    }

    private void sendErrorEmail(String errorMessage) {
        try {
            String errorPID = pid;
            if (errorPID.equals("N/A")) {
                String possiblePID = txtPID.getText().trim().toUpperCase();
                if (!possiblePID.isEmpty()) {
                    errorPID = possiblePID;
                }
            }

            errorMessage = "<b>OS:</b> " + ((computerSpecs != null) ? computerSpecs.getFullOS() : "Specs Not Yet Loaded") + "<br/>"
                    + "<b>Serial:</b> " + ((computerSpecs != null) ? computerSpecs.getFullSerial() : "Specs Not Yet Loaded") + "<br/><br/>"
                    + "<b>PID:</b> " + errorPID + (isTestMode ? " (Test Mode)" : "") + "<br/>"
                    + "<b>User:</b> " + username + "<br/><br/>"
                    + "<b>Error Message:</b><br/><span style=\"font-family: monospace;\">" + errorMessage.replace("<br/>", "\n").replace("<br>", "\n").replace("<", "&lt;").replace(">", "&gt;").replace("\n", "<br/>") + "</span>";

            String sendErrorEmailTo = privateStrings.errorEmailToAddress();
            String sendErrorEmailFrom = privateStrings.errorEmailFromAddress();
            String sendGridAPIKey = privateStrings.sendGridAPIKey();

            // TODO: Do in Java. Eventually.
            if (isWindows) {
                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command",
                    "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12, [Net.SecurityProtocolType]::Ssl3;"
                    + "Invoke-RestMethod -Uri https://api.sendgrid.com/v3/mail/send -TimeoutSec 15 -Method POST"
                    + "-Headers @{Authorization = 'Bearer " + sendGridAPIKey + "'; 'Content-Type' = 'application/json'}"
                    + "-Body (@{personalizations = @(@{to = @(@{email = '" + sendErrorEmailTo + "'})}); from = @{email = '" + sendErrorEmailFrom + "'}; subject = 'QA Helper Error'; content = @(@{type = 'text/html'; value = '" + errorMessage.replace("'", "''") + "'})} | ConvertTo-Json -Depth 4 -Compress)"
                });
            } else {
                Runtime.getRuntime().exec(new String[]{"/usr/bin/curl", "--connect-timeout", "5", "-sfL", "https://api.sendgrid.com/v3/mail/send",
                    "--header", "Authorization: Bearer " + sendGridAPIKey,
                    "--header", "Content-Type: application/json",
                    "--data", "{\"personalizations\": [{\"to\": [{\"email\": \"" + sendErrorEmailTo + "\"}]}], \"from\": {\"email\": \"" + sendErrorEmailFrom + "\"}, \"subject\": \"QA Helper Error\", \"content\": [{\"type\": \"text/html\", \"value\": \"" + errorMessage.replace("\\", "\\\\").replace("\"", "\\\"") + "\"}]}"
                });
            }
        } catch (IOException sendErrorEmailException) {
            if (isTestMode) {
                System.out.println("sendErrorEmailException: " + sendErrorEmailException);
            }
        }
    }

    private void reload() {
        reload(true);
    }

    private void reload(boolean reloadSpecs) {
        if (!isReloading) {
            isReloading = true;
            setActionsEnabled(false);

            if (reloadSpecs || (isLinux && (adminPassword.equals("*UNKNOWN*") || !new CommandReader("printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")))) {
                loadingWindow.setLoadingTextAndDisplay("QA Helper is Loading Computer Specs", "Loading");

                boolean wasFirstLoad = isFirstLoad;

                if (!reloadSpecs) {
                    displayComputerSpecs(); // To display updated status before fully reloading
                }

                long startLoadTime = System.currentTimeMillis();

                (new SwingWorker<String[], Void>() {
                    @Override
                    protected String[] doInBackground() throws Exception {
                        String previousAdminPassword = adminPassword;
                        getAdminPassword("Load Computer Specs");

                        if (wasFirstLoad) {
                            autoUpdateApp(); // Only check for updates on first load
                            new LinuxAutoScripts("Launch", adminPassword); // Only run launch auto scripts on first load
                        }

                        if (reloadSpecs || !adminPassword.equals(previousAdminPassword)) {
                            if (computerSpecs == null) {
                                computerSpecs = new GetComputerSpecs(adminPassword, isTestMode);
                            } else {
                                computerSpecs.reloadSpecs(adminPassword, isTestMode);
                            }
                        }

                        if (isLinuxFirstLaunch) {
                            try {
                                File linuxFlagsDirectory = new File(System.getProperty("user.home") + "/.local/qa-helper/flags/");
                                linuxFlagsDirectory.mkdirs();

                                if (!linuxFlagsDirectory.exists()) {
                                    String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");
                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/bin/mkdir -p '" + linuxFlagsDirectory.getPath().replace("'", "'\\''") + "' && " + possibleSudo + "/bin/chmod 777 '" + linuxFlagsDirectory.getPath().replace("'", "'\\''") + "'"});
                                }

                                new File(linuxFlagsDirectory, "launched-before.flag").createNewFile();
                            } catch (IOException createLaunchedBeforeFlagException) {
                                if (isTestMode) {
                                    System.out.println("createLaunchedBeforeFlagException: " + createLaunchedBeforeFlagException);
                                }
                            }

                            if (isLinuxUbiquityMode) {
                                if (new File("/tmp/post_install_time.sh").exists()) {
                                    try {
                                        String postInstallTimesScriptContents = String.join("\n", Files.readAllLines(Paths.get("/tmp/post_install_time.sh"), StandardCharsets.UTF_8));

                                        if (!postInstallTimesScriptContents.contains("serial=" + computerSpecs.getFullSerial())) {
                                            try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(new File("/tmp/post_install_time.sh"), true))) {
                                                bufferedWriter.write(
                                                        "--data-urlencode \"serial=" + computerSpecs.getFullSerial() + "\" \\" + "\n"
                                                        + "--data-urlencode \"cpu=" + computerSpecs.getFullCPU() + "\" \\" + "\n"
                                                        + "--data-urlencode \"ram=" + computerSpecs.getFullRAM() + "\" \\" + "\n"
                                                );
                                            } catch (IOException logSpecsForInstallTimingLogException) {
                                                if (isTestMode) {
                                                    System.out.println("logSpecsForInstallTimingLogException: " + logSpecsForInstallTimingLogException);
                                                }
                                            }
                                        }
                                    } catch (IOException readPostInstallTimesScriptContentsException) {
                                        if (isTestMode) {
                                            System.out.println("readPostInstallTimesScriptContentsException: " + readPostInstallTimesScriptContentsException);
                                        }
                                    }
                                }

                                if (!new File("/tmp/detailed_hostname.txt").exists()) {
                                    String detailedHostname = "FreeGeek-" + (computerSpecs.isLaptop() ? "Laptop" : (computerSpecs.hasScreen() ? "AllInOne" : "Desktop")) + "-" + computerSpecs.getSerial().replaceAll("[^A-Za-z0-9]", "") + "-" + computerSpecs.getModel().replaceAll("[^A-Za-z0-9]", "");
                                    if (detailedHostname.length() > 64) {
                                        detailedHostname = detailedHostname.substring(0, 64);
                                    }

                                    try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(new File("/tmp/detailed_hostname.txt")))) {
                                        bufferedWriter.write(detailedHostname);

                                        loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE); // Allow closing loading window to quit now that the important file has been made.
                                    } catch (IOException saveDetailedHostNameException) {
                                        if (isTestMode) {
                                            System.out.println("saveDetailedHostNameException: " + saveDetailedHostNameException);
                                        }
                                    }
                                }
                            }
                        } else if (isWindows) {
                            createWindowsDriversCacheModelNameFile();
                            loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE); // Allow closing loading window to quit now that the important file has been made.
                        }

                        return (isLoggedIn ? getHistory(false) : null);
                    }

                    @Override
                    protected void done() {
                        long endLoadTime = System.currentTimeMillis();

                        if (isMacOS && wasFirstLoad && new File("/Users/fg-demo/Applications/Free Geek Setup.app").exists()) {
                            // Do this check AFTER checking for updates so that if things change I can change behavior with an update instead of loading being blocked because this was hit before updating.

                            loadingWindow.closeWindow();

                            JOptionPane.showMessageDialog(null, "<html><b><i>Free Geek Setup</i> Hasn't Been Run Yet</b><br/><br/>Please run <i>Free Geek Setup</i> and then try running <i>QA Helper</i> again.</html>", "QA Helper  —  Free Geek Setup Not Run", JOptionPane.ERROR_MESSAGE);

                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", "/Users/fg-demo/Applications/Free Geek Setup.app"});
                            } catch (IOException launchFreeGeekSetupError) {
                                System.out.println("launchFreeGeekSetupError: " + launchFreeGeekSetupError);
                            }
                            System.exit(0);
                        }

                        if (isLoggedIn) {
                            try {
                                String[] currentStatusAndTech = get();
                                displayComputerSpecs(currentStatusAndTech);
                            } catch (InterruptedException | ExecutionException reloadException) {
                                if (isTestMode) {
                                    System.out.println("reloadException: " + reloadException);
                                }
                            }
                        } else {
                            displayComputerSpecs();
                        }

                        if (isLinuxFirstLaunch && !lastStatus.equals("UNKNOWN STATUS")) {
                            new LinuxAutoScripts(lastStatus, adminPassword);

                            isLinuxFirstLaunch = false;
                        }

                        if (!isVisible()) {
                            logDebugSpecs("Launch (" + (endLoadTime - startLoadTime) + " ms)");

                            ignoreWindowMovesUntilTime = System.currentTimeMillis() + 1500;

                            setLocationRelativeTo(null);
                            setActionsEnabled(true);

                            loadingWindow.closeWindow();
                            loadingWindow.setAlwaysOnTop(true);
                        } else {
                            setActionsEnabled(true, false);
                            loadingWindow.closeWindow();
                        }

                        focusNextTestTaskVerifyButton(null);
                        focusWindow();

                        if (isLinux && wasFirstLoad) {
                            // On Linux, when loading the window before it is visible, the Verify buttons on the right side of the
                            // window end up not horizontally aligned (1 pixel below) with their Test buttons for some reason.
                            // When adding text size adjustments, I found that changing the text size fixed this alignment issue.
                            // From testing, I found that the alignment got fixed even when resetting the default font size.
                            // So, to force the alignment to be fixed right away, reset the default font size after making the window visible.
                            // Not sure why exactly this works, but it does!

                            menResetTextSizeActionPerformed(null);
                        }

                        if (wasFirstLoad && (isLinuxUbiquityMode || isWindowsPE)) {
                            List<String> allowedJavaVersions = Arrays.asList("21.0.1", "21.0.2");
                            String runningJavaVersion = System.getProperty("java.version");
                            if (!allowedJavaVersions.contains(runningJavaVersion)) {
                                playAlertSound("error");
                                sendErrorEmail("Outdated " + (isLinuxUbiquityMode ? "Linux" : "Windows") + " Installer (Java: " + runningJavaVersion + ")");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>This Installer Is Outdated</b><br/><br/>If this is a network installation, please inform Free Geek I.T.<br/><br/>If this is a USB installer, please deliver it to Free Geek I.T.</html>", "QA Helper  —  Outdated Installer", JOptionPane.ERROR_MESSAGE);
                            }
                        }

                        if (computerSpecs == null) {
                            playAlertSound("error");
                            sendErrorEmail("Failed to Load Computer Specs");
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Load Computer Specs</b><br/><br/>This should not have happened, please inform Free Geek I.T.</html>", "QA Helper  —  Load Specs Failed", JOptionPane.ERROR_MESSAGE);
                        } else if (computerSpecs.didError()) {
                            playAlertSound("error");
                            sendErrorEmail("Error Loading Computer Specs");
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Error Loading Computer Specs</b><br/><br/>This should not have happened, please inform Free Geek I.T.</html>", "QA Helper  —  Load Specs Error", JOptionPane.ERROR_MESSAGE);
                        }

                        if (wasFirstLoad) {
                            // If the resolution is small enough to have scrollbars visible on first load,
                            // automatically reduce text size until scroll bars are no longer visible.

                            setActionsEnabled(false);

                            (new SwingWorker<Void, String>() {
                                @Override
                                protected Void doInBackground() throws Exception {
                                    while (themeUpdated) { // Make sure the initial display update is fully done before checking for scrollbars.
                                        TimeUnit.MILLISECONDS.sleep(10);
                                    }

                                    while ((UIManager.getFont("defaultFont").getSize() > 6) && (contentScrollPane.getHorizontalScrollBar().isVisible() || contentScrollPane.getVerticalScrollBar().isVisible())) {
                                        themeUpdated = true; // Must set "themeUpdated" to "true" before calling "menDecreaseTextSizeActionPerformed" on the main thread since it might not get updated in this background thread immediately causing the wait loop would never get hit.

                                        publish("decrease-text-size"); // The size change must happen on the main thread, but we want to wait for the display update in the background.

                                        while (themeUpdated) { // Wait until the display update is completely finished before checking whether or not scrollbars are visible and decreasing again if necessary.
                                            TimeUnit.MILLISECONDS.sleep(10);
                                        }
                                    }

                                    return null;
                                }

                                @Override
                                protected void process(java.util.List<String> tasks) {
                                    menDecreaseTextSizeActionPerformed(null);
                                }

                                @Override
                                protected void done() {
                                    setActionsEnabled(true);
                                    isReloading = false;
                                }
                            }).execute();
                        } else {
                            isReloading = false;
                        }
                    }
                }).execute();
            } else {
                displayComputerSpecs();

                if (!loadingWindow.isVisible()) {
                    setActionsEnabled(true);
                    focusNextTestTaskVerifyButton(null);
                    focusWindow();
                }

                isReloading = false;
            }
        } else {
            loadingWindow.setVisible(true);
        }
    }

    private void getAdminPassword(String passwordPromptReason) {
        try {
            if (!isLinux) {
                adminPassword = "*MacDoesNotNeedAdmin*"; // Mac doesn't need admin password, change it from "*UNKNOWN*" so reload() doesn't keep trying
                adminPasswordQuotedForShell = "'" + adminPassword + "'";
                return;
            }

            // Make sure previous admin password is still correct (it gets changed at the end of Free Geek builds).
            if (!adminPassword.equals("*UNKNOWN*") && new CommandReader("printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")) {
                return;
            }

            List<String> currentUserGroups = Arrays.asList(new CommandReader(new String[]{"/usr/bin/groups"}).getFirstOutputLine().split(" "));

            if (currentUserGroups.contains("root")) {
                if (new CommandReader("echo '' | /usr/bin/sudo -Sk echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")) {
                    adminPassword = "";
                    adminPasswordQuotedForShell = "''";
                    return;
                }
            } else if (!currentUserGroups.contains("adm") && !currentUserGroups.contains("admin") && !currentUserGroups.contains("sudo") && !currentUserGroups.contains("sudoers")) {
                loadingWindow.setAlwaysOnTop(false);
                playAlertSound("error");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>You must be logged in as an Admin or Sudo user to be able to <i>" + passwordPromptReason + "</i>.</b></html>", "QA Helper  —  Admin Warning", JOptionPane.WARNING_MESSAGE);
                loadingWindow.setAlwaysOnTop(true);
                return;
            }

            ArrayList<String> possibleAdminPasswords = new ArrayList<>();

            String configFile = "";
            ArrayList<String> configLines = new ArrayList<>();

            try {
                String launchPath = new File(LinuxAutoScripts.class.getProtectionDomain().getCodeSource().getLocation().toURI()).getPath();

                if (launchPath.endsWith(".jar")) {
                    String launchDirectory = launchPath.substring(0, launchPath.lastIndexOf("/"));
                    String defaultDirectory = System.getProperty("user.home") + "/.local/qa-helper";

                    configFile = launchDirectory + "/qa-helper.config";
                    if (!new File(configFile).exists()) {
                        configFile = defaultDirectory + "/qa-helper.config";
                    }

                    if (new File(configFile).exists()) {
                        configLines.addAll(Arrays.asList(new CommandReader(new String[]{"/usr/bin/unzip", "-P", configPassword, "-p", configFile}).getOutputLines()));
                    }
                }
            } catch (URISyntaxException readConfigFileException) {
                if (isTestMode) {
                    System.out.println("readConfigFileException: " + readConfigFileException);
                }
            }

            configLines.forEach((thisConfigLine) -> {
                if (thisConfigLine.startsWith("Admin Password: ")) {
                    possibleAdminPasswords.add(thisConfigLine.substring(16));
                }
            });

            String shortCurrentUsername = new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine();

            if (possibleAdminPasswords.isEmpty()) {
                // If no passwords are in the config, try some known passwords.
                if (shortCurrentUsername.equals("oem")) {
                    // This will always be the Free Geek username.
                    possibleAdminPasswords.add(privateStrings.getInsecureFreeGeekPassword());
                    possibleAdminPasswords.add(privateStrings.getCurrentFreeGeekPassword());
                    possibleAdminPasswords.add(privateStrings.getPreviousFreeGeekPassword());
                    possibleAdminPasswords.add(privateStrings.getOlderFreeGeekPassword());
                }

                possibleAdminPasswords.add(privateStrings.getGenericPassword());
                possibleAdminPasswords.add(""); // Always check empty string to see if no password is needed (like on live boots).
            } else if ((possibleAdminPasswords.contains(privateStrings.getPreviousFreeGeekPassword()) && possibleAdminPasswords.size() == 3) || (possibleAdminPasswords.contains(privateStrings.getOlderFreeGeekPassword()) && possibleAdminPasswords.size() == 2)) {
                possibleAdminPasswords.add(privateStrings.getCurrentFreeGeekPassword()); // Make sure the current Store password gets included if an old config is loaded.
            }
            for (String thisPossibleAdminPassword : possibleAdminPasswords) {
                String thisPossibleAdminPasswordQuotedForShell = "'" + thisPossibleAdminPassword.replace("'", "'\\''") + "'";
                if (new CommandReader("printf '%s\\n' " + thisPossibleAdminPasswordQuotedForShell + " | /usr/bin/sudo -Sk echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")) {
                    adminPassword = thisPossibleAdminPassword;
                    adminPasswordQuotedForShell = thisPossibleAdminPasswordQuotedForShell;
                    return;
                }
            }

            String fullCurrentUsername = new CommandReader(new String[]{"/usr/bin/getent", "passwd", shortCurrentUsername}).getFirstOutputLine().split(":")[4].replace(",", "");

            while (true) {
                JPasswordField passwordField = new JPasswordField();
                passwordField.putClientProperty("JTextField.showClearButton", true);

                JCheckBox saveAdminPasswordCheckbox = new JCheckBox("Save Admin Password in QA Helper's encrypted configuration file for future use.");
                saveAdminPasswordCheckbox.setSelected(true);

                Object[] passwordPromptFields = new Object[]{
                    "<html><b>Enter Admin Password for \"" + fullCurrentUsername + "\" to <i>" + passwordPromptReason + "</i>:</b></html>",
                    passwordField,
                    (configFile.isEmpty() ? "" : saveAdminPasswordCheckbox)
                };

                JOptionPane passwordPromptPane = new JOptionPane(passwordPromptFields, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION) {
                    @Override
                    public void selectInitialValue() {
                        passwordField.requestFocusInWindow();
                    }
                };

                loadingWindow.setAlwaysOnTop(false);
                passwordPromptPane.createDialog(qaHelperWindow, "QA Helper  —  Admin Password").setVisible(true);
                loadingWindow.setAlwaysOnTop(true);

                if (passwordPromptPane.getValue() != null && (int) passwordPromptPane.getValue() == JOptionPane.OK_OPTION) {
                    String possibleAdminPassword = new String(passwordField.getPassword());
                    String possibleAdminPasswordQuotedForShell = "'" + possibleAdminPassword.replace("'", "'\\''") + "'";

                    if (new CommandReader("printf '%s\\n' " + possibleAdminPasswordQuotedForShell + " | /usr/bin/sudo -Sk echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")) {
                        adminPassword = possibleAdminPassword;
                        adminPasswordQuotedForShell = possibleAdminPasswordQuotedForShell;

                        if (!configFile.isEmpty() && saveAdminPasswordCheckbox.isSelected()) {
                            try {
                                configLines.add(0, "Admin Password: " + adminPassword); // Add new passwords to front so they are tried first.
                                Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' '" + String.join("\n", configLines).replace("'", "'\\''") + "' | /usr/bin/zip -P '" + configPassword.replace("'", "'\\''") + "' > '" + configFile.replace("'", "'\\''") + "'"});
                            } catch (IOException updateConfigFileException) {
                                if (isTestMode) {
                                    System.out.println("updateConfigFileException: " + updateConfigFileException);
                                }
                            }
                        }

                        break;
                    } else {
                        playAlertSound("error");
                    }
                } else {
                    break;
                }
            }
        } catch (HeadlessException | SecurityException getAdminPasswordException) {
            playAlertSound("error");
            if (isTestMode) {
                System.out.println("getAdminPasswordException: " + getAdminPasswordException);
            }
            adminPassword = "*UNKNOWN*";
            adminPasswordQuotedForShell = "'" + adminPassword + "'";
        }
    }

    private void autoUpdateApp() {
        try {
            if (!isLinuxUbiquityMode && !isWindowsPE) {
                boolean shouldCheckForUpdates = false;

                URI launchURI = QAHelper.class.getProtectionDomain().getCodeSource().getLocation().toURI();
                String launchURIString = launchURI.toString();

                String launchPath;
                if (isWindows && launchURIString.startsWith("file://")) {
                    launchPath = new File(launchURIString.replace("file://", "//").replace("%20", " ")).getPath(); // To fix server (or Parallels shared folder) paths on Windows.
                } else {
                    launchPath = new File(launchURI).getPath();
                }

                String launchDirectory = launchPath.substring(0, launchPath.lastIndexOf((isWindows ? "\\" : "/")));
                String javaPath = launchDirectory + "/java-jre/bin/java";

                if (isLinux) {
                    String runningJarInfo = new CommandReader(new String[]{"/usr/bin/pgrep", "-fa", "QA_Helper.jar"}).getFirstOutputLineNotContaining(" sudo");
                    String runningJarInfoFirstPart = runningJarInfo.split(" -jar ")[0];
                    javaPath = runningJarInfoFirstPart.substring(runningJarInfoFirstPart.indexOf(" ") + 1);
                } else if (isWindows) {
                    javaPath = new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(Get-CimInstance Win32_Process -Filter \\\"Name LIKE 'java%.exe' AND CommandLine LIKE '%QA_Helper.jar%'\\\").Path"}).getFirstOutputLine();
                    if (javaPath.endsWith("java.exe")) {
                        javaPath = javaPath.replace("java.exe", "javaw.exe");
                    }
                }

                if (!isLinux && (launchPath.endsWith(".app/Contents/Java/QA_Helper.jar") || launchPath.endsWith(".app/Contents/app/QA_Helper.jar"))) {
                    launchPath = launchPath.replace("/Contents/Java/QA_Helper.jar", "").replace("/Contents/app/QA_Helper.jar", "");
                    launchDirectory = launchPath.substring(0, launchPath.lastIndexOf("/"));

                    shouldCheckForUpdates = true;
                } else if (launchPath.endsWith(".jar")) {
                    if (!new File(javaPath).exists() && !isWindows) {
                        javaPath = "/usr/bin/java";
                    }
                    shouldCheckForUpdates = !javaPath.isEmpty();
                }

                if (shouldCheckForUpdates) {
                    // CANNOT use "computerSpecs.getFullOS()" here to pass the OS version during update check since it's not loaded yet.
                    String osFromJava = System.getProperty("os.name") + " " + System.getProperty("os.version");
                    String latestVersion = new CommandReader((isWindows
                            ? new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command",
                                "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12, [Net.SecurityProtocolType]::Ssl3;"
                                + "(Invoke-WebRequest https://apps.freegeek.org/qa-helper/download/latest-version.php -UseBasicParsing -TimeoutSec 5 -Method POST -Body @{"
                                + "os='" + osFromJava + "';"
                                + "version='" + appVersion + "';"
                                + "}).Content"
                            }
                            : new String[]{"/usr/bin/curl", "-m", "5", "-sfL", "https://apps.freegeek.org/qa-helper/download/latest-version.php", "--data-urlencode", "os=" + osFromJava, "--data-urlencode", "version=" + appVersion})
                    ).getFirstOutputLine(); // TODO: Do in Java. Eventually.

                    if (!latestVersion.isEmpty() && !latestVersion.equals(appVersion)) {
                        String[] currentVersionParts = appVersion.replaceAll("[^0-9.-]", "").split("-");
                        String[] latestVersionParts = latestVersion.replaceAll("[^0-9.-]", "").split("-");

                        SimpleDateFormat versionDateFormat = new SimpleDateFormat("yyyy.MM.dd");
                        Date currentVersionDate = versionDateFormat.parse(currentVersionParts[0]);
                        Date latestVersionDate = versionDateFormat.parse(latestVersionParts[0]);
                        int versionDateComparison = latestVersionDate.compareTo(currentVersionDate);

                        if (versionDateComparison == 1 || (versionDateComparison == 0 && currentVersionParts.length == 2 && latestVersionParts.length == 2
                                && Double.parseDouble(latestVersionParts[1]) > Double.parseDouble(currentVersionParts[1]))) {
                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Updating Itself", "Updating", "CounterclockwiseArrowsButton");

                            String tempDirectory = System.getProperty("java.io.tmpdir");
                            if (!tempDirectory.endsWith(isWindows ? "\\" : "/")) {
                                tempDirectory += (isWindows ? "\\" : "/");
                            }

                            if (launchPath.endsWith(".jar")) {
                                String possibleSudo = (isLinux && !adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");

                                String appUpdateZipFilename = (isLinux ? "QAHelper-linux-jar.zip" : (isWindows ? "QAHelper-windows-jar.zip" : "QAHelper-jar.zip"));
                                String appUpdateJarFilename = "QA_Helper.jar";

                                String appUpdateZipFilePath = tempDirectory + appUpdateZipFilename;
                                String appUpdateJarTempFilePath = tempDirectory + appUpdateJarFilename;

                                File appUpdateZipFile = new File(appUpdateZipFilePath);
                                if (appUpdateZipFile.exists()) {
                                    appUpdateZipFile.delete();
                                }

                                File appUpdateJarTempFile = new File(appUpdateJarTempFilePath);
                                if (appUpdateJarTempFile.exists()) {
                                    appUpdateJarTempFile.delete();
                                }

                                if (isWindows) {
                                    if (new File(tempDirectory, "qa_helper-update_finisher.cmd").exists()) {
                                        new File(tempDirectory, "qa_helper-update_finisher.cmd").delete();
                                    }

                                    if (new File(tempDirectory, "qa-helper_update-finisher.cmd").exists()) { // OLD naming format
                                        new File(tempDirectory, "qa-helper_update-finisher.cmd").delete();
                                    }

                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command",
                                        "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12, [Net.SecurityProtocolType]::Ssl3;"
                                        + "Invoke-WebRequest https://apps.freegeek.org/qa-helper/download/" + appUpdateZipFilename + " -OutFile '" + appUpdateZipFilePath + "';" // TODO: Do in Java. Eventually.
                                        + "Expand-Archive '" + appUpdateZipFilePath + "' -DestinationPath " + tempDirectory + " -Force;"
                                    }).waitFor();
                                } else {
                                    if (appUpdateZipFile.exists()) {
                                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/bin/rm -f '" + appUpdateZipFilePath.replace("'", "'\\''") + "'"}).waitFor();
                                    }
                                    if (appUpdateJarTempFile.exists()) {
                                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/bin/rm -f '" + appUpdateJarTempFilePath.replace("'", "'\\''") + "'"}).waitFor();
                                    }

                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/curl", "--connect-timeout", "5", "-sfL", "https://apps.freegeek.org/qa-helper/download/" + appUpdateZipFilename, "-o", appUpdateZipFilePath}).waitFor(); // TODO: Do in Java. Eventually.
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/unzip", "-o", "-j", appUpdateZipFilePath, appUpdateJarFilename, "-d", tempDirectory}).waitFor();
                                }

                                if (appUpdateZipFile.exists()) {
                                    appUpdateZipFile.delete();
                                }

                                String downloadedJarVersion = "";

                                if (new File(appUpdateJarTempFilePath).exists()) {
                                    if (isWindows) {
                                        downloadedJarVersion = new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command",
                                            "Add-Type -AssemblyName System.IO.Compression.FileSystem;"
                                            + "$qaHelperJar = [System.IO.Compression.ZipFile]::OpenRead('" + appUpdateJarTempFilePath + "');"
                                            + "$qaHelperJar.Entries | Where-Object { $_.Name -eq 'qa-helper-version.txt' } | Select-Object -First 1 { [System.IO.Compression.ZipFileExtensions]::ExtractToFile($_, '" + tempDirectory + "qa_helper-downloaded_version.txt', $true) } | Out-Null;"
                                            + "$qaHelperJar.Dispose();"
                                            + "$downloadedJarVersion = Get-Content '" + tempDirectory + "qa_helper-downloaded_version.txt' -First 1;"
                                            + "Remove-Item '" + tempDirectory + "qa_helper-downloaded_version.txt' -Force;"
                                            + "Write-Output $downloadedJarVersion;"
                                        }).getFirstOutputLine();
                                    } else {
                                        downloadedJarVersion = new CommandReader(new String[]{"/usr/bin/unzip", "-p", appUpdateJarTempFilePath, "*/qa-helper-version.txt"}).getFirstOutputLine();
                                    }
                                }

                                if (!downloadedJarVersion.isEmpty() && downloadedJarVersion.equals(latestVersion)) {
                                    if (!isWindows) {
                                        // Windows needs the current process to quit before it will allow the file to be overwritten
                                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/bin/mv -f '" + appUpdateJarTempFilePath.replace("'", "'\\''") + "' '" + launchPath.replace("'", "'\\''") + "'"}).waitFor(); // Would not get moved with sudo when app was quit before this command for some reason.
                                    }
                                    if (!isWindows && new File(launchPath).exists() && !new File(appUpdateJarTempFilePath).exists()) {
                                        Runtime.getRuntime().exec(new String[]{"/bin/bash", "-c", "/bin/sleep 1; while [[ \"$(/usr/bin/pgrep -fl 'QA_Helper.jar')\" == *java* ]]; do " + (isLinux ? "/usr/bin/wmctrl -Fc 'QA Helper  —  Updating' || /usr/bin/wmctrl -Fc 'QA Helper  —  Loading' || /usr/bin/wmctrl -Fc 'QA Helper'; /bin/sleep 1;" : "/bin/sleep 1;") + " done; '" + javaPath.replace("'", "'\\''") + "' -jar '" + launchPath.replace("'", "'\\''") + "' & disown"});

                                        System.exit(0);
                                    } else if (isWindows && new File(launchPath).exists() && new File(appUpdateJarTempFilePath).exists()) {
                                        File windowsQAhelperUpdateFinisherFile = new File(tempDirectory, "qa_helper-update_finisher.cmd");

                                        try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(windowsQAhelperUpdateFinisherFile))) {
                                            bufferedWriter.write(
                                                    "@ECHO OFF" + "\n"
                                                    + "\n"
                                                    + ":WaitForQuit" + "\n"
                                                    + "\\Windows\\System32\\timeout.exe /t 1 /nobreak >NUL" + "\n"
                                                    + "\\Windows\\System32\\tasklist.exe /nh /fi \"WINDOWTITLE eq QA Helper*\" | \\Windows\\System32\\find.exe \"No tasks are running\" >NUL" + "\n"
                                                    + "IF ERRORLEVEL 1 (" + "\n"
                                                    + "\t" + "\\Windows\\System32\\taskkill.exe /fi \"WINDOWTITLE eq QA Helper*\" >NUL" + "\n"
                                                    + "\t" + "GOTO WaitForQuit" + "\n"
                                                    + ")" + "\n"
                                                    + "\n"
                                                    + "MOVE /Y \"" + appUpdateJarTempFilePath + "\" \"" + launchPath + "\" >NUL" + "\n"
                                                    + "\n"
                                                    + "IF EXIST \"" + appUpdateJarTempFilePath + "\" (" + "\n"
                                                    + "\t" + "\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -NonInteractive -Command Start-Process -WindowStyle Hidden -Verb RunAs \"" + windowsQAhelperUpdateFinisherFile.getPath() + "\"" + "\n"
                                                    + ") ELSE (" + "\n"
                                                    + "\t" + "START \"QA Helper Launcher\" \"" + javaPath + "\" -jar \"" + launchPath + "\"" + "\n"
                                                    + ")" + "\n"
                                                    + "\n"
                                                    + "EXIT 0"
                                                    + "\n"
                                            );
                                        } catch (IOException writeWindowsQAhelperUpdateFinisherFileException) {
                                            if (isTestMode) {
                                                System.out.println("writeWindowsQAhelperUpdateFinisherFileException: " + writeWindowsQAhelperUpdateFinisherFileException);
                                            }
                                        }

                                        if (windowsQAhelperUpdateFinisherFile.exists()) {
                                            // Need to create a CMD file and launch it with Start-Process so it doesn't get killed when QA Helper quits
                                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Start-Process -WindowStyle Hidden '" + windowsQAhelperUpdateFinisherFile.getPath() + "'"}).waitFor();

                                            System.exit(0);
                                        } else {
                                            loadingWindow.closeWindow();
                                            playAlertSound("error");
                                            sendErrorEmail("App Update Error - Failed to create update finisher command file.");
                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Error Updating <i>QA Helper</i></b><br/><br/><i>Failed to create update finisher command file.</i></html>", "QA Helper  —  Update Error", JOptionPane.ERROR_MESSAGE);
                                        }
                                    } else {
                                        loadingWindow.closeWindow();
                                        playAlertSound("error");
                                        sendErrorEmail("App Update Error");
                                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Error Updating <i>QA Helper</i></b><br/><br/><i>You must re-download and re-install QA Helper.</i><br/><br/>Click \"OK\" to go to \"https://apps.freegeek.org/qa-helper/download\" to re-download QA Helper.</html>", "QA Helper  —  Update Error", JOptionPane.ERROR_MESSAGE);

                                        if (isLinux) {
                                            try {
                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/google-chrome-stable", "--password-store=basic", "--start-maximized", "--incognito", "https://apps.freegeek.org/qa-helper/download"});
                                            } catch (IOException chromeException) {
                                                if (isTestMode) {
                                                    System.out.println("chromeException: " + chromeException);
                                                }

                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/firefox", "-private", "https://apps.freegeek.org/qa-helper/download"});
                                                } catch (IOException firefoxException) {
                                                    if (isTestMode) {
                                                        System.out.println("firefoxException: " + firefoxException);
                                                    }

                                                    try {
                                                        Desktop.getDesktop().browse(new URI("https://apps.freegeek.org/qa-helper/download"));
                                                    } catch (IOException | URISyntaxException openQAHelperDownloadException) {
                                                        if (isTestMode) {
                                                            System.out.println("openQAHelperDownloadException: " + openQAHelperDownloadException);
                                                        }
                                                    }
                                                }
                                            }
                                        } else {
                                            try {
                                                Desktop.getDesktop().browse(new URI("https://apps.freegeek.org/qa-helper/download"));
                                            } catch (IOException | URISyntaxException openQAHelperDownloadException) {
                                                if (isTestMode) {
                                                    System.out.println("openQAHelperDownloadException: " + openQAHelperDownloadException);
                                                }
                                            }
                                        }

                                        System.exit(0);
                                    }
                                } else {
                                    playAlertSound("error");
                                }

                                loadingWindow.setLoadingTextAndDisplay("QA Helper is Loading Computer Specs", "Loading");

                                if (isWindows) {
                                    new File(tempDirectory, "QA_Helper.jar").delete();
                                } else {
                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/bin/rm -f '" + tempDirectory.replace("'", "'\\''") + "QA_Helper.jar'"}).waitFor();
                                }
                            } else {
                                if (launchPath.contains("/AppTranslocation/")) {
                                    // Need to get actual launch path before updating if app is currently quarantined (running from within an "AppTranslocation" folder).

                                    String[] appPaths = new CommandReader(new String[]{"/usr/bin/mdfind", "kMDItemCFBundleIdentifier = org.freegeek.QA-Helper"}).getOutputLines();

                                    if (appPaths.length > 0) {
                                        String mostRecentlyOpenedAppPath = launchPath;
                                        String mostRecentlyOpenedAppDate = "1984-01-24 00:00:00 +0000";

                                        for (String thisAppPath : appPaths) {
                                            if (!thisAppPath.contains("/AppTranslocation/")) {
                                                String appLastUsedDateString = new CommandReader(new String[]{"/usr/bin/mdls", "-raw", "-name", "kMDItemLastUsedDate", thisAppPath}).getFirstOutputLine();

                                                // kMDItemLastUsedDate will be "(null)" if it was never launched (which would happen when launching a quarantined app), so lets check the date added.
                                                if (appLastUsedDateString.isEmpty() || appLastUsedDateString.equals("(null)")) {
                                                    appLastUsedDateString = new CommandReader(new String[]{"/usr/bin/mdls", "-raw", "-name", "kMDItemDateAdded", thisAppPath}).getFirstOutputLine();
                                                }

                                                if (appLastUsedDateString.compareTo(mostRecentlyOpenedAppDate) > 0) {
                                                    mostRecentlyOpenedAppDate = appLastUsedDateString;
                                                    mostRecentlyOpenedAppPath = thisAppPath;
                                                }
                                            }
                                        }

                                        if (!launchPath.equals(mostRecentlyOpenedAppPath)) {
                                            launchPath = mostRecentlyOpenedAppPath;
                                            launchDirectory = launchPath.substring(0, launchPath.lastIndexOf("/"));
                                        }
                                    }
                                }

                                // If we're quarantined and for some reason we didn't get a proper path, don't update because it won't work.
                                if (!launchPath.contains("/AppTranslocation/")) {
                                    // This Mac auto-update code was adapted from code I wrote for "IPSW Updater", so some of the variables
                                    // may be excessive because that code had app name flexibility that isn't necessary here.
                                    // But, I didn't want to change the code a lot since it will be easier to share back and forth if I make a valuable changes in the future. - Pico

                                    String nameOfMe = "QA Helper";
                                    String updatedAppFileName = nameOfMe + ".app";

                                    // If is macOS Sierra or newer, allow to update to QA Helper built with Java 17 or newer (and is a Universal Binary).
                                    String appUpdateZipFilename = (isMacOSsierraOrNewer ? "QAHelper-mac-universal.zip" : "QAHelper-mac-ElCapitan.zip");

                                    String appUpdateZipFilePath = tempDirectory + appUpdateZipFilename;
                                    String appUpdateTempFilePath = tempDirectory + updatedAppFileName;

                                    new File(appUpdateZipFilePath).delete();
                                    Runtime.getRuntime().exec(new String[]{"/bin/rm", "-rf", appUpdateTempFilePath}).waitFor();

                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/curl", "--connect-timeout", "5", "-sfL", "https://apps.freegeek.org/qa-helper/download/" + appUpdateZipFilename, "-o", appUpdateZipFilePath}).waitFor(); // TODO: Do in Java. Eventually.
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/ditto", "-x", "-k", "--noqtn", appUpdateZipFilePath, tempDirectory}).waitFor();

                                    new File(appUpdateZipFilePath).delete();

                                    if (new File(appUpdateTempFilePath).exists() && new CommandReader(new String[]{"/usr/bin/unzip", "-p", appUpdateTempFilePath + "/Contents/" + (new File(appUpdateTempFilePath + "/Contents/Java/QA_Helper.jar").exists() ? "Java" : "app") + "/QA_Helper.jar", "*/qa-helper-version.txt"}).getFirstOutputLine().equals(latestVersion)) {
                                        new File(appUpdateTempFilePath).setLastModified(System.currentTimeMillis()); // Equivalent to touch command.

                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript",
                                            "-e", "use scripting additions",
                                            "-e", "use framework \"Foundation\"",
                                            "-e", "set currentAppFilePath to \"" + launchPath.replace("\\", "\\\\").replace("\"", "\\\"") + "\"",
                                            "-e", "delay 0.5",
                                            "-e", "repeat while (application currentAppFilePath is running)",
                                            "-e", "delay 0.5",
                                            "-e", "end repeat",
                                            "-e", "set versionedAppFilePath to \"" + launchDirectory.replace("\\", "\\\\").replace("\"", "\\\"") + "/" + nameOfMe.replace("\\", "\\\\").replace("\"", "\\\"") + " (" + appVersion.replace("\\", "\\\\").replace("\"", "\\\"") + ").app\"",
                                            "-e", "set appUpdateTempFilePath to \"" + appUpdateTempFilePath.replace("\\", "\\\\").replace("\"", "\\\"") + "\"",
                                            "-e", "set appInstallFilePath to \"" + launchDirectory.replace("\\", "\\\\").replace("\"", "\\\"") + "/" + updatedAppFileName.replace("\\", "\\\\").replace("\"", "\\\"") + "\"",
                                            "-e", "set actualInstallFilePath to appInstallFilePath",
                                            "-e", "set systemApplicationsFolder to (POSIX path of (path to applications folder from system domain))",
                                            "-e", "set appInSystemApplicationsFolder to (systemApplicationsFolder & \"" + updatedAppFileName.replace("\\", "\\\\").replace("\"", "\\\"") + "\")",
                                            "-e", "set userApplicationsFolder to (POSIX path of (path to applications folder from user domain))",
                                            "-e", "set appInUserApplicationsFolder to (userApplicationsFolder & \"" + updatedAppFileName.replace("\\", "\\\\").replace("\"", "\\\"") + "\")",
                                            "-e", "set userDownloadsFolder to (POSIX path of (path to downloads folder from user domain))",
                                            "-e", "set appInUserDownloadsFolder to (userDownloadsFolder & \"" + updatedAppFileName.replace("\\", "\\\\").replace("\"", "\\\"") + "\")",
                                            "-e", "set adminPermissionPrompt to \"“" + nameOfMe.replace("\\", "\\\\").replace("\"", "\\\"") + "” requires Admin Permission to update itself to version " + latestVersion.replace("\\", "\\\\").replace("\"", "\\\"") + ".\"",
                                            "-e", "try",
                                            "-e", "set fileManager to (defaultManager of NSFileManager of current application)",
                                            "-e", "try",
                                            "-e", "if (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) then",
                                            "-e", "moveItemAtPath_toPath_error_(currentAppFilePath, versionedAppFilePath, missing value) of fileManager",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (fileExistsAtPath_(versionedAppFilePath) of fileManager)) then",
                                            "-e", "trashItemAtURL_resultingItemURL_error_((fileURLWithPath_(versionedAppFilePath) of NSURL of current application), missing value, missing value) of fileManager",
                                            "-e", "if (fileExistsAtPath_(versionedAppFilePath) of fileManager) then do shell script \"/bin/rm -rf \" & (quoted form of versionedAppFilePath) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (fileExistsAtPath_(currentAppFilePath) of fileManager)) then",
                                            "-e", "trashItemAtURL_resultingItemURL_error_((fileURLWithPath_(currentAppFilePath) of NSURL of current application), missing value, missing value) of fileManager",
                                            "-e", "if (fileExistsAtPath_(currentAppFilePath) of fileManager) then do shell script \"/bin/rm -rf \" & (quoted form of currentAppFilePath) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((currentAppFilePath is not equal to appInstallFilePath) and (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (fileExistsAtPath_(appInstallFilePath) of fileManager)) then",
                                            "-e", "trashItemAtURL_resultingItemURL_error_((fileURLWithPath_(appInstallFilePath) of NSURL of current application), missing value, missing value) of fileManager",
                                            "-e", "if (fileExistsAtPath_(appInstallFilePath) of fileManager) then do shell script \"/bin/rm -rf \" & (quoted form of appInstallFilePath) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((currentAppFilePath is not equal to appInSystemApplicationsFolder) and (appInstallFilePath is not equal to appInSystemApplicationsFolder) and (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (fileExistsAtPath_(appInSystemApplicationsFolder) of fileManager)) then",
                                            "-e", "trashItemAtURL_resultingItemURL_error_((fileURLWithPath_(appInSystemApplicationsFolder) of NSURL of current application), missing value, missing value) of fileManager",
                                            "-e", "if (fileExistsAtPath_(appInSystemApplicationsFolder) of fileManager) then do shell script \"/bin/rm -rf \" & (quoted form of appInSystemApplicationsFolder) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((currentAppFilePath is not equal to appInUserApplicationsFolder) and (appInstallFilePath is not equal to appInUserApplicationsFolder) and (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (fileExistsAtPath_(appInUserApplicationsFolder) of fileManager)) then",
                                            "-e", "trashItemAtURL_resultingItemURL_error_((fileURLWithPath_(appInUserApplicationsFolder) of NSURL of current application), missing value, missing value) of fileManager",
                                            "-e", "if (fileExistsAtPath_(appInUserApplicationsFolder) of fileManager) then do shell script \"/bin/rm -rf \" & (quoted form of appInUserApplicationsFolder) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((currentAppFilePath is not equal to appInUserDownloadsFolder) and (appInstallFilePath is not equal to appInUserDownloadsFolder) and (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (fileExistsAtPath_(appInUserDownloadsFolder) of fileManager)) then",
                                            "-e", "trashItemAtURL_resultingItemURL_error_((fileURLWithPath_(appInUserDownloadsFolder) of NSURL of current application), missing value, missing value) of fileManager",
                                            "-e", "if (fileExistsAtPath_(appInUserDownloadsFolder) of fileManager) then do shell script \"/bin/rm -rf \" & (quoted form of appInUserDownloadsFolder) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "set appUpdateTempFileStructure to \"\"",
                                            "-e", "try",
                                            "-e", "set appUpdateTempFileStructure to (do shell script (\"cd \" & (quoted form of appUpdateTempFilePath) & \" && /bin/ls -Rsk\"))",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInstallFilePath) of fileManager))) then",
                                            "-e", "moveItemAtPath_toPath_error_(appUpdateTempFilePath, appInstallFilePath, missing value) of fileManager",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInstallFilePath) of fileManager))) then do shell script \"/bin/mv -f \" & (quoted form of appUpdateTempFilePath) & \" \" & (quoted form of appInstallFilePath) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((appInstallFilePath is not equal to appInSystemApplicationsFolder) and (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInSystemApplicationsFolder) of fileManager))) then",
                                            "-e", "moveItemAtPath_toPath_error_(appUpdateTempFilePath, appInSystemApplicationsFolder, missing value) of fileManager",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInSystemApplicationsFolder) of fileManager))) then do shell script \"/bin/mv -f \" & (quoted form of appUpdateTempFilePath) & \" \" & (quoted form of appInSystemApplicationsFolder) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "set actualInstallFilePath to appInSystemApplicationsFolder",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "if ((appInstallFilePath is not equal to appInUserApplicationsFolder) and (fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInUserApplicationsFolder) of fileManager))) then",
                                            "-e", "moveItemAtPath_toPath_error_(appUpdateTempFilePath, appInUserApplicationsFolder, missing value) of fileManager",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInUserApplicationsFolder) of fileManager))) then do shell script \"/bin/mv -f \" & (quoted form of appUpdateTempFilePath) & \" \" & (quoted form of appInUserApplicationsFolder) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "set actualInstallFilePath to appInUserApplicationsFolder",
                                            "-e", "end if",
                                            "-e", "end try",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInUserDownloadsFolder) of fileManager))) then",
                                            "-e", "moveItemAtPath_toPath_error_(appUpdateTempFilePath, appInUserDownloadsFolder, missing value) of fileManager",
                                            "-e", "if ((fileExistsAtPath_(appUpdateTempFilePath) of fileManager) and (not (fileExistsAtPath_(appInUserDownloadsFolder) of fileManager))) then do shell script \"/bin/mv -f \" & (quoted form of appUpdateTempFilePath) & \" \" & (quoted form of appInUserDownloadsFolder) with prompt adminPermissionPrompt with administrator privileges",
                                            "-e", "set actualInstallFilePath to appInUserDownloadsFolder",
                                            "-e", "end if",
                                            "-e", "if (fileExistsAtPath_(actualInstallFilePath) of fileManager) then",
                                            // When working on auto-updating for MacLand Script's, Catalina seems to fail to launch if done too quickly after a move (with an "executable not found" error).
                                            // Generating the install path file structure alone seems to delay enough to avoid the issue, but this loop makes it extra safe.
                                            "-e", "repeat 30 times",
                                            "-e", "try",
                                            "-e", "set installAppFileStructure to \"\"",
                                            "-e", "try",
                                            "-e", "set installAppFileStructure to (do shell script (\"cd \" & (quoted form of actualInstallFilePath) & \" && /bin/ls -Rsk\"))",
                                            "-e", "on error",
                                            "-e", "try",
                                            "-e", "set installAppFileStructure to (do shell script (\"cd \" & (quoted form of actualInstallFilePath) & \" && /bin/ls -Rsk\") with prompt adminPermissionPrompt with administrator privileges)",
                                            "-e", "on error",
                                            "-e", "exit repeat",
                                            "-e", "end try",
                                            "-e", "end try",
                                            "-e", "if (appUpdateTempFileStructure is equal to installAppFileStructure) then exit repeat",
                                            "-e", "end try",
                                            "-e", "delay 0.5",
                                            "-e", "end repeat",
                                            "-e", "end if",
                                            "-e", "on error installError",
                                            "-e", "activate",
                                            "-e", "beep",
                                            "-e", "display alert \"Error Installing “" + nameOfMe.replace("\\", "\\\\").replace("\"", "\\\"") + "” After Update\" message installError as critical",
                                            "-e", "end try",
                                            "-e", "try",
                                            "-e", "do shell script \"/usr/bin/open -na \" & (quoted form of actualInstallFilePath)",
                                            "-e", "on error",
                                            "-e", "try",
                                            "-e", "do shell script \"/usr/bin/open -na \" & (quoted form of \"" + launchDirectory.replace("\\", "\\\\").replace("\"", "\\\"") + "/" + nameOfMe.replace("\\", "\\\\").replace("\"", "\\\"") + ".app\")",
                                            "-e", "on error",
                                            "-e", "try",
                                            "-e", "do shell script \"/usr/bin/open -na \" & (quoted form of currentAppFilePath)",
                                            "-e", "on error",
                                            "-e", "try",
                                            "-e", "do shell script \"/usr/bin/open -nb org.freegeek.QA-Helper\"",
                                            "-e", "on error launchError",
                                            "-e", "activate",
                                            "-e", "beep",
                                            "-e", "display alert \"Error Launching “" + nameOfMe.replace("\\", "\\\\").replace("\"", "\\\"") + "” After Update\" message launchError buttons {\"Quit\", \"Re-Download “" + nameOfMe.replace("\\", "\\\\").replace("\"", "\\\"") + "”\"} cancel button 1 default button 2 as critical",
                                            "-e", "do shell script \"/usr/bin/open 'https://apps.freegeek.org/qa-helper/download'\"",
                                            "-e", "end try",
                                            "-e", "end try",
                                            "-e", "end try",
                                            "-e", "end try"});

                                        System.exit(0);
                                    } else {
                                        playAlertSound("error");
                                        Runtime.getRuntime().exec(new String[]{"/bin/rm", "-rf", appUpdateTempFilePath}).waitFor();
                                    }
                                }
                            }
                        }
                    }
                }
            }
        } catch (IOException | InterruptedException | NumberFormatException | URISyntaxException | ParseException autoUpdateAppException) {
            if (isTestMode) {
                System.out.println("autoUpdateAppException: " + autoUpdateAppException);
            }
        }
    }

    public boolean createHelperLogFile() {
        boolean createdHelperLogFile = false;

        if (isLinux) {
            if (!adminPassword.equals("*UNKNOWN*")) {
                if (!new File(linuxBuildInfoPath).exists()) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/mkdir '" + linuxBuildInfoPath.replace("'", "'\\''") + "'"}).waitFor();
                    } catch (IOException | InterruptedException createLinuxBuildInfoFolderException) {
                        if (isTestMode) {
                            System.out.println("createLinuxBuildInfoFolderException: " + createLinuxBuildInfoFolderException);
                        }
                    }
                }

                if (!new File(helperLogFilePath).exists()) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/touch '" + helperLogFilePath.replace("'", "'\\''") + "'"}).waitFor();
                        createdHelperLogFile = true;
                    } catch (IOException | InterruptedException createLinuxHelperLogFileException) {
                        if (isTestMode) {
                            System.out.println("createLinuxHelperLogFileException: " + createLinuxHelperLogFileException);
                        }
                    }
                }

                try {
                    // Always make sure helperLogFilePath is writable without sudo (in case it already exists because it was copied from the pre-install environment).
                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/chmod 666 '" + helperLogFilePath.replace("'", "'\\''") + "'"}).waitFor();
                } catch (IOException | InterruptedException makeHelperLogFileWritableException) {
                    if (isTestMode) {
                        System.out.println("makeHelperLogFileWritableException: " + makeHelperLogFileWritableException);
                    }
                }
            }
        } else {
            if (isMacOS && !new File(macBuildInfoPath).exists()) {
                new File(macBuildInfoPath).mkdirs();
            } else if (isWindows && !new File(windowsBuildInfoPath).exists()) {
                new File(windowsBuildInfoPath).mkdirs();
            }

            if (!new File(helperLogFilePath).exists()) {
                try {
                    createdHelperLogFile = (new File(helperLogFilePath).createNewFile());
                } catch (IOException createMacHelperLogFileException) {
                    if (isTestMode) {
                        System.out.println("createHelperLogFileException: " + createMacHelperLogFileException);
                    }
                }
            }
        }

        return createdHelperLogFile;
    }

    public void writeToHelperLogFile(String newLogLine) {
        createHelperLogFile();

        try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(new File(helperLogFilePath), true))) {
            bufferedWriter.write(newLogLine + " - " + new SimpleDateFormat("MM/dd/yyyy HH:mm:ss").format(new Date()) + "\n");
        } catch (IOException writeToHelperLogFileException) {
            if (isTestMode) {
                System.out.println("writeToHelperLogFileException: " + writeToHelperLogFileException);
            }
        }
    }

    public void createWindowsDriversCacheModelNameFile() {
        if (isWindows) {
            createHelperLogFile();

            File oldDriversCacheModelPathFile = new File(windowsBuildInfoPath + "Drivers Cache Model Path.txt");
            if (oldDriversCacheModelPathFile.exists()) {
                oldDriversCacheModelPathFile.delete();
            }

            File driversCacheModelNameFile = new File(windowsBuildInfoPath + "Drivers Cache Model Name.txt");
            if (!driversCacheModelNameFile.exists()) {
                String driversCacheModelName = computerSpecs.getBrand().replaceAll("[^A-Za-z0-9]", "") + " " + computerSpecs.getModel().replace(" / ", "+").replace(" (", "+").replaceAll("[^A-Za-z0-9+]", "") + " " + computerSpecs.getGPUids() + " " + computerSpecs.getAudioIDs();

                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(driversCacheModelNameFile))) {
                    bufferedWriter.write(driversCacheModelName);
                } catch (IOException createWindowsDriversCacheModelNameFileException) {
                    if (isTestMode) {
                        System.out.println("createWindowsDriversCacheModelNameFileException: " + createWindowsDriversCacheModelNameFileException);
                    }
                }
            }
        }
    }

    private void displayComputerSpecs() {
        displayComputerSpecs(null);
    }

    private void displayComputerSpecs(String[] currentStatusAndTech) {
        long startDisplayComputerSpecsTime = System.currentTimeMillis();

        if (isTestMode) {
            System.out.println("Starting Display Computer Specs");
        }

        Font defaultFont = UIManager.getFont("defaultFont");

        String[] statusNames = privateStrings.getPCsCRMStatusNames();

        if (isFirstLoad) {
            isFirstLoad = false;

            helperLogFilePath = (isLinux ? linuxBuildInfoPath + "qa-helper-log.txt" : (isWindows ? windowsBuildInfoPath : macBuildInfoPath) + "QA Helper Log.txt");

            if (new File(helperLogFilePath).exists()) {
                try {
                    Files.readAllLines(Paths.get(helperLogFilePath), StandardCharsets.UTF_8).forEach(thisHelperLogLine -> {
                        if (thisHelperLogLine.startsWith("PID:")) {
                            pid = thisHelperLogLine.substring(thisHelperLogLine.indexOf(":") + 1).trim().split(" ")[0];
                            lastPIDscannedOrConfirmed = pid;
                            isTestMode = (thisHelperLogLine.contains("Test Mode"));
                            gotTestModeFromLog = isTestMode;
                        } else if (thisHelperLogLine.contains("Verified") || thisHelperLogLine.contains("UNVERIFIED")) {
                            boolean isVerified = (thisHelperLogLine.contains("Verified") && !thisHelperLogLine.contains("UNVERIFIED"));
                            if (thisHelperLogLine.contains("CPU")) {
                                isCPUverified = isVerified;
                            } else if (thisHelperLogLine.contains("Drive Health")) {
                                isDriveHealthVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Disc Drive")) {
                                isDiscDriveVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Internet")) {
                                isInternetVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Screen")) {
                                isScreenVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Audio")) {
                                isAudioVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Microphone")) {
                                isMicrophoneVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Camera")) {
                                isCameraVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Keyboard")) {
                                isKeyboardVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Mouse")) {
                                isMouseVerified = isVerified;
                            } else if (thisHelperLogLine.contains("BIOS")) {
                                isBIOSverified = isVerified;
                            } else if (thisHelperLogLine.contains("Ports")) {
                                isPortsVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Drivers")) {
                                isDriversVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Updates")) {
                                isUpdatesVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Windows Activation")) {
                                isWindowsActivationVerified = isVerified;
                            } else if (thisHelperLogLine.contains("Remote Management")) {
                                isRemoteManagementVerified = isVerified;
                            }
                        } else if (thisHelperLogLine.startsWith("Status:")) {
                            lastStatus = thisHelperLogLine.substring(thisHelperLogLine.indexOf(": ") + 2).split(" - ")[0];
                        } else if (thisHelperLogLine.startsWith("Price:")) {
                            String possibleDisplayPrice = thisHelperLogLine.substring(thisHelperLogLine.indexOf(": ") + 2).split(" - ")[0]; // This will always get the latest price.

                            if (possibleDisplayPrice.startsWith("$")) {
                                displayPrice = "$" + possibleDisplayPrice.replaceAll("[^0-9,]", "");
                                isSold = false;
                            }
                        } else if (thisHelperLogLine.startsWith("Sold")) {
                            isSold = true;
                        }
                    });
                } catch (IOException readLogException) {
                    if (isTestMode) {
                        System.out.println("readLogException: " + readLogException);
                    }
                }

                // Never hide login and tasks in Windows since QA Helper will never be shown in demo mode.
                hideLoginAndTasks = (!isLinuxUbiquityMode && !isWindows && lastStatus.equals(statusNames[12]));

                if (!pid.equals("N/A")) {
                    txtPID.setText(pid);
                }
            } else {
                createHelperLogFile();
            }

            defaultTextSize = defaultFont.getSize();

            if (UIManager.getLookAndFeel().getName().startsWith("FlatLaf")) {
                themeUpdated = true;
            } else {
                // Remove extra button padding that's just for proper button sizing with FlatLaf
                btnDoneTesting.setMargin(btnReloadSpecs.getMargin());
            }
        } else if (themeUpdated) {
            FlatLaf.updateUI();

            // For some reason updateUI (updateComponentTreeUI) sets these null border buttons to FlatButtonBorder which makes them the wrong size (too wide)
            if (contentScrollPane.getBorder() != null) {
                contentScrollPane.setBorder(null);
            }
            if (btnTestMode.getBorder() != null) {
                btnTestMode.setBorder(null);
            }
            if (btnForgot.getBorder() != null) {
                btnForgot.setBorder(null);
            }
            if (btnCheckPID.getBorder() != null) {
                btnCheckPID.setBorder(null);
            }

            if (creditsWindow != null && creditsWindow.isVisible()) {
                creditsWindow.dispose(); // Close creditsWindow so that the JScrollPane border will be reset to null on next open for same reason as above.
            }
        }

        if (themeUpdated) {
            Color themeDefaultColor = lblVersion.getForeground();
            if (!themeDefaultColor.equals(defaultColor)) {
                defaultColor = themeDefaultColor;
            }

            Color themeBlue = UIManager.getColor("Actions.Blue");
            if ((themeBlue != null) && !themeBlue.equals(verifiedColor)) {
                verifiedColor = themeBlue;
                verifiedColorHTML = "#" + Integer.toHexString(verifiedColor.getRGB()).substring(2);
            }

            Color themeGreen = UIManager.getColor("Actions.Green");
            if ((themeGreen != null) && !themeGreen.equals(successColor)) {
                successColor = themeGreen;
                successColorHTML = "#" + Integer.toHexString(successColor.getRGB()).substring(2);
            }

            Color themeYellow = UIManager.getColor("Actions.Yellow");
            if ((themeYellow != null) && !themeYellow.equals(warningColor)) {
                warningColor = themeYellow;
                warningColorHTML = "#" + Integer.toHexString(warningColor.getRGB()).substring(2);
            }

            Color themeRed = UIManager.getColor("Actions.Red");
            if ((themeRed != null) && !themeRed.equals(errorColor)) {
                errorColor = themeRed;
                errorColorHTML = "#" + Integer.toHexString(errorColor.getRGB()).substring(2);
            }

            Color themePurple = UIManager.getColor("Objects.Purple");
            if ((themePurple != null) && !themePurple.equals(attentionColor)) {
                attentionColor = themePurple;
                attentionColorHTML = "#" + Integer.toHexString(attentionColor.getRGB()).substring(2);
            }

            Color linkColor = UIManager.getColor("Component.linkColor");
            if ((linkColor != null) && !btnTestMode.getForeground().equals(linkColor)) {
                btnTestMode.setForeground(linkColor);
                btnForgot.setForeground(linkColor);
                btnCheckPID.setForeground(linkColor);
            }

            btnForgot.setFont(defaultFont);
            btnCheckPID.setFont(defaultFont);

            btnLogIn.setFont(defaultFont.deriveFont(Font.BOLD));
            btnDoneTesting.setFont(defaultFont.deriveFont(Font.BOLD));

            txtUsername.setSize(new Dimension((defaultFont.getSize() * 10), (defaultFont.getSize() * 2)));
            txtUsername.setPreferredSize(txtUsername.getSize());
            pswPassword.setPreferredSize(txtUsername.getSize());
            txtPID.setPreferredSize(txtUsername.getSize());

            txtUsername.putClientProperty("JTextField.showClearButton", true);
            pswPassword.putClientProperty("JTextField.showClearButton", true);
            txtPID.putClientProperty("JTextField.showClearButton", true);
        }

        boolean isLaptop = false;
        boolean hasDiscDrive = false;
        boolean hasScreen = false;
        boolean hasCamera = false;

        if (computerSpecs != null) {
            isLaptop = computerSpecs.isLaptop();
            hasDiscDrive = !computerSpecs.getDiscDrive().equals("N/A");
            hasScreen = computerSpecs.hasScreen();
            hasCamera = computerSpecs.hasCamera();
        }

        boolean shouldShowOptionsMenu = isLoggedIn;
        if (shouldShowOptionsMenu != optionsMenu.isVisible()) {
            optionsMenu.setEnabled(shouldShowOptionsMenu);
            optionsMenu.setVisible(shouldShowOptionsMenu);
        }

        boolean shouldShowTestMenu = (isLoggedIn && !isLaptop);
        if (shouldShowTestMenu != testsMenu.isVisible()) {
            if (isWindowsRE) {
                menForceShowScreenKeyboardAndMouseTests.setText("Force Show Screen and Keyboard Tests");
            } else if (isWindowsPE) {
                menForceShowScreenKeyboardAndMouseTests.setText("Force Show Screen Test");
            }

            testsMenu.setEnabled(shouldShowTestMenu);
            testsMenu.setVisible(shouldShowTestMenu);
        }

        boolean shouldShowInstallAppMenu = (isLoggedIn && ((isLinux && !isLinuxLiveBoot) || (isWindows && !isWindowsPE)));

        if (shouldShowInstallAppMenu && isWindows) {
            menInstallSkype.setEnabled(false);
            menInstallSkype.setVisible(false);

            menInstallSpotify.setEnabled(false);
            menInstallSpotify.setVisible(false);

            menInstallFBReader.setEnabled(false);
            menInstallFBReader.setVisible(false);
        }

        if (shouldShowInstallAppMenu != installAppsMenu.isVisible()) {
            installAppsMenu.setEnabled(shouldShowInstallAppMenu);
            installAppsMenu.setVisible(shouldShowInstallAppMenu);
        }

        boolean shouldShowScriptsMenu = (isLoggedIn && isWindows && !isWindowsPE && new File("\\Install\\Scripts").exists());
        if (shouldShowScriptsMenu != scriptsMenu.isVisible()) {
            scriptsMenu.setEnabled(shouldShowScriptsMenu);
            scriptsMenu.setVisible(shouldShowScriptsMenu);
        }

        if (shouldShowScriptsMenu) {
            boolean shouldShowManuallyCacheDriversMenuItem = false;

            if (new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
                try {
                    List<String> completeWindowsScriptLine = Files.readAllLines(Paths.get("\\Install\\Scripts\\Complete Windows.ps1"), StandardCharsets.UTF_8);

                    for (String thisCompleteWindowsScriptLine : completeWindowsScriptLine) {
                        if (thisCompleteWindowsScriptLine.startsWith("$onlyCacheDriversMode =")) {
                            shouldShowManuallyCacheDriversMenuItem = true;
                            break;
                        } else if (thisCompleteWindowsScriptLine.startsWith("$Host.UI.RawUI.WindowTitle =")) {
                            // $onlyCacheDriversMode will be set before setting the script window title, so stop searching if we got that far to not bother searching the whole script.
                            break;
                        }
                    }
                } catch (IOException readCompleteWindowsScriptException) {
                    if (isTestMode) {
                        System.out.println("readCompleteWindowsScriptException: " + readCompleteWindowsScriptException);
                    }
                }
            }

            if (shouldShowManuallyCacheDriversMenuItem != menCacheDriversWindowsScript.isVisible()) {
                scriptsMenuSeparator.setVisible(shouldShowManuallyCacheDriversMenuItem);

                menCacheDriversWindowsScript.setEnabled(shouldShowManuallyCacheDriversMenuItem);
                menCacheDriversWindowsScript.setVisible(shouldShowManuallyCacheDriversMenuItem);
            }
        }

        String menOpenTerminalOrCommandPromptText = "Open " + (isWindows ? "Command Prompt" : "Terminal");
        if (!menOpenTerminalOrCommandPromptText.equals(menOpenTerminalOrCommandPrompt.getText())) {
            menOpenTerminalOrCommandPrompt.setText(menOpenTerminalOrCommandPromptText);
        }

        boolean shouldOpenTerminalOrCommandPromptMenuItem = ((isLinux && isLinuxUbiquityMode) || (isWindows && isWindowsPE));
        if (shouldOpenTerminalOrCommandPromptMenuItem != menOpenTerminalOrCommandPrompt.isVisible()) {
            menOpenTerminalOrCommandPrompt.setEnabled(shouldOpenTerminalOrCommandPromptMenuItem);
            menOpenTerminalOrCommandPrompt.setVisible(shouldOpenTerminalOrCommandPromptMenuItem);
        }

        boolean shouldShowOpenFileExplorerMenuItem = (isWindows && isWindowsPE && new File("\\Install\\Diagnostic Tools\\File Explorer\\File Explorer (PE).exe").exists());
        if (shouldShowOpenFileExplorerMenuItem != menOpenFileExplorerPE.isVisible()) {
            menOpenFileExplorerPE.setEnabled(shouldShowOpenFileExplorerMenuItem);
            menOpenFileExplorerPE.setVisible(shouldShowOpenFileExplorerMenuItem);
        }

        boolean shouldShowLinuxUtilitiesMenuItems = (isLinux && !isLinuxLiveBoot);
        if (shouldShowLinuxUtilitiesMenuItems != menSetDvdDriveRegion.isVisible()) {
            menSetDvdDriveRegion.setEnabled(shouldShowLinuxUtilitiesMenuItems);
            menSetDvdDriveRegion.setVisible(shouldShowLinuxUtilitiesMenuItems);
        }

        boolean shouldShowUtilitiesMenu = (isLoggedIn && (shouldOpenTerminalOrCommandPromptMenuItem || shouldShowOpenFileExplorerMenuItem || shouldShowLinuxUtilitiesMenuItems));
        if (shouldShowUtilitiesMenu != utilitiesMenu.isVisible()) {
            utilitiesMenu.setEnabled(shouldShowUtilitiesMenu);
            utilitiesMenu.setVisible(shouldShowUtilitiesMenu);
        }

        /*
            // DEBUG: For convenient menu testing
            if (false) {
                optionsMenu.setEnabled(true);
                optionsMenu.setVisible(true);

                testsMenu.setEnabled(true);
                testsMenu.setVisible(true);

                installAppsMenu.setEnabled(true);
                installAppsMenu.setVisible(true);

                scriptsMenu.setEnabled(true);
                scriptsMenu.setVisible(true);

                utilitiesMenu.setEnabled(true);
                utilitiesMenu.setVisible(true);
            }
         */
        String lblStatusText;
        Color lblStatusColor = defaultColor;

        String btnDoneTestingText = "Quit";

        if (isLoggedIn) {
            if (currentStatusAndTech == null) {
                if (isTestMode) {
                    System.out.println("RETRIEVING PID HISTORY ON MAIN THREAD");
                }

                currentStatusAndTech = getHistory(false);
            }

            // Never hide login and tasks in Windows since QA Helper will never be shown in demo mode.
            hideLoginAndTasks = (!isLinuxUbiquityMode && !isWindows && currentStatusAndTech[0].equals(statusNames[12]));

            boolean shouldShowReopenRepairMenuItem = (!currentStatusAndTech[0].equals(statusNames[3]) && !currentStatusAndTech[0].equals("UNKNOWN STATUS"));
            if (shouldShowReopenRepairMenuItem != menReopenRepair.isVisible()) {
                menReopenRepair.setEnabled(shouldShowReopenRepairMenuItem);
                menReopenRepair.setVisible(shouldShowReopenRepairMenuItem);
            }

            lblStatusText = "<html><b style='font-size: larger'>" + pid + ": <u>" + currentStatusAndTech[0] + "</u> by <i>" + currentStatusAndTech[1] + "</i></b></html>";

            if (currentStatusAndTech[0].equals(statusNames[2]) || currentStatusAndTech[0].equals(statusNames[3])) {
                lblStatusColor = warningColor;

                btnDoneTestingText = "Done Testing";
            } else {
                lblStatusColor = (currentStatusAndTech[0].equals(statusNames[12]) ? successColor : attentionColor);

                if (isLinuxUbiquityMode || isWindowsPE) {
                    btnDoneTestingText = "Install OS";
                }
            }

            if (getRootPane().getDefaultButton() == null) {
                getRootPane().setDefaultButton(btnDoneTesting);
            }
        } else {
            lblStatusText = "<html><span style='font-size: larger'>"
                    + (hideLoginAndTasks
                            ? (isSold
                                    ? "<b><u>SOLD</u></b> &nbsp;&mdash;&nbsp; "
                                    : "")
                            + (!displayPrice.isEmpty()
                            ? "<b>Price:</b> " + displayPrice + " &nbsp;&mdash;&nbsp; <b>PID:</b> "
                            : "<b>")
                            + (pid.isEmpty()
                            ? "<i>UNKNOWN PID</i>"
                            : pid)
                            + (displayPrice.isEmpty()
                            ? "</b>"
                            : "")
                            : "")
                    + "</span></html>";

            btnDoneTestingText = (hideLoginAndTasks
                    ? "Options"
                    : ((isLinuxUbiquityMode || isWindowsPE)
                            ? "Install OS"
                            : "Quit"));

            if (getRootPane().getDefaultButton() == null) {
                getRootPane().setDefaultButton(btnLogIn);
            }
        }

        if (!lblStatus.getForeground().equals(lblStatusColor)) {
            lblStatus.setForeground(lblStatusColor);
        }

        if (!lblStatus.getText().equals(lblStatusText)) {
            if (historyWindow != null && historyWindow.isVisible()) {
                historyWindow.dispose();
            }

            lblStatus.setText(lblStatusText);
        }

        boolean shouldShowStatus = (isLoggedIn || hideLoginAndTasks);
        if (shouldShowStatus != lblStatus.isVisible()) {
            lblStatus.setVisible(shouldShowStatus);
        }

        if (!btnDoneTesting.getText().equals(btnDoneTestingText)) {
            btnDoneTesting.setText(btnDoneTestingText);
        }

        String btnTestModeText = (isTestMode ? "Test Mode" : "Live Mode");
        if (!btnTestMode.getText().equals(btnTestModeText) || themeUpdated) {
            btnTestMode.setText(btnTestModeText);
            btnTestMode.setFont((isTestMode ? defaultFont.deriveFont(Font.BOLD) : defaultFont));
        }

        if (btnTestMode.getBorder() != null) {
            btnTestMode.setBorder(null);
        }

        boolean shouldShowLogin = !shouldShowStatus;
        if (shouldShowLogin != btnLogIn.isVisible()) {
            lblUsername.setVisible(shouldShowLogin);
            txtUsername.setEnabled(shouldShowLogin);
            txtUsername.setVisible(shouldShowLogin);

            lblPassword.setVisible(shouldShowLogin);
            pswPassword.setEnabled(shouldShowLogin);
            pswPassword.setVisible(shouldShowLogin);

            lblPID.setVisible(shouldShowLogin);
            txtPID.setEnabled(shouldShowLogin);
            txtPID.setVisible(shouldShowLogin);

            btnTestMode.setEnabled(shouldShowLogin);
            btnTestMode.setVisible(shouldShowLogin);

            btnForgot.setEnabled(shouldShowLogin);
            btnForgot.setVisible(shouldShowLogin);

            btnCheckPID.setEnabled(shouldShowLogin);
            btnCheckPID.setVisible(shouldShowLogin);

            lblVersion.setVisible(shouldShowLogin);

            btnLogIn.setEnabled(shouldShowLogin);
            btnLogIn.setVisible(shouldShowLogin);
        }

        boolean shouldShowStressCPUandTasks = (isLoggedIn || !hideLoginAndTasks);
        if (shouldShowStressCPUandTasks != lblTasks.isVisible()) {
            btnStressCPU.setEnabled(shouldShowStressCPUandTasks);
            btnStressCPU.setVisible(shouldShowStressCPUandTasks);

            btnVerifyCPU.setEnabled(shouldShowStressCPUandTasks);
            btnVerifyCPU.setVisible(shouldShowStressCPUandTasks);

            middleSeparator2.setVisible(shouldShowStressCPUandTasks);

            lblTasks.setVisible(shouldShowStressCPUandTasks);

            btnCheckPorts.setEnabled(shouldShowStressCPUandTasks);
            btnCheckPorts.setVisible(shouldShowStressCPUandTasks);

            btnVerifyPorts.setVisible(shouldShowStressCPUandTasks);
            btnVerifyPorts.setVisible(shouldShowStressCPUandTasks);
        }

        if (!isLinux) {
            String btnDriveHealthText = (isWindows ? "Open DiskInfo" : "Open DriveDx");
            if (!btnDriveHealthText.equals(btnDriveHealth.getText())) {
                btnDriveHealth.setText(btnDriveHealthText);
            }
        }

        boolean shouldShowDriveHealth = (isLinux || (isWindows && new File("\\Install\\Diagnostic Tools\\CrystalDiskInfo\\DiskInfo64.exe").exists()) || (isMacOS && (new File("/Applications/DriveDx.app").exists() || new File("/Users/fg-demo/Applications/DriveDx.app").exists())));
        if (shouldShowDriveHealth != btnDriveHealth.isVisible()) {
            btnDriveHealth.setEnabled(shouldShowDriveHealth);
            btnDriveHealth.setVisible(shouldShowDriveHealth);
        }

        boolean shouldShowVerifyDriveHealth = (shouldShowDriveHealth && shouldShowStressCPUandTasks);
        if (shouldShowVerifyDriveHealth != btnVerifyDriveHealth.isVisible()) {
            btnVerifyDriveHealth.setEnabled(shouldShowVerifyDriveHealth);
            btnVerifyDriveHealth.setVisible(shouldShowVerifyDriveHealth);
        }

        boolean shouldShowDiscDrive = hasDiscDrive;
        if (shouldShowDiscDrive != btnEjectDiscDrive.isVisible()) {
            btnEjectDiscDrive.setEnabled(shouldShowDiscDrive);
            btnEjectDiscDrive.setVisible(shouldShowDiscDrive);
        }

        // Intentionally allowing the lack of a disc drive to be verified to confirm the computer was manufactured without a disc drive.
        btnVerifyDiscDrive.setEnabled(shouldShowStressCPUandTasks);
        btnVerifyDiscDrive.setVisible(shouldShowStressCPUandTasks);

        boolean shouldShowAudioTest = (!isWindowsPE || isWindowsRE);
        if (shouldShowAudioTest != btnTestAudio.isVisible()) {
            btnTestAudio.setEnabled(shouldShowAudioTest);
            btnTestAudio.setVisible(shouldShowAudioTest);
        }

        boolean shouldShowVerifyAudioTest = (shouldShowAudioTest && shouldShowStressCPUandTasks);
        if (shouldShowVerifyAudioTest != btnVerifyAudio.isVisible()) {
            btnVerifyAudio.setVisible(shouldShowVerifyAudioTest);
        }

        // Do not allow Audio Verification in WinPE (even though we can test when in WinRE) since we want it verified in OS after driver are installed.
        boolean shouldEnableVerifyAudio = (btnVerifyAudio.isVisible() && !isWindowsPE);
        if (shouldEnableVerifyAudio != btnVerifyAudio.isEnabled()) {
            btnVerifyAudio.setEnabled(shouldEnableVerifyAudio);
        }

        boolean shouldShowInternetAndMoreTests = (!isWindowsPE);
        if (shouldShowInternetAndMoreTests != lblMoreTests.isVisible()) {
            btnTestInternet.setEnabled(shouldShowInternetAndMoreTests);
            btnTestInternet.setVisible(shouldShowInternetAndMoreTests);

            middleSeparator1.setVisible(shouldShowInternetAndMoreTests);

            lblMoreTests.setVisible(shouldShowInternetAndMoreTests);

            btnTestMicrophone.setEnabled(shouldShowInternetAndMoreTests);
            btnTestMicrophone.setVisible(shouldShowInternetAndMoreTests);

            btnSystemInfo.setEnabled(shouldShowInternetAndMoreTests);
            btnSystemInfo.setVisible(shouldShowInternetAndMoreTests);
        }

        boolean shouldShowVerifyInternetAndMoreTest = (shouldShowInternetAndMoreTests && shouldShowStressCPUandTasks);
        if (shouldShowVerifyInternetAndMoreTest != btnVerifyInternet.isVisible()) {
            btnVerifyInternet.setEnabled(shouldShowVerifyInternetAndMoreTest);
            btnVerifyInternet.setVisible(shouldShowVerifyInternetAndMoreTest);

            btnVerifyMicrophone.setVisible(shouldShowVerifyInternetAndMoreTest);
        }

        // Do not enable btnVerifyMicrophone if no mic detected on macOS even though it will be visible for layout consistency since the Microphone Test button will be visible in this case.
        boolean shouldEnableVerifyMicrophone = (shouldShowVerifyInternetAndMoreTest && (!isMacOS || !new CommandReader(new String[]{"/usr/bin/osascript", "-e", "input volume of (get volume settings)"}).getFirstOutputLine().equals("missing value")));
        if (shouldEnableVerifyMicrophone != btnVerifyMicrophone.isEnabled()) {
            btnVerifyMicrophone.setEnabled(shouldEnableVerifyMicrophone);
        }

        // Do not show Camera Test on a Desktop with no camera detected, but always show it for Laptops and All-In-Ones even if no camera is detected to make it obvious that no camera was detected in case it should have been.
        boolean shouldShowCameraTest = ((hasCamera || hasScreen || forceShowScreenKeyboardAndMouseTests) && shouldShowInternetAndMoreTests);
        if (shouldShowCameraTest != btnTestCamera.isVisible()) {
            btnTestCamera.setEnabled(shouldShowCameraTest);
            btnTestCamera.setVisible(shouldShowCameraTest);
        }

        boolean shouldShowVerifyCameraTest = (shouldShowCameraTest && shouldShowStressCPUandTasks);
        if (shouldShowVerifyCameraTest != btnVerifyCamera.isVisible()) {
            btnVerifyCamera.setVisible(shouldShowVerifyCameraTest);
        }

        // Do not enable btnVerifyCamera if no camera detected and not on a Desktop even though it will be visible for layout consistency since the Camera Test button will be visible in this case.
        boolean shouldEnableVerifyCamera = (shouldShowVerifyCameraTest && hasCamera);
        if (shouldEnableVerifyCamera != btnVerifyCamera.isEnabled()) {
            btnVerifyCamera.setEnabled(shouldEnableVerifyCamera);
        }

        boolean shouldShowScreenTest = (hasScreen || forceShowScreenKeyboardAndMouseTests);
        if (shouldShowScreenTest != btnTestScreen.isVisible()) {
            btnTestScreen.setEnabled(shouldShowScreenTest);
            btnTestScreen.setVisible(shouldShowScreenTest);
        }

        boolean shouldShowVerifyScreenTest = (shouldShowScreenTest && shouldShowStressCPUandTasks);
        if (shouldShowVerifyScreenTest != btnVerifyScreen.isVisible()) {
            btnVerifyScreen.setEnabled(shouldShowVerifyScreenTest);
            btnVerifyScreen.setVisible(shouldShowVerifyScreenTest);
        }

        boolean shouldShowKeyboardTest = ((isLaptop || forceShowScreenKeyboardAndMouseTests) && (shouldShowInternetAndMoreTests || (isWindowsRE && new File("\\Install\\Diagnostic Tools\\Web Browser (PE).exe").exists())));
        if (shouldShowKeyboardTest != btnTestKeyboard.isVisible()) {
            btnTestKeyboard.setEnabled(shouldShowKeyboardTest);
            btnTestKeyboard.setVisible(shouldShowKeyboardTest);
        }

        if (shouldShowKeyboardTest && !middleSeparator1.isVisible()) {
            // ALSO, make sure middleSeparator1 and lblMoreTests are visible too since Keyboard Test can be shown without shouldShowInternetAndMoreTests in WinRE.
            middleSeparator1.setVisible(shouldShowKeyboardTest);
            lblMoreTests.setVisible(shouldShowKeyboardTest);
        }

        boolean shouldShowVerifyKeyboardTest = (shouldShowKeyboardTest && shouldShowStressCPUandTasks);
        if (shouldShowVerifyKeyboardTest != btnVerifyKeyboard.isVisible()) {
            btnVerifyKeyboard.setEnabled(shouldShowVerifyKeyboardTest);
            btnVerifyKeyboard.setVisible(shouldShowVerifyKeyboardTest);
        }

        boolean shouldShowMouseTest = ((isLaptop || forceShowScreenKeyboardAndMouseTests) && shouldShowInternetAndMoreTests);
        if (shouldShowMouseTest != btnTestMouse.isVisible()) {
            btnTestMouse.setEnabled(shouldShowMouseTest);
            btnTestMouse.setVisible(shouldShowMouseTest);
        }

        boolean shouldShowVerifyMouseTest = (shouldShowMouseTest && shouldShowStressCPUandTasks);
        if (shouldShowVerifyMouseTest != btnVerifyMouse.isVisible()) {
            btnVerifyMouse.setEnabled(shouldShowVerifyMouseTest);
            btnVerifyMouse.setVisible(shouldShowVerifyMouseTest);
        }

        boolean shouldShowSetupBIOS = (!isMacOS && shouldShowStressCPUandTasks);
        if (shouldShowSetupBIOS != btnSetupBIOS.isVisible()) {
            btnSetupBIOS.setEnabled(shouldShowSetupBIOS);
            btnSetupBIOS.setVisible(shouldShowSetupBIOS);

            btnVerifyBIOS.setEnabled(shouldShowSetupBIOS);
            btnVerifyBIOS.setVisible(shouldShowSetupBIOS);
        }

        String btnSystemUpdatesText = (isWindows ? "Windows Update" : "System Updates");
        if (!btnSystemUpdatesText.equals(btnSystemUpdates.getText())) {
            btnSystemUpdates.setText(btnSystemUpdatesText);
        }

        boolean shouldShowSystemUpdates = (!isLinuxLiveBoot && shouldShowInternetAndMoreTests && shouldShowStressCPUandTasks);
        if (shouldShowSystemUpdates != btnSystemUpdates.isVisible()) {
            btnSystemUpdates.setEnabled(shouldShowSystemUpdates);
            btnSystemUpdates.setVisible(shouldShowSystemUpdates);

            btnVerifySystemUpdates.setVisible(shouldShowSystemUpdates);
        }

        boolean shouldEnableVerifySystemUpdates = (btnVerifySystemUpdates.isVisible() && (!isMacOS || !new File("/Users/Shared/.fgResetSnapshotCreated").exists()));
        if (shouldEnableVerifySystemUpdates != btnVerifySystemUpdates.isEnabled()) {
            btnVerifySystemUpdates.setEnabled(shouldEnableVerifySystemUpdates);
        }

        boolean shouldShowCheckDrivers = (!isMacOS && shouldShowSystemUpdates);
        if (shouldShowCheckDrivers != btnCheckDrivers.isVisible()) {
            btnCheckDrivers.setEnabled(shouldShowCheckDrivers);
            btnCheckDrivers.setVisible(shouldShowCheckDrivers);

            btnVerifyDrivers.setEnabled(shouldShowCheckDrivers);
            btnVerifyDrivers.setVisible(shouldShowCheckDrivers);
        }

        if (isWindows) {
            String btnCheckWindowsActivationText = "Check Windows Activation" + (isLoggedIn ? " / Activate Windows" : "");
            if (!btnCheckWindowsActivationText.equals(btnCheckWindowsActivation.getText())) {
                btnCheckWindowsActivation.setText(btnCheckWindowsActivationText);
            }
        }

        boolean shouldShowWindowsActivation = (isWindows && shouldShowInternetAndMoreTests && shouldShowStressCPUandTasks);
        if (shouldShowWindowsActivation != btnCheckWindowsActivation.isVisible()) {
            btnCheckWindowsActivation.setEnabled(shouldShowWindowsActivation);
            btnCheckWindowsActivation.setVisible(shouldShowWindowsActivation);

            btnVerifyWindowsActivation.setEnabled(shouldShowWindowsActivation);
            btnVerifyWindowsActivation.setVisible(shouldShowWindowsActivation);
        }

        boolean shouldShowCheckRemoteManagement = (isMacOS && shouldShowStressCPUandTasks);
        if (shouldShowCheckRemoteManagement != btnCheckRemoteManagement.isVisible()) {
            btnCheckRemoteManagement.setEnabled(shouldShowCheckRemoteManagement);
            btnCheckRemoteManagement.setVisible(shouldShowCheckRemoteManagement);

            btnVerifyRemoteManagement.setVisible(shouldShowCheckRemoteManagement);
        }

        boolean shouldEnableVerifyRemoteManagement = (shouldShowCheckRemoteManagement && isLoggedIn);
        if (shouldEnableVerifyRemoteManagement != btnVerifyRemoteManagement.isEnabled()) {
            btnVerifyRemoteManagement.setEnabled(shouldEnableVerifyRemoteManagement);
        }

        boolean shouldShowSaveSpecs = (!isLinuxUbiquityMode && shouldShowInternetAndMoreTests && shouldShowStressCPUandTasks);
        if (shouldShowSaveSpecs != btnSaveSpecs.isVisible()) {
            btnSaveSpecs.setEnabled(shouldShowSaveSpecs);
            btnSaveSpecs.setVisible(shouldShowSaveSpecs);
        }

        boolean showPIDHistoryButton = isLoggedIn;
        if (showPIDHistoryButton != btnPIDHistory.isVisible()) {
            btnPIDHistory.setEnabled(showPIDHistoryButton);
            btnPIDHistory.setVisible(showPIDHistoryButton);
        }

        if (isTestMode != lblTestModeT.isVisible()) {
            lblTestModeT.setVisible(isTestMode);
            lblTestModeE.setVisible(isTestMode);
            lblTestModeS.setVisible(isTestMode);
            lblTestModeT2.setVisible(isTestMode);
            lblTestModeM.setVisible(isTestMode);
            lblTestModeO.setVisible(isTestMode);
            lblTestModeD.setVisible(isTestMode);
            lblTestModeE2.setVisible(isTestMode);
        }

        long finishUpdatingVisibilityInDisplayComputerSpecsTime = System.currentTimeMillis();

        if (isTestMode) {
            System.out.println("Update Visiblity in Display Computer Specs MS: " + (finishUpdatingVisibilityInDisplayComputerSpecsTime - startDisplayComputerSpecsTime));
        }

        if ((isCPUverified != (btnVerifyCPU.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyCPU.setText((isCPUverified ? "Verified" : "Verify"));
            btnVerifyCPU.setFont(defaultFont.deriveFont((isCPUverified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyCPU.setForeground(isCPUverified ? verifiedColor : defaultColor);
            btnVerifyCPU.setBorderPainted(!isCPUverified);
        }

        if ((isDriveHealthVerified != (btnVerifyDriveHealth.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyDriveHealth.setText((isDriveHealthVerified ? "Verified" : "Verify"));
            btnVerifyDriveHealth.setFont(defaultFont.deriveFont((isDriveHealthVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyDriveHealth.setForeground(isDriveHealthVerified ? verifiedColor : defaultColor);
            btnVerifyDriveHealth.setBorderPainted(!isDriveHealthVerified);
        }

        if ((isDiscDriveVerified != (btnVerifyDiscDrive.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyDiscDrive.setText((isDiscDriveVerified ? "Verified" : "Verify"));
            btnVerifyDiscDrive.setFont(defaultFont.deriveFont((isDiscDriveVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyDiscDrive.setForeground(isDiscDriveVerified ? verifiedColor : defaultColor);
            btnVerifyDiscDrive.setBorderPainted(!isDiscDriveVerified);
        }

        if ((isInternetVerified != (btnVerifyInternet.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyInternet.setText((isInternetVerified ? "Verified" : "Verify"));
            btnVerifyInternet.setFont(defaultFont.deriveFont((isInternetVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyInternet.setForeground(isInternetVerified ? verifiedColor : defaultColor);
            btnVerifyInternet.setBorderPainted(!isInternetVerified);
        }

        if ((isScreenVerified != (btnVerifyScreen.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyScreen.setText((isScreenVerified ? "Verified" : "Verify"));
            btnVerifyScreen.setFont(defaultFont.deriveFont((isScreenVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyScreen.setForeground(isScreenVerified ? verifiedColor : defaultColor);
            btnVerifyScreen.setBorderPainted(!isScreenVerified);
        }

        if ((isAudioVerified != (btnVerifyAudio.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyAudio.setText((isAudioVerified ? "Verified" : "Verify"));
            btnVerifyAudio.setFont(defaultFont.deriveFont((isAudioVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyAudio.setForeground(isAudioVerified ? verifiedColor : defaultColor);
            btnVerifyAudio.setBorderPainted(!isAudioVerified);
        }

        if ((isMicrophoneVerified != (btnVerifyMicrophone.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyMicrophone.setText((isMicrophoneVerified ? "Verified" : "Verify"));
            btnVerifyMicrophone.setFont(defaultFont.deriveFont((isMicrophoneVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyMicrophone.setForeground(isMicrophoneVerified ? verifiedColor : defaultColor);
            btnVerifyMicrophone.setBorderPainted(!isMicrophoneVerified);
        }

        if ((isCameraVerified != (btnVerifyCamera.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyCamera.setText((isCameraVerified ? "Verified" : "Verify"));
            btnVerifyCamera.setFont(defaultFont.deriveFont((isCameraVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyCamera.setForeground(isCameraVerified ? verifiedColor : defaultColor);
            btnVerifyCamera.setBorderPainted(!isCameraVerified);
        }

        if ((isKeyboardVerified != (btnVerifyKeyboard.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyKeyboard.setText((isKeyboardVerified ? "Verified" : "Verify"));
            btnVerifyKeyboard.setFont(defaultFont.deriveFont((isKeyboardVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyKeyboard.setForeground(isKeyboardVerified ? verifiedColor : defaultColor);
            btnVerifyKeyboard.setBorderPainted(!isKeyboardVerified);
        }

        if ((isMouseVerified != (btnVerifyMouse.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyMouse.setText((isMouseVerified ? "Verified" : "Verify"));
            btnVerifyMouse.setFont(defaultFont.deriveFont((isMouseVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyMouse.setForeground(isMouseVerified ? verifiedColor : defaultColor);
            btnVerifyMouse.setBorderPainted(!isMouseVerified);
        }

        if ((isBIOSverified != (btnVerifyBIOS.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyBIOS.setText((isBIOSverified ? "Verified" : "Verify"));
            btnVerifyBIOS.setFont(defaultFont.deriveFont((isBIOSverified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyBIOS.setForeground(isBIOSverified ? verifiedColor : defaultColor);
            btnVerifyBIOS.setBorderPainted(!isBIOSverified);
        }

        if ((isPortsVerified != (btnVerifyPorts.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyPorts.setText((isPortsVerified ? "Verified" : "Verify"));
            btnVerifyPorts.setFont(defaultFont.deriveFont((isPortsVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyPorts.setForeground(isPortsVerified ? verifiedColor : defaultColor);
            btnVerifyPorts.setBorderPainted(!isPortsVerified);
        }

        if ((isDriversVerified != (btnVerifyDrivers.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyDrivers.setText((isDriversVerified ? "Verified" : "Verify"));
            btnVerifyDrivers.setFont(defaultFont.deriveFont((isDriversVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyDrivers.setForeground(isDriversVerified ? verifiedColor : defaultColor);
            btnVerifyDrivers.setBorderPainted(!isDriversVerified);
        }

        if ((isUpdatesVerified != (btnVerifySystemUpdates.getText().equals("Verified"))) || themeUpdated) {
            btnVerifySystemUpdates.setText((isUpdatesVerified ? "Verified" : "Verify"));
            btnVerifySystemUpdates.setFont(defaultFont.deriveFont((isUpdatesVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifySystemUpdates.setForeground(isUpdatesVerified ? verifiedColor : defaultColor);
            btnVerifySystemUpdates.setBorderPainted(!isUpdatesVerified);
        }

        if ((isWindowsActivationVerified != (btnVerifyWindowsActivation.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyWindowsActivation.setText((isWindowsActivationVerified ? "Verified" : "Verify"));
            btnVerifyWindowsActivation.setFont(defaultFont.deriveFont((isWindowsActivationVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyWindowsActivation.setForeground(isWindowsActivationVerified ? verifiedColor : defaultColor);
            btnVerifyWindowsActivation.setBorderPainted(!isWindowsActivationVerified);
        }

        if ((isRemoteManagementVerified != (btnVerifyRemoteManagement.getText().equals("Verified"))) || themeUpdated) {
            btnVerifyRemoteManagement.setText((isRemoteManagementVerified ? "Verified" : "Verify"));
            btnVerifyRemoteManagement.setFont(defaultFont.deriveFont((isRemoteManagementVerified ? Font.BOLD : defaultFont.getStyle())));
            btnVerifyRemoteManagement.setForeground(isRemoteManagementVerified ? verifiedColor : defaultColor);
            btnVerifyRemoteManagement.setBorderPainted(!isRemoteManagementVerified);
        }

        long finishVerifyInDisplayComputerSpecsTime = System.currentTimeMillis();

        if (isTestMode) {
            System.out.println("Update Verify Buttons in Display Computer Specs MS: " + (finishVerifyInDisplayComputerSpecsTime - finishUpdatingVisibilityInDisplayComputerSpecsTime));
        }

        if (computerSpecs != null) {
            String toolTipFooter = "<br/><br/><center>" + new TwemojiImage("ComputerMouse", qaHelperWindow).toImgTag("left") + " <i>Right-Click to Copy or Search This Spec Value</i> " + new TwemojiImage("MagnifyingGlassTiltedLeft", qaHelperWindow).toImgTag("right") + "</center></html>";

            // BRAND & MODEL
            String lblModelText = "N/A";
            String lblModelToolTipText = "N/A";
            Color lblModelColor = defaultColor;

            boolean brandIsNA = computerSpecs.getBrand().equals("N/A");
            boolean modelIsNA = computerSpecs.getModel().equals("N/A");

            if (brandIsNA && modelIsNA) {
                if (isLinux && adminPassword.equals("*UNKNOWN*")) {
                    lblModelColor = warningColor;

                    lblModelText = "<html><i>Reload With Admin Password for <b>Model</b> and <b>Serial</b> Info</i></html>";
                } else {
                    lblModelColor = errorColor;
                }
            } else if (brandIsNA || modelIsNA) {
                lblModelColor = warningColor;

                lblModelText = "<html>" + (brandIsNA ? "<i>UNKNOWN BRAND</i>" : computerSpecs.getBrand()) + " - " + (modelIsNA ? "<i>UNKNOWN MODEL</i>" : computerSpecs.getModel()) + "</html>";
                lblModelToolTipText = (brandIsNA ? "<i>UNKNOWN BRAND</i>" : computerSpecs.getFullBrand()) + " - " + (modelIsNA ? "<i>UNKNOWN MODEL</i>" : computerSpecs.getFullModel());
            } else {
                lblModelText = computerSpecs.getBrand() + " " + computerSpecs.getModel();
                if (isMacOS) {
                    if (lblModelText.contains("…") && computerSpecs.getFullModel().contains("POSSIBLE MODELS")) { // Some groups of possible Marketing Model Names can be long especially when including the warnings and we want to be sure to always display the whole thing with the warnings.
                        lblModelText = computerSpecs.getBrand() + " " + computerSpecs.getFullModel();
                    }

                    if (lblModelText.contains(" - UNKNOWN") || lblModelText.contains("POSSIBLE MODELS")) {
                        lblModelColor = warningColor;
                        lblModelText = "<html>" + lblModelText.replaceFirst(" - ", "<b> - ").replace(" or ", " <b>or</b> ") + "</b></html>";
                    }
                }

                lblModelToolTipText = computerSpecs.getFullBrand() + " " + computerSpecs.getFullModel().replace(" - ", "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: ");
            }

            lblModelToolTipText = lblModelLabel.getText().replace("</html>", "<br/>") + lblModelToolTipText + toolTipFooter;

            if (!lblModelLabel.getForeground().equals(lblModelColor)) {
                lblModelLabel.setForeground(lblModelColor);
                lblModel.setForeground(lblModelColor);
            }

            if ((lblModel.getToolTipText() == null) || !lblModel.getToolTipText().equals(lblModelToolTipText)) {
                lblModel.setText(lblModelText);
                lblModel.setToolTipText(lblModelToolTipText);
                lblModelLabel.setToolTipText(lblModelToolTipText);
            }

            // SERIAL
            String lblSerialText = computerSpecs.getSerial();
            String lblSerialToolTipText = "<html><b>Serial:</b><br/>" + computerSpecs.getFullSerial() + toolTipFooter;
            Color lblSerialColor = (lblSerialText.equals("N/A") ? errorColor : defaultColor);

            if (!lblSerial.getForeground().equals(lblSerialColor)) {
                lblSerial.setForeground(lblSerialColor);
            }

            if ((lblSerial.getToolTipText() == null) || !lblSerial.getToolTipText().equals(lblSerialToolTipText)) {
                lblSerial.setText("<html><b>Serial:</b> " + lblSerialText + "</html>");
                lblSerial.setToolTipText(lblSerialToolTipText);
            }

            // CPU
            String lblCPUtext = computerSpecs.getCPU();
            String lblCPUtoolTipText = lblCPULabel.getText().replace("</html>", "<br/>") + computerSpecs.getFullCPU() + toolTipFooter;
            Color lblCPUcolor = (lblCPUtext.equals("N/A") ? errorColor : defaultColor);

            if (!lblCPULabel.getForeground().equals(lblCPUcolor)) {
                lblCPULabel.setForeground(lblCPUcolor);
                lblCPU.setForeground(lblCPUcolor);
            }

            if ((lblCPU.getToolTipText() == null) || !lblCPU.getToolTipText().equals(lblCPUtoolTipText)) {
                lblCPU.setText(lblCPUtext);
                lblCPU.setToolTipText(lblCPUtoolTipText);
                lblCPULabel.setToolTipText(lblCPUtoolTipText);
            }

            // RAM
            String lblRAMtext = computerSpecs.getRAM();
            String lblRAMtoolTipText = computerSpecs.getFullRAM().replace(" - ", "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: ");
            Color lblRAMcolor = defaultColor;

            if (lblRAMtext.equals("N/A")) {
                lblRAMcolor = errorColor;
            } else if (lblRAMtext.contains(" - ")) {
                lblRAMtext = "<html>" + lblRAMtext.replace(" - ", " - <i>") + "</i></html>";
            } else if (isLinux && adminPassword.equals("*UNKNOWN*")) {
                lblRAMcolor = warningColor;

                lblRAMtext = "<html>" + lblRAMtext + " - <i>Reload With Admin Password for More <b>RAM</b> Info</i></html>";
                lblRAMtoolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: Reload With Admin Password for More RAM Info";
            }

            lblRAMtoolTipText = lblRAMLabel.getText().replace("</html>", "<br/>") + lblRAMtoolTipText + toolTipFooter;

            if (!lblRAMLabel.getForeground().equals(lblRAMcolor)) {
                lblRAMLabel.setForeground(lblRAMcolor);
                lblRAM.setForeground(lblRAMcolor);
            }

            if ((lblRAM.getToolTipText() == null) || !lblRAM.getToolTipText().equals(lblRAMtoolTipText)) {
                lblRAM.setText(lblRAMtext);
                lblRAM.setToolTipText(lblRAMtoolTipText);
                lblRAMLabel.setToolTipText(lblRAMtoolTipText);
            }

            // BATTERY
            String lblBatteryText = computerSpecs.getBatteryCapacity();
            boolean hasBattery = (isLaptop || !lblBatteryText.equals("N/A"));

            if (hasBattery) {
                String batteryHealthErrorString = computerSpecs.getBatteryHealthError().replace("<=", "&le;").replace(">=", "&ge;").replace("<", "&lt;").replace(">", "&gt;");
                String batteryHealthWarningString = computerSpecs.getBatteryHealthWarning().replace("<=", "&le;").replace(">=", "&ge;").replace("<", "&lt;").replace(">", "&gt;");

                String lblBatteryToolTipText = "<html><b>Battery:</b><br/>" + lblBatteryText.replace(" - ", "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: ") + "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Battery Health Warning: " + (batteryHealthWarningString.isEmpty() ? "None" : batteryHealthWarningString) + "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Battery Health Error: " + (batteryHealthErrorString.isEmpty() ? "None" : batteryHealthErrorString) + toolTipFooter;
                Color lblBatteryColor = ((!batteryHealthErrorString.isEmpty() || lblBatteryText.equals("N/A")) ? errorColor : (!batteryHealthWarningString.isEmpty() ? warningColor : defaultColor));

                if (lblBatteryText.contains(" - ")) {
                    lblBatteryText = lblBatteryText.replace(" - ", " - <b>") + "</b>";
                }

                if (!lblBatteryCapacity.getForeground().equals(lblBatteryColor)) {
                    lblBatteryCapacity.setForeground(lblBatteryColor);
                }

                if ((lblBatteryCapacity.getToolTipText() == null) || !lblBatteryCapacity.getToolTipText().equals(lblBatteryToolTipText)) {
                    lblBatteryCapacity.setText("<html><b>Battery:</b> " + lblBatteryText + "</html>");
                    lblBatteryCapacity.setToolTipText(lblBatteryToolTipText);
                }
            }

            if (hasBattery != lblBatteryCapacity.isVisible()) {
                lblBatteryCapacity.setVisible(hasBattery);
            }

            // STORAGE
            String lblStorageText = computerSpecs.getStorage().replace("RAID", "<i style='color: " + warningColorHTML + "'>RAID</i>");
            String lblStorageToolTipText = computerSpecs.getFullStorage();
            Color lblStorageColor = (lblStorageText.equals("N/A") ? errorColor : defaultColor);

            String disksFormattedWithoutPartitionTable = computerSpecs.getDisksFormattedWithoutPartitionTable();
            if (computerSpecs.getDriveHealthWarning() || computerSpecs.getDriveTrimWarning() || computerSpecs.getDriveRecalled() || !disksFormattedWithoutPartitionTable.isEmpty()) {
                lblStorageColor = warningColor;

                if (computerSpecs.getDriveRecalled()) {
                    // This is currently only set for some Macs
                    lblStorageText += " - <b>POSSIBLY RECALLED</b>";
                    lblStorageToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: POSSIBLY RECALLED";
                }

                if (computerSpecs.getDriveTrimWarning()) {
                    // This is currently only set on Mac
                    lblStorageText += " - <b>TRIM NOT ENABLED</b>";
                    lblStorageToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: TRIM NOT ENABLED";
                }

                if (!disksFormattedWithoutPartitionTable.isEmpty()) {
                    // This is currently only set on Linux
                    String disksFormattedWithoutPartitionTableNote = "<i>" + disksFormattedWithoutPartitionTable + "</i> " + (disksFormattedWithoutPartitionTable.contains(",") ? "are" : "is") + " Formatted Without a Partition Table";

                    lblStorageText += " - <b>" + disksFormattedWithoutPartitionTableNote + "</b>";
                    lblStorageToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: " + disksFormattedWithoutPartitionTableNote;
                }
            }

            if (lblStorageText.contains("</")) {
                lblStorageText = "<html>" + lblStorageText + "</html>";
            }

            lblStorageToolTipText = lblStorageLabel.getText().replace("</html>", "<br/>") + lblStorageToolTipText + toolTipFooter;

            if (!lblStorageLabel.getForeground().equals(lblStorageColor)) {
                lblStorageLabel.setForeground(lblStorageColor);
                lblStorage.setForeground(lblStorageColor);
            }

            if ((lblStorage.getToolTipText() == null) || !lblStorage.getToolTipText().equals(lblStorageToolTipText)) {
                lblStorage.setText(lblStorageText);
                lblStorage.setToolTipText(lblStorageToolTipText);
                lblStorageLabel.setToolTipText(lblStorageToolTipText);
            }

            // DISC DRIVE
            String lblDiscDriveText = computerSpecs.getDiscDrive();
            String lblDiscDriveToolTipText = computerSpecs.getFullDiscDrive();
            Color lblDiscDriveColor = defaultColor;

            if (hasDiscDrive) {
                String discDriveCapabilityNote;

                if (computerSpecs.discDriveCanBurnCDs() && computerSpecs.discDriveCanBurnDVDs()) {
                    discDriveCapabilityNote = "Supports Writing CDs and DVDs";
                } else {
                    if (computerSpecs.discDriveCanBurnCDs()) {
                        discDriveCapabilityNote = "Does <b>NOT</b> Support Writing DVDs";
                    } else if (computerSpecs.discDriveCanBurnDVDs()) {
                        discDriveCapabilityNote = "Does <b>NOT</b> Support Writing CDs";
                    } else {
                        discDriveCapabilityNote = "Does <b>NOT</b> Support Writing CDs or DVDs";
                    }

                    lblDiscDriveColor = warningColor;
                }

                lblDiscDriveText = "<html>" + lblDiscDriveText + " <i>(" + discDriveCapabilityNote + ")</i></html>";
                lblDiscDriveToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Capability: " + discDriveCapabilityNote;

                if (computerSpecs.hasDiscInDiscDrive()) {
                    lblDiscDriveText = lblDiscDriveText.replace("</html>", " - <b>REMOVE DISC FROM DRIVE</b></html>");
                    lblDiscDriveToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: REMOVE DISC FROM DRIVE";

                    lblDiscDriveColor = errorColor;
                }
            } else {
                lblDiscDriveColor = (isDiscDriveVerified ? warningColor : errorColor);
            }

            lblDiscDriveToolTipText = lblDiscDriveLabel.getText().replace("</html>", "<br/>") + lblDiscDriveToolTipText + toolTipFooter;

            if (!lblDiscDriveLabel.getForeground().equals(lblDiscDriveColor)) {
                lblDiscDriveLabel.setForeground(lblDiscDriveColor);
                lblDiscDrive.setForeground(lblDiscDriveColor);
            }

            if ((lblDiscDrive.getToolTipText() == null) || !lblDiscDrive.getToolTipText().equals(lblDiscDriveToolTipText)) {
                lblDiscDrive.setText(lblDiscDriveText);
                lblDiscDrive.setToolTipText(lblDiscDriveToolTipText);
                lblDiscDriveLabel.setToolTipText(lblDiscDriveToolTipText);
            }

            // WIRELESS
            String lblWirelessText = computerSpecs.getWireless();
            String lblWirelessToolTipText = lblWirelessText;
            Color lblWirelessColor = defaultColor;

            if (lblWirelessText.equals("N/A")) {
                if (isWindowsPE) {
                    lblWirelessColor = warningColor;

                    String wirelessWinPEnote = "<i>Not Detected in Windows Preinstallation Environment (Check Again in Installed OS)</i>";

                    lblWirelessText = "<html>" + wirelessWinPEnote + "</html>";
                    lblWirelessToolTipText = wirelessWinPEnote;
                } else {
                    lblWirelessColor = (isInternetVerified ? warningColor : errorColor);
                }
            } else {
                String wirelessErrorString = computerSpecs.getWirelessErrorString();

                if (!wirelessErrorString.isEmpty()) {
                    lblWirelessColor = errorColor;

                    lblWirelessText = "<html>" + lblWirelessText + " - <b>" + wirelessErrorString + "</b></html>";
                    lblWirelessToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: " + wirelessErrorString;
                }
            }

            lblWirelessToolTipText = lblWirelessLabel.getText().replace("</html>", "<br/>") + lblWirelessToolTipText + toolTipFooter;

            if (!lblWirelessLabel.getForeground().equals(lblWirelessColor)) {
                lblWirelessLabel.setForeground(lblWirelessColor);
                lblWireless.setForeground(lblWirelessColor);
            }

            if ((lblWireless.getToolTipText() == null) || !lblWireless.getToolTipText().equals(lblWirelessToolTipText)) {
                lblWireless.setText(lblWirelessText);
                lblWireless.setToolTipText(lblWirelessToolTipText);
                lblWirelessLabel.setToolTipText(lblWirelessToolTipText);
            }

            // SCREEN SIZE & RESOLUTION
            String lblScreenText = computerSpecs.getScreenSize();
            String screenErrorString = computerSpecs.getScreenErrorString();
            lblScreenText += screenErrorString;

            String lblScreenToolTipText = computerSpecs.getFullScreenSize() + screenErrorString.replace(" - ", "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: ");
            Color lblScreenColor = defaultColor;

            if (lblScreenText.endsWith("N/A")) {
                if (isWindowsPE) {
                    lblScreenColor = warningColor;

                    String screenWinPEnote = (computerSpecs.getFullScreenSize().contains("-inch") ? "<i>" : "<i>Size and ") + "Resolution Not Available in Windows Preinstallation Environment<i>";

                    lblScreenText = "<html>" + lblScreenText.replace("N/A", screenWinPEnote) + "</html>";

                    int seperatorIndex = lblScreenText.lastIndexOf(": ");
                    if (seperatorIndex > 0) {
                        lblScreenText = lblScreenText.substring(0, seperatorIndex) + " - " + lblScreenText.substring(seperatorIndex + 2);
                    }

                    lblScreenToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: " + screenWinPEnote;
                } else {
                    lblScreenColor = (lblScreenText.equals("N/A") ? errorColor : warningColor);
                }
            } else if (screenErrorString.contains("RECALL")) {
                lblScreenColor = warningColor;

                lblScreenText = "<html>" + lblScreenText.replace(" - ", " - <b>") + "</b></html>";
            }

            lblScreenToolTipText = lblScreenLabel.getText().replace("</html>", "<br/>") + lblScreenToolTipText + toolTipFooter;

            if (!lblScreenLabel.getForeground().equals(lblScreenColor)) {
                lblScreenLabel.setForeground(lblScreenColor);
                lblScreen.setForeground(lblScreenColor);
            }

            if ((lblScreen.getToolTipText() == null) || !lblScreen.getToolTipText().equals(lblScreenToolTipText)) {
                lblScreen.setText(lblScreenText);
                lblScreen.setToolTipText(lblScreenToolTipText);
                lblScreenLabel.setToolTipText(lblScreenToolTipText);
            }

            // GPU
            String lblGPUtext = computerSpecs.getGPU();
            String lblGPUtoolTipText = computerSpecs.getFullGPU();
            Color lblGPUcolor = defaultColor;

            String gpuErrorString = computerSpecs.getGPUerrorString();

            if (lblGPUtext.equals("N/A") || !gpuErrorString.isEmpty()) {
                lblGPUcolor = (gpuErrorString.contains("RECALL") ? warningColor : errorColor);

                if (!gpuErrorString.isEmpty()) {
                    lblGPUtext = "<html>" + lblGPUtext + " - <b>" + gpuErrorString + "</b></html>";
                    lblGPUtoolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: " + gpuErrorString;
                }
            }

            lblGPUtoolTipText = lblGPULabel.getText().replace("</html>", "<br/>") + lblGPUtoolTipText + toolTipFooter;

            if (!lblGPULabel.getForeground().equals(lblGPUcolor)) {
                lblGPULabel.setForeground(lblGPUcolor);
                lblGPU.setForeground(lblGPUcolor);
            }

            if ((lblGPU.getToolTipText() == null) || !lblGPU.getToolTipText().equals(lblGPUtoolTipText)) {
                lblGPU.setText(lblGPUtext);
                lblGPU.setToolTipText(lblGPUtoolTipText);
                lblGPULabel.setToolTipText(lblGPUtoolTipText);
            }

            // OS
            String lblOStext = computerSpecs.getOS();
            String lblOStoolTipText = "<html><b>OS:</b><br/>" + computerSpecs.getFullOS() + toolTipFooter;
            Color lblOScolor = (lblOStext.equals("N/A") ? errorColor : defaultColor);

            if (!lblOS.getForeground().equals(lblOScolor)) {
                lblOS.setForeground(lblOScolor);
            }

            if ((lblOS.getToolTipText() == null) || !lblOS.getToolTipText().equals(lblOStoolTipText)) {
                lblOS.setText("<html><b>OS:</b> " + lblOStext + "</html>");
                lblOS.setToolTipText(lblOStoolTipText);
            }

            // AUDIO
            String lblAudioText = computerSpecs.getAudio();
            String lblAudioToolTipText = computerSpecs.getFullAudio();
            Color lblAudioColor = defaultColor;

            String audioErrorString = computerSpecs.getAudioErrorString();

            if (lblAudioText.equals("N/A") || !audioErrorString.isEmpty()) {
                if (audioErrorString.equals("DRIVER MAY NOT BE INSTALLED")) {
                    lblAudioColor = warningColor;
                } else {
                    lblAudioColor = errorColor;
                }

                if (!audioErrorString.isEmpty()) {
                    lblAudioText = "<html>" + lblAudioText + " - <b>" + audioErrorString + "</b></html>";
                    lblAudioToolTipText += "<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note: " + audioErrorString;
                }
            }

            lblAudioToolTipText = lblAudioLabel.getText().replace("</html>", "<br/>") + lblAudioToolTipText + toolTipFooter;

            if (!lblAudioLabel.getForeground().equals(lblAudioColor)) {
                lblAudioLabel.setForeground(lblAudioColor);
                lblAudio.setForeground(lblAudioColor);
            }

            if ((lblAudio.getToolTipText() == null) || !lblAudio.getToolTipText().equals(lblAudioToolTipText)) {
                lblAudio.setText(lblAudioText);
                lblAudio.setToolTipText(lblAudioToolTipText);
                lblAudioLabel.setToolTipText(lblAudioToolTipText);
            }
        }

        long finishUpdateSpecsTime = System.currentTimeMillis();

        if (isTestMode) {
            System.out.println("Update Specs in Display Computer Specs MS: " + (finishUpdateSpecsTime - finishVerifyInDisplayComputerSpecsTime));
        }

        long finishDisplayComputerSpecsTime = System.currentTimeMillis();

        if (isTestMode) {
            System.out.println("Display Computer Specs MS: " + (finishDisplayComputerSpecsTime - startDisplayComputerSpecsTime));
        }

        int fontBasedMinWidth = (defaultFont.getSize() * 50);
        int fontBasedMinHeight = (defaultFont.getSize() * 8);

        if (!isLinux) {
            fontBasedMinHeight = UIScale.scale(fontBasedMinHeight);
            fontBasedMinHeight = UIScale.scale(fontBasedMinHeight);
        }

        int minWidth = Math.min(fontBasedMinWidth, UIScale.scale(800));
        int minHeight = Math.min(fontBasedMinHeight, UIScale.scale(100));

        final Dimension prePackSize = getSize();

        // Don't allow pack() to go smaller than current width (but do allow wider) unless themeUpdated which could be a font size decrease.
        setMinimumSize(new java.awt.Dimension(((isVisible() && !themeUpdated) ? getSize().width : minWidth), minHeight));
        setPreferredSize(null);

        pack();

        long finishPackWindowTime = System.currentTimeMillis();

        if (isTestMode) {
            System.out.println("Pack Windows After Display Computer Specs MS: " + (finishPackWindowTime - finishDisplayComputerSpecsTime));
        }

        ignoreWindowMovesUntilTime = System.currentTimeMillis() + 1500;

        // Wait up to 1/2 second in the background before re-centering and/or reducing window size for screen size because pack() may not happen immediately.
        (new SwingWorker<Void, Void>() {
            @Override
            protected Void doInBackground() throws Exception {
                for (int waitForPack = 0; waitForPack < 50; waitForPack++) {
                    if (!prePackSize.equals(getSize())) {
                        break;
                    }

                    TimeUnit.MILLISECONDS.sleep(10);
                }
                return null;
            }

            @Override
            protected void done() {
                // setMaximumSize does not work. But do not want the windows to get larger than the screen.
                // The window contents are within a scroll pane, so if we set the window size to the screen size, the contents can still be scrolled.

                Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
                Insets screenInsets = Toolkit.getDefaultToolkit().getScreenInsets(getGraphicsConfiguration());
                screenSize.height -= screenInsets.top + screenInsets.bottom;
                screenSize.width -= screenInsets.left + screenInsets.right;

                Dimension windowSize = getSize();
                Dimension reducedWindowSize = getSize();

                boolean didReduceWidth = false;
                if (windowSize.width > screenSize.width) {
                    reducedWindowSize.width = screenSize.width;
                    didReduceWidth = true;
                }

                if (windowSize.height > screenSize.height) {
                    reducedWindowSize.height = screenSize.height;

                    if (!didReduceWidth) {
                        // If reduced height, add the width of the scrollbar to the window to not
                        // need to also scroll horizonally since the scrollbar would block content.

                        reducedWindowSize.width += UIScale.scale(10); // FlatLaf ScrollBar.width

                        if (reducedWindowSize.width > screenSize.width) {
                            reducedWindowSize.width = screenSize.width;
                        }
                    }
                }

                if (!reducedWindowSize.equals(windowSize)) {
                    setMinimumSize(reducedWindowSize);
                    setPreferredSize(reducedWindowSize);
                    setSize(reducedWindowSize);

                    // Wait up to 1/2 second in the background before setting "themeUpdated" to false and re-centering (if necessary) because setSize() may not happen immediately.
                    (new SwingWorker<Void, Void>() {
                        @Override
                        protected Void doInBackground() throws Exception {
                            for (int waitForPack = 0; waitForPack < 50; waitForPack++) {
                                if (!windowSize.equals(getSize())) {
                                    break;
                                }

                                TimeUnit.MILLISECONDS.sleep(10);
                            }
                            return null;
                        }

                        @Override
                        protected void done() {
                            if (!windowMoved) {
                                setLocationRelativeTo(null);
                            }

                            themeUpdated = false;
                        }
                    }).execute();
                } else {
                    if (!windowMoved) {
                        setLocationRelativeTo(null);
                    }

                    themeUpdated = false;
                }
            }
        }).execute();
    }

    private void playAlertSound(String soundName) {
        switch (soundName) {
            case "beep":
                if (isLinux) {
                    // Java beep() doesn't do anything on Linux
                    try {
                        Runtime.getRuntime().exec(new String[]{"/usr/bin/paplay", "/usr/share/sounds/freedesktop/stereo/dialog-information.oga"});
                    } catch (IOException playDialogWarningException) {
                        if (isTestMode) {
                            System.out.println("playDialogWarningException: " + playDialogWarningException);
                        }
                    }
                } else {
                    Toolkit.getDefaultToolkit().beep();
                }

                break;
            case "error":
                if (isLinux) {
                    // Java AudioSystem is not reliable on Linux
                    try {
                        Runtime.getRuntime().exec(new String[]{"/usr/bin/paplay", "/usr/share/sounds/freedesktop/stereo/dialog-error.oga"});
                    } catch (IOException playErrorSoundException) {
                        if (isTestMode) {
                            System.out.println("playErrorSoundException: " + playErrorSoundException);
                        }
                    }
                } else {
                    (new SwingWorker<Void, Void>() {
                        @Override
                        protected Void doInBackground() throws Exception {
                            try (Clip errorSoundClip = AudioSystem.getClip()) {
                                errorSoundClip.open(AudioSystem.getAudioInputStream(new File((isWindows ? "\\Windows\\Media\\Windows Foreground.wav" : "/System/Library/Sounds/Basso.aiff"))));
                                errorSoundClip.start();
                                TimeUnit.SECONDS.sleep(3);
                            } catch (Error | Exception playErrorSoundErrorOrException) {
                                if (isTestMode) {
                                    System.out.println("playErrorSoundErrorOrException: " + playErrorSoundErrorOrException);
                                }

                                try {
                                    if (isWindows) {
                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object Media.SoundPlayer \"\\Windows\\Media\\Windows` Foreground.wav\").PlaySync();"});
                                    } else {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/afplay", "/System/Library/Sounds/Basso.aiff"});
                                    }
                                } catch (IOException playBackupErrorSoundException) {
                                    if (isTestMode) {
                                        System.out.println("playBackupErrorSoundException: " + playBackupErrorSoundException);
                                    }
                                }
                            }

                            return null;
                        }
                    }).execute();
                }

                break;
            case "success":
                if (isLinux) {
                    // Java AudioSystem is not reliable on Linux
                    try {
                        Runtime.getRuntime().exec(new String[]{"/usr/bin/paplay", "/usr/share/sounds/freedesktop/stereo/complete.oga"});
                    } catch (IOException playSuccessSoundException) {
                        if (isTestMode) {
                            System.out.println("playSuccessSoundException: " + playSuccessSoundException);
                        }
                    }
                } else {
                    (new SwingWorker<Void, Void>() {
                        @Override
                        protected Void doInBackground() throws Exception {
                            try (Clip successSoundClip = AudioSystem.getClip()) {
                                successSoundClip.open(AudioSystem.getAudioInputStream(new File((isWindows ? "\\Windows\\Media\\Windows Exclamation.wav" : "/System/Library/Sounds/Glass.aiff"))));
                                successSoundClip.start();
                                TimeUnit.SECONDS.sleep(3);
                            } catch (Error | Exception playSuccessSoundErrorOrException) {
                                if (isTestMode) {
                                    System.out.println("playSuccessSoundErrorOrException: " + playSuccessSoundErrorOrException);
                                }

                                try {
                                    if (isWindows) {
                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object Media.SoundPlayer \"\\Windows\\Media\\Windows` Exclamation.wav\").PlaySync();"});
                                    } else {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/afplay", "/System/Library/Sounds/Glass.aiff"});
                                    }
                                } catch (IOException playBackupSuccessSoundException) {
                                    if (isTestMode) {
                                        System.out.println("playBackupSuccessSoundException: " + playBackupSuccessSoundException);
                                    }
                                }
                            }

                            return null;
                        }
                    }).execute();
                }

                break;
            default:
                break;
        }
    }

    private void focusNextTestTaskVerifyButton(Component currentButton) {
        if (btnDoneTesting.getText().equals("Options")) {
            return;
        }

        Object[][] allTestButtonsAndVerifications = new Object[][]{
            {btnStressCPU, btnVerifyCPU, isCPUverified},
            {btnDriveHealth, btnVerifyDriveHealth, isDriveHealthVerified},
            {btnEjectDiscDrive, btnVerifyDiscDrive, isDiscDriveVerified},
            {btnTestInternet, btnVerifyInternet, isInternetVerified},
            {btnTestScreen, btnVerifyScreen, isScreenVerified},
            {btnTestAudio, btnVerifyAudio, isAudioVerified},
            {btnTestMicrophone, btnVerifyMicrophone, isMicrophoneVerified},
            {btnTestCamera, btnVerifyCamera, isCameraVerified},
            {btnTestKeyboard, btnVerifyKeyboard, isKeyboardVerified},
            {btnTestMouse, btnVerifyMouse, isMouseVerified},
            {btnSetupBIOS, btnVerifyBIOS, isBIOSverified},
            {btnCheckPorts, btnVerifyPorts, isPortsVerified},
            {btnCheckDrivers, btnVerifyDrivers, isDriversVerified},
            {btnSystemUpdates, btnVerifySystemUpdates, isUpdatesVerified},
            {btnCheckWindowsActivation, btnVerifyWindowsActivation, isWindowsActivationVerified},
            {btnCheckRemoteManagement, btnVerifyRemoteManagement, isRemoteManagementVerified}
        };

        boolean foundCurrentButton = (currentButton == null);

        for (Object[] thisTestButtonSet : allTestButtonsAndVerifications) {
            Component thisTestButton = (Component) thisTestButtonSet[0];
            Component thisVerifyButton = (Component) thisTestButtonSet[1];
            boolean thisTestIsVerified = (boolean) thisTestButtonSet[2];

            if (foundCurrentButton || (currentButton == thisTestButton) || (currentButton == thisVerifyButton)) {
                if (!thisTestIsVerified) {
                    if (foundCurrentButton || (currentButton == thisVerifyButton)) {
                        if (thisTestButton.isVisible() && thisTestButton.isEnabled() && (thisVerifyButton.isEnabled() || (currentButton != null))) {
                            thisTestButton.requestFocusInWindow();
                            return;
                        } else if (thisVerifyButton.isVisible() && thisVerifyButton.isEnabled()) {
                            thisVerifyButton.requestFocusInWindow();
                            return;
                        }
                    }
                }

                if (!foundCurrentButton) {
                    foundCurrentButton = true;
                }
            }
        }

        if (!isLoggedIn && ((!isLinuxUbiquityMode && !isWindowsPE) || (currentButton == btnLogIn))) {
            if (txtUsername.getText().trim().isEmpty()) {
                txtUsername.requestFocusInWindow();
            } else if (pswPassword.getPassword().length == 0) {
                pswPassword.requestFocusInWindow();
            } else if (txtPID.getText().trim().isEmpty()) {
                txtPID.requestFocusInWindow();
            } else {
                btnLogIn.requestFocusInWindow();
            }
        } else {
            btnDoneTesting.requestFocusInWindow();
        }
    }

    // LOGIN METHODS
    public boolean authenticateUser() {
        boolean authenticated = false;

        if (!isLoggedIn) {
            username = txtUsername.getText().toLowerCase();
            String passwordString = new String(pswPassword.getPassword());

            if (!username.isEmpty() && !passwordString.isEmpty()) {
                for (int loginAttemptCount = 1; loginAttemptCount <= 3; loginAttemptCount++) {
                    // After adding "sendErrorEmail" functionality, it seems that sporatic login failures are one of the most common issue.
                    // To help workaround this issue, try to log in up to 3 times (waiting a moment between attempts) if there is an exception,
                    // and only display an error and send an error email if the 3rd attempt fails.

                    try {
                        authenticated = PCsCRMManager.authenticateCredentials(username, passwordString, isTestMode);

                        if (!authenticated) {
                            loadingWindow.closeWindow();
                            playAlertSound("error");
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Incorrect Username or Password</b></html>", "QA Helper  —  Login Error", JOptionPane.WARNING_MESSAGE);
                        }

                        break;
                    } catch (Exception authenticateUserException) {
                        if (isTestMode) {
                            System.out.println("authenticateUserException: " + authenticateUserException);
                        }

                        if (loginAttemptCount < 3) {
                            try {
                                TimeUnit.SECONDS.sleep(loginAttemptCount);
                            } catch (InterruptedException sleepException) {
                                // Ignore sleepException
                            }
                        } else {
                            sendErrorEmail("authenticateUserException: " + authenticateUserException);

                            loadingWindow.closeWindow();
                            playAlertSound("error");
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Connect to <i>PCsCRM</i> to <i>Authenticate User</i></b></html>", "QA Helper  —  Authenticate User Error", JOptionPane.ERROR_MESSAGE);
                        }
                    }
                }
            }
        }

        return authenticated;
    }

    public boolean checkPID(boolean isOnlyChecking) {
        if (!isLoggedIn) {
            String thisPID = txtPID.getText().trim().toUpperCase();

            boolean validPID = false;

            if (!thisPID.isEmpty()) {
                String statusHistoryDataXML = "UNKNOWN STATUS HISTORY ERROR";

                try {
                    if (authenticateUser()) {
                        validPID = PCsCRMManager.validatePID(thisPID, isTestMode);

                        if (!validPID) {
                            loadingWindow.closeWindow();
                            playAlertSound("error");
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>PID \"" + thisPID + "\" Does Not Exist</b><br/><br/><i>Double-check the PID or create it at PCsCRM.com.</i></html>", "QA Helper  —  PID Error", JOptionPane.WARNING_MESSAGE, new TwemojiImage("IDButton", qaHelperWindow).toImageIcon(32));
                        } else {
                            String loggedBrand = "ERROR";
                            String loggedModel = "ERROR";
                            String loggedSerial = "ERROR";

                            try {
                                LinkedHashMap<String, String> loggedSpecs = PCsCRMManager.getSpecsForPID(thisPID, isTestMode);

                                loggedBrand = loggedSpecs.get("Brand");
                                loggedModel = loggedSpecs.get("Model");
                                loggedSerial = loggedSpecs.get("Serial");
                            } catch (Exception parseLoggedSpecsException) {
                                System.out.println("parseLoggedSpecsException: " + parseLoggedSpecsException);
                                sendErrorEmail("parseLoggedSpecsException: " + parseLoggedSpecsException);
                            }

                            statusHistoryDataXML = PCsCRMManager.getStatusHistoryXMLForPID(thisPID, isTestMode);
                            String[] latestStatusAndTech = new PIDHistoryWindow(statusHistoryDataXML, null, isTestMode).getLatestStatusAndTech();

                            if (isOnlyChecking) {
                                loadingWindow.closeWindow();
                                playAlertSound("success");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html>"
                                        + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>PID \"" + thisPID + "\" Exists with Status <u>" + latestStatusAndTech[0] + "</u> by <i>" + latestStatusAndTech[1] + "</i></b>"
                                        + "<br/><br/>"
                                        + "<i>Logged Specs Summary for " + thisPID + ":</i>"
                                        + "<br/>"
                                        + "<b>Brand:</b> " + loggedBrand + "<br/>"
                                        + "<b>Model:</b> " + loggedModel + "<br/>"
                                        + "<b>Serial:</b> " + loggedSerial + "<br/>"
                                        + "</html>", "QA Helper  —  Check PID", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("IDButton", qaHelperWindow).toImageIcon(32));
                            } else {
                                if (!loggedSerial.isEmpty() && !loggedSerial.equals("NOT LOGGED") && !loggedSerial.equals(computerSpecs.getSerial())) {
                                    loadingWindow.closeWindow();

                                    playAlertSound("error");
                                    ArrayList<String> pidAlreadyLoggedDialogButtons = new ArrayList<>();
                                    pidAlreadyLoggedDialogButtons.add("Cancel Login");
                                    if (isTestMode) { // TODO: Add some way to allow login in Live Mode.
                                        pidAlreadyLoggedDialogButtons.add("Log In Anyway");
                                    }

                                    int pidAlreadyLoggedDialogReturn = JOptionPane.showOptionDialog(qaHelperWindow, "<html>"
                                            + "<b style='color: " + errorColorHTML + "'>PID \"" + thisPID + "\" Already Logged for Different Serial with Status <u>" + latestStatusAndTech[0] + "</u> by <i>" + latestStatusAndTech[1] + "</i></b>"
                                            + "<br/><br/>"
                                            + "<b style='color: " + warningColorHTML + "'>Double-check the PID. <u style='color: " + warningColorHTML + "'>Most likely, you or a previous technician mistyped the PID.</u></b>"
                                            + "<br/><br/>"
                                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>If the PID is correct, CONSULT YOUR MANAGER (or I.T.) to be able to complete this computer.</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                            + "<br/><br/>"
                                            + "<i>Logged Specs Summary for " + thisPID + ":</i>"
                                            + "<br/>"
                                            + "<b>Brand:</b> " + loggedBrand + "<br/>"
                                            + "<b>Model:</b> " + loggedModel + "<br/>"
                                            + "<b>Serial:</b> " + loggedSerial + "<br/>"
                                            + "</html>", "QA Helper  —  PID Already Logged for Different Serial", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("Collision", qaHelperWindow).toImageIcon(32), pidAlreadyLoggedDialogButtons.toArray(), pidAlreadyLoggedDialogButtons.get(0));

                                    if (pidAlreadyLoggedDialogReturn != JOptionPane.NO_OPTION) {
                                        return false;
                                    }

                                    loadingWindow.setLoadingTextAndDisplay("QA Helper is Logging In", "Working", "Key");
                                }

                                if (isLinux) {
                                    String previousAdminPassword = adminPassword;
                                    getAdminPassword("Save PID to Disk"); // Double-check that admin password is still correct.

                                    if (!adminPassword.equals(previousAdminPassword)) {
                                        computerSpecs.reloadSpecs(adminPassword, isTestMode);

                                        // Will displayComputerSpecs on main thread after login complete.
                                    }
                                }

                                if (createHelperLogFile() || !pid.equals(thisPID) || !Objects.equals(isTestMode, gotTestModeFromLog)) {
                                    writeToHelperLogFile("PID: " + thisPID + (isTestMode ? " (Test Mode)" : ""));
                                    gotTestModeFromLog = isTestMode;
                                }

                                pid = thisPID;
                            }
                        }
                    }
                } catch (Exception checkPIDException) {
                    if (isTestMode) {
                        System.out.println("checkPIDException: " + checkPIDException + "\n\nstatusHistoryDataXML: " + statusHistoryDataXML);
                    }

                    sendErrorEmail("checkPIDException: " + checkPIDException + "\n\nstatusHistoryDataXML: " + statusHistoryDataXML);

                    loadingWindow.closeWindow();
                    playAlertSound("error");
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Connect to <i>PCsCRM</i> to <i>Check PID</i></b></html>", "QA Helper  —  Check PID Error", JOptionPane.ERROR_MESSAGE);
                }
            } else {
                playAlertSound("beep");
            }

            return validPID;
        }

        return false;
    }

    // QA METHODS AFTER LOGIN
    private String[] getHistory(boolean showHistoryWindow) {
        if (isLoggedIn) {
            String statusHistoryDataXML = "UNKNOWN STATUS HISTORY ERROR";

            try {
                if (historyWindow != null && historyWindow.isVisible()) {
                    historyWindow.dispose();
                }

                statusHistoryDataXML = PCsCRMManager.getStatusHistoryXMLForPID(pid, isTestMode);
                historyWindow = new PIDHistoryWindow(
                        statusHistoryDataXML,
                        (showHistoryWindow ? PCsCRMManager.getSpecsForPID(pid, isTestMode) : null),
                        isTestMode
                );

                String[] latestStatusAndTech = historyWindow.getLatestStatusAndTech();

                if (showHistoryWindow) {
                    historyWindow.setLocationRelativeTo(null);
                    historyWindow.setVisible(true);
                }

                return latestStatusAndTech;

            } catch (Exception getHistoryException) {
                if (isTestMode) {
                    System.out.println("getHistoryException: " + getHistoryException + "\n\nstatusHistoryDataXML: " + statusHistoryDataXML);
                }

                sendErrorEmail("getHistoryException: " + getHistoryException + "\n\nstatusHistoryDataXML: " + statusHistoryDataXML);

                loadingWindow.closeWindow();

                if (!themeUpdated) { // No need to show blocking error if only updating theme such as changing font size.
                    playAlertSound("error");
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Connect to <i>PCsCRM</i> to <i>Get PID History</i></b></html>", "QA Helper  —  PID History Error", JOptionPane.ERROR_MESSAGE);
                }

                return new String[]{"UNKNOWN STATUS", "UNKNOWN TECH"};
            }
        } else {
            playAlertSound("beep");
            return new String[]{"UNKNOWN STATUS", "UNKNOWN TECH"};
        }
    }

    private boolean logComputerSpecs() {
        return logComputerSpecs(false);
    }

    private boolean logComputerSpecs(boolean includeWindowsLicenseFlag) {
        if (isLoggedIn && !isReloading) {
            String pidPrefix = pid.replaceAll("[^A-Z]", "");

            if (isMacOS) {
                if (!new File(macBuildInfoPath).exists()) {
                    new File(macBuildInfoPath).mkdirs();
                }

                String batteryCapacityString = computerSpecs.getBatteryCapacity();
                String modelAndProcessorOutput = "Model Name:\n\t"
                        + computerSpecs.getFullModel()
                        + "\n\n"
                        + "Processor Model:\n\t"
                        + computerSpecs.getFullCPU()
                        + (!batteryCapacityString.equals("N/A") ? "\n\nBattery Capacity Remaining:\n\t" + batteryCapacityString : "");

                boolean isAppleSiliconRosetta = (computerSpecs.getFullCPU().startsWith("Apple") && new CommandReader(new String[]{"/usr/sbin/sysctl", "-in", "sysctl.proc_translated"}).getFirstOutputLine().equals("1"));

                ArrayList<String> systemProfilerCommand = new ArrayList<>();
                if (isAppleSiliconRosetta) {
                    systemProfilerCommand.addAll(Arrays.asList("/usr/bin/arch", "-arm64e"));
                }
                systemProfilerCommand.addAll(Arrays.asList("/usr/sbin/system_profiler", "SPHardwareDataType", "SPMemoryDataType", "SPNVMeDataType", "SPSerialATADataType", "SPDisplaysDataType", "SPAudioDataType", "SPDiscBurningDataType", "SPPowerDataType", "SPEthernetDataType", "SPAirPortDataType", "SPBluetoothDataType"));

                String systemProfilerOutput = String.join("\n", new CommandReader(systemProfilerCommand.toArray(String[]::new)).getOutputLines());

                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(new File(macBuildInfoPath + (!pidPrefix.isEmpty() ? ((pidPrefix.equals("FG") ? "Free Geek" : pidPrefix) + " - ") : "") + "System Profile.txt")))) {
                    bufferedWriter.write(modelAndProcessorOutput + "\n\n\n" + systemProfilerOutput);
                } catch (IOException saveSystemProfilerException) {
                    if (isTestMode) {
                        System.out.println("saveSystemProfilerException: " + saveSystemProfilerException);
                    }
                }
            } else if (isLinux) {
                String previousAdminPassword = adminPassword;
                getAdminPassword("Save Computer Specs to Disk"); // Double-check that admin password is still correct.

                if (!adminPassword.equals(previousAdminPassword)) {
                    computerSpecs.reloadSpecs(adminPassword, isTestMode);

                    displayComputerSpecs();
                }

                if (!new File(linuxBuildInfoPath).exists()) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/mkdir '" + linuxBuildInfoPath.replace("'", "'\\''") + "'"}).waitFor();
                    } catch (IOException | InterruptedException createBuildInfoFolderException) {
                        if (isTestMode) {
                            System.out.println("createBuildInfoFolderException: " + createBuildInfoFolderException);
                        }
                    }
                }

                if (new File(linuxBuildInfoPath).exists()) {
                    try {
                        String dmidecodeOutputPath = linuxBuildInfoPath + (!pidPrefix.isEmpty() ? ((pidPrefix.equals("FG") ? "free-geek" : pidPrefix.toLowerCase()) + "_") : "") + "dmidecode-output.txt";
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/touch '" + dmidecodeOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/chmod 666 '" + dmidecodeOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/sbin/dmidecode -q > '" + dmidecodeOutputPath.replace("'", "'\\''") + "'"}).waitFor();
                    } catch (IOException | InterruptedException saveDmidecodeException) {
                        if (isTestMode) {
                            System.out.println("saveDmidecodeException: " + saveDmidecodeException);
                        }
                    }

                    try {
                        String lshwOutputPath = linuxBuildInfoPath + (!pidPrefix.isEmpty() ? ((pidPrefix.equals("FG") ? "free-geek" : pidPrefix.toLowerCase()) + "_") : "") + "lshw-output.txt";
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/touch '" + lshwOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/chmod 666 '" + lshwOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/lshw > '" + lshwOutputPath.replace("'", "'\\''") + "'"}).waitFor();
                    } catch (IOException | InterruptedException saveLshwException) {
                        if (isTestMode) {
                            System.out.println("saveLshwException: " + saveLshwException);
                        }
                    }

                    try {
                        String hdsentinelOutputPath = linuxBuildInfoPath + (!pidPrefix.isEmpty() ? ((pidPrefix.equals("FG") ? "free-geek" : pidPrefix.toLowerCase()) + "_") : "") + "hdsentinel-output.txt";
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/touch '" + hdsentinelOutputPath + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/chmod 666 '" + hdsentinelOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' '" + computerSpecs.getDriveHealth().replace("'", "'\\''") + "' > '" + hdsentinelOutputPath.replace("'", "'\\''") + "'"}).waitFor();
                    } catch (IOException | InterruptedException saveHdsentinelException) {
                        if (isTestMode) {
                            System.out.println("saveHdsentinelException: " + saveHdsentinelException);
                        }
                    }

                    if (computerSpecs.isLaptop() || !computerSpecs.getBatteryCapacity().equals("N/A")) {
                        try {
                            String upowerOutputPath = linuxBuildInfoPath + (!pidPrefix.isEmpty() ? ((pidPrefix.equals("FG") ? "free-geek" : pidPrefix.toLowerCase()) + "_") : "") + "upower-output.txt";
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/touch '" + upowerOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /bin/chmod 666 '" + upowerOutputPath.replace("'", "'\\''") + "' && printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/upower --dump > '" + upowerOutputPath.replace("'", "'\\''") + "'"}).waitFor();
                        } catch (IOException | InterruptedException saveUpowerException) {
                            if (isTestMode) {
                                System.out.println("saveUpowerException: " + saveUpowerException);
                            }
                        }
                    }
                }
            } else if (isWindows) {
                if (!new File(windowsBuildInfoPath).exists()) {
                    new File(windowsBuildInfoPath).mkdirs();
                }

                // TODO: Save full GWMI specs to file
            }

            try {
                boolean logSpecsWasSuccessful = PCsCRMManager.setSpecsForPID(
                        pid,
                        username,
                        computerSpecs.getBrand(),
                        computerSpecs.getModel(),
                        computerSpecs.getSerial(),
                        ((isLinuxLiveBoot || isWindowsPE || isMacTestBoot) ? "N/A" : computerSpecs.getOS()),
                        computerSpecs.getCPU(),
                        computerSpecs.getRAM(),
                        computerSpecs.getStorage(),
                        computerSpecs.getGPU(),
                        computerSpecs.getAudio(),
                        (computerSpecs.hasScreen() ? computerSpecs.getScreenSize() : "N/A"), // Do not want to log a resolution on computers without built-in screens.
                        computerSpecs.getDiscDrive(),
                        includeWindowsLicenseFlag,
                        isTestMode
                );

                if (logSpecsWasSuccessful) {
                    if (historyWindow != null && historyWindow.isVisible()) {
                        historyWindow.dispose();
                    }
                } else { // This should never happen since "setSpecsForPID()" will throw an exception if verification failed.
                    sendErrorEmail("FAILED TO VERIFY LOGGED SPECS (SHOULD NOT HAVE GOTTEN HERE)");
                }

                return logSpecsWasSuccessful;
            } catch (Exception logComputerSpecsException) {
                if (isTestMode) {
                    System.out.println("logComputerSpecsException: " + logComputerSpecsException);
                }

                sendErrorEmail("logComputerSpecsException: " + logComputerSpecsException);

                loadingWindow.closeWindow();
                playAlertSound("error");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Connect to <i>PCsCRM</i> to <i>Log Computer Specs</i> or Failed to <i>Verify Logged Specs</i></b></html>", "QA Helper  —  Log Computer Specs Error", JOptionPane.ERROR_MESSAGE);
            }
        }

        return false;
    }

    private String[] updateStatus(String newStatusName, String previousStatusName) {
        if (isLoggedIn) {
            try {
                if (historyWindow != null && historyWindow.isVisible()) {
                    historyWindow.dispose();
                }

                String[] statusNames = privateStrings.getPCsCRMStatusNames();

                String updateStatusResult = PCsCRMManager.setStatusForPID(pid, username, newStatusName, isTestMode);

                String[] retrievedStatusAndTech = getHistory(false);
                String retrievedStatus = retrievedStatusAndTech[0];

                if (updateStatusResult.equals("true") && !retrievedStatus.equals("UNKNOWN STATUS") && retrievedStatus.equals(newStatusName)) {
                    // Never hide login and tasks in Windows since QA Helper will never be shown in demo mode.
                    hideLoginAndTasks = (!isLinuxUbiquityMode && !isWindows && newStatusName.equals(statusNames[12]));

                    new LinuxAutoScripts(newStatusName, adminPassword);

                    String manualStatusNote = ((newStatusName.equals(statusNames[3]) && !previousStatusName.equals(statusNames[14]) && !previousStatusName.equals(statusNames[0]) && !previousStatusName.equals(statusNames[18])) ? " (Manual)" : "");
                    writeToHelperLogFile("Status: " + newStatusName + manualStatusNote);
                    logDebugSpecs(newStatusName + manualStatusNote);

                    lastStatus = newStatusName;

                    return retrievedStatusAndTech;
                } else {
                    loadingWindow.closeWindow();
                    playAlertSound("error");
                    String updateStatusError = "<b>Failed to Update Status to \"" + newStatusName + "\" on <i>PCsCRM</i></b><br/><br/>Update Status Result: <b>" + (updateStatusResult.equals("") ? "N/A" : updateStatusResult) + "</b><br/><br/>Retrieved Status: <b>" + retrievedStatus + "</b>";
                    sendErrorEmail(updateStatusError);
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + updateStatusError + "</html>", "QA Helper  —  Update Status Error", JOptionPane.ERROR_MESSAGE);
                }
            } catch (Exception updateStatusException) {
                if (isTestMode) {
                    System.out.println("updateStatusException: " + updateStatusException);
                }

                loadingWindow.closeWindow();
                playAlertSound("error");
                String updateStatusError = "Failed to Update Status to \"" + newStatusName + "\"";
                sendErrorEmail(updateStatusError + "\n\nupdateStatusException: " + updateStatusException);
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>" + updateStatusError + "</b></html>", "QA Helper  —  Update Status Error", JOptionPane.ERROR_MESSAGE);
            }
        } else {
            playAlertSound("beep");
        }

        return null;
    }

    private void installOptionalApp(String appName) {
        installOptionalApps(new String[]{appName});
    }

    private void installOptionalApps(String[] appNames) {
        if (actionsEnabled && ((isLinux && !isLinuxLiveBoot) || (isWindows && !isWindowsPE))) {
            setActionsEnabled(false);

            boolean aptIsRunning = false;

            if (isLinux) {
                String[] aptProcesses = new CommandReader(new String[]{"/usr/bin/pgrep", "-fa", "(apt|mintUpdate)"}).getOutputLines();
                for (String thisAptProcess : aptProcesses) {
                    if (thisAptProcess.contains("apt-get") || thisAptProcess.contains("/bin/apt") || thisAptProcess.contains("/apt/methods/") || (thisAptProcess.contains("/mintUpdate/") && !thisAptProcess.endsWith("/mintUpdate/mintUpdate.py"))) {
                        aptIsRunning = true;
                        break;
                    }
                }
            }

            if (aptIsRunning) {
                playAlertSound("beep");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Another installation process (such as \"apt\" or \"mintUpdate\") is currently running. <i>This process may be running in the background.</i></b><br/><br/><i>This other installation process could interrupt installating apps or installating apps may interrupt the other installation process.</i><br/><br/>Try again after the other installation process has finished.</html>", "QA Helper  —  App Install Warning", JOptionPane.WARNING_MESSAGE);
            } else {
                List<String> matchedAppNames = new ArrayList<>();

                String installCommands = "";

                for (String thisAppName : appNames) {
                    switch (thisAppName) {
                        case "Google Chrome":
                            matchedAppNames.add(thisAppName);

                            if (isLinux) {
                                installCommands += "if [ -z \"$(/usr/bin/apt-cache policy google-chrome-stable)\" ]; then echo \"\n\nDOWNLOADING GOOGLE CHROME INSTALLER:\n\" && /usr/bin/curl --connect-timeout 5 --progress-bar -fL https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb -o /tmp/qa_helper-google_chrome.deb; fi && echo \"\n\nINSTALLING GOOGLE CHROME:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y $([ -f /tmp/qa_helper-google_chrome.deb ] && echo /tmp/qa_helper-google_chrome.deb || echo google-chrome-stable) && /bin/rm -f /tmp/qa_helper-google_chrome.deb && ";
                            } else if (isWindows) {
                                if (new File("\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Google Chrome.lnk").exists()) {
                                    installCommands += "Write-Host \\\"`n  Already Installed Google Chrome\\\" -ForegroundColor Yellow;";
                                } else {
                                    installCommands += "Write-Output \\\"`n  Downloading Google Chrome Installer...\\\"; Remove-Item \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; Invoke-WebRequest 'https://dl.google.com/chrome/install/chrome_installer.exe' -OutFile \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.exe\\\" -ErrorAction Stop; Write-Output '  Installing Google Chrome...'; $appInstallExitCode = (Start-Process \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.exe\\\" -NoNewWindow -Wait -PassThru -ArgumentList '/silent', '/install' -ErrorAction Stop).ExitCode; Remove-Item \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; if ($appInstallExitCode -ne 0) { throw \\\"Error Installing Google Chrome (Exit Code = $appInstallExitCode)\\\" } Write-Host '  Successfully Installed Google Chrome' -ForegroundColor Green; ";
                                    // NOTE: The EXE Chrome installer is MUCH FASTER to finish than the MSI. The EXE is a small initial download which then downloads more for the full installation when the EXE is run, and that isn't an issue since these installation require internet to begin with. 
                                    //installCommands += "Write-Output \\\"`n  Downloading Google Chrome Installer...\\\"; Remove-Item \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.msi\\\" -Force -ErrorAction SilentlyContinue; Invoke-WebRequest 'https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi' -OutFile \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.msi\\\" -ErrorAction Stop; Write-Output '  Installing Google Chrome...'; $appInstallExitCode = (Start-Process '\\Windows\\System32\\msiexec.exe' -NoNewWindow -Wait -PassThru -ArgumentList '/i', \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.msi\\\", '/qn' -ErrorAction Stop).ExitCode; Remove-Item \\\"$Env:TEMP\\QAHelper-GoogleChrome_Installer.msi\\\" -Force -ErrorAction SilentlyContinue; if ($appInstallExitCode -ne 0) { throw \\\"Error Installing Google Chrome (Exit Code = $appInstallExitCode)\\\" } Write-Host '  Successfully Installed Google Chrome' -ForegroundColor Green; ";
                                }
                            }

                            break;
                        case "Zoom":
                            matchedAppNames.add(thisAppName);

                            if (isLinux) {
                                installCommands += "if [ -z \"$(/usr/bin/apt-cache policy zoom)\" ]; then echo \"\n\nDOWNLOADING ZOOM INSTALLER:\n\" && /usr/bin/curl --connect-timeout 5 --progress-bar -fL https://zoom.us/client/latest/zoom_amd64.deb -o /tmp/qa_helper-zoom.deb; fi && echo \"\n\nINSTALLING ZOOM:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y $([ -f /tmp/qa_helper-zoom.deb ] && echo /tmp/qa_helper-zoom.deb || echo zoom) && /bin/rm -f /tmp/qa_helper-zoom.deb && ";
                            } else if (isWindows) {
                                if (new File("\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Zoom\\Zoom.lnk").exists()) {
                                    installCommands += "Write-Host \\\"`n  Already Installed Zoom\\\" -ForegroundColor Yellow;";
                                } else {
                                    installCommands += "Write-Output \\\"`n  Downloading Zoom Installer...\\\"; Remove-Item \\\"$Env:TEMP\\QAHelper-Zoom_Installer.msi\\\" -Force -ErrorAction SilentlyContinue; Invoke-WebRequest 'https://zoom.us/client/latest/ZoomInstallerFull.msi?archType=x64' -OutFile \\\"$Env:TEMP\\QAHelper-Zoom_Installer.msi\\\" -ErrorAction Stop; Write-Output '  Installing Zoom...'; $appInstallExitCode = (Start-Process '\\Windows\\System32\\msiexec.exe' -NoNewWindow -Wait -PassThru -ArgumentList '/i', \\\"$Env:TEMP\\QAHelper-Zoom_Installer.msi\\\", '/qn' -ErrorAction Stop).ExitCode; Remove-Item \\\"$Env:TEMP\\QAHelper-Zoom_Installer.msi\\\" -Force -ErrorAction SilentlyContinue; if ($appInstallExitCode -ne 0) { throw \\\"Error Installing Zoom (Exit Code = $appInstallExitCode)\\\" } Write-Host '  Successfully Installed Zoom' -ForegroundColor Green; ";
                                }
                            }

                            break;
                        case "Skype":
                            // Skype already pre-installed on Windows.

                            if (isLinux) {
                                matchedAppNames.add(thisAppName);
                                installCommands += "echo \"\n\nINSTALLING SKYPE:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y skypeforlinux && ";
                            }

                            break;
                        case "TeamViewer":
                            matchedAppNames.add(thisAppName);

                            if (isLinux) {
                                installCommands += "if [ -z \"$(/usr/bin/apt-cache policy teamviewer)\" ]; then echo \"\n\nDOWNLOADING TEAMVIEWER INSTALLER:\n\" && /usr/bin/curl --connect-timeout 5 --progress-bar -fL https://download.teamviewer.com/download/linux/teamviewer_amd64.deb -o /tmp/qa_helper-teamviewer.deb; fi && echo \"\n\nINSTALLING TEAMVIEWER:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y $([ -f /tmp/qa_helper-teamviewer.deb ] && echo /tmp/qa_helper-teamviewer.deb || echo teamviewer) && /bin/rm -f /tmp/qa_helper-teamviewer.deb && ";
                            } else if (isWindows) {
                                if (new File("\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\TeamViewer.lnk").exists()) {
                                    installCommands += "Write-Host \\\"`n  Already Installed TeamViewer\\\" -ForegroundColor Yellow;";
                                } else {
                                    installCommands += "Write-Output \\\"`n  Downloading TeamViewer Installer...\\\"; Remove-Item \\\"$Env:TEMP\\QAHelper-TeamViewer_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; Invoke-WebRequest 'https://download.teamviewer.com/download/TeamViewer_Setup_x64.exe' -OutFile \\\"$Env:TEMP\\QAHelper-TeamViewer_Installer.exe\\\" -ErrorAction Stop; Write-Output '  Installing TeamViewer...'; $appInstallExitCode = (Start-Process \\\"$Env:TEMP\\QAHelper-TeamViewer_Installer.exe\\\" -NoNewWindow -Wait -PassThru -ArgumentList '/S' -ErrorAction Stop).ExitCode; Remove-Item \\\"$Env:TEMP\\QAHelper-TeamViewer_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; if ($appInstallExitCode -ne 0) { throw \\\"Error Installing TeamViewer (Exit Code = $appInstallExitCode)\\\" } Write-Host '  Successfully Installed TeamViewer' -ForegroundColor Green; ";
                                }
                            }

                            break;
                        case "Dropbox":
                            matchedAppNames.add(thisAppName);

                            if (isLinux) {
                                installCommands += "echo \"\n\nINSTALLING DROPBOX:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y dropbox && ";
                            } else if (isWindows) {
                                if (new File("\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Dropbox\\Dropbox.lnk").exists()) {
                                    installCommands += "Write-Host \\\"`n  Already Installed Dropbox\\\" -ForegroundColor Yellow;";
                                } else {
                                    installCommands += "Write-Output \\\"`n  Downloading Dropbox Installer...\\\"; Remove-Item \\\"$Env:TEMP\\QAHelper-Dropbox_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; Invoke-WebRequest \\\"https://www.dropbox.com/download?full=1&os=win\\\" -OutFile \\\"$Env:TEMP\\QAHelper-Dropbox_Installer.exe\\\" -ErrorAction Stop; Write-Output '  Installing Dropbox...'; $appInstallExitCode = (Start-Process \\\"$Env:TEMP\\QAHelper-Dropbox_Installer.exe\\\" -NoNewWindow -Wait -PassThru -ArgumentList '/NOLAUNCH' -ErrorAction Stop).ExitCode; Remove-Item \\\"$Env:TEMP\\QAHelper-Dropbox_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; if ($appInstallExitCode -ne 0) { throw \\\"Error Installing Dropbox (Exit Code = $appInstallExitCode)\\\" } Write-Host '  Successfully Installed Dropbox' -ForegroundColor Green; ";
                                }
                            }

                            break;
                        case "Spotify":
                            // Spotify already pre-installed on Windows.

                            if (isLinux) {
                                matchedAppNames.add(thisAppName);
                                installCommands += "echo \"\n\nINSTALLING SPOTIFY:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y spotify-client && ";
                            }

                            break;
                        case "FBReader":
                            // DO NOT ALLOW INSTALLATION of FBReader on Windows because it only installs for the current user (which is "Administrator" in Audit Mode), so shortcuts on the Desktop and Start Menu would not be available for the customer after Sysprep.
                            // This can be worked around by moving the shortcuts to the global locations and setting their permissions for global access (setting permissions is require or the customer won't be able to launch the app with the shortcuts).
                            // But one quirk is that after moving the Desktop shortcut, explorer needs to be restarted to not display 2 shortcuts on the Administrator desktop which might confuse the technician before Sysprep.
                            // THE FINAL ISSUE that could not be worked around which caused us to decide to not pre-install FBReader on Windows is that
                            // if FBReader is uninstalled by the customer, the global shortcuts are not removed by the uninstaller since it is not aware of the shortcuts in the the global locations. This would just be sloppy and may confuse the customer.
                            // Here is the old FBReader installation code for Windows which was used while testing and discovering all of the issues stated above for historical purposes:
                            // installCommands += "Write-Output \\\"`n  Downloading FBReader Installer...\\\"; Remove-Item \\\"$Env:TEMP\\QAHelper-FBReader_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; Invoke-WebRequest 'https://fbreader.org/files/win32/FBReaderSetup-0.12.10.exe' -OutFile \\\"$Env:TEMP\\QAHelper-FBReader_Installer.exe\\\" -ErrorAction Stop; Write-Output '  Installing FBReader...'; $appInstallExitCode = (Start-Process \\\"$Env:TEMP\\QAHelper-FBReader_Installer.exe\\\" -NoNewWindow -Wait -PassThru -ArgumentList '/S' -ErrorAction Stop).ExitCode; Remove-Item \\\"$Env:TEMP\\QAHelper-FBReader_Installer.exe\\\" -Force -ErrorAction SilentlyContinue; if ($appInstallExitCode -ne 0) { throw \\\"Error Installing FBReader (Exit Code = $appInstallExitCode)\\\" } if (Test-Path '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\FBReader for Windows\\') { Remove-Item '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\FBReader for Windows\\' -Recurse -ErrorAction Stop } Move-Item \\\"$Env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\FBReader for Windows\\\" '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\' -Force -ErrorAction Stop; Set-Acl '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\FBReader for Windows' -AclObject (Get-Acl '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories' -ErrorAction Stop) -ErrorAction Stop; Set-Acl (Get-ChildItem '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\FBReader for Windows' -Recurse -ErrorAction Stop).FullName -AclObject (Get-Acl '\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Microsoft Edge.lnk' -ErrorAction Stop) -ErrorAction Stop; if (Test-Path '\\Users\\Public\\Desktop\\FBReader.lnk') { Remove-Item '\\Users\\Public\\Desktop\\FBReader.lnk' -ErrorAction Stop } Move-Item \\\"$([Environment]::GetFolderPath('Desktop'))\\FBReader.lnk\\\" '\\Users\\Public\\Desktop\\' -Force -ErrorAction Stop; Set-Acl '\\Users\\Public\\Desktop\\FBReader.lnk' -AclObject (Get-Acl '\\Users\\Public\\Desktop\\Microsoft Edge.lnk' -ErrorAction Stop) -ErrorAction Stop; Stop-Process -ProcessName 'explorer' -ErrorAction SilentlyContinue; Write-Host '  Successfully Installed FBReader' -ForegroundColor Green; ";

                            if (isLinux) {
                                matchedAppNames.add(thisAppName);
                                installCommands += "echo \"\n\nINSTALLING FBREADER:\n\" && /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y fbreader && ";
                            }

                            break;
                        default:
                            break;
                    }
                }

                if (!installCommands.isEmpty()) {
                    String joinedMatchedAppNames = String.join(", ", matchedAppNames);

                    try {
                        if (isLinux) {
                            String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");

                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Installing " + joinedMatchedAppNames + "' --hide-menubar --geometry '80x25+0+0' -x /bin/sh -c 'echo \"\nINSTALLING " + joinedMatchedAppNames + "...\"; " + installCommands + "echo \"\n\nFINISHED INSTALLING " + joinedMatchedAppNames + "\" || echo \"\n\n!!! ERROR DURING APP INSTALLATIONS - SOME APPS WERE NOT INSTALLED !!!\n\n>>> SEE ERROR MESSAGES ABOVE FOR MORE DETAILS <<<\"; echo \"\n\nPRESS ENTER TO CLOSE THIS WINDOW\"; read line; /usr/bin/wmctrl -a \"QA Helper\";'"});
                        } else if (isWindows) {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -WindowStyle Maximized -Command $Host.UI.RawUI.WindowTitle = 'QA Helper  —  Installing " + joinedMatchedAppNames + "'; Write-Output \\\"`n  Installing " + joinedMatchedAppNames + "...`n`n`n\\\"; try {" + installCommands + "Write-Output \\\"`n`n  Finished Installing " + joinedMatchedAppNames + "`n\\\" } catch { Write-Host \\\"`n`n  ERROR INSTALLING APP: $_\\\" -ForegroundColor Red; Write-Host \\\"`n`n  !!! ERROR DURING APP INSTALLATIONS - SOME APPS WERE NOT INSTALLED !!!`n`n  >>> SEE ERROR MESSAGES ABOVE FOR MORE DETAILS <<<`n\\\" -ForegroundColor Red } $Host.UI.RawUI.FlushInputBuffer(); Read-Host -Prompt '  PRESS ENTER TO CLOSE THIS WINDOW'"});
                        }

                        TimeUnit.SECONDS.sleep(1);

                        String terminalOrPowerShell = (isLinux ? "Terminal" : "PowerShell");

                        focusWindow();
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Started Installing " + joinedMatchedAppNames + " in " + terminalOrPowerShell + "</b><br/><br/><i>You can continue using QA Helper while " + joinedMatchedAppNames + " installs in " + terminalOrPowerShell + ".</i><br/><br/>When " + joinedMatchedAppNames + " is done installing, " + terminalOrPowerShell + " will stay open and you can press enter in the " + terminalOrPowerShell + " window to close it.</html>", "QA Helper  —  App Install", JOptionPane.INFORMATION_MESSAGE);
                    } catch (IOException | InterruptedException installOptionalAppException) {
                        if (isTestMode) {
                            System.out.println("installOptionalAppException: " + installOptionalAppException);
                        }
                        playAlertSound("error");
                    }
                } else {
                    playAlertSound("beep");
                }
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }

    private boolean runOemConfigPrepare() {
        if (new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine().equals("oem")) {
            if (!new File("/usr/sbin/oem-config-prepare").exists()) {
                getAdminPassword("Prepare for Shipping to End User (Run \"oem-config-prepare\")"); // Get password if needed.

                if (!adminPassword.equals("*UNKNOWN*")) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get install --no-install-recommends -qq oem-config-gtk"}).waitFor();
                    } catch (IOException | InterruptedException installOemConfigGtkException) {
                        if (isTestMode) {
                            System.out.println("installOemConfigGtkException: " + installOemConfigGtkException);
                        }
                    }

                    if (!new File("/usr/sbin/oem-config-prepare").exists() && !isLinuxUbiquityMode) {
                        try {
                            File waitForTerminalPIDtempFile = File.createTempFile("qa_helper-wait_for_terminal_pid", ".txt");
                            waitForTerminalPIDtempFile.deleteOnExit();

                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Installing \"oem-config-gtk\"' --hide-menubar --geometry '80x25+0+0' -x /bin/bash -c 'orig_temp_owner=$(/usr/bin/stat -c %U " + waitForTerminalPIDtempFile.getPath() + "); /bin/chown root " + waitForTerminalPIDtempFile.getPath() + "; echo $$ > " + waitForTerminalPIDtempFile.getPath() + "; /bin/chown ${orig_temp_owner} " + waitForTerminalPIDtempFile.getPath() + "; echo \"\nINSTALLING \\\"oem-config-gtk\\\"\n\n\"; /usr/local/bin/apt install --no-install-recommends -y oem-config-gtk; echo \"\n\nFINISHED INSTALLING \\\"oem-config-gtk\\\"\nTHIS TERMINAL WINDOW WILL CLOSE IN 5 SECONDS - OR PRESS ENTER TO CLOSE NOW\"; read -t 5; /usr/bin/wmctrl -a \"QA Helper\"'"});

                            String waitForTerminalPID = "";

                            for (int i = 0; i < 10; i++) {
                                if (waitForTerminalPIDtempFile.exists()) {
                                    try {
                                        List<String> waitForTerminalPIDtempFileLines = Files.readAllLines(Paths.get(waitForTerminalPIDtempFile.getPath()), StandardCharsets.UTF_8);

                                        if (!waitForTerminalPIDtempFileLines.isEmpty()) {
                                            waitForTerminalPID = waitForTerminalPIDtempFileLines.get(0);
                                            if (!waitForTerminalPID.isEmpty()) {
                                                break;
                                            }
                                        }
                                    } catch (IOException | IndexOutOfBoundsException getTerminalPIDException) {
                                        if (isTestMode) {
                                            System.out.println("getTerminalPIDException: " + getTerminalPIDException);
                                        }
                                    }
                                }

                                TimeUnit.MILLISECONDS.sleep(500);
                            }

                            if (waitForTerminalPIDtempFile.exists()) {
                                waitForTerminalPIDtempFile.delete();
                            }

                            if (!waitForTerminalPID.isEmpty()) {
                                while (!new CommandReader(new String[]{"/bin/ps", "-p", waitForTerminalPID, "-o", "pid="}).getFirstOutputLine().isEmpty()) {
                                    TimeUnit.MILLISECONDS.sleep(500);
                                }
                            }
                        } catch (IOException | InterruptedException installOemConfigGtkViaTerminalException) {
                            if (isTestMode) {
                                System.out.println("installOemConfigGtkViaTerminalException: " + installOemConfigGtkViaTerminalException);
                            }
                        }
                    }
                }
            }

            installUndoOemConfigPrepareScript();

            if (new File("/usr/sbin/oem-config-prepare").exists()) {
                String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");

                try {
                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/sbin/oem-config-prepare"});

                    for (int i = 0; i < 10; i++) {
                        TimeUnit.SECONDS.sleep(1);
                        if (new File("/lib/systemd/system/oem-config.target").exists()) {
                            break;
                        }
                    }

                    boolean didRunOemConfigPrepare = new File("/lib/systemd/system/oem-config.target").exists();

                    if (didRunOemConfigPrepare) {
                        TimeUnit.SECONDS.sleep(1);
                        writeToHelperLogFile("Ran oem-config-prepare");
                        logDebugSpecs("Ran oem-config-prepare");
                    } else {
                        playAlertSound("error");
                    }

                    return didRunOemConfigPrepare;
                } catch (IOException | InterruptedException runOemConfigPrepareException) {
                    if (isTestMode) {
                        System.out.println("runOemConfigPrepareException: " + runOemConfigPrepareException);
                    }
                }
            } else {
                playAlertSound("error");
            }
        }

        return false;
    }

    private void installUndoOemConfigPrepareScript() {
        if (isLinux && new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine().equals("oem") && new File("/home/oem/").exists() && !new File("/home/oem/undo-oem-config-prepare.sh").exists()) {
            try (InputStream undoOemConfigPrepareInputStream = this.getClass().getClassLoader().getResourceAsStream("Resources/undo-oem-config-prepare.sh")) {
                File undoOemConfigPrepareShFile = new File("/home/oem/undo-oem-config-prepare.sh");
                if (undoOemConfigPrepareShFile.createNewFile()) {
                    try (FileOutputStream undoOemConfigPrepareShOutputStream = new FileOutputStream(undoOemConfigPrepareShFile)) {
                        byte[] buf = new byte[1024];
                        int bytesRead;

                        while ((bytesRead = undoOemConfigPrepareInputStream.read(buf)) > 0) {
                            undoOemConfigPrepareShOutputStream.write(buf, 0, bytesRead);
                        }

                        undoOemConfigPrepareShFile.setExecutable(true);
                    } catch (Exception writeUndoOemConfigPrepareShException) {
                        if (isTestMode) {
                            System.out.println("writeUndoOemConfigPrepareShException: " + writeUndoOemConfigPrepareShException);
                        }
                    }
                } else if (isTestMode) {
                    System.out.println("createUndoOemConfigPrepareShFileError: Failed to create undo-oem-config-prepare.sh file.");
                }
            } catch (Exception readUndoOemConfigPrepareShException) {
                if (isTestMode) {
                    System.out.println("readUndoOemConfigPrepareShException: " + readUndoOemConfigPrepareShException);
                }
            }
        }
    }

    /**
     * This method is called from within the constructor to initialize the form. WARNING: Do NOT modify this code. The content of this method is always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        specValueRightClickMenu = new javax.swing.JPopupMenu();
        menCopySpecValue = new javax.swing.JMenuItem();
        menSearchSpecValue = new javax.swing.JMenuItem();
        contentScrollPane = new javax.swing.JScrollPane();
        contentPane = new javax.swing.JPanel();
        lblStatus = new javax.swing.JLabel();
        lblUsername = new javax.swing.JLabel();
        txtUsername = new javax.swing.JTextField();
        lblPassword = new javax.swing.JLabel();
        pswPassword = new javax.swing.JPasswordField();
        lblPID = new javax.swing.JLabel();
        txtPID = new javax.swing.JTextField();
        btnLogIn = new javax.swing.JButton();
        btnTestMode = new javax.swing.JButton();
        btnForgot = new javax.swing.JButton();
        btnCheckPID = new javax.swing.JButton();
        lblVersion = new javax.swing.JLabel();
        topSeparator = new javax.swing.JSeparator();
        lblModelLabel = new javax.swing.JLabel();
        lblModel = new javax.swing.JLabel();
        lblSerial = new javax.swing.JLabel();
        lblCPULabel = new javax.swing.JLabel();
        lblCPU = new javax.swing.JLabel();
        btnStressCPU = new javax.swing.JButton();
        btnVerifyCPU = new javax.swing.JButton();
        lblRAMLabel = new javax.swing.JLabel();
        lblRAM = new javax.swing.JLabel();
        lblBatteryCapacity = new javax.swing.JLabel();
        lblStorageLabel = new javax.swing.JLabel();
        lblStorage = new javax.swing.JLabel();
        btnDriveHealth = new javax.swing.JButton();
        btnVerifyDriveHealth = new javax.swing.JButton();
        lblDiscDriveLabel = new javax.swing.JLabel();
        lblDiscDrive = new javax.swing.JLabel();
        btnEjectDiscDrive = new javax.swing.JButton();
        btnVerifyDiscDrive = new javax.swing.JButton();
        lblWirelessLabel = new javax.swing.JLabel();
        lblWireless = new javax.swing.JLabel();
        btnTestInternet = new javax.swing.JButton();
        btnVerifyInternet = new javax.swing.JButton();
        lblScreenLabel = new javax.swing.JLabel();
        lblScreen = new javax.swing.JLabel();
        btnTestScreen = new javax.swing.JButton();
        btnVerifyScreen = new javax.swing.JButton();
        lblGPULabel = new javax.swing.JLabel();
        lblGPU = new javax.swing.JLabel();
        lblOS = new javax.swing.JLabel();
        lblAudioLabel = new javax.swing.JLabel();
        lblAudio = new javax.swing.JLabel();
        btnTestAudio = new javax.swing.JButton();
        btnVerifyAudio = new javax.swing.JButton();
        middleSeparator1 = new javax.swing.JSeparator();
        lblMoreTests = new javax.swing.JLabel();
        btnTestMicrophone = new javax.swing.JButton();
        btnVerifyMicrophone = new javax.swing.JButton();
        btnTestCamera = new javax.swing.JButton();
        btnVerifyCamera = new javax.swing.JButton();
        btnTestKeyboard = new javax.swing.JButton();
        btnVerifyKeyboard = new javax.swing.JButton();
        btnTestMouse = new javax.swing.JButton();
        btnVerifyMouse = new javax.swing.JButton();
        middleSeparator2 = new javax.swing.JSeparator();
        lblTasks = new javax.swing.JLabel();
        btnSetupBIOS = new javax.swing.JButton();
        btnVerifyBIOS = new javax.swing.JButton();
        btnCheckPorts = new javax.swing.JButton();
        btnVerifyPorts = new javax.swing.JButton();
        btnCheckDrivers = new javax.swing.JButton();
        btnVerifyDrivers = new javax.swing.JButton();
        btnSystemUpdates = new javax.swing.JButton();
        btnVerifySystemUpdates = new javax.swing.JButton();
        btnCheckWindowsActivation = new javax.swing.JButton();
        btnVerifyWindowsActivation = new javax.swing.JButton();
        btnCheckRemoteManagement = new javax.swing.JButton();
        btnVerifyRemoteManagement = new javax.swing.JButton();
        bottomSeparator = new javax.swing.JSeparator();
        btnReloadSpecs = new javax.swing.JButton();
        btnSaveSpecs = new javax.swing.JButton();
        btnSystemInfo = new javax.swing.JButton();
        btnPIDHistory = new javax.swing.JButton();
        btnCredits = new javax.swing.JButton();
        lblTestModeT = new javax.swing.JLabel();
        lblTestModeE = new javax.swing.JLabel();
        lblTestModeS = new javax.swing.JLabel();
        lblTestModeT2 = new javax.swing.JLabel();
        lblTestModeM = new javax.swing.JLabel();
        lblTestModeO = new javax.swing.JLabel();
        lblTestModeD = new javax.swing.JLabel();
        lblTestModeE2 = new javax.swing.JLabel();
        btnDoneTesting = new javax.swing.JButton();
        mainMenubar = new javax.swing.JMenuBar();
        textSizeMenu = new javax.swing.JMenu();
        menResetTextSize = new javax.swing.JMenuItem();
        menIncreaseTextSize = new javax.swing.JMenuItem();
        menDecreaseTextSize = new javax.swing.JMenuItem();
        menMaxTextSizeForScreen = new javax.swing.JMenuItem();
        optionsMenu = new javax.swing.JMenu();
        menLogSpecs = new javax.swing.JMenuItem();
        menReopenRepair = new javax.swing.JMenuItem();
        menLogOut = new javax.swing.JMenuItem();
        testsMenu = new javax.swing.JMenu();
        menForceShowScreenKeyboardAndMouseTests = new javax.swing.JMenuItem();
        installAppsMenu = new javax.swing.JMenu();
        menInstallGoogleChrome = new javax.swing.JMenuItem();
        menInstallZoom = new javax.swing.JMenuItem();
        menInstallSkype = new javax.swing.JMenuItem();
        menInstallTeamViewer = new javax.swing.JMenuItem();
        menInstallDropbox = new javax.swing.JMenuItem();
        menInstallSpotify = new javax.swing.JMenuItem();
        menInstallFBReader = new javax.swing.JMenuItem();
        installAppsMenuSeparator = new javax.swing.JPopupMenu.Separator();
        menInstallAllApps = new javax.swing.JMenuItem();
        scriptsMenu = new javax.swing.JMenu();
        menReRunSetupWindowsScript = new javax.swing.JMenuItem();
        menRunCompleteWindowsScript = new javax.swing.JMenuItem();
        scriptsMenuSeparator = new javax.swing.JPopupMenu.Separator();
        menCacheDriversWindowsScript = new javax.swing.JMenuItem();
        utilitiesMenu = new javax.swing.JMenu();
        menOpenTerminalOrCommandPrompt = new javax.swing.JMenuItem();
        menOpenFileExplorerPE = new javax.swing.JMenuItem();
        menSetDvdDriveRegion = new javax.swing.JMenuItem();

        menCopySpecValue.setIcon(new TwemojiImage("Clipboard", qaHelperWindow).toImageIcon(16));
        menCopySpecValue.setText("Copy This Spec Value to Clipboard");
        menCopySpecValue.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menCopySpecValueActionPerformed(evt);
            }
        });
        specValueRightClickMenu.add(menCopySpecValue);

        menSearchSpecValue.setIcon(new TwemojiImage("MagnifyingGlassTiltedLeft", qaHelperWindow).toImageIcon(16));
        menSearchSpecValue.setText("Search This Spec Value on the Web");
        menSearchSpecValue.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menSearchSpecValueActionPerformed(evt);
            }
        });
        specValueRightClickMenu.add(menSearchSpecValue);

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("QA Helper");
        setIconImages(new TwemojiImage("AppIcon", this).toImageIconsForFrame());
        setLocationByPlatform(true);
        setName("mainFrame"); // NOI18N
        setResizable(false);
        addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentMoved(java.awt.event.ComponentEvent evt) {
                formComponentMoved(evt);
            }
        });

        contentScrollPane.setBorder(null);

        lblStatus.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblStatus.setText("<html><b style='font-size: larger'>ERROR</b></html>");

        lblUsername.setDisplayedMnemonic(KeyEvent.VK_U);
        lblUsername.setLabelFor(txtUsername);
        lblUsername.setText("Username:");

        txtUsername.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtUsernameActionPerformed(evt);
            }
        });

        lblPassword.setDisplayedMnemonic(KeyEvent.VK_W);
        lblPassword.setLabelFor(pswPassword);
        lblPassword.setText("Password:");

        pswPassword.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pswPasswordActionPerformed(evt);
            }
        });

        lblPID.setDisplayedMnemonic(KeyEvent.VK_P);
        lblPID.setLabelFor(txtPID);
        lblPID.setText("PID:");

        txtPID.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPIDActionPerformed(evt);
            }
        });
        txtPID.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtPIDKeyTyped(evt);
            }
        });

        btnLogIn.setMnemonic(KeyEvent.VK_L);
        btnLogIn.setText("Log In");
        btnLogIn.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnLogIn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLogInActionPerformed(evt);
            }
        });

        btnTestMode.setForeground(new java.awt.Color(0, 102, 204));
        btnTestMode.setMnemonic(KeyEvent.VK_M);
        btnTestMode.setText("Live Mode");
        btnTestMode.setBorder(null);
        btnTestMode.setBorderPainted(false);
        btnTestMode.setContentAreaFilled(false);
        btnTestMode.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        btnTestMode.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                btnTestModeFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                btnTestModeFocusLost(evt);
            }
        });
        btnTestMode.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestModeActionPerformed(evt);
            }
        });

        btnForgot.setForeground(new java.awt.Color(0, 102, 204));
        btnForgot.setMnemonic(KeyEvent.VK_F);
        btnForgot.setText("Forgot Password");
        btnForgot.setBorder(null);
        btnForgot.setBorderPainted(false);
        btnForgot.setContentAreaFilled(false);
        btnForgot.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                btnForgotFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                btnForgotFocusLost(evt);
            }
        });
        btnForgot.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnForgotActionPerformed(evt);
            }
        });

        btnCheckPID.setForeground(new java.awt.Color(0, 102, 204));
        btnCheckPID.setMnemonic(KeyEvent.VK_C);
        btnCheckPID.setText("Check PID");
        btnCheckPID.setBorder(null);
        btnCheckPID.setBorderPainted(false);
        btnCheckPID.setContentAreaFilled(false);
        btnCheckPID.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                btnCheckPIDFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                btnCheckPIDFocusLost(evt);
            }
        });
        btnCheckPID.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCheckPIDActionPerformed(evt);
            }
        });

        lblVersion.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblVersion.setText("<html><b>Version:</b> YYYY.MM.DD-R</html>");

        lblModelLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblModelLabel.setText("<html><b>Model:</b></html>");
        lblModelLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblModel.setText("ERROR");
        lblModel.setComponentPopupMenu(specValueRightClickMenu);

        lblSerial.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblSerial.setText("<html><b>Serial:</b> ERROR</html>");
        lblSerial.setComponentPopupMenu(specValueRightClickMenu);

        lblCPULabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblCPULabel.setText("<html><b>CPU:</b></html>");
        lblCPULabel.setToolTipText("");
        lblCPULabel.setComponentPopupMenu(specValueRightClickMenu);

        lblCPU.setText("ERROR");
        lblCPU.setComponentPopupMenu(specValueRightClickMenu);

        btnStressCPU.setText("Stress CPU");
        btnStressCPU.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnStressCPU.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnStressCPUActionPerformed(evt);
            }
        });

        btnVerifyCPU.setText("Verify");
        btnVerifyCPU.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyCPUActionPerformed(evt);
            }
        });

        lblRAMLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblRAMLabel.setText("<html><b>RAM:</b></html>");
        lblRAMLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblRAM.setText("ERROR");
        lblRAM.setComponentPopupMenu(specValueRightClickMenu);

        lblBatteryCapacity.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblBatteryCapacity.setText("<html><b>Battery:</b> ERROR</html>");
        lblBatteryCapacity.setComponentPopupMenu(specValueRightClickMenu);

        lblStorageLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblStorageLabel.setText("<html><b>Storage:</b></html>");
        lblStorageLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblStorage.setText("ERROR");
        lblStorage.setComponentPopupMenu(specValueRightClickMenu);

        btnDriveHealth.setMnemonic(KeyEvent.VK_D);
        btnDriveHealth.setText("Drive Health");
        btnDriveHealth.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnDriveHealth.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDriveHealthActionPerformed(evt);
            }
        });

        btnVerifyDriveHealth.setText("Verify");
        btnVerifyDriveHealth.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyDriveHealthActionPerformed(evt);
            }
        });

        lblDiscDriveLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblDiscDriveLabel.setText("<html><b>Disc Drive:</b></html>");
        lblDiscDriveLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblDiscDrive.setText("ERROR");
        lblDiscDrive.setComponentPopupMenu(specValueRightClickMenu);

        btnEjectDiscDrive.setText("Eject Disc Drive");
        btnEjectDiscDrive.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnEjectDiscDrive.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEjectDiscDriveActionPerformed(evt);
            }
        });

        btnVerifyDiscDrive.setText("Verify");
        btnVerifyDiscDrive.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyDiscDriveActionPerformed(evt);
            }
        });

        lblWirelessLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblWirelessLabel.setText("<html><b>Wireless:</b></html>");
        lblWirelessLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblWireless.setText("ERROR");
        lblWireless.setComponentPopupMenu(specValueRightClickMenu);

        btnTestInternet.setText("Test Internet");
        btnTestInternet.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestInternet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestInternetActionPerformed(evt);
            }
        });

        btnVerifyInternet.setText("Verify");
        btnVerifyInternet.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyInternetActionPerformed(evt);
            }
        });

        lblScreenLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblScreenLabel.setText("<html><b>Screen:</b></html>");
        lblScreenLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblScreen.setText("ERROR");
        lblScreen.setComponentPopupMenu(specValueRightClickMenu);

        btnTestScreen.setText("Test Screen");
        btnTestScreen.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestScreen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestScreenActionPerformed(evt);
            }
        });

        btnVerifyScreen.setText("Verify");
        btnVerifyScreen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyScreenActionPerformed(evt);
            }
        });

        lblGPULabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblGPULabel.setText("<html><b>GPU:</b></html>");
        lblGPULabel.setComponentPopupMenu(specValueRightClickMenu);

        lblGPU.setText("ERROR");
        lblGPU.setComponentPopupMenu(specValueRightClickMenu);

        lblOS.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblOS.setText("<html><b>OS:</b> ERROR</html>");
        lblOS.setComponentPopupMenu(specValueRightClickMenu);

        lblAudioLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblAudioLabel.setText("<html><b>Audio:</b></html>");
        lblAudioLabel.setComponentPopupMenu(specValueRightClickMenu);

        lblAudio.setText("ERROR");
        lblAudio.setComponentPopupMenu(specValueRightClickMenu);

        btnTestAudio.setText("Test Audio");
        btnTestAudio.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestAudio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestAudioActionPerformed(evt);
            }
        });

        btnVerifyAudio.setText("Verify");
        btnVerifyAudio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyAudioActionPerformed(evt);
            }
        });

        lblMoreTests.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblMoreTests.setText("<html><b>More Tests:</b></html>");

        btnTestMicrophone.setText("Test Microphone");
        btnTestMicrophone.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestMicrophone.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestMicrophoneActionPerformed(evt);
            }
        });

        btnVerifyMicrophone.setText("Verify");
        btnVerifyMicrophone.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyMicrophoneActionPerformed(evt);
            }
        });

        btnTestCamera.setText("Test Camera");
        btnTestCamera.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestCamera.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestCameraActionPerformed(evt);
            }
        });

        btnVerifyCamera.setText("Verify");
        btnVerifyCamera.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyCameraActionPerformed(evt);
            }
        });

        btnTestKeyboard.setText("Test Keyboard");
        btnTestKeyboard.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestKeyboard.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestKeyboardActionPerformed(evt);
            }
        });

        btnVerifyKeyboard.setText("Verify");
        btnVerifyKeyboard.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyKeyboardActionPerformed(evt);
            }
        });

        btnTestMouse.setText("Test Mouse");
        btnTestMouse.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnTestMouse.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTestMouseActionPerformed(evt);
            }
        });

        btnVerifyMouse.setText("Verify");
        btnVerifyMouse.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyMouseActionPerformed(evt);
            }
        });

        lblTasks.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblTasks.setText("<html><b>Tasks:</b></html>");

        btnSetupBIOS.setText("UEFI/BIOS Setup");
        btnSetupBIOS.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnSetupBIOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSetupBIOSActionPerformed(evt);
            }
        });

        btnVerifyBIOS.setText("Verify");
        btnVerifyBIOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyBIOSActionPerformed(evt);
            }
        });

        btnCheckPorts.setText("Check Ports");
        btnCheckPorts.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnCheckPorts.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCheckPortsActionPerformed(evt);
            }
        });

        btnVerifyPorts.setText("Verify");
        btnVerifyPorts.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyPortsActionPerformed(evt);
            }
        });

        btnCheckDrivers.setText("Check Drivers");
        btnCheckDrivers.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnCheckDrivers.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCheckDriversActionPerformed(evt);
            }
        });

        btnVerifyDrivers.setText("Verify");
        btnVerifyDrivers.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyDriversActionPerformed(evt);
            }
        });

        btnSystemUpdates.setText("System Updates");
        btnSystemUpdates.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnSystemUpdates.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSystemUpdatesActionPerformed(evt);
            }
        });

        btnVerifySystemUpdates.setText("Verify");
        btnVerifySystemUpdates.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifySystemUpdatesActionPerformed(evt);
            }
        });

        btnCheckWindowsActivation.setText("Check Windows Activation");
        btnCheckWindowsActivation.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnCheckWindowsActivation.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCheckWindowsActivationActionPerformed(evt);
            }
        });

        btnVerifyWindowsActivation.setText("Verify");
        btnVerifyWindowsActivation.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyWindowsActivationActionPerformed(evt);
            }
        });

        btnCheckRemoteManagement.setText("Check Remote Management");
        btnCheckRemoteManagement.setMargin(new java.awt.Insets(0, 8, 0, 8));
        btnCheckRemoteManagement.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCheckRemoteManagementActionPerformed(evt);
            }
        });

        btnVerifyRemoteManagement.setText("Verify");
        btnVerifyRemoteManagement.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerifyRemoteManagementActionPerformed(evt);
            }
        });

        btnReloadSpecs.setMnemonic(KeyEvent.VK_R);
        btnReloadSpecs.setText("Reload Specs");
        btnReloadSpecs.setMargin(new java.awt.Insets(0, 14, 0, 14));
        btnReloadSpecs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReloadSpecsActionPerformed(evt);
            }
        });

        btnSaveSpecs.setMnemonic(KeyEvent.VK_S);
        btnSaveSpecs.setText("Save Specs");
        btnSaveSpecs.setMargin(new java.awt.Insets(0, 14, 0, 14));
        btnSaveSpecs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSaveSpecsActionPerformed(evt);
            }
        });

        btnSystemInfo.setMnemonic(KeyEvent.VK_I);
        btnSystemInfo.setText("System Info");
        btnSystemInfo.setMargin(new java.awt.Insets(0, 14, 0, 14));
        btnSystemInfo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSystemInfoActionPerformed(evt);
            }
        });

        btnPIDHistory.setMnemonic(KeyEvent.VK_H);
        btnPIDHistory.setText("PID History");
        btnPIDHistory.setMargin(new java.awt.Insets(0, 14, 0, 14));
        btnPIDHistory.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPIDHistoryActionPerformed(evt);
            }
        });

        btnCredits.setText("Credits");
        btnCredits.setMargin(new java.awt.Insets(0, 14, 0, 14));
        btnCredits.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCreditsActionPerformed(evt);
            }
        });

        lblTestModeT.setBackground(new java.awt.Color(41, 47, 51));
        lblTestModeT.setForeground(new java.awt.Color(252, 203, 87));
        lblTestModeT.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeT.setText("<html><b style='font-size: larger'>&nbsp;T&nbsp;</b></html>");
        lblTestModeT.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeT.setOpaque(true);

        lblTestModeE.setBackground(new java.awt.Color(252, 203, 87));
        lblTestModeE.setForeground(new java.awt.Color(41, 47, 51));
        lblTestModeE.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeE.setText("<html><b style='font-size: larger'>&nbsp;E&nbsp;</b></html>");
        lblTestModeE.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeE.setOpaque(true);

        lblTestModeS.setBackground(new java.awt.Color(41, 47, 51));
        lblTestModeS.setForeground(new java.awt.Color(252, 203, 87));
        lblTestModeS.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeS.setText("<html><b style='font-size: larger'>&nbsp;S&nbsp;</b></html>");
        lblTestModeS.setToolTipText("");
        lblTestModeS.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeS.setOpaque(true);

        lblTestModeT2.setBackground(new java.awt.Color(252, 203, 87));
        lblTestModeT2.setForeground(new java.awt.Color(41, 47, 51));
        lblTestModeT2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeT2.setText("<html><b style='font-size: larger'>&nbsp;T&nbsp;</b></html>");
        lblTestModeT2.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeT2.setOpaque(true);

        lblTestModeM.setBackground(new java.awt.Color(41, 47, 51));
        lblTestModeM.setForeground(new java.awt.Color(252, 203, 87));
        lblTestModeM.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeM.setText("<html><b style='font-size: larger'>&nbsp;M&nbsp;</b></html>");
        lblTestModeM.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeM.setOpaque(true);

        lblTestModeO.setBackground(new java.awt.Color(252, 203, 87));
        lblTestModeO.setForeground(new java.awt.Color(41, 47, 51));
        lblTestModeO.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeO.setText("<html><b style='font-size: larger'>&nbsp;O&nbsp;</b></html>");
        lblTestModeO.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeO.setOpaque(true);

        lblTestModeD.setBackground(new java.awt.Color(41, 47, 51));
        lblTestModeD.setForeground(new java.awt.Color(252, 203, 87));
        lblTestModeD.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeD.setText("<html><b style='font-size: larger'>&nbsp;D&nbsp;</b></html>");
        lblTestModeD.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeD.setOpaque(true);

        lblTestModeE2.setBackground(new java.awt.Color(252, 203, 87));
        lblTestModeE2.setForeground(new java.awt.Color(41, 47, 51));
        lblTestModeE2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTestModeE2.setText("<html><b style='font-size: larger'>&nbsp;E&nbsp;</b></html>");
        lblTestModeE2.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lblTestModeE2.setOpaque(true);

        btnDoneTesting.setMnemonic(KeyEvent.VK_Q);
        btnDoneTesting.setText("Done Testing");
        btnDoneTesting.setMargin(new java.awt.Insets(3, 14, 3, 14));
        btnDoneTesting.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDoneTestingActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout contentPaneLayout = new javax.swing.GroupLayout(contentPane);
        contentPane.setLayout(contentPaneLayout);
        contentPaneLayout.setHorizontalGroup(
            contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(contentPaneLayout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(topSeparator)
                    .addComponent(middleSeparator1)
                    .addComponent(middleSeparator2)
                    .addComponent(bottomSeparator)
                    .addGroup(contentPaneLayout.createSequentialGroup()
                        .addGap(UIScale.scale(12), UIScale.scale(12), UIScale.scale(12))
                        .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblStatus)
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(contentPaneLayout.createSequentialGroup()
                                        .addComponent(lblUsername)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(txtUsername, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(UIScale.scale(18), UIScale.scale(18), UIScale.scale(18))
                                        .addComponent(lblPassword))
                                    .addComponent(btnTestMode))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(pswPassword, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(btnForgot))
                                .addGap(UIScale.scale(18), UIScale.scale(18), UIScale.scale(18))
                                .addComponent(lblPID)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(txtPID, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(btnCheckPID))
                                .addGap(UIScale.scale(18), UIScale.scale(18), Short.MAX_VALUE)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnLogIn)
                                    .addComponent(lblVersion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblModelLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblModel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(lblSerial, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblCPULabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblCPU, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(btnStressCPU)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnVerifyCPU))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblRAMLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblRAM, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(lblBatteryCapacity, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblStorageLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblStorage, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(btnDriveHealth)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnVerifyDriveHealth))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblDiscDriveLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblDiscDrive, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(btnEjectDiscDrive)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnVerifyDiscDrive))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblWirelessLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblWireless, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(btnTestInternet)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnVerifyInternet))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblScreenLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblScreen, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(btnTestScreen)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnVerifyScreen))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblGPULabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblGPU, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(lblOS, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblAudioLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lblAudio, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(btnTestAudio)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnVerifyAudio))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblTasks, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnSetupBIOS)
                                    .addComponent(btnVerifyBIOS))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnCheckPorts)
                                    .addComponent(btnVerifyPorts))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnCheckDrivers)
                                    .addComponent(btnVerifyDrivers))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnSystemUpdates)
                                    .addComponent(btnVerifySystemUpdates))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnCheckWindowsActivation)
                                    .addComponent(btnVerifyWindowsActivation))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnCheckRemoteManagement)
                                    .addComponent(btnVerifyRemoteManagement)))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(lblMoreTests, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnTestMicrophone)
                                    .addComponent(btnVerifyMicrophone))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnTestCamera)
                                    .addComponent(btnVerifyCamera))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnTestKeyboard)
                                    .addComponent(btnVerifyKeyboard))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btnTestMouse)
                                    .addComponent(btnVerifyMouse)))
                            .addGroup(contentPaneLayout.createSequentialGroup()
                                .addComponent(btnReloadSpecs)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnSaveSpecs)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnSystemInfo)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnPIDHistory)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnCredits)
                                .addGap(UIScale.scale(18), UIScale.scale(18), Short.MAX_VALUE)
                                .addComponent(lblTestModeT, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(lblTestModeE, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(lblTestModeS, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(lblTestModeT2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(lblTestModeM, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(lblTestModeO, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(lblTestModeD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(lblTestModeE2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(UIScale.scale(18), UIScale.scale(18), UIScale.scale(18))
                                .addComponent(btnDoneTesting)))
                        .addGap(UIScale.scale(12), UIScale.scale(12), UIScale.scale(12))))
                .addGap(0, 0, 0))
        );

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnCheckPID, btnForgot, pswPassword, txtPID, txtUsername});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnDriveHealth, btnEjectDiscDrive, btnStressCPU, btnTestAudio, btnTestInternet, btnTestScreen, btnVerifyAudio, btnVerifyCPU, btnVerifyDiscDrive, btnVerifyDriveHealth, btnVerifyInternet, btnVerifyScreen});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {lblTestModeD, lblTestModeE, lblTestModeE2, lblTestModeM, lblTestModeO, lblTestModeS, lblTestModeT, lblTestModeT2});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {lblAudioLabel, lblCPULabel, lblDiscDriveLabel, lblGPULabel, lblModelLabel, lblMoreTests, lblRAMLabel, lblScreenLabel, lblStorageLabel, lblTasks, lblWirelessLabel});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnTestMicrophone, btnVerifyMicrophone});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnTestCamera, btnVerifyCamera});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnTestKeyboard, btnVerifyKeyboard});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnTestMouse, btnVerifyMouse});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnSetupBIOS, btnVerifyBIOS});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnCheckPorts, btnVerifyPorts});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnCheckDrivers, btnVerifyDrivers});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnSystemUpdates, btnVerifySystemUpdates});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnCheckRemoteManagement, btnVerifyRemoteManagement});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnCheckWindowsActivation, btnVerifyWindowsActivation});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnLogIn, lblVersion});

        contentPaneLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {btnDoneTesting, btnReloadSpecs});

        contentPaneLayout.setVerticalGroup(
            contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(contentPaneLayout.createSequentialGroup()
                .addGap(UIScale.scale(12), UIScale.scale(12), UIScale.scale(12))
                .addComponent(lblStatus, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblUsername)
                    .addComponent(txtUsername, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPassword)
                    .addComponent(pswPassword, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPID)
                    .addComponent(txtPID, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnLogIn))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnTestMode)
                    .addComponent(btnForgot)
                    .addComponent(btnCheckPID)
                    .addComponent(lblVersion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(topSeparator, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblModelLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblModel)
                    .addComponent(lblSerial, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblCPULabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblCPU)
                    .addComponent(btnStressCPU)
                    .addComponent(btnVerifyCPU))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblRAMLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblRAM)
                    .addComponent(lblBatteryCapacity, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblStorageLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblStorage)
                    .addComponent(btnDriveHealth)
                    .addComponent(btnVerifyDriveHealth))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblDiscDriveLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblDiscDrive)
                    .addComponent(btnEjectDiscDrive)
                    .addComponent(btnVerifyDiscDrive))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblWirelessLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblWireless)
                    .addComponent(btnTestInternet)
                    .addComponent(btnVerifyInternet))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblScreenLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblScreen)
                    .addComponent(btnTestScreen)
                    .addComponent(btnVerifyScreen))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblGPULabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblGPU)
                    .addComponent(lblOS, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAudioLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblAudio)
                    .addComponent(btnTestAudio)
                    .addComponent(btnVerifyAudio))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(middleSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblMoreTests, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnTestMicrophone)
                    .addComponent(btnTestCamera)
                    .addComponent(btnTestKeyboard)
                    .addComponent(btnTestMouse))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnVerifyMicrophone)
                    .addComponent(btnVerifyCamera)
                    .addComponent(btnVerifyKeyboard)
                    .addComponent(btnVerifyMouse))
                .addGap(UIScale.scale(12), UIScale.scale(12), UIScale.scale(12))
                .addComponent(middleSeparator2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblTasks, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSetupBIOS)
                    .addComponent(btnCheckPorts)
                    .addComponent(btnCheckDrivers)
                    .addComponent(btnSystemUpdates)
                    .addComponent(btnCheckWindowsActivation)
                    .addComponent(btnCheckRemoteManagement))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnVerifyBIOS)
                    .addComponent(btnVerifyPorts)
                    .addComponent(btnVerifyDrivers)
                    .addComponent(btnVerifySystemUpdates)
                    .addComponent(btnVerifyRemoteManagement)
                    .addComponent(btnVerifyWindowsActivation))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(bottomSeparator, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(contentPaneLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnReloadSpecs)
                    .addComponent(btnSaveSpecs)
                    .addComponent(btnSystemInfo)
                    .addComponent(btnPIDHistory)
                    .addComponent(btnCredits)
                    .addComponent(lblTestModeT, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeE, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeS, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeT2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeM, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeO, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTestModeE2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnDoneTesting))
                .addGap(UIScale.scale(12), UIScale.scale(12), UIScale.scale(12)))
        );

        contentPaneLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {btnCheckDrivers, btnCheckPorts, btnCheckRemoteManagement, btnCheckWindowsActivation, btnCredits, btnDoneTesting, btnDriveHealth, btnEjectDiscDrive, btnLogIn, btnPIDHistory, btnReloadSpecs, btnSaveSpecs, btnSetupBIOS, btnStressCPU, btnSystemInfo, btnSystemUpdates, btnTestAudio, btnTestCamera, btnTestInternet, btnTestKeyboard, btnTestMicrophone, btnTestMouse, btnTestScreen, btnVerifyAudio, btnVerifyBIOS, btnVerifyCPU, btnVerifyCamera, btnVerifyDiscDrive, btnVerifyDriveHealth, btnVerifyDrivers, btnVerifyInternet, btnVerifyKeyboard, btnVerifyMicrophone, btnVerifyMouse, btnVerifyPorts, btnVerifyRemoteManagement, btnVerifyScreen, btnVerifySystemUpdates, btnVerifyWindowsActivation, lblAudio, lblAudioLabel, lblBatteryCapacity, lblCPU, lblCPULabel, lblDiscDrive, lblDiscDriveLabel, lblGPU, lblGPULabel, lblModel, lblModelLabel, lblMoreTests, lblOS, lblPID, lblPassword, lblRAM, lblRAMLabel, lblScreen, lblScreenLabel, lblSerial, lblStorage, lblStorageLabel, lblTasks, lblUsername, lblWireless, lblWirelessLabel, pswPassword, txtPID, txtUsername});

        contentScrollPane.setViewportView(contentPane);

        textSizeMenu.setText("Text Size");

        menResetTextSize.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_LEFT, java.awt.event.InputEvent.ALT_DOWN_MASK));
        menResetTextSize.setIcon(new TwemojiImage("LeftArrow", qaHelperWindow).toImageIcon(16));
        menResetTextSize.setText("Reset Text Size");
        menResetTextSize.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menResetTextSizeActionPerformed(evt);
            }
        });
        textSizeMenu.add(menResetTextSize);

        menIncreaseTextSize.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_UP, java.awt.event.InputEvent.ALT_DOWN_MASK));
        menIncreaseTextSize.setIcon(new TwemojiImage("UpArrow", qaHelperWindow).toImageIcon(16));
        menIncreaseTextSize.setText("Increase Text Size");
        menIncreaseTextSize.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menIncreaseTextSizeActionPerformed(evt);
            }
        });
        textSizeMenu.add(menIncreaseTextSize);

        menDecreaseTextSize.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_DOWN, java.awt.event.InputEvent.ALT_DOWN_MASK));
        menDecreaseTextSize.setIcon(new TwemojiImage("DownArrow", qaHelperWindow).toImageIcon(16));
        menDecreaseTextSize.setText("Decrease Text Size");
        menDecreaseTextSize.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menDecreaseTextSizeActionPerformed(evt);
            }
        });
        textSizeMenu.add(menDecreaseTextSize);

        menMaxTextSizeForScreen.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_RIGHT, java.awt.event.InputEvent.ALT_DOWN_MASK));
        menMaxTextSizeForScreen.setIcon(new TwemojiImage("UpDownArrow", qaHelperWindow).toImageIcon(16));
        menMaxTextSizeForScreen.setText("Max Text Size for Screen");
        menMaxTextSizeForScreen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menMaxTextSizeForScreenActionPerformed(evt);
            }
        });
        textSizeMenu.add(menMaxTextSizeForScreen);

        mainMenubar.add(textSizeMenu);

        optionsMenu.setText("Options");

        menLogSpecs.setIcon(new TwemojiImage("Memo", qaHelperWindow).toImageIcon(16));
        menLogSpecs.setText("Log Computer Specs Without Updating Status");
        menLogSpecs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menLogSpecsActionPerformed(evt);
            }
        });
        optionsMenu.add(menLogSpecs);

        menReopenRepair.setIcon(new TwemojiImage("HammerAndWrench", qaHelperWindow).toImageIcon(16));
        menReopenRepair.setText("Set Status Back to \"" + privateStrings.getPCsCRMStatusNames()[3] + "\" (Reopen Repair)");
        menReopenRepair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menReopenRepairActionPerformed(evt);
            }
        });
        optionsMenu.add(menReopenRepair);

        menLogOut.setIcon(new TwemojiImage("Locked", qaHelperWindow).toImageIcon(16));
        menLogOut.setText("Log Out");
        menLogOut.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menLogOutActionPerformed(evt);
            }
        });
        optionsMenu.add(menLogOut);

        mainMenubar.add(optionsMenu);

        testsMenu.setText("Tests");

        menForceShowScreenKeyboardAndMouseTests.setIcon(new TwemojiImage("Laptop", qaHelperWindow).toImageIcon(16));
        menForceShowScreenKeyboardAndMouseTests.setText("Force Show Screen, Keyboard, and Mouse Tests");
        menForceShowScreenKeyboardAndMouseTests.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menForceShowScreenKeyboardAndMouseTestsActionPerformed(evt);
            }
        });
        testsMenu.add(menForceShowScreenKeyboardAndMouseTests);

        mainMenubar.add(testsMenu);

        installAppsMenu.setText("Install Apps");

        menInstallGoogleChrome.setText("Install Google Chrome");
        menInstallGoogleChrome.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallGoogleChromeActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallGoogleChrome);

        menInstallZoom.setText("Install Zoom");
        menInstallZoom.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallZoomActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallZoom);

        menInstallSkype.setText("Install Skype");
        menInstallSkype.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallSkypeActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallSkype);

        menInstallTeamViewer.setText("Install TeamViewer");
        menInstallTeamViewer.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallTeamViewerActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallTeamViewer);

        menInstallDropbox.setText("Install Dropbox");
        menInstallDropbox.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallDropboxActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallDropbox);

        menInstallSpotify.setText("Install Spotify");
        menInstallSpotify.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallSpotifyActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallSpotify);

        menInstallFBReader.setText("Install FBReader");
        menInstallFBReader.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallFBReaderActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallFBReader);
        installAppsMenu.add(installAppsMenuSeparator);

        menInstallAllApps.setIcon(new TwemojiImage("IndexPointingUp", qaHelperWindow).toImageIcon(16));
        menInstallAllApps.setText("Install ALL OF THE ABOVE Apps");
        menInstallAllApps.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menInstallAllAppsActionPerformed(evt);
            }
        });
        installAppsMenu.add(menInstallAllApps);

        mainMenubar.add(installAppsMenu);

        scriptsMenu.setText("Scripts");

        menReRunSetupWindowsScript.setIcon(new TwemojiImage("RepeatButton", qaHelperWindow).toImageIcon(16));
        menReRunSetupWindowsScript.setText("Re-Run \"Setup Windows\" Script");
        menReRunSetupWindowsScript.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menReRunSetupWindowsScriptActionPerformed(evt);
            }
        });
        scriptsMenu.add(menReRunSetupWindowsScript);

        menRunCompleteWindowsScript.setIcon(new TwemojiImage("CheckMarkButton", qaHelperWindow).toImageIcon(16));
        menRunCompleteWindowsScript.setText("Run \"Complete Windows\" Script & Shut Down");
        menRunCompleteWindowsScript.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menRunCompleteWindowsScriptActionPerformed(evt);
            }
        });
        scriptsMenu.add(menRunCompleteWindowsScript);
        scriptsMenu.add(scriptsMenuSeparator);

        menCacheDriversWindowsScript.setIcon(new TwemojiImage("Toolbox", qaHelperWindow).toImageIcon(16));
        menCacheDriversWindowsScript.setText("Manually Cache Drivers (Without Running \"Complete Windows\" Script)");
        menCacheDriversWindowsScript.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menCacheDriversWindowsScriptActionPerformed(evt);
            }
        });
        scriptsMenu.add(menCacheDriversWindowsScript);

        mainMenubar.add(scriptsMenu);

        utilitiesMenu.setText("Utilities");

        menOpenTerminalOrCommandPrompt.setIcon(new TwemojiImage("ControlKnobs", qaHelperWindow).toImageIcon(16));
        menOpenTerminalOrCommandPrompt.setText("Open Terminal / Command Prompt");
        menOpenTerminalOrCommandPrompt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menOpenTerminalOrCommandPromptActionPerformed(evt);
            }
        });
        utilitiesMenu.add(menOpenTerminalOrCommandPrompt);

        menOpenFileExplorerPE.setIcon(new TwemojiImage("MagnifyingGlassTiltedLeft", qaHelperWindow).toImageIcon(16));
        menOpenFileExplorerPE.setText("Open File Explorer (PE)");
        menOpenFileExplorerPE.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menOpenFileExplorerPEActionPerformed(evt);
            }
        });
        utilitiesMenu.add(menOpenFileExplorerPE);

        menSetDvdDriveRegion.setIcon(new TwemojiImage("DVD", qaHelperWindow).toImageIcon(16));
        menSetDvdDriveRegion.setText("Set DVD Drive Region");
        menSetDvdDriveRegion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menSetDvdDriveRegionActionPerformed(evt);
            }
        });
        utilitiesMenu.add(menSetDvdDriveRegion);

        mainMenubar.add(utilitiesMenu);

        setJMenuBar(mainMenubar);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(contentScrollPane, javax.swing.GroupLayout.Alignment.TRAILING)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(contentScrollPane))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void formComponentMoved(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_formComponentMoved
        if (isVisible() && ignoreWindowMovesUntilTime <= System.currentTimeMillis())
            windowMoved = true;
    }//GEN-LAST:event_formComponentMoved

    private void menLogSpecsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menLogSpecsActionPerformed
        if (actionsEnabled && isLoggedIn && !isReloading) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to log the current specs for PID \"" + pid + "\" without updating the status?</b></html>", "QA Helper  —  Confirm Log Specs", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("Memo", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
                setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);

                loadingWindow.setLoadingTextAndDisplay("QA Helper is Logging Current Computer Specs", "Working", "Memo");

                (new SwingWorker<String, Void>() {
                    @Override
                    protected String doInBackground() throws Exception {
                        return logComputerSpecs() ? "success" : "failed";
                    }

                    @Override
                    protected void done() {
                        try {
                            String returnValue = get();

                            if (returnValue.equals("success")) {
                                loadingWindow.closeWindow();
                                playAlertSound("success");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Successfully Logged Current Computer Specs</b></html>", "QA Helper  —  Successfully Logged Specs", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Memo", qaHelperWindow).toImageIcon(32));
                            } else if (returnValue.equals("failed")) {
                                loadingWindow.closeWindow();
                                playAlertSound("error");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Log Current Computer Specs</b></html>", "QA Helper  —  Log Specs Error", JOptionPane.ERROR_MESSAGE);
                            }
                        } catch (HeadlessException | InterruptedException | ExecutionException logSpecsException) {
                            if (isTestMode) {
                                System.out.println("logSpecsException: " + logSpecsException);
                            }
                        }

                        loadingWindow.closeWindow();

                        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                        loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                        setActionsEnabled(true);
                    }
                }).execute();
            } else {
                setActionsEnabled(true);
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menLogSpecsActionPerformed

    private void menReopenRepairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menReopenRepairActionPerformed
        if (actionsEnabled && isLoggedIn) {
            String currentStatus = getHistory(false)[0];

            String[] statusNames = privateStrings.getPCsCRMStatusNames();
            if (!currentStatus.equals(statusNames[3]) && !currentStatus.equals("UNKNOWN STATUS")) {
                setActionsEnabled(false);

                if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to set the status for PID \"" + pid + "\" back to <u>" + statusNames[3] + "</u>?</b></html>", "QA Helper  —  Confirm Reopen Repair", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("HammerAndWrench", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                    loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
                    setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);

                    loadingWindow.setLoadingTextAndDisplay("QA Helper is Reopening Repair", "Working", "HammerAndWrench");

                    (new SwingWorker<String[], Void>() {
                        @Override
                        protected String[] doInBackground() throws Exception {
                            return updateStatus(statusNames[3], currentStatus);
                        }

                        @Override
                        protected void done() {
                            setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                            loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

                            try {
                                String[] currentStatusAndTech = get();
                                displayComputerSpecs(currentStatusAndTech);
                            } catch (InterruptedException | ExecutionException reOpenRepairException) {
                                if (isTestMode) {
                                    System.out.println("reOpenRepairException: " + reOpenRepairException);
                                }
                            }

                            if (!isReloading) {
                                loadingWindow.closeWindow();
                                setActionsEnabled(true);
                            }
                        }
                    }).execute();
                } else {
                    setActionsEnabled(true);
                }
            } else {
                playAlertSound("beep");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menReopenRepairActionPerformed

    private void menLogOutActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menLogOutActionPerformed
        if (actionsEnabled && isLoggedIn) {
            setActionsEnabled(false);

            if (historyWindow != null && historyWindow.isVisible()) {
                historyWindow.dispose();
            }

            pswPassword.setText("");
            isLoggedIn = false;

            getRootPane().setDefaultButton(null);

            reload(false); // Will setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menLogOutActionPerformed

    private void menInstallGoogleChromeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallGoogleChromeActionPerformed
        if (actionsEnabled && ((isLinux && !isLinuxLiveBoot) || (isWindows && !isWindowsPE))) {
            installOptionalApp("Google Chrome");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallGoogleChromeActionPerformed

    private void menInstallZoomActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallZoomActionPerformed
        if (actionsEnabled && ((isLinux && !isLinuxLiveBoot) || (isWindows && !isWindowsPE))) {
            installOptionalApp("Zoom");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallZoomActionPerformed

    private void menInstallSkypeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallSkypeActionPerformed
        if (actionsEnabled && (isLinux && !isLinuxLiveBoot)) {
            installOptionalApp("Skype");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallSkypeActionPerformed

    private void menInstallTeamViewerActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallTeamViewerActionPerformed
        if (actionsEnabled && ((isLinux && !isLinuxLiveBoot) || (isWindows && !isWindowsPE))) {
            installOptionalApp("TeamViewer");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallTeamViewerActionPerformed

    private void menInstallDropboxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallDropboxActionPerformed
        if (actionsEnabled && ((isLinux && !isLinuxLiveBoot) || (isWindows && !isWindowsPE))) {
            installOptionalApp("Dropbox");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallDropboxActionPerformed

    private void menInstallSpotifyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallSpotifyActionPerformed
        if (actionsEnabled && (isLinux && !isLinuxLiveBoot)) {
            installOptionalApp("Spotify");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallSpotifyActionPerformed

    private void menInstallFBReaderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallFBReaderActionPerformed
        if (actionsEnabled && (isLinux && !isLinuxLiveBoot)) {
            installOptionalApp("FBReader");
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallFBReaderActionPerformed

    private void menInstallAllAppsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menInstallAllAppsActionPerformed
        if (actionsEnabled && isLinux && !isLinuxLiveBoot) {
            installOptionalApps(new String[]{"Google Chrome", "Zoom", "Skype", "TeamViewer", "Dropbox", "Spotify", "FBReader"});
        } else if (actionsEnabled && isWindows && !isWindowsPE) {
            installOptionalApps(new String[]{"Google Chrome", "Zoom", "TeamViewer", "Dropbox"});
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menInstallAllAppsActionPerformed

    private void menSetDvdDriveRegionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menSetDvdDriveRegionActionPerformed
        if (actionsEnabled && isLinux && !isLinuxLiveBoot) {
            setActionsEnabled(false);

            String[] aptProcesses = new CommandReader(new String[]{"/usr/bin/pgrep", "-fa", "(apt|mintUpdate)"}).getOutputLines();
            boolean aptIsRunning = false;
            for (String thisAptProcess : aptProcesses) {
                if (thisAptProcess.contains("apt-get") || thisAptProcess.contains("/bin/apt") || thisAptProcess.contains("/apt/methods/") || (thisAptProcess.contains("/mintUpdate/") && !thisAptProcess.endsWith("/mintUpdate/mintUpdate.py"))) {
                    aptIsRunning = true;
                    break;
                }
            }

            if (aptIsRunning) {
                playAlertSound("beep");

                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Another installation process (such as \"apt\" or \"mintUpdate\") is currently running. <i>This process may be running in the background.</i></b><br/><br/><i>This other installation process could interrupt installating <i>RegionSet</i> or installating <i>RegionSet</i> may interrupt the other installation process.</i><br/><br/>Try again after the other installation process has finished.</html>", "QA Helper  —  Set DVD Drive Region Warning", JOptionPane.WARNING_MESSAGE);
            } else {
                try {
                    String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");

                    String setDriveRegionCommands = "";
                    ArrayList<String> discDriveLogicalNames = computerSpecs.getDiscDriveLogicalNames();
                    setDriveRegionCommands = discDriveLogicalNames.stream().map((thisDiscDriveLogicalName) -> "/usr/sbin/regionset " + thisDiscDriveLogicalName + "; ").reduce(setDriveRegionCommands, String::concat);

                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Set DVD Drive Region' --hide-menubar --geometry '80x25+0+0' -x /bin/sh -c 'echo \"\nSETTING DVD DRIVE REGION\n\n\"; /usr/bin/sudo /bin/rm -rf ~/.dvdcss/; /usr/bin/sudo /usr/local/bin/apt install --no-install-recommends -y regionset; echo \"\n\"; " + setDriveRegionCommands + "echo \"\n\nFINISHED SETTING DVD DRIVE REGION\n\nPRESS ENTER TO CLOSE THIS WINDOW\"; read line; /usr/bin/wmctrl -a \"QA Helper\";'"});

                    TimeUnit.SECONDS.sleep(1);

                    focusWindow();
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Started DVD Drive Region Set in a Terminal</b><br/><br/><i>You can continue using QA Helper while setting the DVD drive region in the Terminal.</i><br/><br/>When you are done setting the DVD drive region in the Terminal, you can press enter in the Terminal window to close it.</html>", "QA Helper  —  Set DVD Drive Region", JOptionPane.INFORMATION_MESSAGE);
                } catch (IOException | InterruptedException setDvdDriveRegionException) {
                    if (isTestMode) {
                        System.out.println("setDvdDriveRegionException: " + setDvdDriveRegionException);
                    }
                    playAlertSound("error");
                }
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menSetDvdDriveRegionActionPerformed

    private void menOpenTerminalOrCommandPromptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menOpenTerminalOrCommandPromptActionPerformed
        if (actionsEnabled && isLinux && isLinuxUbiquityMode && new File("/cdrom/preseed/dependencies/xterm").exists()) {
            try {
                Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "LD_LIBRARY_PATH=/cdrom/preseed/dependencies/ /cdrom/preseed/dependencies/xterm -geometry 80x25+0+0 -sb -sl 999999 -e 'echo \"USE ME FOR DEBUGGING\n\n\"; /bin/bash'"});
            } catch (IOException openXTermException) {
                if (isTestMode) {
                    System.out.println("openXTermException: " + openXTermException);
                }
                playAlertSound("error");
            }
        } else if (actionsEnabled && isWindows && isWindowsPE) {
            try {
                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START \\Windows\\System32\\cmd.exe"});

                if (isWindowsPE) {
                    setState(Frame.ICONIFIED);
                }
            } catch (IOException openCommandPromptException) {
                if (isTestMode) {
                    System.out.println("openCommandPromptException: " + openCommandPromptException);
                }
                playAlertSound("error");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menOpenTerminalOrCommandPromptActionPerformed

    private void txtUsernameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtUsernameActionPerformed
        txtPIDActionPerformed(evt);
    }//GEN-LAST:event_txtUsernameActionPerformed

    private void pswPasswordActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pswPasswordActionPerformed
        txtPIDActionPerformed(evt);
    }//GEN-LAST:event_pswPasswordActionPerformed

    private void txtPIDKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPIDKeyTyped
        String typedKeyString = String.valueOf(evt.getKeyChar());

        if (typedKeyString.equals("-")) {
            pidDashKeyTypedMillis = System.currentTimeMillis();
        } else if (pidDashKeyTypedMillis > 0 && typedKeyString.matches("[0-9]")) {
            pidLastDigitAfterDashKeyTypedMillis = System.currentTimeMillis();

            long millisBetweenDigitsAroundDash = (pidLastDigitAfterDashKeyTypedMillis - pidDashKeyTypedMillis);
            if (millisBetweenDigitsAroundDash <= 150) {
                lastPIDscannedOrConfirmed = txtPID.getText().trim().toUpperCase() + typedKeyString;
            }
        }
    }//GEN-LAST:event_txtPIDKeyTyped

    private void txtPIDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPIDActionPerformed
        if (actionsEnabled && !isLoggedIn && !txtUsername.getText().trim().isEmpty() && pswPassword.getPassword().length > 0 && !txtPID.getText().trim().isEmpty())
            btnLogInActionPerformed(evt);
        else {
            playAlertSound("beep");
            focusNextTestTaskVerifyButton(btnLogIn);
        }
    }//GEN-LAST:event_txtPIDActionPerformed

    private void btnLogInActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLogInActionPerformed
        if (actionsEnabled && !isLoggedIn && !txtUsername.getText().trim().isEmpty() && pswPassword.getPassword().length > 0 && !txtPID.getText().trim().isEmpty()) {
            setActionsEnabled(false);

            String currentPID = txtPID.getText().trim().toUpperCase();
            if (isTestMode) {
                lastPIDscannedOrConfirmed = currentPID; // Do not confirm PIDs in Test Mode for convenience.
            }
            if (!lastPIDscannedOrConfirmed.equals(currentPID)) {
                txtPID.setText("CONFIRM PID");

                JTextField pidConfirmationField = new JTextField();
                pidConfirmationField.putClientProperty("JTextField.showClearButton", true);
                pidConfirmationField.setTransferHandler(null); // Disable pasting into field.
                Object[] pidConfirmationFields = new Object[]{
                    "<html><b>Since you've typed in the PID instead of using a barcode scanner,<br/>please double-check and confirm that you've entered the correct PID:</b></html>",
                    pidConfirmationField,
                    "<html><br/><center>"
                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>READ OR SCAN THE PID FROM THE <u>STICKER ON THE COMPUTER</u></i> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                    + "<br/>"
                    + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <b>DO NOT READ THE PID FROM THE HAND WRITTEN LABEL</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                    + "</center></html>"
                };

                JOptionPane pidConfirmationPane = new JOptionPane(pidConfirmationFields, JOptionPane.WARNING_MESSAGE, JOptionPane.OK_CANCEL_OPTION, new TwemojiImage("Eyes", qaHelperWindow).toImageIcon(32)) {
                    @Override
                    public void selectInitialValue() {
                        pidConfirmationField.requestFocusInWindow();
                    }
                };

                pidConfirmationPane.createDialog(qaHelperWindow, "QA Helper  —  Confirm PID").setVisible(true);

                if (pidConfirmationPane.getValue() != null && (int) pidConfirmationPane.getValue() == JOptionPane.OK_OPTION && !pidConfirmationField.getText().trim().isEmpty()) {
                    if (!pidConfirmationField.getText().trim().toUpperCase().equals(currentPID)) {
                        txtPID.setText("");
                        playAlertSound("error");
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>PIDs Did Not Match</b><br/><br/>Please enter the correct PID before attempting to log in again.<br/><br/>"
                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>MAKE SURE THE CORRECT PID IS ON THE HANDWRITTEN LABEL</i> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                                + "</html>", "QA Helper  —  PID Error", JOptionPane.ERROR_MESSAGE);
                    } else {
                        lastPIDscannedOrConfirmed = currentPID;
                        txtPID.setText(currentPID);
                    }
                } else {
                    txtPID.setText(currentPID);
                }
            }

            if (lastPIDscannedOrConfirmed.equals(currentPID)) {
                // Don't allow close on login because status might get updated.
                loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
                setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);

                loadingWindow.setLoadingTextAndDisplay("QA Helper is Logging In", "Working", "Key");

                (new SwingWorker<String[], Void>() {
                    @Override
                    protected String[] doInBackground() throws Exception {
                        isLoggedIn = checkPID(false);

                        if (isLoggedIn) {
                            new LinuxAutoScripts("Login", adminPassword);

                            String[] statusAndTech = getHistory(false);
                            String currentStatus = statusAndTech[0];

                            logDebugSpecs("Login (" + currentStatus + ")");

                            String[] statusNames = privateStrings.getPCsCRMStatusNames();
                            if (currentStatus.equals(statusNames[14]) || currentStatus.equals(statusNames[0]) || currentStatus.equals(statusNames[18])) {
                                // Logs showed that some PCs for People system in Idaho and Kentucky start out as "statusNames[0]" and others in Minnesota (as well as Kentucky) starting out as "statusNames[18]"
                                // instead of "statusNames[14]" like our system does and the technicians have just been manually setting to "statusNames[3]" using the menu item
                                // before being able to normally proceed to "statusNames[12]", so also automatically set the status to "statusNames[3]" upon login when the status
                                // is either "statusNames[14]" or "statusNames[0]" or "statusNames[18]".
                                statusAndTech = updateStatus(statusNames[3], currentStatus);
                            } else if (!lastStatus.equals(currentStatus)) {
                                writeToHelperLogFile("Status: " + currentStatus);

                                new LinuxAutoScripts(currentStatus, adminPassword);

                                lastStatus = currentStatus;
                            }

                            return statusAndTech;
                        }

                        return null;
                    }

                    @Override
                    protected void done() {
                        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                        loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

                        if (isLoggedIn) {
                            try {
                                getRootPane().setDefaultButton(null);
                                String[] currentStatusAndTech = get();
                                displayComputerSpecs(currentStatusAndTech);
                            } catch (InterruptedException | ExecutionException loginException) {
                                if (isTestMode) {
                                    System.out.println("loginException: " + loginException);
                                }

                                isLoggedIn = false;
                            }
                        }

                        if (!isReloading) {
                            loadingWindow.closeWindow();
                            setActionsEnabled(true);
                            focusNextTestTaskVerifyButton(null);
                        }

                        if (!isLoggedIn) {
                            pswPassword.requestFocusInWindow();
                        }
                    }
                }).execute();
            } else {
                setActionsEnabled(true);
                txtPID.requestFocusInWindow();
            }
        } else {
            playAlertSound("beep");
            focusNextTestTaskVerifyButton(btnLogIn);
        }
    }//GEN-LAST:event_btnLogInActionPerformed

    private void btnTestModeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestModeActionPerformed
        if (actionsEnabled && !isLoggedIn) {
            setActionsEnabled(false);

            isTestMode = !isTestMode;

            boolean loginAndTasksWasHidden = hideLoginAndTasks;
            if (loginAndTasksWasHidden) {
                hideLoginAndTasks = false;
            }

            displayComputerSpecs();

            if (loginAndTasksWasHidden) {
                hideLoginAndTasks = true;
            }

            setActionsEnabled(true);
            focusNextTestTaskVerifyButton(btnLogIn);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestModeActionPerformed

    private void btnTestModeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_btnTestModeFocusGained
        JButton thisButton = (JButton) evt.getSource();
        Font defaultFont = (isTestMode ? UIManager.getFont("defaultFont").deriveFont(Font.BOLD) : UIManager.getFont("defaultFont"));
        HashMap<TextAttribute, Object> attributes = new HashMap<>(defaultFont.getAttributes());
        attributes.put(TextAttribute.UNDERLINE, TextAttribute.UNDERLINE_ON);
        thisButton.setFont(defaultFont.deriveFont(attributes));
    }//GEN-LAST:event_btnTestModeFocusGained

    private void btnTestModeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_btnTestModeFocusLost
        JButton thisButton = (JButton) evt.getSource();
        thisButton.setFont((isTestMode ? UIManager.getFont("defaultFont").deriveFont(Font.BOLD) : UIManager.getFont("defaultFont")));
    }//GEN-LAST:event_btnTestModeFocusLost

    private void btnForgotActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnForgotActionPerformed
        if (actionsEnabled && !isLoggedIn) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Would you like to go open \"pcscrm.com/login.aspx\" in your web browser?</b><br/><br/><i>You can use the \"Password help\" link on the PCsCRM.com login page to reset your password.</i></html>", "QA Helper  —  Forgot Password", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE) == JOptionPane.YES_OPTION) {
                String pcsCrmForgotPasswordURL = "https://" + (isTestMode ? "test." : "") + "pcscrm.com/login.aspx";
                String hiddenPCsCRMloginInputs = "";

                for (int i = 0; i < 5; i++) {
                    hiddenPCsCRMloginInputs = String.join("\n", new CommandReader((isWindows ? new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12, [Net.SecurityProtocolType]::Ssl3; (Invoke-WebRequest " + pcsCrmForgotPasswordURL + " -UseBasicParsing -TimeoutSec 5).Content"} : new String[]{"/usr/bin/curl", "-m", "5", "-sfL", pcsCrmForgotPasswordURL})).getOutputLinesContaining("<input type=\"hidden\"")); // TODO: Do in Java. Eventually.

                    if (!hiddenPCsCRMloginInputs.isEmpty()) {
                        if (hiddenPCsCRMloginInputs.contains("__EVENTTARGET")) {
                            // Using Invoke-WebRequest includes an empty __EVENTTARGET which overrides our wanted __EVENTTARGET
                            hiddenPCsCRMloginInputs = hiddenPCsCRMloginInputs.replace("<input type=\"hidden\" name=\"__EVENTTARGET\" id=\"__EVENTTARGET\" value=\"\" />", "");
                        }

                        break;
                    }
                }

                if (!hiddenPCsCRMloginInputs.isEmpty()) {
                    try {
                        File pcsCrmForgotPasswordTempFile = File.createTempFile("qa_helper-pcscrm_forgot_password", ".html");
                        pcsCrmForgotPasswordTempFile.deleteOnExit();

                        try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(pcsCrmForgotPasswordTempFile))) {
                            bufferedWriter.write("<!DOCTYPE html>"
                                    + "<html>"
                                    + "<head><title>New Login Page</title></head>"
                                    + "<body onload=\"javascript:document.getElementById('pcscrmForgotPassword').submit();\">"
                                    + "<form id=\"pcscrmForgotPassword\" action=\"https://" + (isTestMode ? "test." : "") + "pcscrm.com/login.aspx\" method=\"post\">"
                                    + "<input type=\"hidden\" name=\"__EVENTTARGET\" id=\"__EVENTTARGET\" value=\"lbForgotPassword\">"
                                    + hiddenPCsCRMloginInputs
                                    + "</form>"
                                    + "</body>"
                                    + "</html>");
                        } catch (Exception writePcsCrmForgotPasswordTempFileException) {
                            if (isTestMode) {
                                System.out.println("writePcsCrmForgotPasswordTempFileException: " + writePcsCrmForgotPasswordTempFileException);
                            }
                        }

                        pcsCrmForgotPasswordURL = pcsCrmForgotPasswordTempFile.toURI().toString();
                    } catch (IOException createPcsCrmForgotPasswordTempFileException) {
                        if (isTestMode) {
                            System.out.println("createPcsCrmForgotPasswordTempFileException: " + createPcsCrmForgotPasswordTempFileException);
                        }
                    }
                }

                if (isLinux) {
                    boolean didLaunchChrome = false;
                    if (new File("/usr/bin/google-chrome-stable").exists() && !isLinuxUbiquityMode) { // Do not try to launch Chrome and only use Firefox when in Ubiquity mode (even if it has been pre-installed) since Firefox is simpler to launch without the app showing prompts.
                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/google-chrome-stable", "--password-store=basic", "--start-maximized", "--incognito", pcsCrmForgotPasswordURL});
                            didLaunchChrome = true;
                        } catch (IOException chromeException) {
                            if (isTestMode) {
                                System.out.println("chromeException: " + chromeException);
                            }
                        }
                    }

                    if (!didLaunchChrome) {
                        try {
                            if (isLinuxUbiquityMode) { // Sometimes Firefox hangs/freezes in Linux pre-install enviroment, so quit all Firefox instances before launching a new one.
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/pkill", "firefox"});
                            }

                            // Run Firefox as sudo in pre-install environment to fix an issue launching Firefox when java is not launched as sudo.
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", (isLinuxUbiquityMode ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "") + "/usr/bin/firefox -private " + pcsCrmForgotPasswordURL});
                        } catch (IOException firefoxException) {
                            if (isTestMode) {
                                System.out.println("firefoxException: " + firefoxException);
                            }

                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/xdg-open", pcsCrmForgotPasswordURL});
                            } catch (IOException xdgOpenException) {
                                if (isTestMode) {
                                    System.out.println("xdgOpenException: " + xdgOpenException);
                                }
                            }
                        }
                    }
                } else {
                    try {
                        Desktop.getDesktop().browse(new URI(pcsCrmForgotPasswordURL));
                    } catch (IOException | URISyntaxException openPCsCRMLoginException) {
                        if (isTestMode) {
                            System.out.println("openPCsCRMLoginException: " + openPCsCRMLoginException);
                        }
                    }
                }
            }

            setActionsEnabled(true);

            pswPassword.requestFocusInWindow();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnForgotActionPerformed

    private void btnForgotFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_btnForgotFocusGained
        JButton thisButton = (JButton) evt.getSource();
        Font defaultFont = UIManager.getFont("defaultFont");
        HashMap<TextAttribute, Object> attributes = new HashMap<>(defaultFont.getAttributes());
        attributes.put(TextAttribute.UNDERLINE, TextAttribute.UNDERLINE_ON);
        thisButton.setFont(defaultFont.deriveFont(attributes));
    }//GEN-LAST:event_btnForgotFocusGained

    private void btnForgotFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_btnForgotFocusLost
        JButton thisButton = (JButton) evt.getSource();
        thisButton.setFont(UIManager.getFont("defaultFont"));
    }//GEN-LAST:event_btnForgotFocusLost

    private void btnCheckPIDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCheckPIDActionPerformed
        if (actionsEnabled && !isLoggedIn && !txtUsername.getText().trim().isEmpty() && pswPassword.getPassword().length > 0 && !txtPID.getText().trim().isEmpty()) {
            setActionsEnabled(false);

            loadingWindow.setLoadingTextAndDisplay("QA Helper is Checking PID", "Working", "IDButton");

            (new SwingWorker<Void, Void>() {
                @Override
                protected Void doInBackground() throws Exception {
                    checkPID(true);

                    return null;
                }

                @Override
                protected void done() {
                    loadingWindow.closeWindow();

                    setActionsEnabled(true);

                    txtPID.requestFocusInWindow();
                }
            }).execute();
        } else {
            playAlertSound("beep");
            focusNextTestTaskVerifyButton(btnLogIn);
        }
    }//GEN-LAST:event_btnCheckPIDActionPerformed

    private void btnCheckPIDFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_btnCheckPIDFocusGained
        JButton thisButton = (JButton) evt.getSource();
        Font defaultFont = UIManager.getFont("defaultFont");
        HashMap<TextAttribute, Object> attributes = new HashMap<>(defaultFont.getAttributes());
        attributes.put(TextAttribute.UNDERLINE, TextAttribute.UNDERLINE_ON);
        thisButton.setFont(defaultFont.deriveFont(attributes));
    }//GEN-LAST:event_btnCheckPIDFocusGained

    private void btnCheckPIDFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_btnCheckPIDFocusLost
        JButton thisButton = (JButton) evt.getSource();
        thisButton.setFont(UIManager.getFont("defaultFont"));
    }//GEN-LAST:event_btnCheckPIDFocusLost

    private void btnStressCPUActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnStressCPUActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            final int cpuStressTestDurationMinutes = 5;

            int cpuStressTestPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>CPU Stress Test will run for <u>" + cpuStressTestDurationMinutes + " minutes</u>, stressing the full capacity of this computers processor.</b>"
                    + "<br/>"
                    + (isLinux
                            ? "<br/><center><i>When CPU Stress Test starts, \"System Monitor\" will open so that you can switch to the<br/>"
                            + "\"Resources\" tab to make sure the full CPU is being utilized during the duration of the test.</i></center>"
                            : "")
                    + "<br/>"
                    + new TwemojiImage("SpeakerHighVolume", qaHelperWindow).toImgTag("left") + " While the CPU Stress Test runs, it is <u>normal and expected</u> for the <u>fans to run high and loud</u>.<br/>"
                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " Although, the fans sounds should be <u>consistent and smooth</u>."
                    + "<br/><br/>"
                    + new TwemojiImage("Ear", qaHelperWindow).toImgTag("left") + " <i>Listen closely during the test for any fans that sound like they are <u>ticking, clicking, or sounding abnormal</u>."
                    + "<br/>"
                    + new TwemojiImage("HighVoltage", qaHelperWindow).toImgTag("left") + " It is a <u>serious issue</u> the fans <u>do not sound smooth</u> or you hear any <u>electronic sizzling sounds</u>.</i>"
                    + "<br/><br/>"
                    + new TwemojiImage("ExclamationQuestionMark", qaHelperWindow).toImgTag("left") + " <b>If you hear any <u>questionable sounds</u>, or if the <u>fans do not run high</u>, CPU Stress Test <u>has failed</u><br/>"
                    + new TwemojiImage("StopSign", qaHelperWindow).toImgTag("left") + " and you should <u>consult an instructor</u> and <u>shut down the computer immediately</u>!</b>"
                    + "<br/><br/>"
                    + new TwemojiImage("Bomb", qaHelperWindow).toImgTag("left") + " <b><i>Also, if <u>this computer shuts itself down</u> during CPU Stress Test, <u>that is a failure</u>.</i></b>"
                    + (computerSpecs.isLaptop()
                    ? "<br/><br/><center>" + new TwemojiImage("ElectricPlug", qaHelperWindow).toImgTag("left") + " <i>MAKE SURE THIS LAPTOP IS PLUGGED IN BEFORE STARTING CPU STRESS TEST</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "</center>"
                    : "")
                    + (isLinux
                            ? "<br/><center>"
                            + "<i>After CPU Stress Test is finished, you will be presented with results<br/>"
                            + "which will also display whether CPU Stress Test has <b style='color: " + successColorHTML + "'>passed</b> or <b style='color: " + errorColorHTML + "'>failed</b>.</i>"
                            + "<br/><br/>"
                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF CPU STRESS TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "</center>"
                            : "")
                    + "</html>", "QA Helper  —  CPU Stress Test", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE, new TwemojiImage("Brain", qaHelperWindow).toImageIcon());

            if (cpuStressTestPromptReturn == JOptionPane.OK_OPTION) {
                if (isWindowsPE) {
                    setState(Frame.ICONIFIED);
                }

                loadingWindow.setLoadingTextAndDisplay("QA Helper is Setting Up CPU Stress Test", "Testing", "Brain");

                (new SwingWorker<String, String>() {
                    @Override
                    protected String doInBackground() throws Exception {
                        if (isLinux) {
                            boolean stressWasInstalled = false;
                            boolean stressInstalledViaTerminal = false;
                            String stressPath = "/usr/bin/stress-ng";
                            String[] possibleStressPaths = new String[]{"/usr/bin/stress-ng", "LD_LIBRARY_PATH=/cdrom/preseed/dependencies/ /cdrom/preseed/dependencies/stress-ng"};

                            for (String thisStressPath : possibleStressPaths) {
                                stressWasInstalled = !new CommandReader(thisStressPath + " -V").getFirstOutputLineContaining(".").isEmpty();

                                if (stressWasInstalled) {
                                    stressPath = thisStressPath;
                                    break;
                                }
                            }

                            if (isTestMode) {
                                System.out.println("stressPath: " + stressPath);
                            }

                            boolean stressIsInstalled = stressWasInstalled;

                            if (!stressWasInstalled) {
                                String previousAdminPassword = adminPassword;
                                getAdminPassword("Run CPU Stress Test"); // Double-check that admin password is still correct.

                                if (!adminPassword.equals(previousAdminPassword)) {
                                    computerSpecs.reloadSpecs(adminPassword, isTestMode);

                                    publish("reloaded");
                                }

                                if (!adminPassword.equals("*UNKNOWN*")) {
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get install --no-install-recommends -qq stress-ng"}).waitFor();
                                        stressIsInstalled = !new CommandReader(new String[]{"/usr/bin/stress-ng", "-V"}).getFirstOutputLineContaining(".").isEmpty();
                                    } catch (IOException | InterruptedException installStressException) {
                                        if (isTestMode) {
                                            System.out.println("installStressException: " + installStressException);
                                        }
                                    }

                                    if (!stressIsInstalled && !isLinuxUbiquityMode) {
                                        try {
                                            File waitForTerminalPIDtempFile = File.createTempFile("qa_helper-wait_for_terminal_pid", ".txt");
                                            waitForTerminalPIDtempFile.deleteOnExit();

                                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Installing \"stress-ng\"' --hide-menubar --geometry '80x25+0+0' -x /bin/bash -c 'orig_temp_owner=$(/usr/bin/stat -c %U " + waitForTerminalPIDtempFile.getPath() + "); /bin/chown root " + waitForTerminalPIDtempFile.getPath() + "; echo $$ > " + waitForTerminalPIDtempFile.getPath() + "; /bin/chown ${orig_temp_owner} " + waitForTerminalPIDtempFile.getPath() + "; echo \"\nINSTALLING \\\"stress-ng\\\"\n\n\"; /usr/local/bin/apt install --no-install-recommends -y stress-ng; echo \"\n\nFINISHED INSTALLING \\\"stress-ng\\\"\nTHIS TERMINAL WINDOW WILL CLOSE IN 5 SECONDS - OR PRESS ENTER TO CLOSE NOW\"; read -t 5; /usr/bin/wmctrl -a \"QA Helper\"'"});

                                            String waitForTerminalPID = "";

                                            for (int i = 0; i < 10; i++) {
                                                if (waitForTerminalPIDtempFile.exists()) {
                                                    try {
                                                        List<String> waitForTerminalPIDtempFileLines = Files.readAllLines(Paths.get(waitForTerminalPIDtempFile.getPath()), StandardCharsets.UTF_8);

                                                        if (!waitForTerminalPIDtempFileLines.isEmpty()) {
                                                            waitForTerminalPID = waitForTerminalPIDtempFileLines.get(0);
                                                            if (!waitForTerminalPID.isEmpty()) {
                                                                break;
                                                            }
                                                        }
                                                    } catch (IOException | IndexOutOfBoundsException getTerminalPIDException) {
                                                        if (isTestMode) {
                                                            System.out.println("getTerminalPIDException: " + getTerminalPIDException);
                                                        }
                                                    }
                                                }

                                                TimeUnit.MILLISECONDS.sleep(500);
                                            }

                                            if (waitForTerminalPIDtempFile.exists()) {
                                                waitForTerminalPIDtempFile.delete();
                                            }

                                            if (!waitForTerminalPID.isEmpty()) {
                                                while (!new CommandReader(new String[]{"/bin/ps", "-p", waitForTerminalPID, "-o", "pid="}).getFirstOutputLine().isEmpty()) {
                                                    TimeUnit.MILLISECONDS.sleep(500);
                                                }
                                            }

                                            stressIsInstalled = !new CommandReader(new String[]{"/usr/bin/stress-ng", "-V"}).getFirstOutputLineContaining(".").isEmpty();
                                            stressInstalledViaTerminal = stressIsInstalled;
                                        } catch (IOException | InterruptedException installStressViaTerminalException) {
                                            if (isTestMode) {
                                                System.out.println("installStressViaTerminalException: " + installStressViaTerminalException);
                                            }
                                        }
                                    }
                                }
                            }

                            if (stressIsInstalled) {
                                String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : ""); // Man pages says stress-ng can do better with sudo

                                try {
                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-system-monitor"});
                                } catch (IOException openSystemMonitorException) {
                                    if (isTestMode) {
                                        System.out.println("openSystemMonitorException: " + openSystemMonitorException);
                                    }
                                }

                                publish("running");

                                (new SwingWorker<Void, String>() {
                                    @Override
                                    protected Void doInBackground() throws Exception {
                                        do {
                                            TimeUnit.SECONDS.sleep(5);
                                            publish("progress");
                                        } while (loadingWindow.isVisible() && loadingWindow.getLoadingText().startsWith("QA Helper is Stressing CPU") && !new CommandReader(new String[]{"/usr/bin/pgrep", "stress-ng"}).getFirstOutputLine().isEmpty());

                                        return null;
                                    }

                                    @Override
                                    protected void process(java.util.List<String> tasks) {
                                        if (loadingWindow.isVisible() && loadingWindow.getLoadingText().startsWith("QA Helper is Stressing CPU")) {
                                            boolean firstUpdate = loadingWindow.isIndeterminate();

                                            loadingWindow.setLoadingProgressText(String.join("\n", new CommandReader(new String[]{"/usr/bin/sensors"}).getOutputLines()));

                                            if (firstUpdate) {
                                                loadingWindow.setLoadingProgressBarToMax((cpuStressTestDurationMinutes * 60) / 5);
                                            }

                                            loadingWindow.incrementLoadingProgressBar();
                                        }
                                    }
                                }).execute();

                                String stressReturn = String.join("\n", new CommandReader(possibleSudo + stressPath + " -c 0 --verify -t " + cpuStressTestDurationMinutes + "m --verbose 2>&1").getOutputLines());

                                if (!stressWasInstalled) {
                                    publish("finishing");
                                    TimeUnit.SECONDS.sleep(1); // Sleep for a second to make sure the finishing progress has time to show before being closed.

                                    if (stressInstalledViaTerminal) {
                                        try {
                                            File waitForTerminalPIDtempFile = File.createTempFile("qa_helper-wait_for_terminal_pid", ".txt");
                                            waitForTerminalPIDtempFile.deleteOnExit();

                                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Uninstalling \"stress-ng\"' --hide-menubar --geometry '80x25+0+0' -x /bin/bash -c 'orig_temp_owner=$(/usr/bin/stat -c %U " + waitForTerminalPIDtempFile.getPath() + "); /bin/chown root " + waitForTerminalPIDtempFile.getPath() + "; echo $$ > " + waitForTerminalPIDtempFile.getPath() + "; /bin/chown ${orig_temp_owner} " + waitForTerminalPIDtempFile.getPath() + "; echo \"\nUNINSTALLING \\\"stress-ng\\\"\n\n\"; /usr/local/bin/apt purge --auto-remove -y stress-ng; echo \"\n\nFINISHED UNINSTALLING \\\"stress-ng\\\"\nTHIS TERMINAL WINDOW WILL CLOSE IN 5 SECONDS - OR PRESS ENTER TO CLOSE NOW\"; read -t 5; /usr/bin/wmctrl -a \"QA Helper\"'"});

                                            String waitForTerminalPID = "";

                                            for (int i = 0; i < 10; i++) {
                                                if (waitForTerminalPIDtempFile.exists()) {
                                                    try {
                                                        List<String> waitForTerminalPIDtempFileLines = Files.readAllLines(Paths.get(waitForTerminalPIDtempFile.getPath()), StandardCharsets.UTF_8);

                                                        if (!waitForTerminalPIDtempFileLines.isEmpty()) {
                                                            waitForTerminalPID = waitForTerminalPIDtempFileLines.get(0);
                                                            if (!waitForTerminalPID.isEmpty()) {
                                                                break;
                                                            }
                                                        }
                                                    } catch (IOException | IndexOutOfBoundsException getTerminalPIDException) {
                                                        if (isTestMode) {
                                                            System.out.println("getTerminalPIDException: " + getTerminalPIDException);
                                                        }
                                                    }
                                                }

                                                TimeUnit.MILLISECONDS.sleep(500);
                                            }

                                            if (waitForTerminalPIDtempFile.exists()) {
                                                waitForTerminalPIDtempFile.delete();
                                            }

                                            if (!waitForTerminalPID.isEmpty()) {
                                                while (!new CommandReader(new String[]{"/bin/ps", "-p", waitForTerminalPID, "-o", "pid="}).getFirstOutputLine().isEmpty()) {
                                                    TimeUnit.MILLISECONDS.sleep(500);
                                                }
                                            }
                                        } catch (IOException | InterruptedException uninstallStressViaTerminalException) {
                                            if (isTestMode) {
                                                System.out.println("uninstallStressViaTerminalException: " + uninstallStressViaTerminalException);
                                            }
                                        }
                                    } else {
                                        try {
                                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get purge --auto-remove -qq stress-ng"}).waitFor();
                                        } catch (IOException | InterruptedException uninstallStressException) {
                                            if (isTestMode) {
                                                System.out.println("uninstallStressException: " + uninstallStressException);
                                            }
                                        }
                                    }
                                }

                                return stressReturn;

                            } else {
                                return "install-error";
                            }
                        } else if (isMacOS) {
                            try {
                                for (int thread = 0; thread < computerSpecs.getThreadCount(); thread++) {
                                    // For some reason running exec(new String[]{"yes"}) spawns processes that don't use any CPU.
                                    // Maybe because it knows it has no interface to output to?
                                    // But, directing "yes" output to "/dev/null" makes it take full CPU as desired.
                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "/usr/bin/yes > /dev/null"});
                                    TimeUnit.MILLISECONDS.sleep(100); // To allow CPU to ramp up
                                }

                                Runtime.getRuntime().exec(new String[]{"/usr/bin/caffeinate", "-dimsut", "315"}); // Make sure the computer stays awake for the duration of the CPU Stress Test

                                publish("running");

                                int secondsPassed = 0;

                                do {
                                    TimeUnit.SECONDS.sleep(5);
                                    secondsPassed += 5;

                                    publish("mac-progress");

                                } while (secondsPassed <= (cpuStressTestDurationMinutes * 60));
                            } catch (IOException | InterruptedException runYesStressTestException) {
                                if (isTestMode) {
                                    System.out.println("runYesStressTestException: " + runYesStressTestException);
                                }
                            }

                            publish("finishing");
                            TimeUnit.SECONDS.sleep(1); // Sleep for a second to make sure the finishing progress has time to show before being closed.

                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "yes"});
                            } catch (IOException quitYesException) {
                                if (isTestMode) {
                                    System.out.println("quitYesException: " + quitYesException);
                                }
                            }

                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "caffeinate"});
                            } catch (IOException quitCaffeinateException) {
                                if (isTestMode) {
                                    System.out.println("quitCaffeinateException: " + quitCaffeinateException);
                                }
                            }

                            return "mac-windows-done";
                        } else {
                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX " + (new File("\\Install\\Diagnostic Tools\\OpenHardwareMonitor\\OpenHardwareMonitor.exe").exists() ? "\"OpenHardwareMonitor\" \"\\Install\\Diagnostic Tools\\OpenHardwareMonitor\\OpenHardwareMonitor.exe\"" : (isWindowsPE ? "\\Windows\\System32\\Taskmgr.exe" : "\\Windows\\System32\\resmon.exe"))});
                            } catch (IOException openResourceOrTaskManagerException) {
                                if (isTestMode) {
                                    System.out.println("openResourceOrTaskManagerException: " + openResourceOrTaskManagerException);
                                }
                            }

                            try {
                                for (int thread = 0; thread < computerSpecs.getThreadCount(); thread++) {
                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "While (Get-CimInstance Win32_Process -Filter \\\"Name LIKE 'java%.exe' AND CommandLine LIKE '%QA_Helper.jar%'\\\" -Property Name,CommandLine) { <# QA Helper CPU Stress Test #> }"});
                                    TimeUnit.MILLISECONDS.sleep(100); // To allow CPU to ramp up
                                }

                                publish("running");

                                int secondsPassed = 0;

                                do {
                                    TimeUnit.SECONDS.sleep(5);
                                    secondsPassed += 5;

                                    publish("windows-progress");

                                } while (secondsPassed <= (cpuStressTestDurationMinutes * 60));
                            } catch (IOException | InterruptedException runPowerShellStressTestException) {
                                if (isTestMode) {
                                    System.out.println("runPowerShellStressTestException: " + runPowerShellStressTestException);
                                }
                            }

                            publish("finishing");
                            TimeUnit.SECONDS.sleep(1); // Sleep for a second to make sure the finishing progress has time to show before being closed.

                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Get-CimInstance Win32_Process -Filter \\\"Name = 'powershell.exe' AND CommandLine LIKE '%<# QA Helper CPU Stress Test #>%'\\\" | Invoke-CimMethod -Name Terminate"}).waitFor();
                            } catch (IOException terminatePowerShellStressProcessesException) {
                                if (isTestMode) {
                                    System.out.println("terminatePowerShellStressProcessesException: " + terminatePowerShellStressProcessesException);
                                }
                            }

                            return "mac-windows-done";
                        }
                    }

                    @Override
                    protected void process(java.util.List<String> tasks) {
                        tasks.forEach((thisTask) -> {
                            switch (thisTask) {
                                case "reloaded":
                                    displayComputerSpecs();
                                    break;
                                case "running":
                                    loadingWindow.setLoadingTextAndDisplay("QA Helper is Stressing CPU for " + cpuStressTestDurationMinutes + " Minutes", "Testing", "Brain");
                                    break;
                                case "windows-progress":
                                    boolean firstWindowsUpdate = loadingWindow.isIndeterminate();

                                    // TODO: MSAcpi_ThermalZoneTemperature is not CPU but some general temp. Also not available on all computers and requires admin. Also SLOW
                                    /*
                                    String[] systemTemps = new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Get-CimInstance MSAcpi_ThermalZoneTemperature -Namespace ROOT\\WMI -Property CurrentTemperature,CriticalTripPoint | Format-List CurrentTemperature,CriticalTripPoint"}).getOutputLines();

                                    String currentSystemTempInfo = "";

                                    for (String thisSystemTempLine : systemTemps) {
                                        if (thisSystemTempLine.contains(": ")) {
                                            String thisRawSystemTemp = thisSystemTempLine.substring(thisSystemTempLine.indexOf(": ") + 2).replaceAll("[^0-9.]", "");
                                            if (!thisRawSystemTemp.isEmpty() && !thisRawSystemTemp.equals(".")) {
                                                String thisSystemCelciumTemp = new DecimalFormat("#.#").format(((Double.parseDouble(thisRawSystemTemp) / 10) - 273.15)) + " C";

                                                if (thisSystemTempLine.startsWith("CurrentTemperature")) {
                                                    currentSystemTempInfo += "Current System Temperature: " + thisSystemCelciumTemp + "\n";
                                                } else if (thisSystemTempLine.startsWith("CriticalTripPoint")) {
                                                    currentSystemTempInfo += "Critical System Temperature: " + thisSystemCelciumTemp + "\n\n";
                                                }
                                            }
                                        }
                                    }

                                    if (currentSystemTempInfo.isEmpty())
                                        currentSystemTempInfo = "SYSTEM TEMPERATURES ARE NOT AVAILABLE\nFOR THIS COMPUTER";

                                    loadingWindow.setLoadingProgressText(currentSystemTempInfo);
                                     */
                                    if (firstWindowsUpdate) {
                                        loadingWindow.setLoadingProgressBarToMax((cpuStressTestDurationMinutes * 60) / 5);
                                    }

                                    loadingWindow.incrementLoadingProgressBar();
                                    break;
                                case "mac-progress":
                                    boolean firstMacUpdate = loadingWindow.isIndeterminate();

                                    String thermalLevelsOutput = String.join("\n", new CommandReader("/usr/sbin/sysctl -a | /usr/bin/grep thermal_level").getOutputLines()).replace("machdep.xcpm.", "").toUpperCase().replace("_THERMAL_LEVEL", " Thermal Level");

                                    if (!thermalLevelsOutput.isEmpty()) { // These thermal levels are not available on Apple Silcon.
                                        loadingWindow.setLoadingProgressText(thermalLevelsOutput + "\n\n\nPLEASE NOTE:\nTHESE THERMAL LEVELS ARE ARBITRARY NUMBERS PROVIDED BY THE SYSTEM, BUT THEY SHOULD LEVEL OFF AND THEN STAY STEADY THROUGHOUT THE TEST.");
                                    }

                                    if (firstMacUpdate) {
                                        loadingWindow.setLoadingProgressBarToMax((cpuStressTestDurationMinutes * 60) / 5);
                                    }

                                    loadingWindow.incrementLoadingProgressBar();
                                    break;
                                case "finishing":
                                    if (loadingWindow.isVisible()) {
                                        // Make sure to only do this if the window is still visible in case the multi-threaded timing make it so that we finish before this gets processed.
                                        loadingWindow.setLoadingTextAndDisplay("QA Helper is Finishing CPU Stress Test", "Testing", "Brain");
                                        loadingWindow.setLoadingProgressBarToMax(0);
                                        loadingWindow.setLoadingProgressText("");
                                    }
                                    break;
                                default:
                                    break;
                            }
                        });
                    }

                    @Override
                    protected void done() {
                        focusWindow();

                        try {
                            String stressReturn = get();

                            loadingWindow.closeWindow();

                            if (stressReturn.equals("install-error")) {
                                playAlertSound("error");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Install \"stress-ng\"</b><br/><br/><i>To manually install \"stress-ng\", open Terminal and run:</i><br/><pre>sudo apt install stress-ng</pre><br/>After \"stress-ng\" is installed, come back here and try again.</html>", "QA Helper  —  CPU Stress Test Error", JOptionPane.ERROR_MESSAGE);
                            } else if (stressReturn.equals("mac-windows-done")) {
                                playAlertSound("success");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>CPU Stress Test Completed</b></html>", "QA Helper  —  CPU Stress Test Completed", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Brain", qaHelperWindow).toImageIcon(32));

                                if (isWindows) {
                                    try {
                                        // taskkill does not exist in WinPE (unless it has been manually copied in) and will always exist in full Windows, no need to make it hard a requirement when I can just use PowerShell (PowerShell just takes longer so we'll still use taskkill when it's available).
                                        if (!isWindowsPE || new File("\\Windows\\System32\\taskkill.exe").exists()) {
                                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", (new File("\\Install\\Diagnostic Tools\\OpenHardwareMonitor\\OpenHardwareMonitor.exe").exists() ? "OpenHardwareMonitor.exe" : (isWindowsPE ? "Taskmgr.exe" : "perfmon.exe")), "/t"}).waitFor(); // Even though we launch resmon.exe the running executable is perfmon.exe
                                        } else {
                                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Process -Name " + (new File("\\Install\\Diagnostic Tools\\OpenHardwareMonitor\\OpenHardwareMonitor.exe").exists() ? "OpenHardwareMonitor" : "Taskmgr")}).waitFor();
                                        }
                                    } catch (IOException | InterruptedException quitTaskManagerException) {
                                        if (isTestMode) {
                                            System.out.println("quitTaskManagerException: " + quitTaskManagerException);
                                        }
                                    }
                                }

                                if (!isCPUverified && btnVerifyCPU.isVisible() && btnVerifyCPU.isEnabled()) {
                                    btnVerifyCPUActionPerformed(null);
                                }
                            } else if (isLinux) {
                                String lastStressReturnLines = stressReturn.substring(stressReturn.lastIndexOf("stress-ng: info:"));
                                boolean stressPassed = (lastStressReturnLines.contains("] successful run completed in ") && (lastStressReturnLines.contains("s (" + cpuStressTestDurationMinutes + " mins") || lastStressReturnLines.contains("s (" + (cpuStressTestDurationMinutes - 1) + " mins, 59.")));

                                JLabel cpuStressTestOutputHeaderLabel = new JLabel("<html><b>CPU Stress Test " + (stressPassed ? "Passed" : "Failed") + "</b><br/><br/></html>");
                                if (!stressPassed) {
                                    cpuStressTestOutputHeaderLabel.setForeground(errorColor);
                                }

                                JTextArea cpuTestOutputPanelTextArea = new JTextArea(30, 85);
                                cpuTestOutputPanelTextArea.setText(stressReturn.replace("[sudo] password for " + new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine() + ": ", ""));
                                cpuTestOutputPanelTextArea.setEditable(false);
                                cpuTestOutputPanelTextArea.setLineWrap(true);
                                cpuTestOutputPanelTextArea.setWrapStyleWord(true);
                                cpuTestOutputPanelTextArea.setFont(new Font(Font.MONOSPACED, lblVersion.getFont().getStyle(), cpuTestOutputPanelTextArea.getFont().getSize()));
                                JScrollPane cpuStressTestOutputScrollPane = new JScrollPane(cpuTestOutputPanelTextArea);

                                playAlertSound((stressPassed ? "success" : "error"));
                                JOptionPane.showMessageDialog(qaHelperWindow, new Object[]{
                                    cpuStressTestOutputHeaderLabel, cpuStressTestOutputScrollPane
                                }, "QA Helper  —  CPU Stress Test " + (stressPassed ? "Passed" : "Failed"), (stressPassed ? JOptionPane.PLAIN_MESSAGE : JOptionPane.ERROR_MESSAGE), new TwemojiImage("Brain", qaHelperWindow).toImageIcon());

                                try {
                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "") + "/usr/bin/killall " + (isLinuxMATE ? "mate" : "gnome") + "-system-monitor"});
                                } catch (IOException quitSystemMonitorException) {
                                    if (isTestMode) {
                                        System.out.println("quitSystemMonitorException: " + quitSystemMonitorException);
                                    }
                                }

                                if (stressPassed && !isCPUverified && btnVerifyCPU.isVisible() && btnVerifyCPU.isEnabled()) {
                                    btnVerifyCPUActionPerformed(null);
                                }
                            }
                        } catch (HeadlessException | InterruptedException | ExecutionException finishedStressException) {
                            if (isTestMode) {
                                System.out.println("finishedStressException: " + finishedStressException);
                            }
                        }

                        setActionsEnabled(true);
                    }
                }).execute();
            } else {
                setActionsEnabled(true);
                focusNextTestTaskVerifyButton(btnStressCPU);
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnStressCPUActionPerformed

    private void btnVerifyCPUActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyCPUActionPerformed
        if (actionsEnabled || (evt == null)) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isCPUverified ? "UNVERIFY" : "verify") + "</i> the CPU?</b></html>", "QA Helper  —  Confirm " + (isCPUverified ? "Unverify" : "Verify") + " CPU", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isCPUverified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isCPUverified = !isCPUverified;

                writeToHelperLogFile("Test: CPU " + (isCPUverified ? "Verified" : "UNVERIFIED"));

                btnVerifyCPU.setText((isCPUverified ? "Verified" : "Verify"));
                btnVerifyCPU.setFont(btnVerifyCPU.getFont().deriveFont((isCPUverified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyCPU.setForeground(isCPUverified ? verifiedColor : defaultColor);
                btnVerifyCPU.setBorderPainted(!isCPUverified);

                new LinuxAutoScripts("CPU " + (isCPUverified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyCPU);
            } else {
                focusNextTestTaskVerifyButton(btnStressCPU);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyCPUActionPerformed

    private void btnDriveHealthActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDriveHealthActionPerformed
        if (actionsEnabled) {
            if (isLinux) {
                setActionsEnabled(false);

                String driveHealth = computerSpecs.getDriveHealth();

                if (!driveHealth.equals("N/A")) {
                    JTextArea hdSentinelOutputTextArea = new JTextArea(30, 100);
                    hdSentinelOutputTextArea.setText(computerSpecs.getDriveHealth());
                    hdSentinelOutputTextArea.setCaretPosition(0);
                    hdSentinelOutputTextArea.setEditable(false);
                    hdSentinelOutputTextArea.setLineWrap(true);
                    hdSentinelOutputTextArea.setWrapStyleWord(true);
                    hdSentinelOutputTextArea.setFont(new Font(Font.MONOSPACED, lblVersion.getFont().getStyle(), hdSentinelOutputTextArea.getFont().getSize()));
                    JScrollPane hdSentinelOutputScrollPane = new JScrollPane(hdSentinelOutputTextArea);

                    JOptionPane.showMessageDialog(qaHelperWindow, new Object[]{
                        "<html><b>Confirm Specs for Every Drive:</b><br/><br/>"
                        + "<b>Power on time</b> <i>MUST</i> be <u>LESS than 2500 days</u><br/>"
                        + "<b>Est. lifetime</b> <i>MUST</i> be <u>GREATER than 399 days</u><br/>"
                        + "The <b>status</b> <i>MUST</i> be <u>PERFECT</u><br/>"
                        + "The <b>last line</b> <i>MUST</i> be <u>No actions needed.</u><br/>"
                        + "<br/>"
                        + "</html>",
                        hdSentinelOutputScrollPane}, "QA Helper  —  Drive Health", JOptionPane.PLAIN_MESSAGE, new TwemojiImage("Hospital", qaHelperWindow).toImageIcon());

                    if (!computerSpecs.getDriveHealthWarning() && !computerSpecs.getDriveRecalled() && !isDriveHealthVerified && btnVerifyDriveHealth.isVisible() && btnVerifyDriveHealth.isEnabled()) {
                        String disksFormattedWithoutPartitionTable = computerSpecs.getDisksFormattedWithoutPartitionTable();

                        if (disksFormattedWithoutPartitionTable.isEmpty()) {
                            btnVerifyDriveHealthActionPerformed(null);
                        }
                    }
                } else {
                    playAlertSound("error");
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Load Drive Health</b><br/><br/><i>Try again after reloading specs and entering admin password.</i></html>", "QA Helper  —  Drive Health Error", JOptionPane.ERROR_MESSAGE);
                    btnReloadSpecs.requestFocusInWindow();
                }

                setActionsEnabled(true);
            } else if (isWindows) {
                if (new File("\\Install\\Diagnostic Tools\\CrystalDiskInfo\\DiskInfo64.exe").exists()) {
                    try {
                        // tasklist doesn't exist in WinPE, do use PowerShell Get-Process instead
                        if ((isWindowsPE ? new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(Get-Process | Where-Object Name -eq 'DiskInfo64').Name"}) : new CommandReader(new String[]{"\\Windows\\System32\\tasklist.exe", "/nh", "/fi", "IMAGENAME eq DiskInfo64.exe"})).getFirstOutputLineContaining("DiskInfo64").isEmpty()) {
                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Install\\Diagnostic Tools\\CrystalDiskInfo\\DiskInfo64.exe"});
                            } catch (IOException launchDiskCheckException) { // Fallback to launching via "cmd.exe /c START" to allow elevated permissions prompt when needed when running on test systems without being in Audit mode or WinPE.
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START \"CrystalDiskInfo\" \"\\Install\\Diagnostic Tools\\CrystalDiskInfo\\DiskInfo64.exe\""});
                            }
                        } else {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object -ComObject Wscript.Shell).AppActivate(' CrystalDiskInfo')"}); // NOTE: Window title starts with a SPACE and will have the version number at the end, but AppActivate will match the closest window with the same PREFIX (which is why the SPACE must be included).
                        }

                        if (isWindowsPE) {
                            setState(Frame.ICONIFIED);
                        } else {
                            // TODO: Make this message better
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b><i>CrystalDiskInfo</i> will open momentarily.</b></html>", "QA Helper  —  Open CrystalDiskInfo", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Hospital", qaHelperWindow).toImageIcon(32));
                        }

                        if (!isDriveHealthVerified && btnVerifyDriveHealth.isVisible() && btnVerifyDriveHealth.isEnabled()) {
                            if (isWindowsPE) {
                                btnVerifyDriveHealth.requestFocusInWindow();
                            } else {
                                btnVerifyDriveHealthActionPerformed(null);
                            }
                        }
                    } catch (IOException openDiskCheckException) {
                        if (isTestMode) {
                            System.out.println("openDiskCheckException: " + openDiskCheckException);
                        }
                    }
                }
            } else if (isMacOS) {
                if (new File("/Applications/DriveDx.app").exists() || new File("/Users/fg-demo/Applications/DriveDx.app").exists()) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-a", (new File("/Applications/DriveDx.app").exists() ? "/Applications/DriveDx.app" : "/Users/fg-demo/Applications/DriveDx.app")});

                        // TODO: Make this message better
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b><i>DriveDx</i> will open momentarily.</b></html>", "QA Helper  —  Open DriveDx", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Hospital", qaHelperWindow).toImageIcon(32));

                        if (!isDriveHealthVerified && btnVerifyDriveHealth.isVisible() && btnVerifyDriveHealth.isEnabled()) {
                            btnVerifyDriveHealthActionPerformed(null);
                        }
                    } catch (IOException openDriveDxException) {
                        if (isTestMode) {
                            System.out.println("openDriveDxException: " + openDriveDxException);
                        }
                    }
                }
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnDriveHealthActionPerformed

    private void btnVerifyDriveHealthActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyDriveHealthActionPerformed
        if (actionsEnabled || (evt == null)) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isDriveHealthVerified ? "UNVERIFY" : "verify") + "</i> the hard drive health?</b></html>", "QA Helper  —  Confirm " + (isDriveHealthVerified ? "Unverify" : "Verify") + " Hard Drive Health", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isDriveHealthVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isDriveHealthVerified = !isDriveHealthVerified;

                writeToHelperLogFile("Test: Drive Health " + (isDriveHealthVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyDriveHealth.setText((isDriveHealthVerified ? "Verified" : "Verify"));
                btnVerifyDriveHealth.setFont(btnVerifyDriveHealth.getFont().deriveFont((isDriveHealthVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyDriveHealth.setForeground(isDriveHealthVerified ? verifiedColor : defaultColor);
                btnVerifyDriveHealth.setBorderPainted(!isDriveHealthVerified);

                new LinuxAutoScripts("Drive Health " + (isDriveHealthVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyDriveHealth);
            } else {
                focusNextTestTaskVerifyButton(btnDriveHealth);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyDriveHealthActionPerformed

    private void btnEjectDiscDriveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEjectDiscDriveActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            try {
                if (isLinux || isWindows) {
                    ArrayList<String> discDriveLogicalNames = computerSpecs.getDiscDriveLogicalNames();

                    for (String thisDiscDriveLogicalName : discDriveLogicalNames) {
                        if (isLinux) {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/eject", thisDiscDriveLogicalName});
                        } else {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object -ComObject Shell.Application).NameSpace(17).ParseName('" + thisDiscDriveLogicalName + "').InvokeVerb('Eject')"});
                        }
                    }
                } else if (isMacOS) {
                    Runtime.getRuntime().exec(new String[]{"/usr/bin/drutil", "eject"}).waitFor();
                }

                if (computerSpecs.hasDiscInDiscDrive()) {
                    reload();
                }

                // TODO: Make this message better.
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>The disc drive should eject momentarily.</b></html>", "QA Helper  —  Disc Drive Ejected", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("DVD", qaHelperWindow).toImageIcon(32));

                if (!isDiscDriveVerified && btnVerifyDiscDrive.isVisible() && btnVerifyDiscDrive.isEnabled()) {
                    btnVerifyDiscDriveActionPerformed(null);
                }
            } catch (IOException | InterruptedException ejectDiscException) {
                if (isTestMode) {
                    System.out.println("ejectDiscException: " + ejectDiscException);
                }

                playAlertSound("error");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Perform Eject Command</b></html>", "QA Helper  —  Eject Disc Drive Error", JOptionPane.ERROR_MESSAGE);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnEjectDiscDriveActionPerformed

    private void btnVerifyDiscDriveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyDiscDriveActionPerformed
        if (actionsEnabled || (evt == null)) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isDiscDriveVerified ? "UNVERIFY" : "verify") + "</i> the disc drive?</b></html>", "QA Helper  —  Confirm " + (isDiscDriveVerified ? "Unverify" : "Verify") + " Disc Drive", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isDiscDriveVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isDiscDriveVerified = !isDiscDriveVerified;

                boolean hasDiscDrive = !computerSpecs.getDiscDrive().equals("N/A");

                writeToHelperLogFile("Test: " + (hasDiscDrive ? "" : "Manufactured Without ") + "Disc Drive " + (isDiscDriveVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyDiscDrive.setText((isDiscDriveVerified ? "Verified" : "Verify"));
                btnVerifyDiscDrive.setFont(btnVerifyDiscDrive.getFont().deriveFont((isDiscDriveVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyDiscDrive.setForeground(isDiscDriveVerified ? verifiedColor : defaultColor);
                btnVerifyDiscDrive.setBorderPainted(!isDiscDriveVerified);

                new LinuxAutoScripts("Disc Drive " + (isDiscDriveVerified ? "Verified" : "Unverified"), adminPassword);

                if (!hasDiscDrive) {
                    boolean loginAndTasksWasHidden = hideLoginAndTasks;
                    if (loginAndTasksWasHidden) {
                        hideLoginAndTasks = false;
                    }

                    displayComputerSpecs();

                    if (loginAndTasksWasHidden) {
                        hideLoginAndTasks = true;
                    }
                }

                focusNextTestTaskVerifyButton(btnVerifyDiscDrive);
            } else {
                focusNextTestTaskVerifyButton(btnEjectDiscDrive);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyDiscDriveActionPerformed

    private void btnTestInternetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestInternetActionPerformed
        if (actionsEnabled && !isWindowsPE) {
            setActionsEnabled(false);

            loadingWindow.setLoadingTextAndDisplay("QA Helper is " + (isLinux ? "Preparing to Test Internet" : "Testing Internet"), "Testing", "SatelliteAntenna");

            (new SwingWorker<String, String>() {
                @Override
                protected String doInBackground() throws Exception {
                    ArrayList<String> ethernetNetworkDeviceIDs = new ArrayList<>();
                    ArrayList<String> wiFiNetworkDeviceIDs = new ArrayList<>();

                    String osCompanySiteName = "LinuxMint.com";

                    if (isLinux) {
                        String[] allNetworkDeviceInfo = new CommandReader(new String[]{"/usr/bin/nmcli", "device", "show"}).getOutputLines();
                        String thisNetworkDeviceID = "";
                        for (String thisNetworkDeviceInfoLine : allNetworkDeviceInfo) {
                            if (thisNetworkDeviceInfoLine.startsWith("GENERAL.DEVICE:")) {
                                thisNetworkDeviceID = thisNetworkDeviceInfoLine.substring(thisNetworkDeviceInfoLine.indexOf(":") + 1).trim();
                            } else if (thisNetworkDeviceInfoLine.startsWith("GENERAL.TYPE:")) {
                                String thisNetworkDeviceType = thisNetworkDeviceInfoLine.substring(thisNetworkDeviceInfoLine.indexOf(":") + 1).trim();
                                if (thisNetworkDeviceType.equals("wifi")) {
                                    wiFiNetworkDeviceIDs.add(thisNetworkDeviceID);
                                } else if (thisNetworkDeviceType.equals("ethernet")) {
                                    ethernetNetworkDeviceIDs.add(thisNetworkDeviceID);
                                }
                            }
                        }
                    } else if (isMacOS) {
                        osCompanySiteName = "Apple.com";

                        String[] allNetworkInterfaces = new CommandReader(new String[]{"/usr/sbin/networksetup", "-listallhardwareports"}).getOutputLines();

                        String thisNetworkDeviceName = "";
                        for (String thisNetworkInterfaceLine : allNetworkInterfaces) {
                            if (thisNetworkInterfaceLine.startsWith("Hardware Port:")) {
                                thisNetworkDeviceName = thisNetworkInterfaceLine.substring(thisNetworkInterfaceLine.indexOf(": ") + 2);
                            } else if (thisNetworkInterfaceLine.startsWith("Device:")) {
                                String thisNetworkDeviceID = thisNetworkInterfaceLine.substring(thisNetworkInterfaceLine.indexOf(": ") + 2);

                                if (thisNetworkDeviceName.contains("Wi-Fi")) {
                                    wiFiNetworkDeviceIDs.add(thisNetworkDeviceID);
                                } else if (thisNetworkDeviceName.contains("Ethernet") || thisNetworkDeviceName.contains(" LAN")) {
                                    ethernetNetworkDeviceIDs.add(thisNetworkDeviceID);
                                }
                            }
                        }
                    } else if (isWindows) {
                        osCompanySiteName = "Microsoft.com";

                        String[] allNetworkInterfaces = new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Get-NetAdapter -Physical | Format-List Name,PhysicalMediaType"}).getOutputLines();

                        String thisNetworkDeviceName = "";
                        for (String thisNetworkInterfaceLine : allNetworkInterfaces) {
                            if (thisNetworkInterfaceLine.startsWith("Name")) {
                                thisNetworkDeviceName = thisNetworkInterfaceLine.substring(thisNetworkInterfaceLine.indexOf(": ") + 2);
                            } else if (thisNetworkInterfaceLine.startsWith("PhysicalMediaType")) {
                                String thisNetworkPhysicalMediaType = thisNetworkInterfaceLine.substring(thisNetworkInterfaceLine.indexOf(": ") + 2);

                                if (thisNetworkPhysicalMediaType.equals("802.3")) {
                                    ethernetNetworkDeviceIDs.add(thisNetworkDeviceName);
                                } else if (thisNetworkPhysicalMediaType.equals("Native 802.11")) {
                                    wiFiNetworkDeviceIDs.add(thisNetworkDeviceName);
                                }
                            }
                        }
                    }

                    boolean hasEthernetPort = !ethernetNetworkDeviceIDs.isEmpty();
                    boolean ethernetCableConnected = false;
                    boolean connectedToCompanySiteViaEthernet = false;
                    boolean connectedToGoogleViaEthernet = false;
                    boolean ethernetTestPassed = false;
                    boolean ethernetTestSkipped = false;

                    boolean hasWiFiCard = !wiFiNetworkDeviceIDs.isEmpty();
                    boolean wiFiIsOff = true;
                    int numberOfWiFiNetworksDetected = 0;
                    String connectedWiFiNetworkName = "";
                    boolean connectedToCompanySiteViaWiFi = false;
                    boolean connectedToGoogleViaWiFi = false;
                    boolean wiFiTestPassed = false;
                    boolean wiFiTestSkipped = false;

                    do {
                        if (hasEthernetPort && !ethernetTestPassed && !ethernetTestSkipped) {
                            publish("ethernet");

                            for (;;) {
                                for (;;) {
                                    if (!isMacOS) {
                                        ethernetNetworkDeviceIDs.forEach((thisEthernetNetworkDeviceID) -> {
                                            if (isLinux) {
                                                if (!new CommandReader(new String[]{"/usr/bin/nmcli", "device", "status"}).getFirstOutputLineContaining(thisEthernetNetworkDeviceID).contains(" connected ")) {
                                                    try {
                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/nmcli", "device", "connect", thisEthernetNetworkDeviceID}).waitFor();
                                                    } catch (IOException | InterruptedException turnOnEthernetException) {
                                                        if (isTestMode) {
                                                            System.out.println("turnOnEthernetException: " + turnOnEthernetException);
                                                        }
                                                    }
                                                }
                                            } else if (isWindows) {
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Enable-NetAdapter '" + thisEthernetNetworkDeviceID + "'"}).waitFor();
                                                } catch (IOException | InterruptedException enableEthernetAdapterException) {
                                                    if (isTestMode) {
                                                        System.out.println("enableEthernetAdapterException: " + enableEthernetAdapterException);
                                                    }
                                                }
                                            }
                                        });
                                    }

                                    for (String thisEthernetNetworkDeviceID : ethernetNetworkDeviceIDs) {
                                        if (isLinux) {
                                            if (new File("/sys/class/net/" + thisEthernetNetworkDeviceID + "/carrier").exists()) {
                                                try {
                                                    List<String> networkDeviceLines = Files.readAllLines(Paths.get("/sys/class/net/" + thisEthernetNetworkDeviceID + "/carrier"));
                                                    if (!networkDeviceLines.isEmpty()) {
                                                        ethernetCableConnected = networkDeviceLines.get(0).equals("1");
                                                    }
                                                } catch (IOException outputCardCodecInfoException) {
                                                    if (isTestMode) {
                                                        System.out.println("outputCardCodecInfoException: " + outputCardCodecInfoException);
                                                    }
                                                }
                                            }
                                        } else {
                                            ethernetCableConnected = (isWindows
                                                    ? !new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(Get-NetAdapter '" + thisEthernetNetworkDeviceID + "').Status"}).getFirstOutputLine().equals("Disconnected")
                                                    : !new CommandReader(new String[]{"/usr/sbin/ipconfig", "getifaddr", thisEthernetNetworkDeviceID}).getFirstOutputLine().isEmpty());
                                        }

                                        if (ethernetCableConnected) {
                                            break;
                                        }
                                    }

                                    if (!ethernetCableConnected && isMacOS && computerSpecs.getFullCPU().startsWith("Apple") && computerSpecs.isLaptop()) {
                                        // Apple Silicon Mac laptops always show multiple Ethernet ports even though there are no built-in physical Ethernet ports on any Apple Silicon Mac laptops (only Apple Silicon desktops, and it's even optional on iMacs but not worrying about that right now).
                                        // So, ignore Ethernet test if testing Apple Silicon Mac laptop an no Ethernet is connected, but if Ethernet is connected with adapter, go ahead and test it anyways.
                                        hasEthernetPort = false;
                                        break;
                                    }

                                    if (ethernetCableConnected || (hasWiFiCard && !wiFiTestPassed && !wiFiTestSkipped)) {
                                        // Do Wi-Fi test first if Ethernet is not connected.
                                        break;
                                    } else {
                                        loadingWindow.setAlwaysOnTop(false);
                                        playAlertSound("error");
                                        String[] plugInEthernetDialogButtons = new String[]{"Test Ethernet Again", "Skip Ethernet Test"};
                                        ethernetTestSkipped = (JOptionPane.showOptionDialog(qaHelperWindow, "<html>"
                                                + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <b>No Ethernet Cable Detected</b>"
                                                + "<br/><br/>"
                                                + new TwemojiImage("ElectricPlug", qaHelperWindow).toImgTag("left") + " <i><u>PLUG IN</u> an Ethernet cable and then click \"Test Ethernet Again\".</i>"
                                                + "<br/><br/>"
                                                + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " If an Ethernet cable is plugged in and is not detected after multiple<br/>"
                                                + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " attempts, click \"Skip Ethernet Test\" and <u>CONSULT AN INSTRUCTOR</u>."
                                                + "</html>", "QA Helper  —  No Ethernet Cable Detected", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("SatelliteAntenna", qaHelperWindow).toImageIcon(32), plugInEthernetDialogButtons, plugInEthernetDialogButtons[0]) != JOptionPane.YES_OPTION);
                                        loadingWindow.setAlwaysOnTop(true);

                                        if (ethernetTestSkipped) {
                                            break;
                                        } else {
                                            TimeUnit.SECONDS.sleep(2);
                                        }
                                    }
                                }

                                if (!ethernetCableConnected) {
                                    break;
                                }

                                for (String thisEthernetNetworkDeviceID : ethernetNetworkDeviceIDs) {
                                    for (int ethernetTestAttempt = 0; ethernetTestAttempt < 5; ethernetTestAttempt++) {
                                        String thisWindowsEthernetNetworkDeviceIP = (isWindows ? new CommandReader(new String[]{"\\Windows\\System32\\netsh.exe", "interface", "ipv4", "show", "addresses", thisEthernetNetworkDeviceID}).getFirstOutputLineContaining("IP Address:").replace("IP Address:", "").trim() : "");

                                        // Can't only check for "Sent = 1, Received = 1" from ping on Windows because "Destination host unreachable" error will show no packet loss.
                                        connectedToCompanySiteViaEthernet = (new CommandReader((isLinux ? new String[]{"/bin/ping", "-I", thisEthernetNetworkDeviceID, "-W", "2", "-c", "1", "www." + osCompanySiteName}
                                                : (isWindows ? new String[]{"\\Windows\\System32\\PING.EXE", "-S", thisWindowsEthernetNetworkDeviceIP, "-w", "2", "-n", "1", "www." + osCompanySiteName}
                                                : new String[]{"/sbin/ping", "-b", thisEthernetNetworkDeviceID, "-t", "2", "-c", "1", "www." + osCompanySiteName}))).getOutputLinesContaining((isWindows ? new String[]{"TTL=", "Sent = 1, Received = 1", "round trip times"} : new String[]{"ttl=", "1 packets transmitted, 1 ", "min/avg/max"})).length == 3);

                                        connectedToGoogleViaEthernet = (new CommandReader((isLinux ? new String[]{"/bin/ping", "-I", thisEthernetNetworkDeviceID, "-W", "2", "-c", "1", "www.google.com"}
                                                : (isWindows ? new String[]{"\\Windows\\System32\\PING.EXE", "-S", thisWindowsEthernetNetworkDeviceIP, "-w", "2", "-n", "1", "www.google.com"}
                                                : new String[]{"/sbin/ping", "-b", thisEthernetNetworkDeviceID, "-t", "2", "-c", "1", "www.google.com"}))).getOutputLinesContaining((isWindows ? new String[]{"TTL=", "Sent = 1, Received = 1", "round trip times"} : new String[]{"ttl=", "1 packets transmitted, 1 ", "min/avg/max"})).length == 3);

                                        if (connectedToCompanySiteViaEthernet || connectedToGoogleViaEthernet) {
                                            ethernetTestPassed = true;
                                            break;
                                        } else {
                                            TimeUnit.SECONDS.sleep(1);
                                        }
                                    }

                                    if (ethernetTestPassed) {
                                        break;
                                    }
                                }

                                if (ethernetTestPassed) {
                                    break;
                                } else {
                                    loadingWindow.setAlwaysOnTop(false);
                                    playAlertSound("error");
                                    String[] failedViaEthernetDialogButtons = new String[]{"Test Ethernet Again", "Skip Ethernet Test"};
                                    ethernetTestSkipped = (JOptionPane.showOptionDialog(qaHelperWindow, "<html>"
                                            + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b>Failed to Connect to the Internet via Ethernet</b>"
                                            + "<br/><br/>"
                                            + new TwemojiImage("Locked", qaHelperWindow).toImgTag("left") + " <i>Make sure the Ethernet cable is <u>SECURELY CONNECTED</u> or connect<br/>"
                                            + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " a <u>DIFFERENT</u> Ethernet cable and then click \"Test Ethernet Again\".</i>"
                                            + "<br/><br/>"
                                            + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " If the Ethernet cable is securely connected and this test fails after multiple<br/>"
                                            + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " attempts, click \"Skip Ethernet Test\" and <u>CONSULT AN INSTRUCTOR</u>."
                                            + "</html>", "QA Helper  —  Failed to Connect via Ethernet", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("SatelliteAntenna", qaHelperWindow).toImageIcon(32), failedViaEthernetDialogButtons, failedViaEthernetDialogButtons[0]) != JOptionPane.YES_OPTION);
                                    loadingWindow.setAlwaysOnTop(true);

                                    if (ethernetTestSkipped) {
                                        break;
                                    } else {
                                        TimeUnit.SECONDS.sleep(2);
                                    }
                                }
                            }
                        }

                        if (hasWiFiCard && !wiFiTestPassed && !wiFiTestSkipped) {
                            publish("wifi");

                            for (;;) {
                                for (;;) {
                                    if (isLinux) {
                                        wiFiIsOff = new CommandReader(new String[]{"/usr/bin/nmcli", "radio", "wifi"}).getFirstOutputLine().equals("disabled");

                                        if (wiFiIsOff) {
                                            try {
                                                Runtime.getRuntime().exec(new String[]{"/usr/sbin/rfkill", "unblock", "all"}).waitFor();
                                            } catch (IOException | InterruptedException rfkillUnblockException) {
                                                if (isTestMode) {
                                                    System.out.println("rfkillUnblockException: " + rfkillUnblockException);
                                                }
                                            }

                                            try {
                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/nmcli", "radio", "all", "on"}).waitFor();
                                                wiFiIsOff = new CommandReader(new String[]{"/usr/bin/nmcli", "radio", "wifi"}).getFirstOutputLine().equals("disabled");
                                            } catch (IOException | InterruptedException turnOnWiFiException) {
                                                if (isTestMode) {
                                                    System.out.println("turnOnWiFiException: " + turnOnWiFiException);
                                                }
                                            }
                                        }

                                        if (!wiFiIsOff && hasEthernetPort && !isLinuxBootedFromNetwork) {
                                            // Only disable Ethernet when Wi-Fi actually got enabled.
                                            // This fixes an issue where Ethernet could stay disabled after the test on some computers that don't allow Wi-Fi to get enabled while an Ethernet cable is plugged in.
                                            ethernetNetworkDeviceIDs.forEach((thisEthernetNetworkDeviceID) -> {
                                                if (new CommandReader(new String[]{"/usr/bin/nmcli", "device", "status"}).getFirstOutputLineContaining(thisEthernetNetworkDeviceID).contains(" connected ")) {
                                                    try {
                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/nmcli", "device", "disconnect", thisEthernetNetworkDeviceID}).waitFor();
                                                    } catch (IOException | InterruptedException turnOffEthernetException) {
                                                        if (isTestMode) {
                                                            System.out.println("turnOffEthernetException: " + turnOffEthernetException);
                                                        }
                                                    }
                                                }
                                            });
                                        }
                                    } else if (isMacOS) {
                                        for (String thisWiFiNetworkDeviceID : wiFiNetworkDeviceIDs) {
                                            wiFiIsOff = new CommandReader(new String[]{"/usr/sbin/networksetup", "-getairportpower", thisWiFiNetworkDeviceID}).getFirstOutputLine().endsWith("): Off");

                                            if (wiFiIsOff) {
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"/usr/sbin/networksetup", "-setairportpower", thisWiFiNetworkDeviceID, "on"}).waitFor();
                                                    wiFiIsOff = new CommandReader(new String[]{"/usr/sbin/networksetup", "-getairportpower", thisWiFiNetworkDeviceID}).getFirstOutputLine().endsWith("): Off");
                                                } catch (IOException | InterruptedException turnOnWiFiException) {
                                                    if (isTestMode) {
                                                        System.out.println("turnOnWiFiException: " + turnOnWiFiException);
                                                    }
                                                }
                                            }

                                            if (!wiFiIsOff) {
                                                break;
                                            }
                                        }
                                    } else if (isWindows) {
                                        wiFiIsOff = !new CommandReader(new String[]{"\\Windows\\System32\\netsh.exe", "wlan", "show", "interfaces"}).getFirstOutputLineContaining("ware Off").isEmpty();

                                        if (wiFiIsOff) {
                                            wiFiNetworkDeviceIDs.forEach(thisWiFiNetworkDeviceID -> {
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Enable-NetAdapter '" + thisWiFiNetworkDeviceID + "'"}).waitFor();
                                                } catch (IOException | InterruptedException enableWiFiAdapterException) {
                                                    if (isTestMode) {
                                                        System.out.println("enableWiFiAdapterException: " + enableWiFiAdapterException);
                                                    }
                                                }
                                            });
                                        }
                                    }

                                    if (wiFiIsOff) {
                                        loadingWindow.setAlwaysOnTop(false);
                                        playAlertSound("error");
                                        String[] turnOnWiFiDialogButtons = new String[]{"Test Wi-Fi Again", "Skip Wi-Fi Test"};
                                        wiFiTestSkipped = (JOptionPane.showOptionDialog(qaHelperWindow, "<html>"
                                                + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <b>Wi-Fi is DISABLED</b>"
                                                + "<br/><br/>"
                                                + new TwemojiImage("IndexPointingUp", qaHelperWindow).toImgTag("left") + " <i>Manually <u>TURN ON</u> any Wi-Fi switches, buttons, or software settings and then click \"Test Wi-Fi Again\"."
                                                + "<br/><br/>"
                                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " If all Wi-Fi switches, buttons, and software settings are turned on,<br/>"
                                                + (isLinuxBootedFromNetwork
                                                        ? new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " you <u>MAY NOT BE ABLE TO TEST Wi-Fi</u> since you are currently booted via Ethernet."
                                                        + "<br/><br/>"
                                                        + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <u>DO NOT DISCONNECT</u> the Ethernet cable since that will freeze this computer and you will need to reboot."
                                                        : new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " <u>DISCONNECT</u> the Ethernet cable and then click \"Test Wi-Fi Again\".")
                                                + "</i>"
                                                + "<br/><br/>"
                                                + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " If all Wi-Fi switches, buttons, and software settings are turned on "
                                                + (isLinuxBootedFromNetwork
                                                        ? "and this test fails after multiple attempts,<br/>"
                                                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " click \"Skip Wi-Fi Test\" and then test Wi-Fi again after you're booted into the installed OS."
                                                        : "and the Ethernet cable is disconnected and<br/>"
                                                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " this test fails after multiple attempts, click \"Skip Wi-Fi Test\" and <u>CONSULT AN INSTRUCTOR</u>.")
                                                + "</html>", "QA Helper  —  Wi-Fi Disabled", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("SatelliteAntenna", qaHelperWindow).toImageIcon(32), turnOnWiFiDialogButtons, turnOnWiFiDialogButtons[0]) != JOptionPane.YES_OPTION);
                                        loadingWindow.setAlwaysOnTop(true);

                                        if (wiFiTestSkipped) {
                                            break;
                                        } else {
                                            TimeUnit.SECONDS.sleep(2);
                                        }
                                    } else {
                                        break;
                                    }
                                }

                                if (wiFiIsOff) {
                                    break;
                                }

                                String[] wiFiNetworks = new String[0];
                                numberOfWiFiNetworksDetected = 0;

                                for (int detectWiFiNetworksAttempt = 0; detectWiFiNetworksAttempt < 5; detectWiFiNetworksAttempt++) {
                                    wiFiNetworks = (isLinux
                                            ? new CommandReader(new String[]{"/usr/bin/nmcli", "device", "wifi", "list"}).getOutputLines()
                                            : (isWindows
                                                    ? new CommandReader(new String[]{"\\Windows\\System32\\netsh.exe", "wlan", "show", "networks"}).getOutputLinesContaining("SSID ")
                                                    : new CommandReader(new String[]{"/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport", "-s"}).getOutputLines()));

                                    numberOfWiFiNetworksDetected = (wiFiNetworks.length - (isWindows ? 0 : 1));
                                    if (numberOfWiFiNetworksDetected < 0) {
                                        numberOfWiFiNetworksDetected = 0;
                                    }

                                    if (numberOfWiFiNetworksDetected > 3) {
                                        break;
                                    }

                                    TimeUnit.SECONDS.sleep(2); // Wait to see if we can get more wifi networks on another attempt
                                }

                                connectedWiFiNetworkName = "";

                                if (isLinux) {
                                    for (String thisWiFiNetworkLine : wiFiNetworks) {
                                        if (thisWiFiNetworkLine.startsWith("*") && thisWiFiNetworkLine.contains(" Infra ")) {
                                            String thisWiFiNetworkName = thisWiFiNetworkLine.substring(1, thisWiFiNetworkLine.indexOf(" Infra ")).trim();
                                            if (!thisWiFiNetworkName.endsWith("--")) {
                                                if (wiFiNetworks[0].replaceAll("\\s{2,}", " ").contains(" BSSID SSID ")) {
                                                    thisWiFiNetworkName = thisWiFiNetworkName.substring(17).trim();
                                                }
                                                connectedWiFiNetworkName = thisWiFiNetworkName;
                                                break;
                                            }
                                        }
                                    }
                                } else if (isMacOS) {
                                    for (String thisWiFiNetworkDeviceID : wiFiNetworkDeviceIDs) {
                                        String connectedWiFiNetworkStatus = new CommandReader(new String[]{"/usr/sbin/networksetup", "-getairportnetwork", thisWiFiNetworkDeviceID}).getFirstOutputLine();
                                        if (connectedWiFiNetworkStatus.startsWith("Current Wi-Fi Network: ")) {
                                            connectedWiFiNetworkName = connectedWiFiNetworkStatus.substring(connectedWiFiNetworkStatus.indexOf(": ") + 2);
                                            break;
                                        }
                                    }
                                } else if (isWindows) {
                                    String connectedSSID = new CommandReader(new String[]{"\\Windows\\System32\\netsh.exe", "wlan", "show", "interfaces"}).getFirstOutputLineContaining("SSID");
                                    if (!connectedSSID.isEmpty()) {
                                        connectedWiFiNetworkName = connectedSSID.substring(connectedSSID.indexOf(": ") + 2);
                                    }
                                }

                                if (connectedWiFiNetworkName.isEmpty()) {
                                    boolean attemptedToConnectToWiFiNetwork = false;

                                    if (isLinux) {
                                        for (String thisWiFiNetworkLine : wiFiNetworks) {
                                            if (thisWiFiNetworkLine.contains(" Infra ") && thisWiFiNetworkLine.trim().endsWith("--")) {
                                                String thisWiFiNetworkName = thisWiFiNetworkLine.substring(0, thisWiFiNetworkLine.indexOf(" Infra ")).trim();
                                                if (!thisWiFiNetworkName.endsWith("--")) {
                                                    if (wiFiNetworks[0].replaceAll("\\s{2,}", " ").contains(" BSSID SSID ")) {
                                                        thisWiFiNetworkName = thisWiFiNetworkName.substring(17).trim();
                                                    }
                                                    try {
                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/nmcli", "device", "wifi", "connect", thisWiFiNetworkName}).waitFor();
                                                        attemptedToConnectToWiFiNetwork = true;
                                                        break;
                                                    } catch (IOException | InterruptedException connectToWiFiNetworkException) {
                                                        if (isTestMode) {
                                                            System.out.println("connectToWiFiNetworkException: " + connectToWiFiNetworkException);
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    } else if (isMacOS) {
                                        for (String thisWiFiNetworkLine : wiFiNetworks) {
                                            if (thisWiFiNetworkLine.trim().endsWith("NONE")) {
                                                String thisWiFiNetworkName = thisWiFiNetworkLine.substring(0, 33).trim();
                                                for (String thisWiFiNetworkDeviceID : wiFiNetworkDeviceIDs) {
                                                    try {
                                                        Runtime.getRuntime().exec(new String[]{"/usr/sbin/networksetup", "-setairportnetwork", thisWiFiNetworkDeviceID, thisWiFiNetworkName}).waitFor();
                                                        attemptedToConnectToWiFiNetwork = true;
                                                        break;
                                                    } catch (IOException | InterruptedException connectToWiFiNetworkException) {
                                                        if (isTestMode) {
                                                            System.out.println("connectToWiFiNetworkException: " + connectToWiFiNetworkException);
                                                        }
                                                    }
                                                }

                                                if (attemptedToConnectToWiFiNetwork) {
                                                    break;
                                                }
                                            }
                                        }
                                    } else if (isWindows) {
                                        // TODO: Can I connect to a Wi-Fi network on Windows? Need to create a profile?
                                    }

                                    if (attemptedToConnectToWiFiNetwork) {
                                        if (isLinux) {
                                            wiFiNetworks = new CommandReader(new String[]{"/usr/bin/nmcli", "device", "wifi", "list"}).getOutputLines();
                                            numberOfWiFiNetworksDetected = (wiFiNetworks.length - 1);

                                            for (String thisWiFiNetworkLine : wiFiNetworks) {
                                                if (thisWiFiNetworkLine.startsWith("*") && thisWiFiNetworkLine.contains(" Infra ")) {
                                                    String thisWiFiNetworkName = thisWiFiNetworkLine.substring(1, thisWiFiNetworkLine.indexOf(" Infra ")).trim();
                                                    if (!thisWiFiNetworkName.endsWith("--")) {
                                                        if (wiFiNetworks[0].replaceAll("\\s{2,}", " ").contains(" BSSID SSID ")) {
                                                            thisWiFiNetworkName = thisWiFiNetworkName.substring(17).trim();
                                                        }
                                                        connectedWiFiNetworkName = thisWiFiNetworkName;
                                                        break;
                                                    }
                                                }
                                            }
                                        } else if (isMacOS) {
                                            for (String thisWiFiNetworkDeviceID : wiFiNetworkDeviceIDs) {
                                                String connectedWiFiNetworkStatus = new CommandReader(new String[]{"/usr/sbin/networksetup", "-getairportnetwork", thisWiFiNetworkDeviceID}).getFirstOutputLine();
                                                if (connectedWiFiNetworkStatus.startsWith("Current Wi-Fi Network: ")) {
                                                    connectedWiFiNetworkName = connectedWiFiNetworkStatus.substring(connectedWiFiNetworkStatus.indexOf(": ") + 2);
                                                    break;
                                                }
                                            }

                                            if (!connectedWiFiNetworkName.isEmpty()) {
                                                boolean gotWiFiIP = false;
                                                for (int getIPaddressAttempt = 0; getIPaddressAttempt < 5; getIPaddressAttempt++) {
                                                    for (String thisWiFiNetworkDeviceID : wiFiNetworkDeviceIDs) {
                                                        if (new CommandReader(new String[]{"/usr/sbin/ipconfig", "getifaddr", thisWiFiNetworkDeviceID}).getFirstOutputLine().isEmpty()) {
                                                            TimeUnit.SECONDS.sleep(2); // Wait for Wi-Fi to connect
                                                        } else {
                                                            gotWiFiIP = true;
                                                            break;
                                                        }
                                                    }

                                                    if (gotWiFiIP) {
                                                        break;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }

                                if (!connectedWiFiNetworkName.isEmpty()) {
                                    for (int wiFiTestAttempt = 0; wiFiTestAttempt < 5; wiFiTestAttempt++) {
                                        for (String thisWiFiNetworkDeviceID : wiFiNetworkDeviceIDs) {
                                            String thisWindowsWiFiNetworkDeviceIP = (isWindows ? new CommandReader(new String[]{"\\Windows\\System32\\netsh.exe", "interface", "ipv4", "show", "addresses", thisWiFiNetworkDeviceID}).getFirstOutputLineContaining("IP Address:").replace("IP Address:", "").trim() : "");

                                            // Can't only check for "Sent = 1, Received = 1" from ping on Windows because "Destination host unreachable" error will show no packet loss.
                                            connectedToCompanySiteViaWiFi = (new CommandReader((isLinux ? new String[]{"/bin/ping", "-I", thisWiFiNetworkDeviceID, "-W", "2", "-c", "1", "www." + osCompanySiteName}
                                                    : (isWindows ? new String[]{"\\Windows\\System32\\PING.EXE", "-S", thisWindowsWiFiNetworkDeviceIP, "-w", "2", "-n", "1", "www." + osCompanySiteName}
                                                    : new String[]{"/sbin/ping", "-b", thisWiFiNetworkDeviceID, "-t", "2", "-c", "1", "www." + osCompanySiteName}))).getOutputLinesContaining((isWindows ? new String[]{"TTL=", "Sent = 1, Received = 1", "round trip times"} : new String[]{"ttl=", "1 packets transmitted, 1 ", "min/avg/max"})).length == 3);

                                            connectedToGoogleViaWiFi = (new CommandReader((isLinux ? new String[]{"/bin/ping", "-I", thisWiFiNetworkDeviceID, "-W", "2", "-c", "1", "www.google.com"}
                                                    : (isWindows ? new String[]{"\\Windows\\System32\\PING.EXE", "-S", thisWindowsWiFiNetworkDeviceIP, "-w", "2", "-n", "1", "www.google.com"}
                                                    : new String[]{"/sbin/ping", "-b", thisWiFiNetworkDeviceID, "-t", "2", "-c", "1", "www.google.com"}))).getOutputLinesContaining((isWindows ? new String[]{"TTL=", "Sent = 1, Received = 1", "round trip times"} : new String[]{"ttl=", "1 packets transmitted, 1 ", "min/avg/max"})).length == 3);

                                            if (connectedToCompanySiteViaWiFi || connectedToGoogleViaWiFi) {
                                                wiFiTestPassed = true;
                                                break;
                                            } else {
                                                TimeUnit.SECONDS.sleep(1);
                                            }
                                        }

                                        if (wiFiTestPassed) {
                                            break;
                                        }
                                    }
                                }

                                if (isWindows && !wiFiTestPassed && connectedWiFiNetworkName.isEmpty() && numberOfWiFiNetworksDetected > 0) {
                                    wiFiTestPassed = true; // Allow Windows to pass if not connected to Wi-Fi network, but networks were detected (because we're not automatically connecting to a Wi-Fi network).
                                }
                                if (isLinuxBootedFromNetwork && !wiFiTestPassed && !connectedWiFiNetworkName.isEmpty()) {
                                    wiFiTestPassed = true;
                                }

                                if (wiFiTestPassed) {
                                    break;
                                } else {
                                    loadingWindow.setAlwaysOnTop(false);
                                    playAlertSound("error");
                                    String[] failedViaWiFiDialogButtons = new String[]{"Test Wi-Fi Again", "Skip Wi-Fi Test"};
                                    wiFiTestSkipped = (JOptionPane.showOptionDialog(qaHelperWindow, "<html>"
                                            + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b>Failed to Connect to the Internet via Wi-Fi</b>"
                                            + "<br/><br/>"
                                            + "<i>"
                                            + (isLinuxBootedFromNetwork
                                                    ? new TwemojiImage("IndexPointingUp", qaHelperWindow).toImgTag("left") + " Since you are currently booted via Ethernet, you <u>MAY NOT BE ABLE TO TEST Wi-Fi</u>."
                                                    + "<br/><br/>"
                                                    + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <u>DO NOT DISCONNECT</u> the Ethernet cable since that will freeze this computer and you will need to reboot.</i>"
                                                    + "<br/><br/>"
                                                    + "If this test fails after multiple attempts, click \"Skip Wi-Fi Test\" and then test Wi-Fi again after you're booted into the installed OS."
                                                    : new TwemojiImage("IndexPointingUp", qaHelperWindow).toImgTag("left") + " <u>MANUALLY CONNECT</u> to a" + (connectedWiFiNetworkName.isEmpty() ? "" : " <u>DIFFERENT</u>") + " Wi-Fi network and then click \"Test Wi-Fi Again\".</i>"
                                                    + "<br/><br/>"
                                                    + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " If this computer is connected to a known good Wi-Fi network and this test fails<br/>"
                                                    + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " after multiple attempts, click \"Skip Wi-Fi Test\" and <u>CONSULT AN INSTRUCTOR</u>.")
                                            + "</html>", "QA Helper  —  Failed to Connect via Wi-Fi", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("SatelliteAntenna", qaHelperWindow).toImageIcon(32), failedViaWiFiDialogButtons, failedViaWiFiDialogButtons[0]) != JOptionPane.YES_OPTION);
                                    loadingWindow.setAlwaysOnTop(true);

                                    if (wiFiTestSkipped) {
                                        break;
                                    } else {
                                        TimeUnit.SECONDS.sleep(2);
                                    }
                                }
                            }
                        }
                    } while ((hasWiFiCard && !wiFiTestPassed && !wiFiTestSkipped) || (hasEthernetPort && !ethernetTestPassed && !ethernetTestSkipped));

                    if (isLinux && hasWiFiCard && hasEthernetPort) {
                        ethernetNetworkDeviceIDs.forEach((thisEthernetNetworkDeviceID) -> {
                            if (!new CommandReader(new String[]{"/usr/bin/nmcli", "device", "status"}).getFirstOutputLineContaining(thisEthernetNetworkDeviceID).contains(" connected ")) {
                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/nmcli", "device", "connect", thisEthernetNetworkDeviceID}).waitFor();
                                } catch (IOException | InterruptedException turnOnEthernetException) {
                                    if (isTestMode) {
                                        System.out.println("turnOnEthernetException: " + turnOnEthernetException);
                                    }
                                }
                            }
                        });
                    }

                    String resultsOutput = "<html>";

                    if (hasWiFiCard) {
                        resultsOutput += new TwemojiImage((wiFiTestPassed ? "CheckMarkButton" : "CrossMark"), qaHelperWindow).toImgTag("left") + " <b style='color: " + (wiFiTestPassed ? successColorHTML : errorColorHTML) + "'>Wi-Fi Test " + (wiFiTestPassed ? "Passed" : ((wiFiIsOff && isLinuxBootedFromNetwork) ? "Unknown" : "Failed")) + "</b>";
                    }

                    if (hasEthernetPort) {
                        resultsOutput += (hasWiFiCard ? "<br/><br/>" : "") + new TwemojiImage((ethernetTestPassed ? "CheckMarkButton" : "CrossMark"), qaHelperWindow).toImgTag("left") + " <b style='color: " + (ethernetTestPassed ? successColorHTML : errorColorHTML) + "'>Ethernet Test " + (ethernetTestPassed ? "Passed" : "Failed") + "</b>";
                    } else {
                        resultsOutput += (hasWiFiCard ? "<br/><br/>" : "") + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>No Ethernet Port Detected</b>";
                    }

                    if (!hasWiFiCard) {
                        resultsOutput += "<br/><br/>" + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>No Wi-Fi Card Detected</b>";
                    }

                    if (hasWiFiCard) {
                        resultsOutput += "<br/><br/><br/><b>Wi-Fi Test Results:</b> " + new TwemojiImage((wiFiTestPassed ? "CheckMarkButton" : "CrossMark"), qaHelperWindow).toImgTag("inline") + " <i style='color: " + (wiFiTestPassed ? successColorHTML : errorColorHTML) + "'>" + (wiFiTestPassed ? "PASSED" : ((wiFiIsOff && isLinuxBootedFromNetwork) ? "UNKNOWN" : "FAILED")) + "</i><br/><br/>";

                        if (wiFiIsOff) {
                            resultsOutput += new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " Wi-Fi is <i>DISABLED</i>";

                            if (isLinuxBootedFromNetwork) {
                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i>TEST WI-FI AGAIN WHEN BOOTED INTO INSTALLED OS</i>";
                            } else {
                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i>TURN ON WI-FI AND TRY AGAIN</i>";
                            }
                        } else {
                            if (connectedToCompanySiteViaWiFi || connectedToGoogleViaWiFi) {
                                resultsOutput += new TwemojiImage("ThumbsUp", qaHelperWindow).toImgTag("left") + " " + ((connectedToCompanySiteViaWiFi && connectedToGoogleViaWiFi)
                                        ? "Successfully Connected to " + osCompanySiteName + " &amp; Google.com via Wi-Fi<br/><br/>" : ((connectedToCompanySiteViaWiFi ? "Successfully Connected to " + osCompanySiteName + " via Wi-Fi<br/><br/>" : "")
                                        + (connectedToGoogleViaWiFi ? "Successfully Connected to Google.com via Wi-Fi<br/><br/>" : "")));
                            } else if (!wiFiTestPassed) {
                                resultsOutput += new TwemojiImage("ThumbsDown", qaHelperWindow).toImgTag("left") + " Failed to Connect to Both " + osCompanySiteName + " &amp; Google.com via Wi-Fi<br/><br/>";
                            }

                            resultsOutput += (connectedWiFiNetworkName.isEmpty()
                                    ? (isWindows ? ""
                                            : new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " Failed to Connect to a Wi-Fi Network<br/><br/>")
                                    : new TwemojiImage("AntennaBars", qaHelperWindow).toImgTag("left") + " Connected to Wi-Fi Network: " + connectedWiFiNetworkName + "<br/><br/>");

                            resultsOutput += new TwemojiImage("MagnifyingGlassTiltedLeft", qaHelperWindow).toImgTag("left") + " Number of Wi-Fi Networks Detected: " + numberOfWiFiNetworksDetected;

                            if (numberOfWiFiNetworksDetected == 0) {
                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i>MOVE CLOSER TO WI-FI ACCESS POINT AND TRY AGAIN</i>";
                            } else if (connectedWiFiNetworkName.isEmpty() && !isWindows) {
                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i> MANUALLY CONNECT TO A WI-FI NETWORK AND TRY AGAIN</i>";
                            } else if (!wiFiTestPassed && !connectedWiFiNetworkName.isEmpty()) {
                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i>MANUALLY CONNECT TO A DIFFERENT WI-FI NETWORK AND TRY AGAIN</i>";
                            }
                        }

                        if (wiFiNetworkDeviceIDs.size() > 1) {
                            resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i>MULTIPLE WI-FI CARDS DETECTED - ONLY ONE WI-FI CARD HAS BEEN TESTED</i>";
                        }
                    }

                    if (hasEthernetPort) {
                        resultsOutput += "<br/><br/><br/><b>Ethernet Test Results:</b> " + new TwemojiImage((ethernetTestPassed ? "CheckMarkButton" : "CrossMark"), qaHelperWindow).toImgTag("inline") + " <i style='color: " + (ethernetTestPassed ? successColorHTML : errorColorHTML) + "'>" + (ethernetTestPassed ? "PASSED" : "FAILED") + "</i><br/><br/>";

                        if (ethernetTestPassed) {
                            resultsOutput += new TwemojiImage("ThumbsUp", qaHelperWindow).toImgTag("left") + " " + ((connectedToCompanySiteViaEthernet && connectedToGoogleViaEthernet)
                                    ? "Successfully Connected to " + osCompanySiteName + " &amp; Google.com via Ethernet" : ((connectedToCompanySiteViaEthernet ? "Successfully Connected to " + osCompanySiteName + " via Ethernet" : "")
                                    + (connectedToGoogleViaEthernet ? "Successfully Connected to Google.com via Ethernet" : "")));
                        } else if (ethernetCableConnected) {
                            resultsOutput += new TwemojiImage("ThumbsDown", qaHelperWindow).toImgTag("left") + " Failed to Connect to Both " + osCompanySiteName + " &amp; Google.com via Ethernet";
                        } else {
                            resultsOutput += new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " No Ethernet Cable Detected"
                                    + "<br/><br/>"
                                    + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <i>PLUG IN AN ETHERNET CABLE AND TRY AGAIN</i>";
                        }

                        if (ethernetNetworkDeviceIDs.size() > 1) {
                            if (isLinuxBootedFromNetwork) {
                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>MULTIPLE ETHERNET PORTS DETECTED</b><br/>"
                                        + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <i>DO NOT CHANGE ETHERNET PORTS WHILE YOU ARE IN THIS INSTALLATION ENVIRONMENT</i><br/>"
                                        + new TwemojiImage("RepeatButton", qaHelperWindow).toImgTag("left") + " <i>TEST ETHERNET AGAIN WHEN BOOTED INTO INSTALLED OS</i>";
                            } else if (!isMacOS || !computerSpecs.getFullCPU().startsWith("Apple") || computerSpecs.getFullModel().contains("Mac Pro")) {
                                // Apple Silicon Macs always show multiple Ethernet ports, but only the Apple Silicon Mac Pro actually has multiple physical Ethernet ports, so only show this note if NOT an Apple Silicon Mac or IF IS an Apple Silicon Mac Pro.

                                resultsOutput += "<br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>MULTIPLE ETHERNET PORTS DETECTED</b><br/>"
                                        + new TwemojiImage("ShuffleTracksButton", qaHelperWindow).toImgTag("left") + " <i>TEST EACH ETHERNET PORT BY RUNNING THIS TEST<br/>"
                                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " MULTIPLE TIMES WITH ONLY ONE CABLE PLUGGED IN</i>";
                            }
                        }
                    } else {
                        resultsOutput += "<br/><br/><br/>" + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>NO ETHERNET PORT DETECTED</b>";
                    }

                    if (!hasWiFiCard) {
                        resultsOutput += "<br/><br/><br/>"
                                + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>NO WI-FI CARD DETECTED</b>"
                                + "<br/><br/>"
                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>IF THIS COMPUTER SHOULD HAVE WI-FI - MAKE SURE WI-FI IS TURNED ON AND TRY AGAIN</i>";
                    }

                    if ((hasWiFiCard && !connectedWiFiNetworkName.isEmpty() && !wiFiTestPassed) || (hasEthernetPort && ethernetCableConnected && !ethernetTestPassed)) {
                        resultsOutput += "<br/><br/><br/>" + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR SINCE INTERNET TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                    }

                    resultsOutput += "</html>";

                    return resultsOutput;
                }

                @Override
                protected void process(java.util.List<String> tasks) {
                    tasks.forEach((thisTask) -> {
                        if (thisTask.equals("wifi")) {
                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Testing Wi-Fi", "Testing", "SatelliteAntenna");
                        } else if (thisTask.equals("ethernet")) {
                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Testing Ethernet", "Testing", "SatelliteAntenna");
                        }
                    });
                }

                @Override
                protected void done() {
                    loadingWindow.closeWindow();

                    try {
                        String internetTestResult = get();

                        String internetTestTitle = internetTestResult.substring(0, internetTestResult.indexOf("<br/><br/><br/>")).replace("&nbsp;", " ").replace("<br/><br/>", " & ").replaceAll("\\<[^>]*>", "").trim().replaceAll("\\s{2,}", " ");
                        boolean didFullPass = internetTestTitle.contains("Test Passed") && !internetTestTitle.contains("Test Failed") && !internetTestTitle.contains("Test Unknown");
                        boolean didPartialPass = internetTestTitle.contains("Test Passed") && (internetTestTitle.contains("Test Failed") || internetTestTitle.contains("Test Unknown"));

                        if ((computerSpecs.isLaptop() && internetTestTitle.contains("No Wi-Fi Card Detected"))
                                || (!computerSpecs.isLaptop() && internetTestTitle.contains("No Ethernet Port Detected"))) {
                            didFullPass = false;
                        }

                        playAlertSound(didFullPass ? "success" : "error");
                        JOptionPane.showMessageDialog(qaHelperWindow, internetTestResult, "QA Helper  —  " + internetTestTitle, (didFullPass ? JOptionPane.INFORMATION_MESSAGE : (didPartialPass ? JOptionPane.WARNING_MESSAGE : JOptionPane.ERROR_MESSAGE)), new TwemojiImage("SatelliteAntenna", qaHelperWindow).toImageIcon());

                        if (didFullPass && !isInternetVerified && btnVerifyInternet.isVisible() && btnVerifyInternet.isEnabled()) {
                            btnVerifyInternetActionPerformed(null);
                        }
                    } catch (HeadlessException | InterruptedException | ExecutionException finishInternetTestException) {
                        if (isTestMode) {
                            System.out.println("finishInternetTestException: " + finishInternetTestException);
                        }
                    }

                    setActionsEnabled(true);
                }
            }).execute();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestInternetActionPerformed

    private void btnVerifyInternetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyInternetActionPerformed
        if ((actionsEnabled || (evt == null)) && !isWindowsPE) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isInternetVerified ? "UNVERIFY" : "verify") + "</i> internet connectivity?</b></html>", "QA Helper  —  Confirm " + (isInternetVerified ? "Unverify" : "Verify") + " Internet", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isInternetVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isInternetVerified = !isInternetVerified;

                boolean hasWiFi = computerSpecs.getWireless().contains("Wi-Fi");

                writeToHelperLogFile("Test: Internet " + (hasWiFi ? "" : "(No Wi-Fi) ") + (isInternetVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyInternet.setText((isInternetVerified ? "Verified" : "Verify"));
                btnVerifyInternet.setFont(btnVerifyInternet.getFont().deriveFont((isInternetVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyInternet.setForeground(isInternetVerified ? verifiedColor : defaultColor);
                btnVerifyInternet.setBorderPainted(!isInternetVerified);

                new LinuxAutoScripts("Internet " + (isInternetVerified ? "Verified" : "Unverified"), adminPassword);

                if (computerSpecs.getWireless().equals("N/A")) {
                    boolean loginAndTasksWasHidden = hideLoginAndTasks;
                    if (loginAndTasksWasHidden) {
                        hideLoginAndTasks = false;
                    }

                    displayComputerSpecs();

                    if (loginAndTasksWasHidden) {
                        hideLoginAndTasks = true;
                    }
                }

                focusNextTestTaskVerifyButton(btnVerifyInternet);
            } else {
                focusNextTestTaskVerifyButton(btnTestInternet);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyInternetActionPerformed

    private void btnTestScreenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestScreenActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            boolean shouldDoAnyScreenTest = true;
            boolean shouldDoTouchscreenTest = false;

            boolean hasTouchscreen = (computerSpecs != null && computerSpecs.hasTouchscreen());

            if (hasTouchscreen) {
                String[] screenTestOptionsDialogButtons = new String[]{"Start Solid Colors Screen Test…", "Start Touchscreen Test…", "Cancel"};
                if (didSolidColorsScreenTest && !didTouchscreenTest) {
                    screenTestOptionsDialogButtons = new String[]{"Start Touchscreen Test…", "Start Solid Colors Screen Test…", "Cancel"};
                }

                int screenTestOptionsDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html>"
                        + "<b>Since this computer has a touchscreen, the touchscreen functionality must be tested as well as checking the screen for any visual imperfections.</b>"
                        + "<br/><br/>"
                        + new TwemojiImage("FlagMauritius", qaHelperWindow).toImgTag("left") + " The \"Solid Colors Screen Test\" is used to check the screen for any visual imperfections."
                        + (didSolidColorsScreenTest ? "<br/>" + new TwemojiImage("CheckBoxWithCheck", qaHelperWindow).toImgTag("left") + " <b>You have performed the Solid Color Screen Test.</b>" : "")
                        + "<br/><br/>"
                        + new TwemojiImage("IndexPointingUp", qaHelperWindow).toImgTag("left") + " The \"Touchscreen Test\" is used to test the touchscreen functionality."
                        + (didTouchscreenTest ? "<br/>" + new TwemojiImage("CheckBoxWithCheck", qaHelperWindow).toImgTag("left") + " <b>You have performed the Touchscreen Test.</b>" : "")
                        + "<br/><br/><br/>"
                        + "<center>"
                        + "<i>You can perform these screen tests in any order, when you are done with one test you will be prompted to perform the other.</i>"
                        + "<br/><br/>"
                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>BOTH OF THESE SCREEN TESTS MUST BE PERFORMED AND PASSED BEFORE THE SCREEN IS VERIFIED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                        + "</center></html>", "QA Helper  —  Screen Test Options", JOptionPane.DEFAULT_OPTION, JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Laptop", qaHelperWindow).toImageIcon(), screenTestOptionsDialogButtons, screenTestOptionsDialogButtons[0]);

                String screenTestOptionsDialogResponseString = "Cancel";
                if (screenTestOptionsDialogResponse > -1) {
                    screenTestOptionsDialogResponseString = screenTestOptionsDialogButtons[screenTestOptionsDialogResponse];
                }

                shouldDoAnyScreenTest = (!screenTestOptionsDialogResponseString.equals("Cancel"));
                shouldDoTouchscreenTest = (screenTestOptionsDialogResponseString.contains("Touchscreen"));
            }

            if (shouldDoAnyScreenTest) {
                int screenTestPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow, "<html>"
                        + (shouldDoTouchscreenTest
                                ? "<b>Touchscreen Test starts out as a solid <i style='color: red; background-color: white'>&nbsp;Red&nbsp;</i> screen."
                                + "<br/>"
                                + "<i>Then, you must <u>touch every zone with your finger</u> to turn the whole screen <i style='color: green; background-color: white'>&nbsp;Green&nbsp;</i>.</b>"
                                + "<br/><br/>"
                                + new TwemojiImage("IndexPointingUp", qaHelperWindow).toImgTag("left") + " <i>YOU MUST TOUCH THE SCREEN WITH YOUR FINGER</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                + "<br/>"
                                + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " <i>DO NOT USE A MOUSE OR TOUCHPAD TO PERFORM THIS TEST</i> " + new TwemojiImage("ComputerMouse", qaHelperWindow).toImgTag("right")
                                + "<br/><br/>"
                                + new TwemojiImage("Stopwatch", qaHelperWindow).toImgTag("left") + " <b>You must finish this test <u>within 45 seconds</u>."
                                + "<br/>"
                                + new TwemojiImage("StopSign", qaHelperWindow).toImgTag("left") + " <i>After 45 seconds</i>, the touchscreen test will <u>timeout and end on its own</u>.</b>"
                                + "<br/><br/>"
                                + new TwemojiImage("Memo", qaHelperWindow).toImgTag("left") + " <i>MAKE NOTE OF ANY ZONES WHICH HAVE ISSUES OR CANNOT BE TURNED GREEN</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                + "<br/><br/><br/>"
                                + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>TOUCHSCREEN TEST PASSED IF:</b>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li><u>Each zone</u> turns <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> <u>immediately</u> the <u>first time you touch it</u>.</li>"
                                + "<li>You <u>touch every zone</u> and <u>turn the whole screen</u> <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> <u>within 45 seconds</u>.</li>"
                                + "</ul>"
                                + "<br/>"
                                + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>TOUCHSCREEN TEST FAILED IF:</b>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li><i>Any zone</i> needs to be <u>touched multiple times to turn Green</u>.</li>"
                                + "<li><i>Any zone</i> is <u>not able to be turned Green</u> by touching the screen.</li>"
                                + "</ul>"
                                + "<br/><center>"
                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF TOUCHSCREEN TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                : "<b>Solid Colors Screen Test will cycle through solid color <i style='color: red; background-color: white'>&nbsp;Red&nbsp;</i>, <i style='color: green; background-color: white'>&nbsp;Green&nbsp;</i>, <i style='color: blue; background-color: white'>&nbsp;Blue&nbsp;</i>, <i style='color: black; background-color: white'>&nbsp;Black&nbsp;</i>, and <i style='color: white; background-color: black'>&nbsp;White&nbsp;</i> screens.</b>"
                                + "<br/><br/>"
                                + "<i>When you start Solid Colors Screen Test, the whole screen will first turn solid <b style='color: red; background-color: white'>&nbsp;Red&nbsp;</b>.</i>"
                                + "<br/><br/>"
                                + new TwemojiImage("Eyes", qaHelperWindow).toImgTag("left") + " Examine the entire screen carefully, looking for any <u>discolorations</u>, <u>dead pixels</u>, or <u>scratches</u>."
                                + "<br/><br/>"
                                + new TwemojiImage("Memo", qaHelperWindow).toImgTag("left") + " <i>MAKE NOTE OF ANY ISSUES YOU FIND</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                + "<br/><br/>"
                                + new TwemojiImage("ComputerMouse", qaHelperWindow).toImgTag("left") + " When you're finished examining a screen color, <u>CLICK THE MOUSE</u><br/>"
                                + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " to move to the next color and repeat your examination and note taking."
                                + "<br/><br/>"
                                + new TwemojiImage("MagnifyingGlassTiltedLeft", qaHelperWindow).toImgTag("left") + " Look very carefully over the entire screen for <u>EACH COLOR</u> as some<br/>"
                                + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " kinds of screen issues will show on some colors and not on others."
                                + "<br/><br/><br/>"
                                + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>SOLID COLORS SCREEN TEST PASSED IF:</b>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li>The screen has <b>NO</b> <u>discolorations</u> or <u>hot spots</u>.</li>"
                                + "<li>The screen has <b>NO</b> <u>dead pixels</u>.</li>"
                                + "<li>The screen has <b>NO</b> <u>scratches or <u>dents</u>.</li>"
                                + "</ul>"
                                + "<br/>"
                                + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>SOLID COLORS SCREEN TEST FAILED IF:</b>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li>The screen has <i>ANY</i> <u>discoloration</u> or <u>hot spots</u>.</li>"
                                + "<li>The screen has <i>ANY</i> <u>dead pixels</u>.</li>"
                                + "<li>The screen has <i>ANY</i> <u>scratches</u> or <u>dents</u>.</li>"
                                + "</ul>"
                                + "<br/><center>"
                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF SOLID COLORS SCREEN TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")) + "</center></html>", "QA Helper  —  " + (shouldDoTouchscreenTest ? "Touchscreen" : "Solid Colors Screen") + " Test", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE, new TwemojiImage(shouldDoTouchscreenTest ? "IndexPointingUp" : "FlagMauritius", qaHelperWindow).toImageIcon());

                if (screenTestPromptReturn == JOptionPane.OK_OPTION) {
                    if (shouldDoTouchscreenTest) {
                        new QATouchscreenTestWindow().addWindowListener(new WindowAdapter() {
                            @Override
                            public void windowClosed(WindowEvent windowEvent) {
                                boolean touchscreenTestPassed = ((JFrame) windowEvent.getSource()).getTitle().endsWith(" PASSED");

                                if (touchscreenTestPassed) {
                                    playAlertSound("success");
                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Touchscreen Test Successfully Completed Within 45 Seconds</b>"
                                            + "<br/><br/><br/>"
                                            + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>TOUCHSCREEN TEST PASSED IF:</b>"
                                            + "<ul style='margin-left: 20px'>"
                                            + "<li><u>Each zone</u> turned <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> <u>immediately</u> the <u>first time you touched it</u>.</li>"
                                            + "<li>You <u>touched every zone</u> and <u>turned the whole screen</u> <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> <u>within 45 seconds</u>.</li>"
                                            + "</ul>"
                                            + "<br/>"
                                            + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>TOUCHSCREEN TEST FAILED IF:</b>"
                                            + "<ul style='margin-left: 20px'>"
                                            + "<li><i>Any zone</i> needed to be <u>touched multiple times to turn Green</u>.</li>"
                                            + "<li><i>Any zone</i> was <u>not able to be turned Green</u> by touching the screen.</li>"
                                            + "</ul>"
                                            + "<br/><center>"
                                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF TOUCHSCREEN TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                            + "</center></html>", "QA Helper  —  Touchscreen Test Completed", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("IndexPointingUp", qaHelperWindow).toImageIcon());

                                    didTouchscreenTest = true;

                                    if (didSolidColorsScreenTest) {
                                        if (!isScreenVerified && btnVerifyScreen.isVisible() && btnVerifyScreen.isEnabled()) {
                                            btnVerifyScreenActionPerformed(null);
                                        }

                                        setActionsEnabled(true);
                                    } else {
                                        setActionsEnabled(true);
                                        btnTestScreenActionPerformed(evt);
                                    }
                                } else {
                                    playAlertSound("error");
                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b>TOUCHSCREEN TEST HAS FAILED SINCE IT WAS NOT COMPLTED WITHIN 45 SECONDS</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                            + "<br/><br/><center>"
                                            + "<i>If this happened because you had to stop the test for any reason other than<br/>"
                                            + "the <u>touchscreen not working</u>, <b>you can just peform the touchscreen test again.</b></i>"
                                            + "<br/><br/>"
                                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF TOUCHSCREEN TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                            + "</center></html>", "QA Helper  —  Touchscreen Test Failed", JOptionPane.ERROR_MESSAGE, new TwemojiImage("IndexPointingUp", qaHelperWindow).toImageIcon());

                                    setActionsEnabled(true);
                                    btnTestScreenActionPerformed(evt);
                                }
                            }
                        });
                    } else {
                        new QAScreenTestWindow(!btnVerifyScreen.isVisible() || isTestMode).addWindowListener(new WindowAdapter() {
                            @Override
                            public void windowClosed(WindowEvent windowEvent) {
                                boolean screenTestFinished = ((JFrame) windowEvent.getSource()).getTitle().endsWith(" FINISHED");

                                // TODO: THIS ISSUE WAS ACTUALLY CAUSED BY METAL RENDERING BECOMING DEFAULT ON JAVA 19
//                                if (isMacOS && System.getProperty("java.version").startsWith("19")) {
//                                    // NOTE: Starting with Java 19 on macOS I've been seeing the screen stay black after the fullscreen screen test window closes.
//                                    // The window is truley getting closed, but the screen just doesn't re-display properly and stays black.
//                                    // I found that key presses still worked and if I hit the right keys to re-open the screen test again,
//                                    // the screen would properly re-display and not be all black after the 2nd screen test window was closed.
//                                    // I tried a variety of other things around closing the window to make this issue not happen,
//                                    // but in the end I tried automating the situation that I knew seemed to work,
//                                    // which was re-opening and 2nd screen test window and closing it again.
//                                    // So, that's why this 2nd screen test window is being opened and immediately closed after the original screen test window is closed.
//                                    // This is a total hack, but it actually works reliably well in my testing.
//                                    // This WAS NOT an issue with Java 18 or older and only started with Java 19 and has continue with 19.0.1 and 19.0.2.
//                                    // TODO: Re-test if this hacky workaround is still needed in Java 20+
//
//                                    new QAScreenTestWindow(false).dispose();
//                                }
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Solid Colors Screen Test Completed</b>"
                                        + "<br/><br/><br/>"
                                        + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>SOLID COLORS SCREEN TEST PASSED IF:</b>"
                                        + "<ul style='margin-left: 20px'>"
                                        + "<li>The screen had <b>NO</b> <u>discolorations</u> or <u>hot spots</u>.</li>"
                                        + "<li>The screen had <b>NO</b> <u>dead pixels</u>.</li>"
                                        + "<li>The screen had <b>NO</b> <u>scratches or <u>dents</u>.</li>"
                                        + "</ul>"
                                        + "<br/>"
                                        + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>SOLID COLORS SCREEN TEST FAILED IF:</b>"
                                        + "<ul style='margin-left: 20px'>"
                                        + "<li>The screen had <i>ANY</i> <u>discoloration</u> or <u>hot spots</u>.</li>"
                                        + "<li>The screen had <i>ANY</i> <u>dead pixels</u>.</li>"
                                        + "<li>The screen had <i>ANY</i> <u>scratches</u> or <u>dents</u>.</li>"
                                        + "</ul>"
                                        + "<br/><center>"
                                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF SOLID COLORS SCREEN TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                        + "</center></html>", "QA Helper  —  Solid Colors Screen Test Completed", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("FlagMauritius", qaHelperWindow).toImageIcon());

                                if (screenTestFinished) {
                                    didSolidColorsScreenTest = true;
                                }

                                if (screenTestFinished && (!hasTouchscreen || (hasTouchscreen && didTouchscreenTest))) {
                                    if (!isScreenVerified && btnVerifyScreen.isVisible() && btnVerifyScreen.isEnabled()) {
                                        btnVerifyScreenActionPerformed(null);
                                    }

                                    setActionsEnabled(true);
                                } else {
                                    setActionsEnabled(true);
                                    btnTestScreenActionPerformed(evt);
                                }
                            }
                        });
                    }
                } else {
                    setActionsEnabled(true);
                    focusNextTestTaskVerifyButton(btnTestScreen);
                }
            } else {
                setActionsEnabled(true);
                focusNextTestTaskVerifyButton(btnTestScreen);
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestScreenActionPerformed

    private void btnVerifyScreenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyScreenActionPerformed
        if (actionsEnabled || (evt == null)) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isScreenVerified ? "UNVERIFY" : "verify") + "</i> the screen?</b></html>", "QA Helper  —  Confirm " + (isScreenVerified ? "Unverify" : "Verify") + " Screen", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isScreenVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isScreenVerified = !isScreenVerified;

                writeToHelperLogFile("Test: Screen " + (isScreenVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyScreen.setText((isScreenVerified ? "Verified" : "Verify"));
                btnVerifyScreen.setFont(btnVerifyScreen.getFont().deriveFont((isScreenVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyScreen.setForeground(isScreenVerified ? verifiedColor : defaultColor);
                btnVerifyScreen.setBorderPainted(!isScreenVerified);

                new LinuxAutoScripts("Screen " + (isScreenVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyScreen);
            } else {
                focusNextTestTaskVerifyButton(btnTestScreen);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyScreenActionPerformed

    private void btnTestAudioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestAudioActionPerformed
        if (actionsEnabled && (!isWindowsPE || isWindowsRE)) {
            setActionsEnabled(false);

            if (isWindows) {
                if (isWindowsPE) {
                    setState(Frame.ICONIFIED);
                }

                try {
                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\SndVol.exe"});

                    TimeUnit.MILLISECONDS.sleep(500); // Sleep a little to make sure focusWindow() gets focus back
                } catch (IOException | InterruptedException openWindowsSoundMixerException) {
                    if (isTestMode) {
                        System.out.println("openWindowsSoundMixerException: " + openWindowsSoundMixerException);
                    }
                }

                if (!isWindowsPE) {
                    focusWindow();
                }
            }

            JCheckBox turnDownOutputVolumeCheckbox = new JCheckBox("Turn Down Output Volume to 25%"); // This checkbox will only be shown on macOS 10.13 High Sierra and older since headphones cannot be easily detected.
            if (isMacOS && !isMacOSmojaveOrNewer && ((speakerTestCount + headphoneTestCount) == 1)) { // Enable lower volume checkbox by default if about to start 2nd test, which should be the headphone test.
                turnDownOutputVolumeCheckbox.setSelected(true);
            }

            int audioTestPromptReturn = JOptionPane.showConfirmDialog((isWindowsPE ? null : qaHelperWindow), new Object[]{"<html>" + new TwemojiImage("SpeakerHighVolume", qaHelperWindow).toImgTag("left") + " <b>First, run this Audio Test through the <u>built-in speakers</u>."
                + "<br/><br/>"
                + new TwemojiImage("Headphone", qaHelperWindow).toImgTag("left") + " Then, run this Audio Test again <u>with headphones plugged in</u> to test the headphone port.</b>"
                + "<br/><br/><br/>"
                + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>AUDIO TEST PASSED IF:</b><br/>"
                + "<ul style='margin-left: 20px'>"
                + "<li>You hear the <u>tones crisply and clearly</u> from the <u>left speakers</u>,<br/>"
                + "then the <u>right speakers</u>, and then <u>both speakers</u> with both the<br/>"
                + "<u>built-in speakers</u> as well as the <u>headphones</u>.</li>"
                + "</ul>"
                + "<br/>"
                + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>AUDIO TEST FAILED IF:</b><br/>"
                + "<ul style='margin-left: 20px'>"
                + "<li>You <u>do not hear the tones</u> out of the <u>correct speakers</u> or they <u>don't sound<br/>"
                + "crisp and clear</u> for either the <u>built-in speakers</u> or the <u>headphones</u>.</li>"
                + "</ul>"
                + "<br/><br/>"
                + ((isLinux || isMacOSmojaveOrNewer) // Can't detect headphone vs speaker on Windows or macOS 10.13 High Sierra and older.
                ? "<b>Number of Internal Speaker Tests Run:</b> " + speakerTestCount + "<br/><br/>"
                + "<b>Number of Headphone Port Tests Run:</b> " + headphoneTestCount + "<br/><br/><br/>"
                : "<b>Number of Audio Tests Run:</b> " + (speakerTestCount + headphoneTestCount) + "<br/><br/><br/>")
                + "<center>"
                + (isWindows ? new TwemojiImage("LevelSlider", qaHelperWindow).toImgTag("left") + " <i>SET VOLUME TO AN <u>APPROPRIATE LEVEL</u> BEFORE STARTING TEST</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "<br/><br/>" : "")
                + new TwemojiImage("ShuffleTracksButton", qaHelperWindow).toImgTag("left") + " <i>REMEMBER TO TEST BOTH <u>BUILT-IN SPEAKERS</u> AND <u>HEADPHONES</u></i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "<br/><br/>"
                + (!computerSpecs.isLaptop() ? new TwemojiImage("Headphone", qaHelperWindow).toImgTag("left") + " <i>REMEMBER TO TEST <u>ALL HEADPHONE PORTS</u></i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "<br/><br/>" : "")
                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF AUDIO TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                + "</center></html>",
                ((isMacOS && !isMacOSmojaveOrNewer) ? " " : ""),
                ((isMacOS && !isMacOSmojaveOrNewer) ? turnDownOutputVolumeCheckbox : ""),
                ((isMacOS && !isMacOSmojaveOrNewer) ? "<html>" + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <i>Check box above to turn down output volume before running headphone test.</i></html>" : "")
            }, "QA Helper  —  Audio Test", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE, new TwemojiImage("Loudspeaker", qaHelperWindow).toImageIcon());

            if (audioTestPromptReturn == JOptionPane.OK_OPTION) {
                loadingWindow.setLoadingTextAndDisplay("QA Helper is Testing Audio", "Testing", "Loudspeaker");
                loadingWindow.setLoadingProgressBarToMax(((isLinux && !isLinuxUbiquityMode) ? 0 : 6)); // Make intermediate for linux (not pre-install) since we may wait for Pulse to be ready.

                (new SwingWorker<Void, Void>() {
                    @Override
                    protected Void doInBackground() throws Exception {
                        String outputCard = "0";
                        String outputDevice = "0";

                        boolean headphonesAreConnected = false;

                        if (isLinux) {
                            // Kill any aplay, paplay, and arecord before we start playing new audio
                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "aplay"});
                            } catch (IOException quitAplayException) {
                                if (isTestMode) {
                                    System.out.println("quitAplayException: " + quitAplayException);
                                }
                            }

                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "paplay"});
                            } catch (IOException quitPaplayException) {
                                if (isTestMode) {
                                    System.out.println("quitPaplayException: " + quitPaplayException);
                                }
                            }

                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "arecord"});
                            } catch (IOException quitArecordException) {
                                if (isTestMode) {
                                    System.out.println("quitArecordException: " + quitArecordException);
                                }
                            }

                            if (!isLinuxUbiquityMode) {
                                // Wait up to 5 seconds for Pulse to be ready before we start playing new audio. (Pulse isn't loaded in pre-install)
                                for (int waitForPulseToBeReadyAttempt = 0; waitForPulseToBeReadyAttempt < 10; waitForPulseToBeReadyAttempt++) {
                                    if (new CommandReader(new String[]{"/usr/bin/pactl", "list", "short", "sinks"}).getFirstOutputLine().endsWith("SUSPENDED")) {
                                        break;
                                    } else {
                                        TimeUnit.MILLISECONDS.sleep(500);
                                    }
                                }
                            }

                            // Restoring ALSA before we start seems to help with some volume sync issues on Mint 19.3
                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/sbin/alsactl", "restore"}).waitFor();
                                TimeUnit.MILLISECONDS.sleep(500);
                            } catch (IOException | InterruptedException alsaRestoreException) {
                                if (isTestMode) {
                                    System.out.println("alsaRestoreException: " + alsaRestoreException);
                                }
                            }

                            String lastOutputCard = "UNKNOWN CARD";
                            String[] outputCardsAndDevicesInfo = new CommandReader(new String[]{"/usr/bin/aplay", "-l"}).getOutputLinesContaining("card");

                            for (String thisOutputCardAndDeviceInfo : outputCardsAndDevicesInfo) {
                                if (!thisOutputCardAndDeviceInfo.contains("HDMI")) {
                                    String[] thisOutputCardAndDeviceInfoParts = thisOutputCardAndDeviceInfo.split(":");
                                    if (thisOutputCardAndDeviceInfoParts[0].startsWith("card") && !thisOutputCardAndDeviceInfoParts[0].equals(lastOutputCard)) {
                                        lastOutputCard = thisOutputCardAndDeviceInfoParts[0];
                                        String thisOutputCard = lastOutputCard.replaceAll("[^0-9]", "");

                                        // Actual desired volume will get set below.
                                        String setVolumeForOutputCardOutput = new CommandReader(new String[]{"/usr/bin/amixer", "-c", thisOutputCard, "sset", "Master", "playback", "100%", "unmute"}).getFirstOutputLine();

                                        if (!setVolumeForOutputCardOutput.isEmpty()) {
                                            outputCard = thisOutputCard;

                                            if (thisOutputCardAndDeviceInfoParts.length >= 2 && thisOutputCardAndDeviceInfoParts[1].contains("device ")) {
                                                outputDevice = thisOutputCardAndDeviceInfoParts[1].split("device ")[1];
                                            }
                                        }
                                    }
                                }
                            }

                            TimeUnit.MILLISECONDS.sleep(500);

                            boolean acpiListenerGotHeadphoneState = false;

                            if (new File("/tmp/qa_helper-acpi_listener.txt").exists()) {
                                try {
                                    List<String> acpiListenerLines = Files.readAllLines(Paths.get("/tmp/qa_helper-acpi_listener.txt"), StandardCharsets.UTF_8);
                                    for (String acpiListenerLine : acpiListenerLines) {
                                        // headphonesAreConnected will be accurate for the last event detected. Can't just check last line since other events could get logged.
                                        if (acpiListenerLine.endsWith("HEADPHONE unplug")) {
                                            headphonesAreConnected = false;
                                            acpiListenerGotHeadphoneState = true;
                                        } else if (acpiListenerLine.endsWith("HEADPHONE plug")) {
                                            headphonesAreConnected = true;
                                            acpiListenerGotHeadphoneState = true;
                                        }
                                    }
                                } catch (IOException acpiListenerException) {
                                    if (isTestMode) {
                                        System.out.println("acpiListenerException: " + acpiListenerException);
                                    }
                                }
                            }

                            if (!acpiListenerGotHeadphoneState && new File("/proc/asound/card" + outputCard + "/codec#0").exists()) {
                                // This method of headphone detection is no reliable and does not work on all computer.
                                // But, still use it as a fallback if nothing has been logged yet by acpi_listen which started when QA Helper launched.

                                try {
                                    List<String> outputCardCodecInfoLines = Files.readAllLines(Paths.get("/proc/asound/card" + outputCard + "/codec#0"), StandardCharsets.UTF_8);
                                    boolean nextPinCtlsIsHeadphoneJack = false;
                                    for (String thisOutputCardCodecInfoLine : outputCardCodecInfoLines) {
                                        if (thisOutputCardCodecInfoLine.contains("Conn = Analog, Color = Unknown") || thisOutputCardCodecInfoLine.contains("Conn = 1/8, Color = Green")) {
                                            nextPinCtlsIsHeadphoneJack = true;
                                        } else if (nextPinCtlsIsHeadphoneJack && thisOutputCardCodecInfoLine.contains("Pin-ctls:")) {
                                            if (thisOutputCardCodecInfoLine.contains("0x00:")) {
                                                headphonesAreConnected = true;
                                                break;
                                            }

                                            nextPinCtlsIsHeadphoneJack = false;
                                        }
                                    }
                                } catch (IOException outputCardCodecInfoException) {
                                    if (isTestMode) {
                                        System.out.println("outputCardCodecInfoException: " + outputCardCodecInfoException);
                                    }
                                }
                            }

                            // Everything is quiter in pre-installation environment for some reason. Maybe because Pulse isn't loaded?
                            String desiredVolumePercentage = (!computerSpecs.isLaptop() ? "100" : (headphonesAreConnected ? (isLinuxUbiquityMode ? "75" : "35") : (isLinuxUbiquityMode ? "100" : "75")));

                            String[][] outputCardArguments = new String[][]{
                                {"-c", outputCard},
                                {}, // Still try to set default volume for when we're not in pre-install environment.
                                {"-D", "pulse"} // Still try to set pulse volume for when we're not in pre-install environment.
                            };

                            for (String[] thisOutputCardArguments : outputCardArguments) {
                                String thisCardMixerControlName = "Master";
                                ArrayList<String> amixerScontentsCommand = new ArrayList<>();
                                amixerScontentsCommand.add("/usr/bin/amixer");
                                amixerScontentsCommand.addAll(Arrays.asList(thisOutputCardArguments));
                                amixerScontentsCommand.add("scontents");
                                for (String thisMixerContentsLine : new CommandReader(amixerScontentsCommand.toArray(String[]::new)).getOutputLines()) {
                                    if (thisMixerContentsLine.startsWith("Simple mixer control '")) {
                                        thisCardMixerControlName = thisMixerContentsLine.substring(21);
                                    } else if (thisMixerContentsLine.startsWith("  Playback channels")) {
                                        try {
                                            boolean shouldMute = ((headphonesAreConnected && thisCardMixerControlName.startsWith("'Speaker")) || (!headphonesAreConnected && thisCardMixerControlName.startsWith("'Headphone")));
                                            ArrayList<String> amixerSsetCommand = new ArrayList<>();
                                            amixerSsetCommand.add("/usr/bin/amixer");
                                            amixerSsetCommand.addAll(Arrays.asList(thisOutputCardArguments));
                                            amixerSsetCommand.addAll(Arrays.asList("sset", thisCardMixerControlName, "playback", (shouldMute ? "0" : (thisCardMixerControlName.contains(" Boost'") ? "100" : desiredVolumePercentage)) + "%", (shouldMute ? "mute" : "unmute")));
                                            Runtime.getRuntime().exec(amixerSsetCommand.toArray(String[]::new)).waitFor();
                                        } catch (IOException | InterruptedException setCardOutputVolumeException) {
                                            if (isTestMode) {
                                                System.out.println("setCardOutputVolumeException (" + String.join(" ", thisOutputCardArguments) + " + " + thisCardMixerControlName + "): " + setCardOutputVolumeException);
                                            }
                                        }
                                    }
                                }
                            }
                        } else if (isMacOS) {
                            if (isMacOSmojaveOrNewer) { // "currentRoute" of "AVAudioSession" is not available on macOS 10.13 High Sierra and older.
                                headphonesAreConnected = new CommandReader(new String[]{"/usr/bin/osascript", "-l", "JavaScript",
                                    "-e", "ObjC.import('objc')", // Detecting headphones in Objective-C: https://stackoverflow.com/a/21382748
                                    "-e", "ObjC.import('AVFoundation')", // Loading "AVFoundation" classes in JXA: https://gist.github.com/SKaplanOfficial/b564edb219a40965c464c284dc9ca3e3#file-recordaudio-scpt-L11
                                    "-e", "const headphonesConnected = $.objc_getClass('AVAudioSession').sharedInstance.currentRoute.outputs.js.map(thisPortDescription => thisPortDescription.portType.js).includes('Headphones')",
                                    "-e", "const app = Application.currentApplication()",
                                    "-e", "app.includeStandardAdditions = true",
                                    "-e", "app.setVolume(null, {outputVolume: (headphonesConnected ? 25 : 75), alertVolume: 100, outputMuted: false})",
                                    "-e", "headphonesConnected"}).getFirstOutputLine().equals("true");
                            } else {
                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "set volume output volume " + (turnDownOutputVolumeCheckbox.isSelected() ? "25" : "75") + " without output muted", "-e", "set volume alert volume 100"}).waitFor();
                                } catch (IOException | InterruptedException setMacOutputVolumeException) {
                                    if (isTestMode) {
                                        System.out.println("setMacOutputVolumeException: " + setMacOutputVolumeException);
                                    }
                                }
                            }
                        }

                        boolean didPlayAudioTest = false;

                        if (!isLinux) {
                            // Java AudioSystem is not reliable on Linux and can fail with UnsatisfiedLinkError or an "Invalid Format" Exception for seemingly no reason.
                            // But, worst of all, sometimes it doesn't error and just doesn't play anything.

                            try (Clip audioTestClip = AudioSystem.getClip()) {
                                audioTestClip.open(AudioSystem.getAudioInputStream(this.getClass().getResource("/Resources/StereoSoundTest.wav")));
                                audioTestClip.start();

                                loadingWindow.setLoadingProgressBarToMax(6);

                                for (int waitSecond = 0; waitSecond < 6; waitSecond++) {
                                    loadingWindow.incrementLoadingProgressBar();

                                    if (isMacOSmojaveOrNewer) {
                                        long startGetMacHeadphoneConnectedTime = System.currentTimeMillis();

                                        headphonesAreConnected = new CommandReader(new String[]{"/usr/bin/osascript", "-l", "JavaScript",
                                            "-e", "ObjC.import('objc')", // Detecting headphones in Objective-C: https://stackoverflow.com/a/21382748
                                            "-e", "ObjC.import('AVFoundation')", // Loading "AVFoundation" classes in JXA: https://gist.github.com/SKaplanOfficial/b564edb219a40965c464c284dc9ca3e3#file-recordaudio-scpt-L11
                                            "-e", "const headphonesConnected = $.objc_getClass('AVAudioSession').sharedInstance.currentRoute.outputs.js.map(thisPortDescription => thisPortDescription.portType.js).includes('Headphones')",
                                            "-e", "const app = Application.currentApplication()",
                                            "-e", "app.includeStandardAdditions = true",
                                            "-e", "if (headphonesConnected != " + headphonesAreConnected + ") app.setVolume(null, {outputVolume: (headphonesConnected ? 25 : 75), alertVolume: 100, outputMuted: false})",
                                            "-e", "headphonesConnected"}).getFirstOutputLine().equals("true"); // NOTE: The volume will only be changed if the headphone state is changed to allow a technician to manually adjust the volume after a test starts without it being re-set by this code.

                                        long getMacHeadphoneConnectedDuration = (System.currentTimeMillis() - startGetMacHeadphoneConnectedTime);

                                        if (getMacHeadphoneConnectedDuration < 1000) {
                                            // Checking Mac headphone connected state (and setting volume) usually takes about 200ms, but can take up to around 2 seconds right after headphones are connected or disconnected,
                                            // so don't wait if it already took longer than 1 second, or subtract the duration from our desired 1 second wait time to not cumulatively wait too long for the whole test.

                                            TimeUnit.MILLISECONDS.sleep(1000 - getMacHeadphoneConnectedDuration);
                                        }
                                    } else {
                                        TimeUnit.SECONDS.sleep(1);
                                    }
                                }

                                didPlayAudioTest = true;
                            } catch (Error | Exception playAudioTestErrorOrException) {
                                if (isTestMode) {
                                    System.out.println("playAudioTestErrorOrException: " + playAudioTestErrorOrException);
                                }
                            }
                        }

                        if (!didPlayAudioTest && !isWindows) {
                            File stereoSoundTestTempFile = File.createTempFile("qa_helper-audio_test", ".wav");
                            stereoSoundTestTempFile.deleteOnExit();

                            String stereoSoundTestTempPath = "";

                            try (InputStream stereoSoundTestInputStream = this.getClass().getClassLoader().getResourceAsStream("Resources/StereoSoundTest.wav")) {
                                try (FileOutputStream stereoSoundTestOutputStream = new FileOutputStream(stereoSoundTestTempFile)) {
                                    byte[] buf = new byte[1024];
                                    int bytesRead;

                                    while ((bytesRead = stereoSoundTestInputStream.read(buf)) > 0) {
                                        stereoSoundTestOutputStream.write(buf, 0, bytesRead);
                                    }

                                    stereoSoundTestTempPath = stereoSoundTestTempFile.getPath();
                                } catch (Exception writeStereoSoundTestException) {
                                    if (isTestMode) {
                                        System.out.println("writeStereoSoundTestException: " + writeStereoSoundTestException);
                                    }
                                }
                            } catch (Exception readStereoSoundTestException) {
                                if (isTestMode) {
                                    System.out.println("readStereoSoundTestException: " + readStereoSoundTestException);
                                }
                            }

                            if (!stereoSoundTestTempPath.isEmpty()) {
                                for (int playAudioTestAttempt = 0; playAudioTestAttempt < 3; playAudioTestAttempt++) {
                                    loadingWindow.setLoadingProgressBarToMax((isLinux ? 7 : 6));

                                    try {
                                        Runtime.getRuntime().exec((isLinux // Mint 19.3 in pre-install seems to have an issue on some computers where the beginning get's cut off. This "aplay /dev/null; sleep 1" seems to help work around it. (Like aplay needs to be warmed up or something stupid like that?)
                                                ? new String[]{"/bin/sh", "-c", "/usr/bin/aplay /dev/null; /bin/sleep 1; /usr/bin/aplay -D hw:" + outputCard + "," + outputDevice + " '" + stereoSoundTestTempPath.replace("'", "'\\''") + "'"}
                                                : new String[]{"/usr/bin/afplay", stereoSoundTestTempPath})
                                        );

                                        for (int waitSecond = 0; waitSecond < (isLinux ? 7 : 6); waitSecond++) {
                                            loadingWindow.incrementLoadingProgressBar();
                                            TimeUnit.SECONDS.sleep(1);
                                        }

                                        didPlayAudioTest = true;

                                        break;
                                    } catch (IOException | InterruptedException playAudioTestFileException) {
                                        if (isTestMode) {
                                            System.out.println("playAudioTestFileException: " + playAudioTestFileException);
                                        }
                                        TimeUnit.SECONDS.sleep(1);
                                    }
                                }
                            }

                            if (isLinux) { // There is an odd rare bug on Linux Mint 20.3 (not sure if it affect other versions) which may be caused by driver issues where the audio keeps looping in segments and it can go on for a long time, so "killall aplay" just in case to stop it.
                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "aplay"});
                                } catch (IOException quitAplayException) {
                                    if (isTestMode) {
                                        System.out.println("quitAplayException: " + quitAplayException);
                                    }
                                }
                            }

                            stereoSoundTestTempFile.delete();
                        }

                        if (!didPlayAudioTest) {
                            loadingWindow.closeWindow();
                            JOptionPane.showMessageDialog((isWindowsPE ? null : qaHelperWindow), "<html><b>Failed to Play Audio Test</b></html>", "QA Helper  —  Audio Test Error", JOptionPane.ERROR_MESSAGE);
                        } else if (headphonesAreConnected) {
                            headphoneTestCount++;
                        } else {
                            speakerTestCount++;
                        }

                        return null;
                    }

                    @Override
                    protected void done() {
                        loadingWindow.closeWindow();

                        if (isWindows) {
                            try {
                                if (!isWindowsPE || new File("\\Windows\\System32\\taskkill.exe").exists()) {
                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", "SndVol.exe", "/t"}).waitFor();
                                } else {
                                    // taskkill does not exist in WinPE (unless it has been manually copied in), no need to make it hard a requirement when I can just use PowerShell (PowerShell just takes longer so we'll still use taskkill when it's available).
                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Process -Name SndVol"}).waitFor();
                                }
                            } catch (IOException | InterruptedException quitSoundMixerException) {
                                if (isTestMode) {
                                    System.out.println("quitSoundMixerException: " + quitSoundMixerException);
                                }
                            }
                        }

                        focusWindow();
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Audio Test Completed</b>"
                                + "<br/><br/><br/>"
                                + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>AUDIO TEST PASSED IF:</b><br/>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li>You heard the <u>tones crisply and clearly</u> from the <u>left speakers</u>,<br/>"
                                + "then the <u>right speakers</u>, and then <u>both speakers</u> with both the<br/>"
                                + "<u>built-in speakers</u> as well as the <u>headphones</u>.</li>"
                                + "</ul>"
                                + "<br/>"
                                + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>AUDIO TEST FAILED IF:</b><br/>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li>You <u>did not hear the tones out</u> out of the <u>correct speakers</u> or they <u>didn't<br/>"
                                + "sound crisp and clear</u> for either the <u>built-in speakers</u> or the <u>headphones</u>.</li>"
                                + "</ul>"
                                + "<br/><br/>"
                                + ((isLinux || isMacOSmojaveOrNewer) // Can't detect headphone vs speaker on Windows or macOS 10.13 High Sierra and older.
                                        ? "<b>Number of Internal Speaker Tests Run:</b> " + speakerTestCount + "<br/><br/>"
                                        + "<b>Number of Headphone Port Tests Run:</b> " + headphoneTestCount + "<br/><br/><br/>"
                                        : "<b>Number of Audio Tests Run:</b> " + (speakerTestCount + headphoneTestCount) + "<br/><br/><br/>")
                                + "<center>"
                                + new TwemojiImage("ShuffleTracksButton", qaHelperWindow).toImgTag("left") + " <i>REMEMBER TO TEST BOTH <u>BUILT-IN SPEAKERS</u> AND <u>HEADPHONES</u></i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "<br/><br/>"
                                + (!computerSpecs.isLaptop() ? new TwemojiImage("Headphone", qaHelperWindow).toImgTag("left") + " <i>REMEMBER TO TEST <u>ALL HEADPHONE PORTS</u></i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "<br/><br/>" : "")
                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF AUDIO TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                + "</center></html>", "QA Helper  —  Audio Test Completed", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Loudspeaker", qaHelperWindow).toImageIcon());

                        boolean didMinimumAudioTests = (((isLinux || isMacOSmojaveOrNewer) && computerSpecs.isLaptop() && speakerTestCount >= 1 && headphoneTestCount >= 1) || (((!isLinux && !isMacOSmojaveOrNewer) || !computerSpecs.isLaptop()) && (speakerTestCount + headphoneTestCount) >= 2));

                        if (didMinimumAudioTests && !isAudioVerified && btnVerifyAudio.isVisible()) {
                            if (btnVerifyAudio.isEnabled()) {
                                btnVerifyAudioActionPerformed(null);
                            } else {
                                // If btnVerifyAudio is not enabled (such as when in WinPE), just focus the next test button.
                                focusNextTestTaskVerifyButton(btnTestAudio);
                            }
                        }

                        setActionsEnabled(true);
                    }
                }).execute();
            } else {
                if (isWindows) {
                    try {
                        if (!isWindowsPE || new File("\\Windows\\System32\\taskkill.exe").exists()) {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", "SndVol.exe", "/t"}).waitFor();
                        } else {
                            // taskkill does not exist in WinPE (unless it has been manually copied in), no need to make it hard a requirement when I can just use PowerShell (PowerShell just takes longer so we'll still use taskkill when it's available).
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Process -Name SndVol"}).waitFor();
                        }
                    } catch (IOException | InterruptedException quitSoundMixerException) {
                        if (isTestMode) {
                            System.out.println("quitSoundMixerException: " + quitSoundMixerException);
                        }
                    }
                }

                setActionsEnabled(true);
                focusNextTestTaskVerifyButton(btnTestAudio);
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestAudioActionPerformed

    private void btnVerifyAudioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyAudioActionPerformed
        if ((actionsEnabled || (evt == null)) && !isWindowsPE) { // Do not allow Audio Verification in WinPE (even though we can test when in WinRE) since we want it verified in OS after driver are installed.
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isAudioVerified ? "UNVERIFY" : "verify") + "</i> the audio outputs?</b></html>", "QA Helper  —  Confirm " + (isAudioVerified ? "Unverify" : "Verify") + " Audio", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isAudioVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isAudioVerified = !isAudioVerified;

                writeToHelperLogFile("Test: Audio " + (isAudioVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyAudio.setText((isAudioVerified ? "Verified" : "Verify"));
                btnVerifyAudio.setFont(btnVerifyAudio.getFont().deriveFont((isAudioVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyAudio.setForeground(isAudioVerified ? verifiedColor : defaultColor);
                btnVerifyAudio.setBorderPainted(!isAudioVerified);

                new LinuxAutoScripts("Audio " + (isAudioVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyAudio);
            } else {
                focusNextTestTaskVerifyButton((evt == null) ? btnVerifyAudio : btnTestAudio); // Stay on audio test is user chooses not to verify after testing
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyAudioActionPerformed

    private void btnTestMicrophoneActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestMicrophoneActionPerformed
        if (actionsEnabled && !isWindowsPE) {

            setActionsEnabled(false);

            if (isMacOS && new CommandReader(new String[]{"/usr/bin/osascript", "-e", "input volume of (get volume settings)"}).getFirstOutputLine().equals("missing value")) {
                playAlertSound("error");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>No Microphone Detected</b><br/><br/><i>If this computer is supposed to have a microphone, then Microphone Test has failed.</i></html>", "QA Helper  —  Microphone Test Error", JOptionPane.ERROR_MESSAGE, new TwemojiImage("NoEntry", qaHelperWindow).toImageIcon(32));

                setActionsEnabled(true);
                focusNextTestTaskVerifyButton(btnTestMicrophone);
            } else {

                final int microphoneTestDurationSeconds = 10;

                if (isWindows) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\SndVol.exe"});
                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\control.exe", "mmsys.cpl,,1"});
                        TimeUnit.MILLISECONDS.sleep(500); // Sleep a little to make sure focusWindow() gets focus back
                    } catch (IOException | InterruptedException openWindowsSoundMixerException) {
                        if (isTestMode) {
                            System.out.println("openWindowsSoundMixerException: " + openWindowsSoundMixerException);
                        }
                    }

                    focusWindow();
                }

                JComboBox microphoneInputVolumeComboBox = new JComboBox<>(new String[]{"Microphone Input Volume: 100%", "Microphone Input Volume: 75%", "Microphone Input Volume: 50%", "Microphone Input Volume: 25%", "Microphone Input Volume: 10%"});
                microphoneInputVolumeComboBox.setSelectedIndex(2);

                int microphoneTestPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow, new Object[]{"<html><b>Microphone Test will start an audio recording and record for <u>" + microphoneTestDurationSeconds + " seconds</u>.</b>"
                    + "<br/><br/>"
                    + new TwemojiImage("SpeakingHead", qaHelperWindow).toImgTag("left") + " <i><u>Speak a phrase</u> during the recording so that we can<br/>"
                    + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " make sure the <u>microphone records crisply and clearly</u>.</i>"
                    + "<br/><br/>"
                    + new TwemojiImage("Stopwatch", qaHelperWindow).toImgTag("left") + " <b><i>After " + microphoneTestDurationSeconds + " seconds of audio is recorded</i>, it will be <u>played back to you</u>.</b>"
                    + "<br/><br/>"
                    + new TwemojiImage("Ear", qaHelperWindow).toImgTag("left") + " <u>Listen closely</u> to the recording to make sure you can <u>understand</u><br/>"
                    + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " <u>the phrase you spoke</u> and that it <u>sounds crisp and clear</u>."
                    + "<br/><br/><br/>"
                    + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>MICROPHONE TEST PASSED IF:</b>"
                    + "<ul style='margin-left: 20px'>"
                    + "<li>You hear your recording <u>crisply and clearly</u>.</li>"
                    + "</ul>"
                    + "<br/>"
                    + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>MICROPHONE TEST FAILED IF:</b>"
                    + "<ul style='margin-left: 20px'>"
                    + "<li><u>Nothing</u> gets recorded.</li>"
                    + "<li>The recording <u>doesn't sound crisp and clear</u>.</li>"
                    + "</ul>"
                    + "<br/><center>"
                    + (isWindows ? new TwemojiImage("LevelSlider", qaHelperWindow).toImgTag("left") + " <i>SET INPUT AND OUTPUT VOLUMES TO <u>APPROPRIATE LEVELS</u> BEFORE STARTING TEST</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "<br/><br/>" : "")
                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF MICROPHONE TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                    + "</center></html>",
                    (isLinux ? " " : ""),
                    (isLinux ? microphoneInputVolumeComboBox : ""),
                    (isLinux ? "<html>" + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <i>Only adjust mic volume if the previous test was too quiet or too loud.</i></html>" : "")}, "QA Helper  —  Microphone Test", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE, new TwemojiImage("StudioMicrophone", qaHelperWindow).toImageIcon());

                if (isLinux) {
                    File micTestRecordingFile = new File(System.getProperty("java.io.tmpdir"), "qa_helper-mic_test.wav");
                    if (micTestRecordingFile.exists()) {
                        micTestRecordingFile.delete();
                    }
                }

                if (microphoneTestPromptReturn == JOptionPane.OK_OPTION) {
                    loadingWindow.setLoadingTextAndDisplay("QA Helper is Setting Up Recording", "Working", "StudioMicrophone");
                    (new SwingWorker<Boolean, String>() {
                        @Override
                        protected Boolean doInBackground() throws Exception {
                            boolean didRecordAndPlayBack = true;

                            String inputCard = "0";
                            String inputDevice = "0";

                            if (isLinux) {
                                int micInputVolume = 50;

                                try {
                                    micInputVolume = Integer.parseInt(microphoneInputVolumeComboBox.getSelectedItem().toString().replaceAll("[^0-9]", ""));
                                } catch (NumberFormatException getMicInputVolumeException) {
                                    // Ignore Error
                                }

                                // Kill any aplay, paplay, and arecord before we start playing new audio
                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "aplay"});
                                } catch (IOException quitAplayException) {
                                    if (isTestMode) {
                                        System.out.println("quitAplayException: " + quitAplayException);
                                    }
                                }

                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "paplay"});
                                } catch (IOException quitPaplayException) {
                                    if (isTestMode) {
                                        System.out.println("quitPaplayException: " + quitPaplayException);
                                    }
                                }

                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "arecord"});
                                } catch (IOException quitArecordException) {
                                    if (isTestMode) {
                                        System.out.println("quitArecordException: " + quitArecordException);
                                    }
                                }

                                if (!isLinuxUbiquityMode) {
                                    // Wait up to 5 seconds for Pulse to be ready before we start playing new audio. (Pulse isn't loaded in pre-install)
                                    for (int waitForPulseToBeReadyAttempt = 0; waitForPulseToBeReadyAttempt < 10; waitForPulseToBeReadyAttempt++) {
                                        if (new CommandReader(new String[]{"/usr/bin/pactl", "list", "short", "sinks"}).getFirstOutputLine().endsWith("SUSPENDED")) {
                                            break;
                                        } else {
                                            TimeUnit.MILLISECONDS.sleep(500);
                                        }
                                    }
                                }

                                // Restoring ALSA before we start seems to help with some volume sync issues on Mint 19.3
                                // This also resets the default capture device, which is good in case it ever got changed.
                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/sbin/alsactl", "restore"}).waitFor();
                                    TimeUnit.MILLISECONDS.sleep(500);
                                } catch (IOException | InterruptedException alsaRestoreException) {
                                    if (isTestMode) {
                                        System.out.println("alsaRestoreException: " + alsaRestoreException);
                                    }
                                }

                                String lastInputCard = "UNKNOWN CARD";
                                String[] inputCardsAndDevicesInfo = new CommandReader(new String[]{"/usr/bin/arecord", "-l"}).getOutputLinesContaining("card");

                                for (String thisInputCardAndDeviceInfo : inputCardsAndDevicesInfo) {
                                    if (!thisInputCardAndDeviceInfo.contains("HDMI")) {
                                        String[] thisInputCardAndDeviceInfoParts = thisInputCardAndDeviceInfo.split(":");
                                        if (thisInputCardAndDeviceInfoParts[0].startsWith("card") && !thisInputCardAndDeviceInfoParts[0].equals(lastInputCard)) {
                                            lastInputCard = thisInputCardAndDeviceInfoParts[0];
                                            String thisInputCard = lastInputCard.replaceAll("[^0-9]", "");

                                            // 50% capture volume sounds WAY better than any higher on many laptops.
                                            // Do not set "cap" modifier argument so that we never change the default input device.
                                            String setVolumeForInputCardOutput = new CommandReader(new String[]{"/usr/bin/amixer", "-c", thisInputCard, "sset", "Capture", "capture", micInputVolume + "%", "unmute"}).getFirstOutputLine();

                                            if (!setVolumeForInputCardOutput.isEmpty()) {
                                                inputCard = thisInputCard;

                                                if (thisInputCardAndDeviceInfoParts.length >= 2 && thisInputCardAndDeviceInfoParts[1].contains("device ")) {
                                                    inputDevice = thisInputCardAndDeviceInfoParts[1].split("device ")[1];
                                                }
                                            }
                                        }
                                    }
                                }

                                TimeUnit.MILLISECONDS.sleep(500);

                                String[][] inputCardArguments = new String[][]{
                                    {"-c", inputCard},
                                    {}, // Still try to set default volume for when we're not in pre-install environment.
                                    {"-D", "pulse"} // Still try to set pulse volume for when we're not in pre-install environment.
                                };

                                for (String[] thisInputCardArguments : inputCardArguments) {
                                    String thisCardMixerControlName = "Capture";
                                    ArrayList<String> amixerScontentsCommand = new ArrayList<>();
                                    amixerScontentsCommand.add("/usr/bin/amixer");
                                    amixerScontentsCommand.addAll(Arrays.asList(thisInputCardArguments));
                                    amixerScontentsCommand.add("scontents");
                                    for (String thisMixerContentsLine : new CommandReader(amixerScontentsCommand.toArray(String[]::new)).getOutputLines()) {
                                        if (thisMixerContentsLine.startsWith("Simple mixer control '")) {
                                            thisCardMixerControlName = thisMixerContentsLine.substring(21);
                                        } else if (thisMixerContentsLine.startsWith("  Capture channels")) {
                                            try {
                                                // Do not set "cap" modifier argument so that we never change the default input device, and always set Boosts to 100%.
                                                ArrayList<String> amixerSsetCommand = new ArrayList<>();
                                                amixerSsetCommand.add("/usr/bin/amixer");
                                                amixerSsetCommand.addAll(Arrays.asList(thisInputCardArguments));
                                                amixerSsetCommand.addAll(Arrays.asList("sset", thisCardMixerControlName, "capture", (thisCardMixerControlName.contains(" Boost'") ? "100" : micInputVolume) + "%", "unmute"));
                                                Runtime.getRuntime().exec(amixerSsetCommand.toArray(String[]::new)).waitFor();
                                            } catch (IOException | InterruptedException setCardInputVolumeException) {
                                                if (isTestMode) {
                                                    System.out.println("setCardInputVolumeException (" + String.join(" ", thisInputCardArguments) + " + " + thisCardMixerControlName + "): " + setCardInputVolumeException);
                                                }
                                            }
                                        }
                                    }
                                }
                            } else if (isMacOS) {
                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "set volume input volume 100"}).waitFor();
                                } catch (IOException | InterruptedException setMacInputVolumeException) {
                                    if (isTestMode) {
                                        System.out.println("setMacInputVolumeException: " + setMacInputVolumeException);
                                    }
                                }
                            }

                            boolean didRecordByteStream = false;
                            ByteArrayOutputStream recordingOutputByteStream = new ByteArrayOutputStream();
                            AudioFormat recordingFormat = new AudioFormat(44100, 16, 2, true, false);

                            if (!isLinux) {
                                // Java AudioSystem is not reliable on Linux and can fail with UnsatisfiedLinkError or an "Invalid Format" Exception for seemingly no reason.
                                // But, worst of all, sometimes it doesn't error and just doesn't play anything.

                                DataLine.Info lineInfo = new DataLine.Info(TargetDataLine.class, recordingFormat);
                                if (AudioSystem.isLineSupported(lineInfo)) {
                                    // Based On: https://docs.oracle.com/javase/tutorial/sound/capturing.html
                                    try (TargetDataLine recordingLine = (TargetDataLine) AudioSystem.getLine(lineInfo)) {
                                        recordingLine.open(recordingFormat);
                                        recordingLine.start();

                                        int recordingBytesRead;
                                        byte[] recordingDataBuffer = new byte[recordingLine.getBufferSize() / 5];
                                        long startTimestamp = 0;
                                        boolean didStartRecording = false;

                                        do {
                                            recordingBytesRead = recordingLine.read(recordingDataBuffer, 0, recordingDataBuffer.length);
                                            recordingOutputByteStream.write(recordingDataBuffer, 0, recordingBytesRead);

                                            if (startTimestamp == 0) {
                                                startTimestamp = new Date().getTime();
                                            } else if (!didStartRecording && (new Date().getTime() - startTimestamp >= 500)) {
                                                // Make sure data is being recorded after a half second.
                                                // If every byte is 0, that means no data was recorded for a half second.
                                                // This is important on macOS to verify we have Microphone access.

                                                boolean didRecordSomeData = false;
                                                for (byte thisRecordingByte : recordingOutputByteStream.toByteArray()) {
                                                    if (thisRecordingByte != 0) {
                                                        didRecordSomeData = true;
                                                        break;
                                                    }
                                                }

                                                if (!didRecordSomeData) {
                                                    recordingLine.stop();

                                                    if (isMacOS) {
                                                        // If no data was recorded, clear Microphone access to prompt again on next attempt.
                                                        // It may require a relaunch to actually be allowed Microphone access though.

                                                        try {
                                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/tccutil", "reset", "Microphone", "org.freegeek.QA-Helper"}).waitFor();
                                                        } catch (IOException | InterruptedException resetMicrophoneAccessException) {
                                                            if (isTestMode) {
                                                                System.out.println("resetMicrophoneAccessException: " + resetMicrophoneAccessException);
                                                            }
                                                        }
                                                    }

                                                    throw new Exception("NO DATA WAS RECORDED");
                                                } else {
                                                    publish("recording");
                                                    didStartRecording = true;
                                                }
                                            }
                                        } while (new Date().getTime() - startTimestamp < 500 + (microphoneTestDurationSeconds * 1000));

                                        recordingBytesRead = recordingLine.read(recordingDataBuffer, 0, recordingDataBuffer.length);
                                        recordingOutputByteStream.write(recordingDataBuffer, 0, recordingBytesRead);

                                        recordingLine.stop();

                                        didRecordByteStream = true;
                                    } catch (Error | Exception recordingErrorOrException) {
                                        if (isTestMode) {
                                            System.out.println("recordingErrorOrException: " + recordingErrorOrException);
                                        }
                                    }
                                }
                            }

                            boolean didRecordFile = false;
                            boolean didAutomateQuickTime = false;

                            if (!didRecordByteStream) {
                                if (isLinux) {
                                    if (new CommandReader("/usr/bin/wmctrl -Fc Sound; echo $?").getFirstOutputLine().equals("0")) {
                                        TimeUnit.SECONDS.sleep(5); // Sound settings window being open interrupts arecord for some reason. Need to wait a bit after closing as well for arecord to not fail.
                                    }
                                    publish("recording");

                                    File micTestRecordingFile = new File(System.getProperty("java.io.tmpdir"), "qa_helper-mic_test.wav");

                                    for (int recordAudioAttempt = 0; recordAudioAttempt < 3; recordAudioAttempt++) {
                                        if (micTestRecordingFile.exists()) {
                                            micTestRecordingFile.delete();
                                        }

                                        if (recordAudioAttempt > 0) {
                                            publish("re-recording");
                                        }

                                        try {
                                            long startTimestamp = new Date().getTime();

                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/arecord", "-D", "hw:" + inputCard + "," + inputDevice, "-f", "cd", "-d", String.valueOf(microphoneTestDurationSeconds), micTestRecordingFile.getPath()}).waitFor();

                                            long recordingDuration = new Date().getTime() - startTimestamp;
                                            if (recordingDuration >= (microphoneTestDurationSeconds * 1000) - 1000) {
                                                didRecordFile = micTestRecordingFile.exists();

                                                if (didRecordFile) {
                                                    break;
                                                } else if (isTestMode) {
                                                    System.out.println("recordAudioError: NO FILE SAVED");
                                                    TimeUnit.SECONDS.sleep(1);
                                                }
                                            } else {
                                                if (isTestMode) {
                                                    System.out.println("recordAudioError: NOT ENOUGH TIME PASSED (" + recordingDuration + " MS < " + ((microphoneTestDurationSeconds * 1000) - 1000) + " MS)");
                                                }
                                                TimeUnit.SECONDS.sleep(1);
                                            }
                                        } catch (IOException | InterruptedException arecordAudioException) {
                                            if (isTestMode) {
                                                System.out.println("arecordAudioException: " + arecordAudioException);
                                            }
                                            TimeUnit.SECONDS.sleep(1);
                                        }
                                    }
                                } else if (isMacOS) {
                                    // T2 and Apple Silicon Macs appear to NOT allow Mic access via Java, access is not prompted and the RecordByteStream code above errors.
                                    // Maybe there is another Java recording technique that works, but I just fell back on what I new would work:
                                    // As a workaround, use QuickTime automation instead, the user will just have to approve automation access.

                                    boolean hasQuickTimeAutomationAccess = new CommandReader(new String[]{"/usr/bin/osascript",
                                        "-e", "set systemVersion to (system version of (system info))",
                                        "-e", "considering numeric strings",
                                        "-e", "set isMojaveOrNewer to (systemVersion ≥ \"10.14\")",
                                        "-e", "end considering",
                                        "-e", "if (isMojaveOrNewer) then",
                                        "-e", "try",
                                        "-e", "tell application id \"com.apple.QuickTimePlayerX\" to every window",
                                        "-e", "on error automationAccessErrorMessage number automationAccessErrorNumber",
                                        "-e", "if (automationAccessErrorNumber is equal to -1743) then",
                                        "-e", "return \"NEEDS QUICKTIME AUTOMATION ACCESS\"",
                                        "-e", "end if",
                                        "-e", "end try",
                                        "-e", "end if"}).getFirstOutputLineContaining("NEEDS QUICKTIME AUTOMATION ACCESS").isEmpty();

                                    if (hasQuickTimeAutomationAccess) {
                                        try {
                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript",
                                                "-e", "tell application id \"com.apple.QuickTimePlayerX\"",
                                                "-e", "try",
                                                "-e", "activate",
                                                "-e", "end try",
                                                "-e", "delay 0.5",
                                                "-e", "close every window without saving",
                                                "-e", "delay 0.5",
                                                "-e", "set newAudioRecording to new audio recording",
                                                "-e", "delay 0.5",
                                                "-e", "try",
                                                "-e", "activate",
                                                "-e", "end try",
                                                "-e", "start newAudioRecording",
                                                "-e", "end tell"}).waitFor();

                                            publish("recording");

                                            focusWindow();
                                            TimeUnit.SECONDS.sleep(microphoneTestDurationSeconds);

                                            String quickTimeRecordingDuration = new CommandReader(new String[]{"/usr/bin/osascript",
                                                "-e", "tell application id \"com.apple.QuickTimePlayerX\"",
                                                "-e", "stop (every document)",
                                                "-e", "duration of (document 1)",
                                                "-e", "end tell"}).getFirstOutputLine();

                                            focusWindow();

                                            didAutomateQuickTime = (!quickTimeRecordingDuration.isEmpty() && Float.parseFloat(quickTimeRecordingDuration) > 2);
                                            // Sometimes on T2 Macs, QuickTime appears to record, but then the recorded file is just 0 seconds (or a fraction of a second) and just plays a sort of "click" or "pop" sound.
                                            // Detect if this happened by making sure the recorded document is at least 2 seconds, and error without attempting playback if shorter.
                                        } catch (IOException | InterruptedException | NumberFormatException automateStartQuickTimeRecordingException) {
                                            if (isTestMode) {
                                                System.out.println("automateStartQuickTimeRecordingException: " + automateStartQuickTimeRecordingException);
                                            }
                                        }

                                        if (!didAutomateQuickTime) {
                                            try {
                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript",
                                                    "-e", "tell application id \"com.apple.QuickTimePlayerX\"",
                                                    "-e", "try",
                                                    "-e", "close every window without saving",
                                                    "-e", "end try",
                                                    "-e", "delay 1",
                                                    "-e", "with timeout of 1 second",
                                                    "-e", "quit",
                                                    "-e", "end timeout",
                                                    "-e", "end tell"
                                                }).waitFor();

                                                focusWindow();
                                            } catch (IOException | InterruptedException automateQuitQuickTimePlaybackException) {
                                                if (isTestMode) {
                                                    System.out.println("automateQuitQuickTimePlaybackException: " + automateQuitQuickTimePlaybackException);
                                                }
                                            }
                                        }
                                    } else {
                                        try {
                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/tccutil", "reset", "AppleEvents", "org.freegeek.QA-Helper"}).waitFor();
                                        } catch (IOException | InterruptedException resetAutomationAccessException) {
                                            if (isTestMode) {
                                                System.out.println("resetAutomationAccessException: " + resetAutomationAccessException);
                                            }
                                        }
                                    }
                                }
                            }

                            if (didRecordByteStream || didRecordFile || didAutomateQuickTime) {
                                String outputCard = "0";
                                String outputDevice = "0";

                                if (isLinux) {
                                    // Kill any aplay, paplay, and arecord before we start playing new audio
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "aplay"});
                                    } catch (IOException quitAplayException) {
                                        if (isTestMode) {
                                            System.out.println("quitAplayException: " + quitAplayException);
                                        }
                                    }

                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "paplay"});
                                    } catch (IOException quitPaplayException) {
                                        if (isTestMode) {
                                            System.out.println("quitPaplayException: " + quitPaplayException);
                                        }
                                    }

                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "arecord"});
                                    } catch (IOException quitArecordException) {
                                        if (isTestMode) {
                                            System.out.println("quitArecordException: " + quitArecordException);
                                        }
                                    }

                                    if (!isLinuxUbiquityMode) {
                                        // Wait up to 5 seconds for Pulse to be ready before we start playing new audio. (Pulse isn't loaded in pre-install)
                                        for (int waitForPulseToBeReadyAttempt = 0; waitForPulseToBeReadyAttempt < 10; waitForPulseToBeReadyAttempt++) {
                                            if (new CommandReader(new String[]{"/usr/bin/pactl", "list", "short", "sinks"}).getFirstOutputLine().endsWith("SUSPENDED")) {
                                                break;
                                            } else {
                                                TimeUnit.MILLISECONDS.sleep(500);
                                            }
                                        }
                                    }

                                    // Restoring ALSA before we start seems to help with some volume sync issues on Mint 19.3
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/sbin/alsactl", "restore"}).waitFor();
                                        TimeUnit.MILLISECONDS.sleep(500);
                                    } catch (IOException | InterruptedException alsaRestoreException) {
                                        if (isTestMode) {
                                            System.out.println("alsaRestoreException: " + alsaRestoreException);
                                        }
                                    }

                                    String lastOutputCard = "UNKNOWN CARD";
                                    String[] outputCardsAndDevicesInfo = new CommandReader(new String[]{"/usr/bin/aplay", "-l"}).getOutputLinesContaining("card");

                                    for (String thisOutputCardAndDeviceInfo : outputCardsAndDevicesInfo) {
                                        if (!thisOutputCardAndDeviceInfo.contains("HDMI")) {
                                            String[] thisOutputCardAndDeviceInfoParts = thisOutputCardAndDeviceInfo.split(":");
                                            if (thisOutputCardAndDeviceInfoParts[0].startsWith("card") && !thisOutputCardAndDeviceInfoParts[0].equals(lastOutputCard)) {
                                                lastOutputCard = thisOutputCardAndDeviceInfoParts[0];
                                                String thisOutputCard = lastOutputCard.replaceAll("[^0-9]", "");

                                                // Actual desired volume will get set below.
                                                String setVolumeForOutputCardOutput = new CommandReader(new String[]{"/usr/bin/amixer", "-c", thisOutputCard, "sset", "Master", "playback", "100%", "unmute"}).getFirstOutputLine();

                                                if (!setVolumeForOutputCardOutput.isEmpty()) {
                                                    outputCard = thisOutputCard;

                                                    if (thisOutputCardAndDeviceInfoParts.length >= 2 && thisOutputCardAndDeviceInfoParts[1].contains("device ")) {
                                                        outputDevice = thisOutputCardAndDeviceInfoParts[1].split("device ")[1];
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    TimeUnit.MILLISECONDS.sleep(500);

                                    boolean headphonesAreConnected = false;
                                    boolean acpiListenerGotHeadphoneState = false;

                                    if (new File("/tmp/qa_helper-acpi_listener.txt").exists()) {
                                        try {
                                            List<String> acpiListenerLines = Files.readAllLines(Paths.get("/tmp/qa_helper-acpi_listener.txt"), StandardCharsets.UTF_8);
                                            for (String acpiListenerLine : acpiListenerLines) {
                                                // headphonesAreConnected will be accurate for the last event detected. Can't just check last line since other events could get logged.
                                                if (acpiListenerLine.endsWith("HEADPHONE unplug")) {
                                                    headphonesAreConnected = false;
                                                    acpiListenerGotHeadphoneState = true;
                                                } else if (acpiListenerLine.endsWith("HEADPHONE plug")) {
                                                    headphonesAreConnected = true;
                                                    acpiListenerGotHeadphoneState = true;
                                                }
                                            }
                                        } catch (IOException acpiListenerException) {
                                            if (isTestMode) {
                                                System.out.println("acpiListenerException: " + acpiListenerException);
                                            }
                                        }
                                    }

                                    if (!acpiListenerGotHeadphoneState && new File("/proc/asound/card" + outputCard + "/codec#0").exists()) {
                                        // This method of headphone detection is no reliable and does not work on all computer.
                                        // But, still use it as a fallback if nothing has been logged yet by acpi_listen which started when QA Helper launched.

                                        try {
                                            List<String> outputCardCodecInfoLines = Files.readAllLines(Paths.get("/proc/asound/card" + outputCard + "/codec#0"), StandardCharsets.UTF_8);
                                            boolean nextPinCtlsIsHeadphoneJack = false;
                                            for (String thisOutputCardCodecInfoLine : outputCardCodecInfoLines) {
                                                if (thisOutputCardCodecInfoLine.contains("Conn = Analog, Color = Unknown") || thisOutputCardCodecInfoLine.contains("Conn = 1/8, Color = Green")) {
                                                    nextPinCtlsIsHeadphoneJack = true;
                                                } else if (nextPinCtlsIsHeadphoneJack && thisOutputCardCodecInfoLine.contains("Pin-ctls:")) {
                                                    if (thisOutputCardCodecInfoLine.contains("0x00:")) {
                                                        headphonesAreConnected = true;
                                                        break;
                                                    }

                                                    nextPinCtlsIsHeadphoneJack = false;
                                                }
                                            }
                                        } catch (IOException outputCardCodecInfoException) {
                                            if (isTestMode) {
                                                System.out.println("outputCardCodecInfoException: " + outputCardCodecInfoException);
                                            }
                                        }
                                    }

                                    // Everything is quiter in pre-installation environment for some reason. Maybe because Pulse isn't loaded?
                                    String desiredVolumePercentage = (!computerSpecs.isLaptop() ? "100" : (headphonesAreConnected ? (isLinuxUbiquityMode ? "75" : "35") : (isLinuxUbiquityMode ? "100" : "75")));

                                    String[][] outputCardArguments = new String[][]{
                                        {"-c", outputCard},
                                        {}, // Still try to set default volume for when we're not in pre-install environment.
                                        {"-D", "pulse"} // Still try to set pulse volume for when we're not in pre-install environment.
                                    };

                                    for (String[] thisOutputCardArguments : outputCardArguments) {
                                        String thisCardMixerControlName = "Master";
                                        ArrayList<String> amixerScontentsCommand = new ArrayList<>();
                                        amixerScontentsCommand.add("/usr/bin/amixer");
                                        amixerScontentsCommand.addAll(Arrays.asList(thisOutputCardArguments));
                                        amixerScontentsCommand.add("scontents");
                                        for (String thisMixerContentsLine : new CommandReader(amixerScontentsCommand.toArray(String[]::new)).getOutputLines()) {
                                            if (thisMixerContentsLine.startsWith("Simple mixer control '")) {
                                                thisCardMixerControlName = thisMixerContentsLine.substring(21);
                                            } else if (thisMixerContentsLine.startsWith("  Playback channels")) {
                                                try {
                                                    boolean shouldMute = ((headphonesAreConnected && thisCardMixerControlName.startsWith("'Speaker")) || (!headphonesAreConnected && thisCardMixerControlName.startsWith("'Headphone")));
                                                    ArrayList<String> amixerSsetCommand = new ArrayList<>();
                                                    amixerSsetCommand.add("/usr/bin/amixer");
                                                    amixerSsetCommand.addAll(Arrays.asList(thisOutputCardArguments));
                                                    amixerSsetCommand.addAll(Arrays.asList("sset", thisCardMixerControlName, "playback", (shouldMute ? "0" : (thisCardMixerControlName.contains(" Boost'") ? "100" : desiredVolumePercentage)) + "%", (shouldMute ? "mute" : "unmute")));
                                                    Runtime.getRuntime().exec(amixerSsetCommand.toArray(String[]::new)).waitFor();
                                                } catch (IOException | InterruptedException setCardOutputVolumeException) {
                                                    if (isTestMode) {
                                                        System.out.println("setCardOutputVolumeException (" + String.join(" ", thisOutputCardArguments) + " + " + thisCardMixerControlName + "): " + setCardOutputVolumeException);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                } else if (isMacOS) {
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "set volume output volume 50 without output muted", "-e", "set volume alert volume 100"}).waitFor();
                                    } catch (IOException | InterruptedException setMacOutputVolumeException) {
                                        if (isTestMode) {
                                            System.out.println("setMacOutputVolumeException: " + setMacOutputVolumeException);
                                        }
                                    }
                                }

                                publish("playback");

                                boolean didPlaybackMicrophoneTest = false;

                                if (!isLinux) {
                                    if (didAutomateQuickTime) {
                                        try {
                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript",
                                                "-e", "tell application id \"com.apple.QuickTimePlayerX\"",
                                                "-e", "try",
                                                "-e", "activate",
                                                "-e", "end try",
                                                "-e", "play (document 1)",
                                                "-e", "end tell"}).waitFor();

                                            focusWindow();
                                            TimeUnit.SECONDS.sleep(microphoneTestDurationSeconds);

                                            try {
                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript",
                                                    "-e", "tell application id \"com.apple.QuickTimePlayerX\"",
                                                    "-e", "try",
                                                    "-e", "close every window without saving",
                                                    "-e", "end try",
                                                    "-e", "delay 1",
                                                    "-e", "with timeout of 1 second",
                                                    "-e", "quit",
                                                    "-e", "end timeout",
                                                    "-e", "end tell"
                                                }).waitFor();

                                                focusWindow();
                                                didPlaybackMicrophoneTest = true;
                                            } catch (IOException | InterruptedException automateStartQuickTimePlaybackException) {
                                                if (isTestMode) {
                                                    System.out.println("automateStartQuickTimePlaybackException: " + automateStartQuickTimePlaybackException);
                                                }
                                            }
                                        } catch (IOException | InterruptedException automateStartQuickTimePlaybackException) {
                                            if (isTestMode) {
                                                System.out.println("automateStartQuickTimePlaybackException: " + automateStartQuickTimePlaybackException);
                                            }
                                        }
                                    } else {
                                        // Java AudioSystem is not reliable on Linux and can fail with UnsatisfiedLinkError or an "Invalid Format" Exception for seemingly no reason.
                                        // But, worst of all, sometimes it doesn't error and just doesn't play anything.

                                        try (Clip microphoneTestClip = AudioSystem.getClip()) {
                                            //if (didRecordByteStream) {

                                            // Will only ever have recorded a byte stream since only used on Mac and Windows.
                                            byte[] recordingByteArray = recordingOutputByteStream.toByteArray();
                                            microphoneTestClip.open(new AudioInputStream(new ByteArrayInputStream(recordingByteArray), recordingFormat, recordingByteArray.length));

                                            //} else if (didRecordFile) {
                                            //    microphoneTestClip.open(AudioSystem.getAudioInputStream(new File(System.getProperty("java.io.tmpdir"), "qa_helper-mic_test.wav")));
                                            //}
                                            microphoneTestClip.start();

                                            TimeUnit.SECONDS.sleep(microphoneTestDurationSeconds);

                                            didPlaybackMicrophoneTest = true;
                                        } catch (Error | Exception playbackMicrophoneTestClipErrorOrException) {
                                            if (isTestMode) {
                                                System.out.println("playbackMicrophoneTestClipErrorOrException: " + playbackMicrophoneTestClipErrorOrException);
                                            }
                                        }
                                    }
                                }

                                if (!didPlaybackMicrophoneTest && !isWindows) {
                                    File microphoneTestTempFile = null;
                                    String microphoneTestTempPath = "";

                                    if (didRecordByteStream) {
                                        microphoneTestTempFile = File.createTempFile("qa_helper-mic_test", ".wav");
                                        microphoneTestTempFile.deleteOnExit();

                                        byte[] recordingByteArray = recordingOutputByteStream.toByteArray();
                                        try (AudioInputStream microphoneTestInputStream = new AudioInputStream(new ByteArrayInputStream(recordingByteArray), recordingFormat, recordingByteArray.length)) {
                                            AudioSystem.write(microphoneTestInputStream, AudioFileFormat.Type.WAVE, microphoneTestTempFile);
                                            microphoneTestTempPath = microphoneTestTempFile.getPath();
                                        } catch (Exception readMicrophoneTestException) {
                                            if (isTestMode) {
                                                System.out.println("readMicrophoneTestException: " + readMicrophoneTestException);
                                            }
                                        }
                                    }

                                    if (didRecordFile || !microphoneTestTempPath.isEmpty()) {
                                        if (microphoneTestTempPath.isEmpty()) {
                                            microphoneTestTempPath = new File(System.getProperty("java.io.tmpdir"), "qa_helper-mic_test.wav").getPath();
                                        }

                                        for (int playbackRecordingAttempt = 0; playbackRecordingAttempt < 3; playbackRecordingAttempt++) {
                                            if (playbackRecordingAttempt > 0) {
                                                publish("re-playback");
                                            }

                                            try {
                                                Runtime.getRuntime().exec((isLinux // Mint 19.3 in pre-install seems to have an issue on some computers where the beginning get's cut off. This "aplay /dev/null; sleep 1" seems to help work around it. (Like aplay needs to be warmed up or something stupid like that?)
                                                        ? new String[]{"/bin/sh", "-c", "/usr/bin/aplay /dev/null; /bin/sleep 1; /usr/bin/aplay -D hw:" + outputCard + "," + outputDevice + " '" + microphoneTestTempPath.replace("'", "'\\''") + "'"}
                                                        : new String[]{"/usr/bin/afplay", microphoneTestTempPath})
                                                );

                                                TimeUnit.SECONDS.sleep(microphoneTestDurationSeconds + (isLinux ? 1 : 0));

                                                didPlaybackMicrophoneTest = true;

                                                break;
                                            } catch (IOException | InterruptedException playbackMicrophoneTestFileException) {
                                                if (isTestMode) {
                                                    System.out.println("playbackMicrophoneTestFileException: " + playbackMicrophoneTestFileException);
                                                }
                                                TimeUnit.SECONDS.sleep(1);
                                            }
                                        }
                                    }

                                    if ((microphoneTestTempFile != null) && microphoneTestTempFile.exists()) {
                                        microphoneTestTempFile.delete();
                                    }

                                    if (!didPlaybackMicrophoneTest) {
                                        didRecordAndPlayBack = false;
                                    }
                                }
                            } else {
                                didRecordAndPlayBack = false;
                            }

                            if (isLinux) {
                                try { // There is an odd rare bug on Linux Mint 20.3 (not sure if it affect other versions) which may be caused by driver issues where the audio keeps looping in segments and it can go on for a long time, so "killall aplay" just in case to stop it.
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "aplay"});
                                } catch (IOException quitAplayException) {
                                    if (isTestMode) {
                                        System.out.println("quitAplayException: " + quitAplayException);
                                    }
                                }

                                File micTestRecordingFile = new File(System.getProperty("java.io.tmpdir"), "qa_helper-mic_test.wav");
                                if (micTestRecordingFile.exists()) {
                                    micTestRecordingFile.delete();
                                }
                            } else if (isWindows) {
                                try {
                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$WscriptShell = New-Object -ComObject Wscript.Shell; if ($WscriptShell.AppActivate('Sound')) { $WscriptShell.SendKeys('%{F4}') }; Start-Sleep -Milliseconds 500; if ($WscriptShell.AppActivate('Sound')) { $WscriptShell.SendKeys('%{F4}') }"}).waitFor(); // Try closing Sound window twice in case the Properties windows is open.
                                } catch (IOException | InterruptedException quitRecordingPropertiesException) {
                                    if (isTestMode) {
                                        System.out.println("quitRecordingPropertiesException: " + quitRecordingPropertiesException);
                                    }
                                }

                                try {
                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", "SndVol.exe", "/t"}).waitFor();
                                } catch (IOException | InterruptedException quitSoundMixerException) {
                                    if (isTestMode) {
                                        System.out.println("quitSoundMixerException: " + quitSoundMixerException);
                                    }
                                }
                            }

                            return didRecordAndPlayBack;
                        }

                        @Override
                        protected void process(java.util.List<String> tasks) {
                            tasks.forEach((thisTask) -> {
                                switch (thisTask) {
                                    case "recording":
                                    case "re-recording":
                                        boolean isReRecording = (thisTask.startsWith("re-"));
                                        loadingWindow.setLoadingTextAndDisplay("QA Helper is " + (isReRecording ? "Re-" : "") + "Recording " + microphoneTestDurationSeconds + " Seconds of Audio", "Testing", "StudioMicrophone");
                                        loadingWindow.setLoadingProgressBarToMax(microphoneTestDurationSeconds);

                                        if (!isReRecording) {
                                            (new SwingWorker<Void, String>() {
                                                @Override
                                                protected Void doInBackground() throws Exception {
                                                    do {
                                                        TimeUnit.SECONDS.sleep(1);
                                                        publish("progress");
                                                    } while (loadingWindow.isVisible());

                                                    return null;
                                                }

                                                @Override
                                                protected void process(java.util.List<String> tasks) {
                                                    loadingWindow.incrementLoadingProgressBar();
                                                }
                                            }).execute();

                                            loadingWindow.incrementLoadingProgressBar();
                                        }

                                        break;
                                    case "playback":
                                    case "re-playback":
                                        loadingWindow.setLoadingTextAndDisplay("QA Helper is " + (thisTask.startsWith("re-") ? "Re-" : "") + "Playing Back " + microphoneTestDurationSeconds + " Second Recording", "Testing", "SpeakerHighVolume");
                                        loadingWindow.setLoadingProgressBarToMax(microphoneTestDurationSeconds + (isLinux ? 1 : 0));
                                        break;
                                    default:
                                        break;
                                }
                            });
                        }

                        @Override
                        protected void done() {
                            focusWindow(); // To make sure we have focus after closing Sound and Recording stuff on Windows.

                            loadingWindow.closeWindow();

                            try {
                                if (get()) {
                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Microphone Test Completed</b>"
                                            + "<br/><br/><br/>"
                                            + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>MICROPHONE TEST PASSED IF:</b>"
                                            + "<ul style='margin-left: 20px'>"
                                            + "<li>You heard your recording <u>crisply and clearly</u>.</li>"
                                            + "</ul>"
                                            + "<br/>"
                                            + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>MICROPHONE TEST FAILED IF:</b>"
                                            + "<ul style='margin-left: 20px'>"
                                            + "<li><u>Nothing</u> got recorded.</li>"
                                            + "<li>The recording <u>didn't sound crisp and clear</u>.</li>"
                                            + "</ul>"
                                            + "<br/>"
                                            + ((isLinux && (microphoneInputVolumeComboBox.getSelectedIndex() == 2))
                                            ? new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>IF THE RECORDING WAS <u>VERY QUIET/SILENT</u> OR <u>VERY LOAD/DISTORTED</u>:</b><br/>"
                                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'><i>TEST AGAIN WITH <u>HIGHER OR LOWER MIC INPUT VOLUME</u> SELECTED</i></b>"
                                            : new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF MICROPHONE TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right"))
                                            + "</html>", "QA Helper  —  Microphone Test Completed", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("StudioMicrophone", qaHelperWindow).toImageIcon());

                                    if (!isMicrophoneVerified && btnVerifyMicrophone.isVisible() && btnVerifyMicrophone.isEnabled()) {
                                        btnVerifyMicrophoneActionPerformed(null);
                                    }
                                } else {
                                    playAlertSound("error");
                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b>Failed to Record Audio or Playback Recording</b>" + (isMacOS ? (computerSpecs.getFullCPU().endsWith("+ T2 Security Chip") ? "<br/><br/>Sometimes the recording fails on T2 Macs. Try again." : "<br/><br/>If you approved Microphone access and still got this error, quit and relaunch QA Helper and then try again.") : "") + "</html>", "QA Helper  —  Microphone Test Error", JOptionPane.ERROR_MESSAGE, new TwemojiImage("StudioMicrophone", qaHelperWindow).toImageIcon(32));
                                }
                            } catch (HeadlessException | InterruptedException | ExecutionException finishMicrophoneTestException) {
                                if (isTestMode) {
                                    System.out.println("finishMicrophoneTestException: " + finishMicrophoneTestException);
                                }
                            }

                            setActionsEnabled(true);
                        }
                    }).execute();
                } else {
                    if (isWindows) {
                        try {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$WscriptShell = New-Object -ComObject Wscript.Shell; if ($WscriptShell.AppActivate('Sound')) { $WscriptShell.SendKeys('%{F4}') }; Start-Sleep -Milliseconds 500; if ($WscriptShell.AppActivate('Sound')) { $WscriptShell.SendKeys('%{F4}') }"}).waitFor(); // Try closing Sound window twice in case the Properties windows is open.
                        } catch (IOException | InterruptedException quitRecordingPropertiesException) {
                            if (isTestMode) {
                                System.out.println("quitRecordingPropertiesException: " + quitRecordingPropertiesException);
                            }
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/im", "SndVol.exe", "/t"}).waitFor();
                        } catch (IOException | InterruptedException quitSoundMixerException) {
                            if (isTestMode) {
                                System.out.println("quitSoundMixerException: " + quitSoundMixerException);
                            }
                        }
                    }

                    setActionsEnabled(true);
                    focusNextTestTaskVerifyButton(btnTestMicrophone);
                }
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestMicrophoneActionPerformed

    private void btnVerifyMicrophoneActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyMicrophoneActionPerformed
        if ((actionsEnabled || (evt == null)) && !isWindowsPE && (!isMacOS || !new CommandReader(new String[]{"/usr/bin/osascript", "-e", "input volume of (get volume settings)"}).getFirstOutputLine().equals("missing value"))) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isMicrophoneVerified ? "UNVERIFY" : "verify") + "</i> the microphone?</b></html>", "QA Helper  —  Confirm " + (isMicrophoneVerified ? "Unverify" : "Verify") + " Microphone", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isMicrophoneVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isMicrophoneVerified = !isMicrophoneVerified;

                writeToHelperLogFile("Test: Microphone " + (isMicrophoneVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyMicrophone.setText((isMicrophoneVerified ? "Verified" : "Verify"));
                btnVerifyMicrophone.setFont(btnVerifyMicrophone.getFont().deriveFont((isMicrophoneVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyMicrophone.setForeground(isMicrophoneVerified ? verifiedColor : defaultColor);
                btnVerifyMicrophone.setBorderPainted(!isMicrophoneVerified);

                new LinuxAutoScripts("Microphone " + (isMicrophoneVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyMicrophone);
            } else {
                focusNextTestTaskVerifyButton(btnTestMicrophone);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyMicrophoneActionPerformed

    private void btnTestCameraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestCameraActionPerformed
        if (actionsEnabled && !isWindowsPE) {
            setActionsEnabled(false);

            if (!computerSpecs.hasCamera()) {
                playAlertSound("error");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>No Camera Detected</b><br/><br/><i>If this computer is supposed to have a camera, then Camera Test has failed.</i></html>", "QA Helper  —  Camera Test Error", JOptionPane.ERROR_MESSAGE, new TwemojiImage("NoEntry", qaHelperWindow).toImageIcon(32));

                setActionsEnabled(true);
                focusNextTestTaskVerifyButton(btnTestCamera);
            } else {
                boolean enoughRAMforCameraTest = true;

                if (isLinuxBootedToRAM) {
                    // There may not be enough free RAM for Cheese when booted "toram"
                    try {
                        enoughRAMforCameraTest = (2000000000 <= Long.parseLong(new CommandReader("/usr/bin/free -b | /usr/bin/awk '($1 == \"Mem:\") { print $4; exit }'").getFirstOutputLine()));
                    } catch (NumberFormatException getFreeMemoryException) {
                        if (isTestMode) {
                            System.out.println("getFreeMemoryException: " + getFreeMemoryException);
                        }
                    }
                }

                if (enoughRAMforCameraTest) {
                    final int cameraTestDurationSeconds = 10;

                    int cameraTestPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Camera Test will open a camera feed in " + (isLinux ? "full screen" : (isMacOS ? "<i>Photo Booth</i>" : "<i>Camera</i>")) + " and keep it open for <u>" + cameraTestDurationSeconds + " seconds</u>.</b>"
                            + "<br/><br/>"
                            + "<center>" + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>YOU DO NOT NEED TO RECORD THE VIDEO</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "</center>"
                            + "<br/>"
                            + new TwemojiImage("WavingHand", qaHelperWindow).toImgTag("left") + " <u>Wave your hands</u> in front of the camera to make sure the <u>camera feed updates properly</u>."
                            + "<br/><br/>"
                            + new TwemojiImage("Eyes", qaHelperWindow).toImgTag("left") + " <u>Look around the entire image</u> to make sure the camera feed is <u>crisp, clear, and bright</u>.<br/>"
                            + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " Also, make sure there is <u>no darkness around the edge</u> as well as <u>no spots or artifacts</u>."
                            + "<br/><br/>"
                            + new TwemojiImage("Stopwatch", qaHelperWindow).toImgTag("left") + " <b><i>After " + cameraTestDurationSeconds + " seconds</i>, the camera feed will be <u>closed automatically</u>.</b>"
                            + "<br/><br/><br/>"
                            + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>CAMERA TEST PASSED IF:</b>"
                            + "<ul style='margin-left: 20px'>"
                            + "<li>The image is <u>crisp, clear, and bright</u>.</li>"
                            + "<li>There is <u>no dark edge</u> around the image.</li>"
                            + "<li>There are <u>no spots or artifacts</u> in the image.</li>"
                            + "</ul>"
                            + "<br/>"
                            + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>CAMERA TEST FAILED IF:</b>"
                            + "<ul style='margin-left: 20px'>"
                            + "<li>The image is <u>blurry or dim</u>.</li>"
                            + "<li>There is a <u>dark edge</u> around the image.</li>"
                            + "<li>There are <u>any spots or artifacts</u> in the image.</li>"
                            + "</ul>"
                            + "<br/><center>"
                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF CAMERA TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                            + "</center></html>", "QA Helper  —  Camera Test", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE, new TwemojiImage("MovieCamera", qaHelperWindow).toImageIcon());

                    if (cameraTestPromptReturn == JOptionPane.OK_OPTION) {
                        loadingWindow.setLoadingTextAndDisplay("QA Helper is Setting Up Camera Test", "Testing", "MovieCamera");

                        (new SwingWorker<String, String>() {
                            @Override
                            protected String doInBackground() throws Exception {
                                if (isLinux) {
                                    boolean cheeseWasInstalled = false;
                                    boolean cheeseInstalledViaTerminal = false;
                                    String cheesePath = "/usr/bin/cheese";

                                    if (new File("/usr/share/glib-2.0/schemas/org.gnome.Cheese.gschema.xml").exists()) {
                                        String[] possibleCheesePaths = new String[]{"/usr/bin/cheese", "LD_LIBRARY_PATH=/cdrom/preseed/dependencies/ /cdrom/preseed/dependencies/cheese"};

                                        for (String thisCheesePath : possibleCheesePaths) {
                                            cheeseWasInstalled = !new CommandReader(thisCheesePath + " -v").getFirstOutputLineContaining(".").isEmpty();

                                            if (cheeseWasInstalled) {
                                                cheesePath = thisCheesePath;
                                                break;
                                            }
                                        }
                                    }

                                    if (isTestMode) {
                                        System.out.println("cheesePath: " + cheesePath);
                                    }

                                    boolean cheeseIsInstalled = cheeseWasInstalled;

                                    if (!cheeseWasInstalled) {
                                        String previousAdminPassword = adminPassword;
                                        getAdminPassword("Run Camera Test"); // Double-check that admin password is still correct.

                                        if (!adminPassword.equals(previousAdminPassword)) {
                                            computerSpecs.reloadSpecs(adminPassword, isTestMode);

                                            publish("reloaded");
                                        }

                                        if (!adminPassword.equals("*UNKNOWN*")) {
                                            try {
                                                Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get install --no-install-recommends -qq cheese"}).waitFor();
                                                cheeseIsInstalled = !new CommandReader(new String[]{"/usr/bin/cheese", "-v"}).getFirstOutputLineContaining(".").isEmpty();
                                            } catch (IOException | InterruptedException installCheeseException) {
                                                if (isTestMode) {
                                                    System.out.println("installCheeseException: " + installCheeseException);
                                                }
                                            }

                                            if (!cheeseIsInstalled && !isLinuxUbiquityMode) {
                                                try {
                                                    File waitForTerminalPIDtempFile = File.createTempFile("qa_helper-wait_for_terminal_pid", ".txt");
                                                    waitForTerminalPIDtempFile.deleteOnExit();

                                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Installing \"cheese\"' --hide-menubar --geometry '80x25+0+0' -x /bin/bash -c 'orig_temp_owner=$(/usr/bin/stat -c %U " + waitForTerminalPIDtempFile.getPath() + "); /bin/chown root " + waitForTerminalPIDtempFile.getPath() + "; echo $$ > " + waitForTerminalPIDtempFile.getPath() + "; /bin/chown ${orig_temp_owner} " + waitForTerminalPIDtempFile.getPath() + "; echo \"\nINSTALLING \\\"cheese\\\"\n\n\"; /usr/local/bin/apt install --no-install-recommends -y cheese; echo \"\n\nFINISHED INSTALLING \\\"cheese\\\"\nTHIS TERMINAL WINDOW WILL CLOSE IN 5 SECONDS - OR PRESS ENTER TO CLOSE NOW\"; read -t 5; /usr/bin/wmctrl -a \"QA Helper\"'"});

                                                    String waitForTerminalPID = "";

                                                    for (int i = 0; i < 10; i++) {
                                                        if (waitForTerminalPIDtempFile.exists()) {
                                                            try {
                                                                List<String> waitForTerminalPIDtempFileLines = Files.readAllLines(Paths.get(waitForTerminalPIDtempFile.getPath()), StandardCharsets.UTF_8);

                                                                if (!waitForTerminalPIDtempFileLines.isEmpty()) {
                                                                    waitForTerminalPID = waitForTerminalPIDtempFileLines.get(0);
                                                                    if (!waitForTerminalPID.isEmpty()) {
                                                                        break;
                                                                    }
                                                                }
                                                            } catch (IOException | IndexOutOfBoundsException getTerminalPIDException) {
                                                                if (isTestMode) {
                                                                    System.out.println("getTerminalPIDException: " + getTerminalPIDException);
                                                                }
                                                            }
                                                        }

                                                        TimeUnit.MILLISECONDS.sleep(500);
                                                    }

                                                    if (waitForTerminalPIDtempFile.exists()) {
                                                        waitForTerminalPIDtempFile.delete();
                                                    }

                                                    if (!waitForTerminalPID.isEmpty()) {
                                                        while (!new CommandReader(new String[]{"/bin/ps", "-p", waitForTerminalPID, "-o", "pid="}).getFirstOutputLine().isEmpty()) {
                                                            TimeUnit.MILLISECONDS.sleep(500);
                                                        }
                                                    }

                                                    cheeseIsInstalled = !new CommandReader(new String[]{"/usr/bin/cheese", "-v"}).getFirstOutputLineContaining(".").isEmpty();
                                                    cheeseInstalledViaTerminal = cheeseIsInstalled;
                                                } catch (IOException | InterruptedException installCheeseViaTerminalException) {
                                                    if (isTestMode) {
                                                        System.out.println("installCheeseViaTerminalException: " + installCheeseViaTerminalException);
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    if (cheeseIsInstalled) {
                                        try {
                                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", cheesePath + " -f"});
                                        } catch (IOException runCheeseException) {
                                            if (isTestMode) {
                                                System.out.println("runCheeseException: " + runCheeseException);
                                            }
                                        }

                                        for (int waitForCheese = 0; waitForCheese < 30; waitForCheese++) {
                                            TimeUnit.MILLISECONDS.sleep(500);

                                            if (!new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("Cheese").isEmpty() || !new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("Photo").isEmpty()) {
                                                break;
                                            }
                                        }

                                        if (!new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("Cheese").isEmpty() || !new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("Photo").isEmpty()) {
                                            TimeUnit.SECONDS.sleep(1); // Sleep 1 extra second to make sure app is fully loaded.

                                            publish("running");

                                            for (int i = 0; i < cameraTestDurationSeconds; i++) {
                                                TimeUnit.SECONDS.sleep(1);

                                                if ((i >= (cameraTestDurationSeconds / 2)) && new CommandReader(new String[]{"/usr/bin/pgrep", "cheese"}).getFirstOutputLine().isEmpty()) {
                                                    playAlertSound("error");
                                                    break;
                                                }
                                            }
                                        }

                                        publish("finishing"); // Must be here to always set loadingWindow to alwaysOnTop.
                                        TimeUnit.SECONDS.sleep(1); // Sleep for a second to make sure the finishing progress has time to show before being closed.

                                        try {
                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/killall", "cheese"}).waitFor();
                                        } catch (IOException | InterruptedException quitCheeseException) {
                                            if (isTestMode) {
                                                System.out.println("quitCheeseException: " + quitCheeseException);
                                            }
                                        }

                                        if (!cheeseWasInstalled) {
                                            if (cheeseInstalledViaTerminal) {
                                                try {
                                                    File waitForTerminalPIDtempFile = File.createTempFile("qa_helper-wait_for_terminal_pid", ".txt");
                                                    waitForTerminalPIDtempFile.deleteOnExit();

                                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Uninstalling \"cheese\"' --hide-menubar --geometry '80x25+0+0' -x /bin/bash -c 'orig_temp_owner=$(/usr/bin/stat -c %U " + waitForTerminalPIDtempFile.getPath() + "); /bin/chown root " + waitForTerminalPIDtempFile.getPath() + "; echo $$ > " + waitForTerminalPIDtempFile.getPath() + "; /bin/chown ${orig_temp_owner} " + waitForTerminalPIDtempFile.getPath() + "; echo \"\nUNINSTALLING \\\"cheese\\\"\n\n\"; /usr/local/bin/apt purge --auto-remove -y cheese; echo \"\n\nFINISHED UNINSTALLING \\\"cheese\\\"\nTHIS TERMINAL WINDOW WILL CLOSE IN 5 SECONDS - OR PRESS ENTER TO CLOSE NOW\"; read -t 5; /usr/bin/wmctrl -a \"QA Helper\"'"});

                                                    String waitForTerminalPID = "";

                                                    for (int i = 0; i < 10; i++) {
                                                        if (waitForTerminalPIDtempFile.exists()) {
                                                            try {
                                                                List<String> waitForTerminalPIDtempFileLines = Files.readAllLines(Paths.get(waitForTerminalPIDtempFile.getPath()), StandardCharsets.UTF_8);

                                                                if (!waitForTerminalPIDtempFileLines.isEmpty()) {
                                                                    waitForTerminalPID = waitForTerminalPIDtempFileLines.get(0);
                                                                    if (!waitForTerminalPID.isEmpty()) {
                                                                        break;
                                                                    }
                                                                }
                                                            } catch (IOException | IndexOutOfBoundsException getTerminalPIDException) {
                                                                if (isTestMode) {
                                                                    System.out.println("getTerminalPIDException: " + getTerminalPIDException);
                                                                }
                                                            }
                                                        }

                                                        TimeUnit.MILLISECONDS.sleep(500);
                                                    }

                                                    if (waitForTerminalPIDtempFile.exists()) {
                                                        waitForTerminalPIDtempFile.delete();
                                                    }

                                                    if (!waitForTerminalPID.isEmpty()) {
                                                        while (!new CommandReader(new String[]{"/bin/ps", "-p", waitForTerminalPID, "-o", "pid="}).getFirstOutputLine().isEmpty()) {
                                                            TimeUnit.MILLISECONDS.sleep(500);
                                                        }
                                                    }
                                                } catch (IOException | InterruptedException uninstallCheeseViaTerminalException) {
                                                    if (isTestMode) {
                                                        System.out.println("uninstallCheeseViaTerminalException: " + uninstallCheeseViaTerminalException);
                                                    }
                                                }
                                            } else {
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get purge --auto-remove -qq cheese"}).waitFor();
                                                } catch (IOException | InterruptedException uninstallCheeseException) {
                                                    if (isTestMode) {
                                                        System.out.println("uninstallCheeseException: " + uninstallCheeseException);
                                                    }
                                                }
                                            }
                                        }
                                    } else {
                                        return "install-error";
                                    }
                                } else if (isMacOS) {
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-b", "com.apple.PhotoBooth"}).waitFor();
                                        TimeUnit.SECONDS.sleep(1); // Sleep 1 extra second to make sure app is fully loaded.

                                        publish("running");

                                        for (int i = 0; i < cameraTestDurationSeconds; i++) {
                                            TimeUnit.SECONDS.sleep(1);

                                            if ((i >= (cameraTestDurationSeconds / 2)) && new CommandReader(new String[]{"/usr/bin/pgrep", "Photo Booth"}).getFirstOutputLine().isEmpty()) {
                                                playAlertSound("error");
                                                break;
                                            }
                                        }
                                    } catch (IOException | InterruptedException runPhotoBoothException) {
                                        if (isTestMode) {
                                            System.out.println("runPhotoBoothException: " + runPhotoBoothException);
                                        }
                                    }

                                    publish("finishing"); // Must be here to always set loadingWindow to alwaysOnTop.
                                    TimeUnit.SECONDS.sleep(1); // Sleep for a second to make sure the finishing progress has time to show before being closed.

                                    try {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "with timeout of 1 second", "-e", "tell application id \"com.apple.PhotoBooth\" to quit", "-e", "end timeout"}).waitFor();
                                    } catch (IOException | InterruptedException quitPhotoBoothException) {
                                        if (isTestMode) {
                                            System.out.println("quitPhotoBoothException: " + quitPhotoBoothException);
                                        }
                                    }
                                } else if (isWindows) {
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START microsoft.windows.camera:"}).waitFor();
                                        TimeUnit.SECONDS.sleep(1); // Sleep 1 extra second to make sure app is fully loaded.

                                        publish("running");

                                        for (int i = 0; i < cameraTestDurationSeconds; i++) {
                                            TimeUnit.SECONDS.sleep(1);

                                            if ((i >= (cameraTestDurationSeconds / 2)) && new CommandReader(new String[]{"\\Windows\\System32\\tasklist.exe", "/nh", "/fi", "WINDOWTITLE eq Camera"}).getFirstOutputLineContaining("ApplicationFrameHost.exe").isEmpty()) {
                                                playAlertSound("error");
                                                break;
                                            }
                                        }
                                    } catch (IOException | InterruptedException runCameraAppException) {
                                        if (isTestMode) {
                                            System.out.println("runCameraAppException: " + runCameraAppException);
                                        }
                                    }

                                    publish("finishing"); // Must be here to always set loadingWindow to alwaysOnTop.
                                    TimeUnit.SECONDS.sleep(1); // Sleep for a second to make sure the finishing progress has time to show before being closed.

                                    try {
                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\taskkill.exe", "/fi", "WINDOWTITLE eq Camera", "/t"}).waitFor();
                                    } catch (IOException | InterruptedException quitCameraAppException) {
                                        if (isTestMode) {
                                            System.out.println("quitCameraAppException: " + quitCameraAppException);
                                        }
                                    }
                                }

                                return "done";
                            }

                            @Override
                            protected void process(java.util.List<String> tasks) {
                                tasks.forEach((thisTask) -> {
                                    switch (thisTask) {
                                        case "reloaded":
                                            displayComputerSpecs();
                                            break;
                                        case "running":
                                            loadingWindow.setAlwaysOnTop(false);
                                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Testing Camera for " + cameraTestDurationSeconds + " Seconds", "Testing", "MovieCamera");

                                            (new SwingWorker<Void, String>() {
                                                @Override
                                                protected Void doInBackground() throws Exception {
                                                    do {
                                                        TimeUnit.SECONDS.sleep(1);
                                                        publish("progress");
                                                    } while (loadingWindow.isVisible());

                                                    return null;
                                                }

                                                @Override
                                                protected void process(java.util.List<String> tasks) {
                                                    loadingWindow.incrementLoadingProgressBar();
                                                }
                                            }).execute();

                                            loadingWindow.setLoadingProgressBarToMax(cameraTestDurationSeconds);
                                            loadingWindow.incrementLoadingProgressBar();
                                            break;
                                        case "finishing":
                                            if (loadingWindow.isVisible()) {
                                                // Make sure to only do this if the window is still visible in case the multi-threaded timing make it so that we finish before this gets processed.
                                                loadingWindow.setLoadingTextAndDisplay("QA Helper is Finishing Camera Test", "Testing", "MovieCamera");
                                                loadingWindow.setLoadingProgressBarToMax(0);
                                                loadingWindow.setAlwaysOnTop(true);
                                            }
                                            break;
                                        default:
                                            break;
                                    }
                                });
                            }

                            @Override
                            protected void done() {
                                focusWindow();

                                loadingWindow.closeWindow();

                                try {
                                    String cheeseReturn = get();

                                    if (cheeseReturn.equals("install-error")) {
                                        playAlertSound("error");
                                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Install \"cheese\"</b><br/><br/><i>To manually install \"cheese\", open Terminal and run:</i><br/><pre>sudo apt install cheese</pre><br/>After \"cheese\" is installed, come back here and try again.</html>", "QA Helper  —  Camera Test Error", JOptionPane.ERROR_MESSAGE);
                                    } else {
                                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Camera Test Completed</b>"
                                                + "<br/><br/><br/>"
                                                + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>CAMERA TEST PASSED IF:</b>"
                                                + "<ul style='margin-left: 20px'>"
                                                + "<li>The image was <u>crisp, clear, and bright</u>.</li>"
                                                + "<li>There was <u>no dark edge</u> around the image.</li>"
                                                + "<li>There were <u>no spots or artifacts</u> in the image.</li>"
                                                + "</ul>"
                                                + "<br/>"
                                                + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>CAMERA TEST FAILED IF:</b>"
                                                + "<ul style='margin-left: 20px'>"
                                                + "<li>The image was <u>blurry or dim</u>.</li>"
                                                + "<li>There was a <u>dark edge</u> around the image.</li>"
                                                + "<li>There were <u>any spots or artifacts</u> in the image.</li>"
                                                + "</ul>"
                                                + "<br/><center>"
                                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF CAMERA TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                                + "</center></html>", "QA Helper  —  Camera Test Completed", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("MovieCamera", qaHelperWindow).toImageIcon());

                                        if (!isCameraVerified && btnVerifyCamera.isVisible() && btnVerifyCamera.isEnabled()) {
                                            btnVerifyCameraActionPerformed(null);
                                        }
                                    }
                                } catch (HeadlessException | InterruptedException | ExecutionException finishCameraTestException) {
                                    if (isTestMode) {
                                        System.out.println("finishCameraTestException: " + finishCameraTestException);
                                    }
                                }

                                setActionsEnabled(true);
                            }
                        }).execute();
                    } else {
                        setActionsEnabled(true);
                        focusNextTestTaskVerifyButton(btnTestCamera);
                    }
                } else {
                    playAlertSound("beep");
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Not Enough Free RAM to Open Cheese to Test Camera</b><br/><br/><i>You will be able to test the camera after you've installed the OS.</i></html>", "QA Helper  —  Cannot Run Camera Test", JOptionPane.WARNING_MESSAGE);

                    setActionsEnabled(true);
                    focusNextTestTaskVerifyButton(btnTestCamera);
                }
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestCameraActionPerformed

    private void btnVerifyCameraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyCameraActionPerformed
        if ((actionsEnabled || (evt == null)) && computerSpecs.hasCamera() && !isWindowsPE) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isCameraVerified ? "UNVERIFY" : "verify") + "</i> the camera?</b></html>", "QA Helper  —  Confirm " + (isCameraVerified ? "Unverify" : "Verify") + " Camera", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isCameraVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isCameraVerified = !isCameraVerified;

                writeToHelperLogFile("Test: Camera " + (isCameraVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyCamera.setText((isCameraVerified ? "Verified" : "Verify"));
                btnVerifyCamera.setFont(btnVerifyCamera.getFont().deriveFont((isCameraVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyCamera.setForeground(isCameraVerified ? verifiedColor : defaultColor);
                btnVerifyCamera.setBorderPainted(!isCameraVerified);

                new LinuxAutoScripts("Camera " + (isCameraVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyCamera);
            } else {
                focusNextTestTaskVerifyButton(btnTestCamera);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyCameraActionPerformed

    private void btnTestKeyboardActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestKeyboardActionPerformed
        if (actionsEnabled && (!isWindowsPE || (isWindowsRE && new File("\\Install\\Diagnostic Tools\\Web Browser (PE).exe").exists()))) {
            setActionsEnabled(false);

            boolean enoughRAMforKeyboardTest = true;

            if (isLinuxBootedToRAM) {
                // There may not be enough free RAM for Firefox when booted "toram"
                try {
                    enoughRAMforKeyboardTest = (2000000000 <= Long.parseLong(new CommandReader("/usr/bin/free -b | /usr/bin/awk '($1 == \"Mem:\") { print $4; exit }'").getFirstOutputLine()));
                } catch (NumberFormatException getFreeMemoryException) {
                    if (isTestMode) {
                        System.out.println("getFreeMemoryException: " + getFreeMemoryException);
                    }
                }
            }

            boolean isMacOSwithKeyboardTestApp = (isMacOS && (new File("/Users/fg-demo/Applications/Keyboard Test.app").exists() || new File("/Applications/Keyboard Test.app").exists()));

            if (enoughRAMforKeyboardTest) {
                String keyboardTestInstructions = "<br/><br/>"
                        + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " The best way to test a keyboard is to <u>TYPE ACTUAL WORDS</u> and make sure that exactly<br/>"
                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " what you typed <u>shows up in the text box</u> and that each key highlights <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> <u>as you type it</u>."
                        + "<br/><br/>"
                        + new TwemojiImage("BackhandIndexPointingDown", qaHelperWindow).toImgTag("left") + " When a <u>key is pressed</u> on the keyboard, it will <u>momentarily highlight</u> <b style='color: orange; background-color: white'>&nbsp;Orange&nbsp;</b><br/>"
                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " and then <u>highlight</u> <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> " + (isMacOSwithKeyboardTestApp ? "in the <u>Keyboard Test</u> app" : "on <u>KeyboardTester.com</u>") + "."
                        + "<br/><br/>"
                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " Start testing the keyboard by typing <b><i>The quick brown fox jumps over the lazy dog.</i></b>"
                        + "<br/><br/>"
                        + new TwemojiImage("Prohibited", qaHelperWindow).toImgTag("left") + " You <u>SHOULD NOT just slide your finger across the keyboard</u> to hit every key.<br/>"
                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " <i>With water damaged keyboards, it's common that one key on the keyboard may trigger the wrong key, or multiple keys.</i><br/>"
                        + new TwemojiImage("Blank", qaHelperWindow).toImgTag("left") + " Also, modifier keys such as <b>Shift</b>, <b>Control</b>, etc <u>could be stuck down</u> which can make <u>other keys behave incorrectly</u>."
                        + "<br/><br/>"
                        + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("left") + " <u>DO NOT just press</u> the <b>Shift</b> and <b>Caps Lock</b> keys <u>by themselves</u>.<br/>"
                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <u>Type while using these keys</u> to make sure they are working properly."
                        + "<br/><br/>"
                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " Make sure to <u>test both the left and right</u> <b>Shift</b> keys since this test <u>cannot tell which side is being pressed</u>."
                        + "<br/><br/>"
                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " The <b>Caps Lock</b> key <u>WILL NOT highlight</u> <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> when turned ON, but <u>WILL highlight <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> when turned OFF</u>."
                        + "<br/><br/>"
                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " The <b>Tab</b> key <u>WILL highlight</u> <b style='color: green; background-color: white'>&nbsp;Green&nbsp;</b> but <u>WILL NOT output a tab character</u>."
                        + "<br/><br/>"
                        + new TwemojiImage("IndexPointingUp", qaHelperWindow).toImgTag("left") + " You <u>MAY need to hold down</u> the <b>FN</b> key to test the top row of <b>Function</b> keys."
                        + "<br/><br/>"
                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " Also, make sure that <u>no keys feel funky, sticky, or get stuck down</u> as you type."
                        + "<br/><br/>";

                int keyboardTestPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Keyboard Test will open " + (isMacOSwithKeyboardTestApp ? "the <u>Keyboard Test</u> app" : "<u>KeyboardTester.com</u> in a web browser") + ".</b>"
                        + keyboardTestInstructions
                        + "<center>"
                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF KEYBOARD TEST FAILS</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                        + "</center></html>", "QA Helper  —  Keyboard Test", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE, new TwemojiImage("Keyboard", qaHelperWindow).toImageIcon());

                if (keyboardTestPromptReturn == JOptionPane.OK_OPTION) {
                    if (!isLinuxUbiquityMode && !isMacOSwithKeyboardTestApp && keyboardTesterURL.contains("keyboardtester.com")) {
                        try {
                            File silentKeyboardTesterSubmitterTempFile = File.createTempFile("qa_helper-silent_keyboard_tester", ".html");
                            silentKeyboardTesterSubmitterTempFile.deleteOnExit();

                            try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(silentKeyboardTesterSubmitterTempFile))) {
                                bufferedWriter.write("<!DOCTYPE html>"
                                        + "<html>"
                                        + "<head><title>Keyboard Tester</title></head>"
                                        + "<body onload=\"javascript:document.getElementById('silent-keyboard-tester').submit();\">"
                                        + "<form id=\"silent-keyboard-tester\" action=\"" + keyboardTesterURL + "\" method=\"post\">"
                                        + "<input type=\"hidden\" name=\"sound\" value=\"\" />"
                                        + "</form>"
                                        + "</body>"
                                        + "</html>");
                            } catch (Exception writeSilentKeyboardTesterSubmitterTempFileException) {
                                if (isTestMode) {
                                    System.out.println("writeSilentKeyboardTesterSubmitterTempFileException: " + writeSilentKeyboardTesterSubmitterTempFileException);
                                }
                            }

                            keyboardTesterURL = silentKeyboardTesterSubmitterTempFile.toURI().toString();
                        } catch (IOException createSilentKeyboardTesterSubmitterTempFileException) {
                            if (isTestMode) {
                                System.out.println("createSilentKeyboardTesterSubmitterTempFileException: " + createSilentKeyboardTesterSubmitterTempFileException);
                            }
                        }
                    }

                    if (isLinux) {
                        boolean didLaunchChrome = false;
                        if (new File("/usr/bin/google-chrome-stable").exists() && !isLinuxUbiquityMode) { // Do not try to launch Chrome and only use Firefox when in Ubiquity mode (even if it has been pre-installed) since Firefox is simpler to launch without the app showing prompts.
                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/google-chrome-stable", "--password-store=basic", "--start-maximized", "--incognito", keyboardTesterURL});
                                didLaunchChrome = true;
                            } catch (IOException chromeException) {
                                if (isTestMode) {
                                    System.out.println("chromeException: " + chromeException);
                                }
                            }
                        }

                        if (!didLaunchChrome) {
                            try {
                                if (isLinuxUbiquityMode) { // Sometimes Firefox hangs/freezes in Linux pre-install enviroment, so quit all Firefox instances before launching a new one.
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/pkill", "firefox"});
                                }

                                // Run Firefox as sudo in pre-install environment to fix an issue launching Firefox
                                Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", (isLinuxUbiquityMode ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "") + "/usr/bin/firefox -private '" + keyboardTesterURL.replace("'", "'\\''") + "'"});
                            } catch (IOException firefoxException) {
                                if (isTestMode) {
                                    System.out.println("firefoxException: " + firefoxException);
                                }

                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/xdg-open", keyboardTesterURL});
                                } catch (IOException xdgOpenException) {
                                    if (isTestMode) {
                                        System.out.println("xdgOpenException: " + xdgOpenException);
                                    }
                                }
                            }
                        }
                    } else if (isWindowsRE && new File("\\Install\\Diagnostic Tools\\Web Browser (PE).exe").exists()) {
                        if (new File("\\Windows\\System32\\links.xml").exists()) {
                            new File("\\Windows\\System32\\links.xml").delete();
                        }

                        File webBrowserPElinksFile = new File("\\Windows\\System32\\", "links.xml");

                        try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(webBrowserPElinksFile))) {
                            bufferedWriter.write("<Items version=\"1.0\" application=\"Web Browser (PE)\">\n"
                                    + "  <Homepage>\n"
                                    + "    <Home>" + keyboardTesterURL.replace("file:/", "file:///") + "</Home>\n"
                                    + "  </Homepage>\n"
                                    + "  <Favorites />\n"
                                    + "</Items>");
                        } catch (Exception writeWebBrowserPElinksFileException) {
                            if (isTestMode) {
                                System.out.println("writeWebBrowserPElinksFileException: " + writeWebBrowserPElinksFileException);
                            }

                            playAlertSound("beep");
                        }

                        try {
                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \"Web Browser\" \"\\Install\\Diagnostic Tools\\Web Browser (PE).exe\""}).waitFor();
                        } catch (IOException | InterruptedException openWebBrowserPEexception) {
                            if (isTestMode) {
                                System.out.println("openWebBrowserPEexception: " + openWebBrowserPEexception);
                            }
                        }

                        if (isWindowsPE) {
                            setState(Frame.ICONIFIED);
                        }
                    } else if (isMacOSwithKeyboardTestApp) {
                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", (new File("/Users/fg-demo/Applications/Keyboard Test.app").exists() ? "/Users/fg-demo/Applications/Keyboard Test.app" : "/Applications/Keyboard Test.app")});
                        } catch (IOException launchKeyboardTestError) {
                            System.out.println("launchKeyboardTestError: " + launchKeyboardTestError);
                        }
                    } else {
                        try {
                            Desktop.getDesktop().browse(new URI(keyboardTesterURL));
                        } catch (IOException | URISyntaxException openKeyboardTesterException) {
                            if (isTestMode) {
                                System.out.println("openKeyboardTesterException: " + openKeyboardTesterException);
                            }
                        }
                    }

                    if (!isWindowsPE) {
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>" + (isMacOSwithKeyboardTestApp ? "The <u>Keyboard Test</u> app will open" : "Keyboard Test will open <u>KeyboardTester.com</u> in a web browser") + " momentarily...</b>"
                                + keyboardTestInstructions
                                + "<br/><center>"
                                + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b><i>WHEN YOU ARE FINISHED TESTING THE KEYBOARD, COME BACK HERE AND CLICK \"OK\" TO PROCEED</i></b> " + new TwemojiImage("ThumbsUp", qaHelperWindow).toImgTag("right")
                                + "<br/><br/>"
                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>CONSULT AN INSTRUCTOR IF KEYBOARD TEST FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                + "</center></html>", "QA Helper  —  Keyboard Test", JOptionPane.PLAIN_MESSAGE, new TwemojiImage("Keyboard", qaHelperWindow).toImageIcon());

                        if (computerSpecs.getKeyboardRecalled()) {
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Keyboard Possibly Recalled for Repair</b><br/><br/><i>If this keyboard had any bad keys or other issues, it may be able to be replaced for free by the manufacturer.</i></html>", "QA Helper  —  Keyboard Recall", JOptionPane.WARNING_MESSAGE, new TwemojiImage("Construction", qaHelperWindow).toImageIcon(32));
                        }
                    }

                    if (!isKeyboardVerified && btnVerifyKeyboard.isVisible() && btnVerifyKeyboard.isEnabled()) {
                        if (isWindowsPE) {
                            btnVerifyKeyboard.requestFocusInWindow();
                        } else {
                            btnVerifyKeyboardActionPerformed(null);
                        }
                    }

                    setActionsEnabled(true, !isWindowsPE);
                } else {
                    setActionsEnabled(true);
                    focusNextTestTaskVerifyButton(btnTestKeyboard);
                }
            } else {
                playAlertSound("beep");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Not Enough Free RAM to Open KeyboardTester.com in Firefox</b><br/><br/><i>You will be able to test the keyboard after you've installed the OS.</i></html>", "QA Helper  —  Cannot Run Keyboard Test", JOptionPane.WARNING_MESSAGE);

                setActionsEnabled(true);
                focusNextTestTaskVerifyButton(btnTestKeyboard);
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestKeyboardActionPerformed

    private void btnVerifyKeyboardActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyKeyboardActionPerformed
        if ((actionsEnabled || (evt == null)) && (!isWindowsPE || (isWindowsRE && new File("\\Install\\Diagnostic Tools\\Web Browser (PE).exe").exists()))) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isKeyboardVerified ? "UNVERIFY" : "verify") + "</i> the keyboard?</b></html>", "QA Helper  —  Confirm " + (isKeyboardVerified ? "Unverify" : "Verify") + " Keyboard", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isKeyboardVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isKeyboardVerified = !isKeyboardVerified;

                writeToHelperLogFile("Test: Keyboard " + (isKeyboardVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyKeyboard.setText((isKeyboardVerified ? "Verified" : "Verify"));
                btnVerifyKeyboard.setFont(btnVerifyKeyboard.getFont().deriveFont((isKeyboardVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyKeyboard.setForeground(isKeyboardVerified ? verifiedColor : defaultColor);
                btnVerifyKeyboard.setBorderPainted(!isKeyboardVerified);

                new LinuxAutoScripts("Keyboard " + (isKeyboardVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyKeyboard);
            } else {
                focusNextTestTaskVerifyButton(btnTestKeyboard);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyKeyboardActionPerformed

    private void btnTestMouseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTestMouseActionPerformed
        if (actionsEnabled && !isWindowsPE) {
            setActionsEnabled(false);

            QAMouseTestWindow mouseTestWindow = new QAMouseTestWindow(qaHelperWindow, true);
            mouseTestWindow.setLocationRelativeTo(null);
            mouseTestWindow.setVisible(true);

            if (!isMouseVerified && btnVerifyMouse.isVisible() && btnVerifyMouse.isEnabled()) {
                btnVerifyMouseActionPerformed(null);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnTestMouseActionPerformed

    private void btnVerifyMouseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyMouseActionPerformed
        if ((actionsEnabled || (evt == null)) && !isWindowsPE) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isMouseVerified ? "UNVERIFY" : "verify") + "</i> the mouse?</b></html>", "QA Helper  —  Confirm " + (isMouseVerified ? "Unverify" : "Verify") + " Mouse", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isMouseVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isMouseVerified = !isMouseVerified;

                writeToHelperLogFile("Test: Mouse " + (isMouseVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyMouse.setText((isMouseVerified ? "Verified" : "Verify"));
                btnVerifyMouse.setFont(btnVerifyMouse.getFont().deriveFont((isMouseVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyMouse.setForeground(isMouseVerified ? verifiedColor : defaultColor);
                btnVerifyMouse.setBorderPainted(!isMouseVerified);

                new LinuxAutoScripts("Mouse " + (isMouseVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyMouse);
            } else {
                focusNextTestTaskVerifyButton(btnTestMouse);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyMouseActionPerformed

    private void btnSetupBIOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSetupBIOSActionPerformed
        if (actionsEnabled && !isMacOS) {
            setActionsEnabled(false);

            // Tried using <ol> here but the numbers look bad on Windows and Linux (not anti-aliased).
            JOptionPane.showMessageDialog(qaHelperWindow, "<html>"
                    + "<b style='font-family: monospace'>&nbsp;1)</b> <u>Boot into UEFI/BIOS Setup</u> and " + new TwemojiImage("Memo", qaHelperWindow).toImgTag("inline") + " <b>make a note of the UEFI/BIOS Setup and Boot Options keys.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;2)</b> Confirm there are <u>no UEFI/BIOS passwords set</u>. " + new TwemojiImage("Unlocked", qaHelperWindow).toImgTag("inline") + " <b><i>If possible</i>, remove any existing UEFI/BIOS passwords.</b>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> " + new TwemojiImage("LockedWithKey", qaHelperWindow).toImgTag("left") + " <i>IF A UEFI/BIOS PASSWORD IS SET THAT CANNOT BE REMOVED, INFORM AN INSTRUCTOR</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;3)</b> <u>Set the date and time</u> in UEFI/BIOS Setup to the <b>current date and time.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;4)</b> <u>RESET</u> and <u>SAVE</u> the <b>default UEFI/BIOS Setup configuration.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;5)</b> Fully <u>SHUT DOWN</u> the computer <i>(don't just reboot)</i> and <u>DISCONNECT</u> the power and <b>wait a moment.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;6)</b> <u>Re-connect the power</u> and <b>boot the computer back into UEFI/BIOS Setup.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;7)</b> <u>Double-check the date and time</u> in UEFI/BIOS Setup and <b>confirm it is still correct.</b>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> " + new TwemojiImage("ThumbsDown", qaHelperWindow).toImgTag("left") + " <i>If the date and time is no longer correct, the CMOS battery may need to be replaced.</i>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> " + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>IF THE DATE AND TIME IS NO LONGER CORRECT, INFORM AN INSTRUCTOR</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;8)</b> For <u>UEFI</u>, <i>set the boot mode</i> to <b>UEFI Only <i>(with CSM Off)</i></b> or to <b>Both <i>with UEFI First (and CSM On)</i>.</b>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> For <u>Legacy BIOS</u>, <i>set boot mode</i> to <b>Legacy BIOS Only</b> or to <b>Both <i>with Legacy BIOS First</i>.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>&nbsp;9)</b> For <u>Legacy BIOS</u>, or <u>if UEFI allows a custom boot order</u>, set the <i>following boot order/sequence/priority:</i>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> <b>Optical Drive, Hard Drive/Solid State Drive, Network (LAN/NIC/PXE), USB</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>10)</b> Set <u>SATA Operation</u> to <b>AHCI.</b>"
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>11)</b> <u>DISABLE any and all SECURITY settings</u> related to the <i>following keywords:</i>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> <b>MEBx, AMT, Intel ME, OROM Keyboard Access, Computrace/Absolute/Persistence/Remote Management</b>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> " + new TwemojiImage("Eyes", qaHelperWindow).toImgTag("left") + " <i>Check all sections thoroughly for any of these settings as they may be stored separately and in a variety of sections.</i>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> " + new TwemojiImage("Unlocked", qaHelperWindow).toImgTag("left") + " <i>These settings could allow a low level backdoor, they must be disabled to ensure all refurbished computers are secure.</i>"
                    + "<br/>"
                    + "<b style='font-family: monospace'>&nbsp;&nbsp;&nbsp;</b> " + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>IF ANY OF THESE SETTINGS ARE ENABLED AND CANNOT BE DISABLED, INFORM AN INSTRUCTOR</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                    + "<br/><br/>"
                    + "<b style='font-family: monospace'>12)</b> <u>Save the UEFI/BIOS Setup configuration</u> and <b>reboot the computer to boot up normally.</b>"
                    + "</html>", "QA Helper  —  UEFI/BIOS Setup Setup Information", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("ControlKnobs", qaHelperWindow).toImageIcon());

            if (!isBIOSverified && btnVerifyBIOS.isVisible() && btnVerifyBIOS.isEnabled()) {
                btnVerifyBIOSActionPerformed(null);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnSetupBIOSActionPerformed

    private void btnVerifyBIOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyBIOSActionPerformed
        if ((actionsEnabled || (evt == null)) && !isMacOS) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isBIOSverified ? "UNVERIFY" : "verify") + "</i> the UEFI/BIOS Setup configuration?</b></html>", "QA Helper  —  Confirm " + (isBIOSverified ? "Unverify" : "Verify") + " UEFI/BIOS Setup", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isBIOSverified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isBIOSverified = !isBIOSverified;

                writeToHelperLogFile("Task: UEFI/BIOS Setup " + (isBIOSverified ? "Verified" : "UNVERIFIED"));

                btnVerifyBIOS.setText((isBIOSverified ? "Verified" : "Verify"));
                btnVerifyBIOS.setFont(btnVerifyBIOS.getFont().deriveFont((isBIOSverified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyBIOS.setForeground(isBIOSverified ? verifiedColor : defaultColor);
                btnVerifyBIOS.setBorderPainted(!isBIOSverified);

                new LinuxAutoScripts("UEFI/BIOS Setup " + (isBIOSverified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyBIOS);
            } else {
                focusNextTestTaskVerifyButton(btnSetupBIOS);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyBIOSActionPerformed

    private void btnCheckPortsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCheckPortsActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Test All USB Ports:</b>"
                    + "<br/><br/>"
                    + new TwemojiImage("ComputerMouse", qaHelperWindow).toImgTag("left") + " <u>Plug a USB mouse into a USB port</u> and test the USB port by <u>moving the cursor on screen with the USB mouse</u>."
                    + "<br/><br/>"
                    + new TwemojiImage("ShuffleTracksButton", qaHelperWindow).toImgTag("left") + " Repeat this test for <u>every USB port</u>."
                    + "<br/><br/>"
                    + new TwemojiImage("Memo", qaHelperWindow).toImgTag("left") + " Make note of <u>any USB ports that do not function</u> and <u>cover broken or non-functional ports with electrical tape</u>."
                    + "<br/><br/><br/>"
                    + "<b>Test HDMI/DisplayPort/Mini DisplayPort:</b>"
                    + "<br/><br/>"
                    + new TwemojiImage("ElectricPlug", qaHelperWindow).toImgTag("left") + " <u>Plug an external monitor into this computer</u> with an HDMI/DisplayPort/Mini DisplayPort cable."
                    + "<br/><br/>"
                    + new TwemojiImage("CheckBoxWithCheck", qaHelperWindow).toImgTag("left") + " If HDMI/DisplayPort/Mini DisplayPort is working correctly, you should <u>see this computers desktop picture on the external monitor</u>."
                    + "<br/><br/>"
                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>IF YOU DO NOT SEE THE DESKTOP PICTURE ON THE EXTERNAL MONITOR, INFORM AN INSTRUCTOR</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                    + "</html>", "QA Helper  —  Check Ports", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("PuzzlePiece", qaHelperWindow).toImageIcon());

            if (!isPortsVerified && btnVerifyPorts.isVisible() && btnVerifyPorts.isEnabled()) {
                btnVerifyPortsActionPerformed(null);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnCheckPortsActionPerformed

    private void btnVerifyPortsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyPortsActionPerformed
        if (actionsEnabled || (evt == null)) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isPortsVerified ? "UNVERIFY" : "verify") + "</i> the ports?</b></html>", "QA Helper  —  Confirm " + (isPortsVerified ? "Unverify" : "Verify") + " Ports", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isPortsVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isPortsVerified = !isPortsVerified;

                writeToHelperLogFile("Task: Ports " + (isPortsVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyPorts.setText((isPortsVerified ? "Verified" : "Verify"));
                btnVerifyPorts.setFont(btnVerifyPorts.getFont().deriveFont((isPortsVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyPorts.setForeground(isPortsVerified ? verifiedColor : defaultColor);
                btnVerifyPorts.setBorderPainted(!isPortsVerified);

                new LinuxAutoScripts("Ports " + (isPortsVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyPorts);
            } else {
                focusNextTestTaskVerifyButton(btnCheckPorts);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyPortsActionPerformed

    private void btnCheckDriversActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCheckDriversActionPerformed
        if (actionsEnabled && isLinux && !isLinuxLiveBoot) {
            if (!new CommandReader(new String[]{"/usr/bin/pgrep", "-f", "(driver-manager|mintdrivers)"}).getFirstOutputLine().isEmpty()) {
                try {
                    Runtime.getRuntime().exec(new String[]{"/usr/bin/wmctrl", "-a", "Driver Manager"});
                } catch (IOException focusDriverManagerException) {
                    if (isTestMode) {
                        System.out.println("focusDriverManagerException: " + focusDriverManagerException);
                    }
                }

                if (!isDriversVerified && btnVerifyDrivers.isVisible() && btnVerifyDrivers.isEnabled()) {
                    btnVerifyDriversActionPerformed(null);
                }
            } else {
                setActionsEnabled(false);

                String[] aptProcesses = new CommandReader(new String[]{"/usr/bin/pgrep", "-fa", "(apt|mintUpdate)"}).getOutputLines();
                boolean aptIsRunning = false;
                for (String thisAptProcess : aptProcesses) {
                    if (thisAptProcess.contains("apt-get") || thisAptProcess.contains("/bin/apt") || thisAptProcess.contains("/apt/methods/") || (thisAptProcess.contains("/mintUpdate/") && !thisAptProcess.endsWith("/mintUpdate/mintUpdate.py"))) {
                        aptIsRunning = true;
                        break;
                    }
                }

                if (aptIsRunning) {
                    playAlertSound("beep");

                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Another installation process (such as \"apt\" or \"mintUpdate\") is currently running. <i>This process may be running in the background.</i></b><br/><br/><i>This other installation process could interrupt <i>Driver Manager</i> or <i>Driver Manager</i> may interrupt the other installation process.</i><br/><br/>Try again after the other installation process has finished.</html>", "QA Helper  —  Check Drivers Warning", JOptionPane.WARNING_MESSAGE);
                } else {
                    String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "/usr/bin/pkexec ");

                    try {
                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/driver-manager"});

                        loadingWindow.setLoadingTextAndDisplay("QA Helper is Waiting for Driver Manager to Launch", "Working", "Toolbox");

                        (new SwingWorker<Void, Void>() {
                            @Override
                            protected Void doInBackground() throws Exception {
                                for (int waitForDriverManager = 0; waitForDriverManager < 60; waitForDriverManager++) {
                                    TimeUnit.MILLISECONDS.sleep(500);

                                    if (!new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("Driver Manager").isEmpty()) {
                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/wmctrl", "-r", "Driver Manager", "-e", "0,-100,-100,-1,-1"}); // In Mint 21.1, the "Driver Manager" window will not go all the way to the top right corner if "0,0" are specified, so use "-100,-100" instead to accomodate this behavior (and "wmctrl" will not put the window off screen even if "-100" is actuall too much).
                                        break;
                                    }
                                }

                                return null;
                            }

                            @Override
                            protected void done() {
                                loadingWindow.closeWindow();
                            }
                        }).execute();

                        // TODO: Add a message describing what should be checked in Driver Manager
                        //JOptionPane.showMessageDialog(qaHelperWindow, "<html><b><i>Driver Manager</i> will open momentarily.</b></html>", "QA Helper  —  Check Drivers", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Toolbox", qaHelperWindow).toImageIcon(32));
                        if (!isDriversVerified && btnVerifyDrivers.isVisible() && btnVerifyDrivers.isEnabled()) {
                            btnVerifyDriversActionPerformed(null);
                        }
                    } catch (IOException openDriverManagerException) {
                        if (isTestMode) {
                            System.out.println("openDriverManagerException: " + openDriverManagerException);
                        }
                    }
                }

                setActionsEnabled(true);
            }
        } else if (actionsEnabled && isWindows && !isWindowsPE) {
            setActionsEnabled(false);

            loadingWindow.setLoadingTextAndDisplay("QA Helper is Checking Drivers", "Working", "Toolbox");

            (new SwingWorker<String, Void>() {
                @Override
                protected String doInBackground() throws Exception {
                    // ConfigManagerErrorCode NOTES:
                    // Get-PnpDevice outputs ConfigManagerErrorCode as Problem Strings rather than Error Code integers (such as CM_PROB_FAILED_INSTALL, which is Error Code 28).
                    // But Win32_PnPEntity, Win32_VideoController, and Win32_SoundDevice (which are all used within GetComputerSpecs) output the Error Code integer.
                    // Although, Get-PnpDevice can still filter ConfigManagerErrorCode by their Error Code integers (rather than having to use the Problem Strings) as I do in the following code:
                    // Ignore ConfigManagerErrorCode 45 because it only indicates the disconnected status of a device and is not a problem.
                    // Ignore ConfigManagerErrorCode 24 for PS/2 Keyboard or PS/2 Mouse because it just means a PS/2 Keyboard or PS/2 Mouse is not plugged in.
                    String[] pnpDevicesWithErrorCodes = new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "[Console]::OutputEncoding = New-Object System.Text.UTF8Encoding; Get-PnpDevice | Where-Object { ($_.ConfigManagerErrorCode -ne 0)" + (isTestMode ? "" : " -and ($_.ConfigManagerErrorCode -ne 45) -and (($_.ConfigManagerErrorCode -ne 24) -or (($_.Caption -notlike '*PS/2 Keyboard*') -and ($_.Caption -notlike '*PS/2 Mouse*')))") + " } | Format-List Caption,ConfigManagerErrorCode,DeviceID"}).getOutputLines();
                    int numberOfPnPDevicesWithErrorCodes = 0;

                    String pnpDevicesWithErrors = "";

                    String thisDeviceCaption = "";
                    String thisDeviceErrorCode = "";
                    for (String thisPnpDeviceWithErrorCodeLine : pnpDevicesWithErrorCodes) {
                        if (thisPnpDeviceWithErrorCodeLine.contains(": ")) {
                            String thisPnpDeviceProperty = thisPnpDeviceWithErrorCodeLine.substring(thisPnpDeviceWithErrorCodeLine.indexOf(": ") + 2);

                            if (thisPnpDeviceWithErrorCodeLine.startsWith("Caption")) {
                                thisDeviceCaption = thisPnpDeviceProperty;
                            } else if (thisPnpDeviceWithErrorCodeLine.startsWith("ConfigManagerErrorCode")) {
                                thisDeviceErrorCode = thisPnpDeviceProperty.replace("CM_PROB_", "");
                            } else if (thisPnpDeviceWithErrorCodeLine.startsWith("DeviceID")) {
                                numberOfPnPDevicesWithErrorCodes++;

                                String thisDeviceID = thisPnpDeviceProperty;

                                // Some devices won't be PCI devices, so they won't get fully translated, but might get a vendor at least.
                                String thisDeviceName = computerSpecs.getCleanNameForWindowsDeviceID(thisDeviceID);

                                if (thisDeviceName.equals("N/A")) {
                                    String[] thisDeviceIDparts = thisDeviceID.split("\\\\");

                                    if ((thisDeviceIDparts.length == 3) && thisDeviceIDparts[2].contains("&")) { // Get rid of any concatenated Instance IDs on the end of Device IDs, because that part isn't useful in Google searches.
                                        thisDeviceID = thisDeviceIDparts[0] + "\\" + thisDeviceIDparts[1];
                                    }
                                }

                                if (thisDeviceCaption.isEmpty() && thisDeviceName.equals("N/A")) {
                                    pnpDevicesWithErrors += "<li>Unknown Device: <i>" + thisDeviceID + "</i>";
                                } else {
                                    pnpDevicesWithErrors += "<li>" + (thisDeviceCaption.isEmpty() ? "" : thisDeviceCaption + ": ") + "<i>" + (thisDeviceName.equals("N/A") ? thisDeviceID : thisDeviceName) + "</i>";
                                }

                                pnpDevicesWithErrors += " <b style='color: " + errorColorHTML + "'>(Error " + thisDeviceErrorCode + ")</b></li>";

                                thisDeviceErrorCode = "";
                                thisDeviceCaption = "";
                            }
                        }
                    }

                    String gpuErrorString = computerSpecs.getGPUerrorString();
                    String audioErrorString = computerSpecs.getAudioErrorString();
                    String wirelessErrorString = computerSpecs.getWirelessErrorString();

                    return new TwemojiImage((lblGPU.getText().equals("N/A") ? "Warning" : (!gpuErrorString.isEmpty() ? "CrossMark" : "CheckMarkButton")), qaHelperWindow).toImgTag("left") + " <b style='color: " + (lblGPU.getText().equals("N/A") ? warningColorHTML : (!gpuErrorString.isEmpty() ? errorColorHTML : successColorHTML)) + "'>"
                            + (lblGPU.getText().equals("N/A") ? "GPU NOT DETECTED" : (!gpuErrorString.isEmpty() ? "GPU " + gpuErrorString : "GPU Drivers Installed with No Errors")) + "</b><br/><br/>"
                            + new TwemojiImage((lblAudio.getText().equals("N/A") ? "Warning" : (!audioErrorString.isEmpty() ? (audioErrorString.equals("DRIVER MAY NOT BE INSTALLED") ? "Warning" : "CrossMark") : "CheckMarkButton")), qaHelperWindow).toImgTag("left") + " <b style='color: " + (lblAudio.getText().equals("N/A") ? warningColorHTML : (!audioErrorString.isEmpty() ? (audioErrorString.equals("DRIVER MAY NOT BE INSTALLED") ? warningColorHTML : errorColorHTML) : successColorHTML)) + "'>"
                            + (lblAudio.getText().equals("N/A") ? "AUDIO NOT DETECTED" : (!audioErrorString.isEmpty() ? "AUDIO " + audioErrorString : "Audio Drivers Installed with No Errors")) + "</b>" + (audioErrorString.contains("DRIVER MAY NOT BE INSTALLED")
                            ? "<br/>" + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'><i>If Audio Test Passed &amp; No Other Audio or GPU Driver Errors</i>, \"DRIVER MAY NOT BE INSTALLED\" Warning Can Be Ignored</b>" : "")
                            + "<br/><br/>"
                            + (!wirelessErrorString.isEmpty() ? new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>WIRELESS " + wirelessErrorString + "</b><br/><br/>" : "")
                            + ((numberOfPnPDevicesWithErrorCodes > 0)
                                    ? new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>" + numberOfPnPDevicesWithErrorCodes + " DEVICE" + ((numberOfPnPDevicesWithErrorCodes > 1) ? "S" : "") + " WITH DRIVER ERROR" + ((numberOfPnPDevicesWithErrorCodes > 1) ? "S" : "") + ":</b><ul style='margin-left: 20px'>" + pnpDevicesWithErrors + "</ul>"
                                    : new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>All Other Device Drivers Installed with No Errors</b><br/><br/>");
                }

                @Override
                protected void done() {
                    loadingWindow.closeWindow();

                    try {
                        String driverSummaryBodyOutput = get();

                        boolean driverErrors = driverSummaryBodyOutput.contains("NOT DETECTED") || driverSummaryBodyOutput.contains("NOT INSTALLED") || driverSummaryBodyOutput.contains("MAY NOT BE INSTALLED") || driverSummaryBodyOutput.contains("DRIVER ERROR");

                        ArrayList<String> driversDialogButtons = new ArrayList<>();

                        driversDialogButtons.add("OK");

                        driversDialogButtons.add("Open Device Manager");

                        if (driverErrors) {
                            driversDialogButtons.add("Open Windows Update");
                        }

                        boolean isLenovoWithSystemUpdateApp = (computerSpecs.getBrand().equals("Lenovo") && new File("\\Program Files (x86)\\Lenovo\\System Update\\tvsu.exe").exists());

                        if (isLenovoWithSystemUpdateApp) {
                            driversDialogButtons.add("Open Lenovo System Update");
                        }

                        driversDialogButtons.add("Search Google for Drivers");

                        JButton viewDriverErrorMessagesAndSolutionsButton = null;

                        if (driverSummaryBodyOutput.contains("DRIVER ERROR")) {
                            viewDriverErrorMessagesAndSolutionsButton = new JButton("Open Microsoft Documentation to Read Driver Error Messages & Solutions for Error Codes Listed Above");

                            viewDriverErrorMessagesAndSolutionsButton.addActionListener((java.awt.event.ActionEvent evt1) -> {
                                try {
                                    // This link DOES NOT have the Problem Name strings which are outputted by Get-PnpDevice:
                                    // https://support.microsoft.com/en-us/help/310123/error-codes-in-device-manager-in-windows
                                    // But this one DOES:
                                    Desktop.getDesktop().browse(new URI("https://docs.microsoft.com/en-us/windows-hardware/drivers/install/device-manager-error-messages"));
                                } catch (IOException | URISyntaxException openDriverErrorCodeInfoException) {
                                    if (isTestMode) {
                                        System.out.println("openDriverErrorCodeInfoException: " + openDriverErrorCodeInfoException);
                                    }
                                    playAlertSound("error");
                                }
                            });
                        }

                        playAlertSound(driverErrors ? "error" : "success");

                        JEditorPane driverErrorsEditorPane = new JEditorPane();
                        if (driverSummaryBodyOutput.contains("<ul ")) {
                            driverErrorsEditorPane.setContentType("text/html");
                            driverErrorsEditorPane.setText("<html><br/>" + driverSummaryBodyOutput + "</html>");
                            driverErrorsEditorPane.setCaretPosition(0);
                            driverErrorsEditorPane.setEditable(false);
                            driverErrorsEditorPane.setPreferredSize(new Dimension((int) driverErrorsEditorPane.getPreferredSize().getWidth(), 200));
                        }

                        OUTER:
                        for (;;) {
                            int driversDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, new Object[]{"<html>"
                                + (driverErrors
                                ? new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>Some Drivers Are Not Installed or Have Errors</b>"
                                : new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>All Drivers Installed with No Errors</b>")
                                + "<br/><br/></html>",
                                (driverSummaryBodyOutput.contains("<ul ") ? new JScrollPane(driverErrorsEditorPane) : "<html><br/>" + driverSummaryBodyOutput + "</html>"),
                                ((viewDriverErrorMessagesAndSolutionsButton != null) ? " " : ""), viewDriverErrorMessagesAndSolutionsButton,
                                "<html><br/>"
                                + (driverErrors
                                ? "<b>You can attempt to install the missing drivers a few different ways:</b>"
                                + "<ul style='margin-left: 20px'>"
                                + "<li>Using the \"Update driver\" action in <b>Device Manager</b> for each device.<br/><i>(Check \"Other devices\", \"Display adapters\", and \"Sound controllers\" sections for devices needing drivers.)</i></li>"
                                + "<li>Running \"Check for updates\" in <b>Windows Update</b>.</li>"
                                + (isLenovoWithSystemUpdateApp ? "<li>Running \"Get new updates\" in <b>Lenovo System Update</b>.</li>" : "")
                                + "<li><b>Searching Google for drivers</b> for this computers model or GPU.</li>"
                                + "</ul>"
                                : "<i>Even though all drivers are installed properly</i>, you can "
                                + (isLenovoWithSystemUpdateApp ? "<i>run \"Get new updates\"</i> in <u>Lenovo System Update</u> or " : "")
                                + "<u>search Google for drivers</u><br/>"
                                + "for this computers model or GPU to get the <u>newest drivers as well as BIOS updates</u>, etc.<br/>"
                                + "<i>" + (isLenovoWithSystemUpdateApp ? "Running Lenovo System Update or s" : "S") + "earching Google for drivers in not required if you're not having any issues with this computer.</i>") + "</html>"}, "QA Helper  —  Check Drivers", JOptionPane.DEFAULT_OPTION, (driverErrors ? JOptionPane.ERROR_MESSAGE : JOptionPane.INFORMATION_MESSAGE), new TwemojiImage("Toolbox", qaHelperWindow).toImageIcon(), driversDialogButtons.toArray(), driversDialogButtons.get(0));

                            String driversDialogResponseString = "OK";
                            if (driversDialogResponse > -1) {
                                driversDialogResponseString = driversDialogButtons.get(driversDialogResponse);
                            }

                            switch (driversDialogResponseString) {
                                case "Open Device Manager":
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\control.exe", "/name", "Microsoft.DeviceManager"});
                                    } catch (IOException openDeviceManagerException) {
                                        if (isTestMode) {
                                            System.out.println("openDeviceManagerException: " + openDeviceManagerException);
                                        }
                                        playAlertSound("error");
                                    }

                                    break;
                                case "Open Windows Update":
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\control.exe", "update"});
                                    } catch (IOException openWindowsUpdateException) {
                                        if (isTestMode) {
                                            System.out.println("openWindowsUpdateException: " + openWindowsUpdateException);
                                        }
                                        playAlertSound("error");
                                    }

                                    break;
                                case "Open Lenovo System Update":
                                    try {
                                        Runtime.getRuntime().exec(new String[]{"\\Program Files (x86)\\Lenovo\\System Update\\tvsu.exe"});
                                    } catch (IOException openLenovoSystemUpdateException) {
                                        if (isTestMode) {
                                            System.out.println("openLenovoSystemUpdateException: " + openLenovoSystemUpdateException);
                                        }
                                        playAlertSound("error");
                                    }

                                    break;
                                case "Search Google for Drivers":
                                    String[] searchDriversDialogButtons = new String[]{"Search Google for Model Drivers & Copy Serial to Clipboard", "Search Google for GPU Drivers", "Cancel"};

                                    String brandAndModel = computerSpecs.getFullBrand() + " " + computerSpecs.getFullModel();
                                    String gpu = computerSpecs.getFullGPU();

                                    int searchDriversDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>Would you like to search Google for model or GPU drivers?</b><br/><br/><b>Model:</b> " + brandAndModel + "<br/><b>Serial to Copy to Clipboard:</b> " + computerSpecs.getFullSerial() + "<br/><br/><b>GPU:</b> " + gpu + "</html>",
                                            "QA Helper  —  Search Google for Drivers", JOptionPane.DEFAULT_OPTION, JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("MagnifyingGlassTiltedLeft", qaHelperWindow).toImageIcon(32), searchDriversDialogButtons, searchDriversDialogButtons[0]);
                                    String searchDriversDialogResponseString = "Cancel";
                                    if (searchDriversDialogResponse > -1) {
                                        searchDriversDialogResponseString = searchDriversDialogButtons[searchDriversDialogResponse];
                                    }

                                    if (!searchDriversDialogResponseString.equals("Cancel")) {
                                        boolean isSearchingGPU = searchDriversDialogResponseString.contains("GPU");

                                        if (!isSearchingGPU) {
                                            Toolkit.getDefaultToolkit().getSystemClipboard().setContents(new StringSelection(computerSpecs.getFullSerial()), null);
                                        }

                                        try {
                                            Desktop.getDesktop().browse(new URI("https://google.com/search?q=" + URLEncoder.encode("Drivers for " + (isSearchingGPU ? gpu : brandAndModel), StandardCharsets.UTF_8.toString())));
                                        } catch (IOException | URISyntaxException searchGoogleForDriversException) {
                                            if (isTestMode) {
                                                System.out.println("searchGoogleForDriversException: " + searchGoogleForDriversException);
                                            }
                                            playAlertSound("error");
                                        }
                                    }

                                    break;
                                default:
                                    break OUTER;
                            }
                        }

                        if (!driverErrors && !isDriversVerified && btnVerifyDrivers.isVisible() && btnVerifyDrivers.isEnabled()) {
                            btnVerifyDriversActionPerformed(null);
                        }
                    } catch (HeadlessException | InterruptedException | ExecutionException checkWindowsDriversException) {
                        if (isTestMode) {
                            System.out.println("checkWindowsDriversException: " + checkWindowsDriversException);
                        }
                        playAlertSound("error");
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>UNKNOWN ERROR CHECKING DRIVERS</b><br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Check Drivers Error", JOptionPane.ERROR_MESSAGE);
                    }

                    setActionsEnabled(true);
                }
            }).execute();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnCheckDriversActionPerformed

    private void btnVerifyDriversActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyDriversActionPerformed
        if ((actionsEnabled || (evt == null)) && !isMacOS && !isLinuxLiveBoot && !isWindowsPE) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isDriversVerified ? "UNVERIFY" : "verify") + "</i> the drivers?</b></html>", "QA Helper  —  Confirm " + (isDriversVerified ? "Unverify" : "Verify") + " Drivers", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isDriversVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isDriversVerified = !isDriversVerified;

                writeToHelperLogFile("Task: Drivers " + (isDriversVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyDrivers.setText((isDriversVerified ? "Verified" : "Verify"));
                btnVerifyDrivers.setFont(btnVerifyDrivers.getFont().deriveFont((isDriversVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyDrivers.setForeground(isDriversVerified ? verifiedColor : defaultColor);
                btnVerifyDrivers.setBorderPainted(!isDriversVerified);

                new LinuxAutoScripts("Drivers " + (isDriversVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyDrivers);
            } else {
                focusNextTestTaskVerifyButton(btnCheckDrivers);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyDriversActionPerformed

    private void btnSystemUpdatesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSystemUpdatesActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            boolean didLaunchSystemUpdates = false;

            if (isLinux) {
                if (!isLinuxLiveBoot) {
                    String[] aptProcesses = new CommandReader(new String[]{"/usr/bin/pgrep", "-fa", "(apt|mintUpdate)"}).getOutputLines();
                    boolean aptIsRunning = false;
                    for (String thisAptProcess : aptProcesses) {
                        if (thisAptProcess.contains("apt-get") || thisAptProcess.contains("/bin/apt") || thisAptProcess.contains("/apt/methods/") || (thisAptProcess.contains("/mintUpdate/") && !thisAptProcess.endsWith("/mintUpdate/mintUpdate.py"))) {
                            aptIsRunning = true;
                            break;
                        }
                    }

                    if (aptIsRunning) {
                        playAlertSound("beep");

                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Another installation process (such as \"apt\" or \"mintUpdate\") is currently running. <i>This process may be running in the background.</i></b><br/><br/><i>This other installation process could interrupt <i>System Updates</i> or <i>System Updates</i> may interrupt the other installation process.</i><br/><br/>Try again after the other installation process has finished.</html>", "QA Helper  —  System Updates Warning", JOptionPane.WARNING_MESSAGE);
                    } else {
                        try {
                            String possibleSudo = (!adminPassword.equals("*UNKNOWN*") ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "");

                            String systemUpdateCommand = "/usr/bin/sudo /usr/local/bin/apt update && /usr/bin/sudo /usr/local/bin/apt upgrade -y";

                            if (new File("/usr/bin/mintupdate-cli").exists()) {
                                // Will exist on Mint 19 and newer
                                systemUpdateCommand = "/usr/bin/sudo /usr/bin/mintupdate-cli upgrade -ry";
                            } else if (new File("/usr/bin/mintupdate-tool").exists()) {
                                // Will exist on Mint 18.3 and older
                                systemUpdateCommand = "/usr/bin/sudo /usr/bin/mintupdate-tool upgrade -l12345 -ry";
                            }

                            // Run update commands 3 times to make sure that all possible updates are installed since some updates require others to be installed first.
                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", possibleSudo + "/usr/bin/" + (isLinuxMATE ? "mate" : "gnome") + "-terminal --window" + (isLinuxMATE ? "" : "-with-profile-internal-id '0'") + " --title 'QA Helper  —  Installing System Updates' --hide-menubar --geometry '80x25+0+0' -x /bin/sh -c 'echo \"\nINSTALLING SYSTEM UPDATES\nBY EXECUTING \\\"" + systemUpdateCommand.replace("/usr/bin/", "").replace("/usr/local/bin/", "") + "\\\" 3 TIMES\nAND EXECUTING \\\"sudo apt autoremove -y\\\" ONCE BEFORE THE LAST SYSTEM UPDATE CYCLE\n\nSYSTEM UPDATE 1 OF 3:\"; " + systemUpdateCommand + "; echo \"\nSYSTEM UPDATE 2 OF 3:\"; " + systemUpdateCommand + "; echo \"\nAUTOREMOVE ONCE BEFORE LAST UPDATE CYCLE:\"; /usr/bin/sudo /usr/local/bin/apt autoremove -y; echo \"\nSYSTEM UPDATE 3 OF 3:\"; " + systemUpdateCommand + "; echo \"\n\nFINISHED INSTALLING SYSTEM UPDATES\nBY EXECUTING \\\"" + systemUpdateCommand.replace("/usr/bin/", "").replace("/usr/local/bin/", "") + "\\\" 3 TIMES\nAND EXECUTING \\\"sudo apt autoremove -y\\\" ONCE BEFORE THE LAST SYSTEM UPDATE CYCLE\n\nPRESS ENTER TO CLOSE THIS WINDOW\"; read line; /usr/bin/wmctrl -a \"QA Helper\"'"});

                            TimeUnit.SECONDS.sleep(1);

                            focusWindow();
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Started <i>System Updates</i> in a <i>Terminal</i></b><br/><br/><i>You can continue using QA Helper while System Updates install in the Terminal.</i><br/><br/>When System Updates are done, the Terminal will stay open and you can press enter in the Terminal window to close it.</html>", "QA Helper  —  System Updates", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("CounterclockwiseArrowsButton", qaHelperWindow).toImageIcon(32));

                            didLaunchSystemUpdates = true;
                        } catch (HeadlessException | IOException | InterruptedException | NumberFormatException installSystemUpdateStressViaTerminalException) {
                            if (isTestMode) {
                                System.out.println("installSystemUpdateStressViaTerminalException: " + installSystemUpdateStressViaTerminalException);
                            }
                        }
                    }
                } else {
                    playAlertSound("beep");
                }
            } else if (isMacOS) {
                if (new File("/Users/Shared/.fgResetSnapshotCreated").exists()) {
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b style='color: " + warningColorHTML + "'>System Updates <i style='color: " + errorColorHTML + "'>MUST NOT</i> Be Installed on This Mac!</b><br/><br/><b>This Mac will be reset using a specially made reset Snapshot.</b><br/><br/><i>If any System Updates are installed, that reset Snapshot will be automatically deleted by macOS which would prevent resetting this Mac.</i></html>", "QA Helper  —  System Updates", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("CounterclockwiseArrowsButton", qaHelperWindow).toImageIcon(32));
                    focusNextTestTaskVerifyButton(btnSystemUpdates);
                } else {
                    String[] macOSversionParts = System.getProperty("os.version").replaceAll("[^0-9.]", "").split("\\.");
                    if ((Integer.parseInt(macOSversionParts[0]) >= 11) || (Integer.parseInt(macOSversionParts[1]) >= 14)) {
                        try {
                            String systemPreferencesOrSettingsAppName = new CommandReader(new String[]{"/usr/bin/osascript", "-e", "name of application id \"com.apple.systempreferences\""}).getFirstOutputLine(); // Use "name of application id" to correctly display "System Preferences" or "System Settings" depending on macOS version.

                            if (systemPreferencesOrSettingsAppName.isEmpty()) {
                                systemPreferencesOrSettingsAppName = "System Preferences/Settings";
                            }

                            Desktop.getDesktop().browse(new URI(systemPreferencesOrSettingsAppName.equals("System Settings") ? "x-apple.systempreferences:com.apple.Software-Update-Settings.extension" : "x-apple.systempreferences:com.apple.preferences.softwareupdate"));
                            // https://github.com/bvanpeski/SystemPreferences/blob/main/macos_preferencepanes-Monterey.md#software-update-comapplepreferencessoftwareupdate
                            // https://github.com/bvanpeski/SystemPreferences/blob/main/macos_preferencepanes-Ventura.md#general

                            didLaunchSystemUpdates = true;

                            // TODO: Make this message better
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b><i>Software Update</i> in <i>" + systemPreferencesOrSettingsAppName + "</i> will open momentarily.</b><br/><br/><i>Updates will be checked automatically.</i><br/><br/>If any updates are present, click \"Update Now\" to install them.</html>", "QA Helper  —  System Updates", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("CounterclockwiseArrowsButton", qaHelperWindow).toImageIcon(32));
                        } catch (HeadlessException | IOException | URISyntaxException openSystemPreferencesUpdatesException) {
                            if (isTestMode) {
                                System.out.println("openSystemPreferencesUpdatesException: " + openSystemPreferencesUpdatesException);
                            }
                            playAlertSound("error");
                        }
                    } else {
                        try {
                            Desktop.getDesktop().browse(new URI("macappstore://showUpdatesPage"));
                            didLaunchSystemUpdates = true;

                            // TODO: Make this message better
                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>The <i>Update</i> section in <i>Mac App Store</i> will open momentarily.</b><br/><br/><i>Updates will be checked automatically.</i><br/><br/>If any updates are present, click \"Update All\" to install them.</html>", "QA Helper  —  System Updates", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("CounterclockwiseArrowsButton", qaHelperWindow).toImageIcon(32));
                        } catch (HeadlessException | IOException | URISyntaxException openMacAppStoreUpdatesException) {
                            if (isTestMode) {
                                System.out.println("openMacAppStoreUpdatesException: " + openMacAppStoreUpdatesException);
                            }
                            playAlertSound("error");
                        }
                    }
                }
            } else if (isWindows && !isWindowsPE) {
                try {
                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\control.exe", "update"});
                    didLaunchSystemUpdates = true;

                    // TODO: Make this message better
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b><i>Windows Update</i> in <i>Settings</i> will open momentarily.</b><br/><br/>Click \"Check for updates\" to install any available updates.</html>", "QA Helper  —  Windows Update", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("CounterclockwiseArrowsButton", qaHelperWindow).toImageIcon(32));
                } catch (IOException openWindowsUpdateException) {
                    if (isTestMode) {
                        System.out.println("openWindowsUpdateException: " + openWindowsUpdateException);
                    }
                    playAlertSound("error");
                }
            } else {
                playAlertSound("beep");
            }

            if (didLaunchSystemUpdates && !isUpdatesVerified && btnVerifySystemUpdates.isVisible() && btnVerifySystemUpdates.isEnabled()) {
                btnVerifySystemUpdatesActionPerformed(null);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnSystemUpdatesActionPerformed

    private void btnVerifySystemUpdatesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifySystemUpdatesActionPerformed
        if ((actionsEnabled || (evt == null)) && !isWindowsPE && (!isMacOS || !new File("/Users/Shared/.fgResetSnapshotCreated").exists())) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isUpdatesVerified ? "UNVERIFY" : "verify") + "</i> that the system is up-to-date?</b></html>", "QA Helper  —  Confirm " + (isUpdatesVerified ? "Unverify" : "Verify") + " System Updates", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isUpdatesVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isUpdatesVerified = !isUpdatesVerified;

                writeToHelperLogFile("Task: Updates " + (isUpdatesVerified ? "Verified" : "UNVERIFIED"));

                btnVerifySystemUpdates.setText((isUpdatesVerified ? "Verified" : "Verify"));
                btnVerifySystemUpdates.setFont(btnVerifySystemUpdates.getFont().deriveFont((isUpdatesVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifySystemUpdates.setForeground(isUpdatesVerified ? verifiedColor : defaultColor);
                btnVerifySystemUpdates.setBorderPainted(!isUpdatesVerified);

                new LinuxAutoScripts("Updates " + (isUpdatesVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifySystemUpdates);
            } else {
                focusNextTestTaskVerifyButton(btnSystemUpdates);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifySystemUpdatesActionPerformed

    private void btnCheckWindowsActivationActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCheckWindowsActivationActionPerformed
        String[] statusNames = privateStrings.getPCsCRMStatusNames();
        if ((actionsEnabled || (evt == null) || evt.getActionCommand().equals(statusNames[12] + " Activation Issue")) && isWindows && !isWindowsPE) {
            setActionsEnabled(false);

            loadingWindow.setLoadingTextAndDisplay("QA Helper is Checking Windows Activation", "Working", "Window");

            (new SwingWorker<String, Void>() {
                @Override
                protected String doInBackground() throws Exception {
                    String windowsActivationInfo = computerSpecs.getWindowsActivationInfo(isTestMode, isLoggedIn);
                    // The following code does a lot of not ideal string parsing because getWindowsActivationInfo was originally used just for a simple
                    // Activation Info output display, but things slowly evolved and a lot more complex stuff if being done and getWindowsActivationInfo
                    // should really be broken out to its own class with sepearate properties to be able to make the following code much cleaner and simpler.

                    if (windowsActivationInfo.contains("REPLACE_FOR_SUCESS_TITLE")) {
                        windowsActivationInfo = windowsActivationInfo.replace("<b style='color: REPLACE_FOR_SUCESS_TITLE'>", new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>");
                    } else if (windowsActivationInfo.contains("REPLACE_FOR_WARNING_TITLE")) {
                        windowsActivationInfo = windowsActivationInfo.replace("<b style='color: REPLACE_FOR_WARNING_TITLE'>", new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>");
                    } else if (windowsActivationInfo.contains("REPLACE_FOR_ERROR_TITLE")) {
                        windowsActivationInfo = windowsActivationInfo.replace("<b style='color: REPLACE_FOR_ERROR_TITLE'>", new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>");
                    }

                    boolean isActivated = windowsActivationInfo.contains("Licensed");
                    boolean possibleNonRefurbProductKey = windowsActivationInfo.contains("ACTIVATED WITH A NON-REFURBISHED PC PRODUCT KEY");

                    if (isLoggedIn) {
                        boolean isDPK = false;
                        boolean didUploadCBRifDPK = true;

                        if (isActivated && !possibleNonRefurbProductKey && windowsActivationInfo.contains("OEM:DM")) {
                            isDPK = true;
                            didUploadCBRifDPK = false;

                            if (new File(helperLogFilePath).exists()) {
                                try {
                                    String productKeyID = "";

                                    for (String thisWindowsActivationInfoLine : windowsActivationInfo.split("<br/>")) {
                                        if (thisWindowsActivationInfoLine.contains(":</b> ")) {
                                            String thisWindowsActivationInfoProperty = thisWindowsActivationInfoLine.substring(thisWindowsActivationInfoLine.indexOf(":</b> ") + 6).trim();

                                            if (!thisWindowsActivationInfoProperty.isEmpty()) {
                                                if (thisWindowsActivationInfoLine.startsWith("<b>Product Key ID:</b>")) {
                                                    productKeyID = thisWindowsActivationInfoProperty;
                                                    break;
                                                }
                                            }
                                        }
                                    }

                                    List<String> allHelperLogLines = Files.readAllLines(Paths.get(helperLogFilePath), StandardCharsets.UTF_8);
                                    for (String thisHelperLogLine : allHelperLogLines) {
                                        if (thisHelperLogLine.startsWith("Uploaded CBR for DPK: CBR+" + productKeyID + "+" + computerSpecs.getFullSerial() + "+" + pid + ".xml")) {
                                            didUploadCBRifDPK = true;
                                        } else if (thisHelperLogLine.startsWith("Reverted DPK")) {
                                            didUploadCBRifDPK = false;
                                        }
                                    }
                                } catch (IOException readLogForCBRexception) {
                                    if (isTestMode) {
                                        System.out.println("readLogForCBRexception: " + readLogForCBRexception);
                                    }
                                }
                            }
                        }

                        try {
                            HashMap<String, String> windowsProductKeyInfoSavedInPCsCRM = PCsCRMManager.getWindowsProductKeyInfoForPID(pid, isTestMode);
                            String productKeySavedInPCsCRM = windowsProductKeyInfoSavedInPCsCRM.get("productKey");
                            String newCoaIdSavedInPCsCRM = windowsProductKeyInfoSavedInPCsCRM.get("newCoaID");

                            if (!productKeySavedInPCsCRM.isEmpty() && !newCoaIdSavedInPCsCRM.isEmpty()) {
                                String preExistingCoaIdSavedInPCsCRM = windowsProductKeyInfoSavedInPCsCRM.get("oldCoaID");

                                String savedPreExistingCoaIdLines = "";
                                String savedProductKeyWasDPKnote = "";
                                if (!preExistingCoaIdSavedInPCsCRM.isEmpty() && !preExistingCoaIdSavedInPCsCRM.equals("00999-999-000-777")) {
                                    if (preExistingCoaIdSavedInPCsCRM.equals("DIGITALPRODUCTKEY")) {
                                        if (!isDPK) {
                                            isDPK = true;
                                            didUploadCBRifDPK = false;
                                        }

                                        savedProductKeyWasDPKnote = "<br/><br/>"
                                                + "<b><i>Previously Used Product Key Was a <u>Digital Product Key</u></i></b>";
                                    } else {
                                        savedPreExistingCoaIdLines = "<br/><br/>"
                                                + "<b>Pre-Existing COA ID / COA Serial Number for PID \"" + pid + "\" (from PCsCRM):</b> " + preExistingCoaIdSavedInPCsCRM;
                                    }
                                }

                                if (windowsActivationInfo.contains("<b>COA ID / COA Serial Number:</b> " + newCoaIdSavedInPCsCRM) && windowsActivationInfo.contains("<b>Product Key in Registry:</b> " + productKeySavedInPCsCRM)) {
                                    boolean justSetProductKey = (evt == null);
                                    windowsActivationInfo += savedPreExistingCoaIdLines + "<br/><br/><br/>"
                                            + new TwemojiImage((justSetProductKey ? "CheckMarkButton" : "ThumbsUp"), qaHelperWindow).toImgTag("left") + " <i " + (justSetProductKey ? "style='color: " + successColorHTML + "'" : "") + ">" + ((isDPK && didUploadCBRifDPK) ? "UPLOADED CBR FOR THIS DPK & THE" : ((justSetProductKey || isDPK) ? "THE" : "THIS")) + " PRODUCT KEY " + (isDPK ? "ID FOR THIS DPK " : "") + (justSetProductKey ? "WAS SUCCESSFULLY" : "IS") + " SAVED TO PCsCRM FOR PID \"" + pid + "\"</i> " + new TwemojiImage("Memo", qaHelperWindow).toImgTag("right")
                                            + (isDPK
                                                    ? "<br/><br/>"
                                                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>SINCE A DPK HAS BEEN APPLIED, REMEMBER TO AFFIX A \"Genuine Microsoft Refurbisher Label\" (GMRL) STICKER TO THIS COMPUTER <u>AND REMOVE ANY EXISTING COA OR GML STICKERS</u></b> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                                                    : "");
                                } else {
                                    windowsActivationInfo += "<br/><br/>"
                                            + "<b>Previously Used Product Key for PID \"" + pid + "\" (from PCsCRM):</b> " + productKeySavedInPCsCRM
                                            + savedProductKeyWasDPKnote
                                            + "<br/><br/>"
                                            + "<b>Previously Used COA ID / COA Serial Number for PID \"" + pid + "\" (from PCsCRM):</b> " + newCoaIdSavedInPCsCRM
                                            + savedPreExistingCoaIdLines
                                            + "<br/><br/><br/>"
                                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>IF THE PREVIOUSLY USED PRODUCT KEY IS NOT CORRECT, YOU MAY HAVE LOGGED IN WITH THE WRONG PID</b> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                                            + "<br/>"
                                            + new TwemojiImage("BackhandIndexPointingDown", qaHelperWindow).toImgTag("left") + " <i>USE THE \"" + (isActivated ? "Change" : "Set") + " Product Key\" BUTTON BELOW TO ACTIVATE WINDOWS WITH THE PREVIOUSLY USED PRODUCT KEY</i> " + new TwemojiImage("BackhandIndexPointingDown", qaHelperWindow).toImgTag("right");
                                }
                            } else if (isActivated && !possibleNonRefurbProductKey) {
                                windowsActivationInfo += "<br/><br/><br/>"
                                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <u>THIS REFURBISHED PC PRODUCT KEY IS NOT SAVED TO PCsCRM FOR PID \"" + pid + "\"</u>"
                                        + "<br/>"
                                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b>THE PRODUCT KEY MUST BE SAVED TO PCsCRM TO CONTINUE</b>"
                                        + "<br/>"
                                        + new TwemojiImage("BackhandIndexPointingDown", qaHelperWindow).toImgTag("left") + " <i>USE THE \"Re-Activate Windows\" BUTTON BELOW TO SAVE THE PRODUCT KEY TO PCsCRM</i>";
                            }
                        } catch (Exception checkSavedProductKeyException) {
                            if (isTestMode) {
                                System.out.println("checkSavedProductKeyException: " + checkSavedProductKeyException);
                            }

                            sendErrorEmail("checkSavedProductKeyException: " + checkSavedProductKeyException);

                            windowsActivationInfo += "<br/><br/><br/>"
                                    + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b>FAILED TO CONNECT TO PCsCRM TO CHECK FOR SAVED PRODUCT KEY FOR PID \"" + pid + "\"</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                        }

                        if (isActivated && !possibleNonRefurbProductKey && !didUploadCBRifDPK && !windowsActivationInfo.contains("PRODUCT KEY IS NOT CORRECT")) {
                            windowsActivationInfo += "<br/><br/><br/>"
                                    + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <u>THE CBR FOR THIS DIGITAL PRODUCT KEY HAS NOT BEEN UPLOADED YET</u>"
                                    + "<br/>"
                                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b>THE CBR MUST BE UPLOADED FOR THIS DPK TO CONTINUE</b>"
                                    + "<br/>"
                                    + new TwemojiImage("BackhandIndexPointingDown", qaHelperWindow).toImgTag("left") + " <i>USE THE \"Re-Activate Windows\" BUTTON BELOW TO UPLOAD THE CBR FOR THIS DPK</i>";
                        }

                        return windowsActivationInfo;
                    }

                    return windowsActivationInfo
                            + (!isActivated
                                    ? "<br/><br/><br/><center>" + new TwemojiImage("OldKey", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>LOG IN TO SET PRODUCT KEY TO ACTIVATE WINDOWS</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "</center>"
                                    : (possibleNonRefurbProductKey
                                            ? "<br/><br/><br/><center>" + new TwemojiImage("OldKey", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>LOG IN TO CHANGE PRODUCT KEY TO PROPERLY ACTIVATE WINDOWS</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right") + "</center>"
                                            : ""));
                }

                @Override
                protected void done() {
                    loadingWindow.closeWindow();

                    boolean didContinueActivateWindows = false;

                    try {
                        String windowsActivationOutput = get();

                        boolean isActivated = windowsActivationOutput.contains("Licensed");
                        boolean possibleNonRefurbProductKey = windowsActivationOutput.contains("ACTIVATED WITH A NON-REFURBISHED PC PRODUCT KEY");

                        playAlertSound((isActivated && !possibleNonRefurbProductKey) ? "success" : "error");

                        String[] windowsActivationButtons = new String[]{"OK"};

                        if (isLoggedIn) {
                            if (isActivated) {
                                if (possibleNonRefurbProductKey) {
                                    windowsActivationButtons = new String[]{"Change Product Key", "OK"};
                                } else if (windowsActivationOutput.contains("\"Re-Activate Windows\" BUTTON")) {
                                    windowsActivationButtons = new String[]{"OK", "Re-Activate Windows", "Change Product Key"};
                                } else {
                                    windowsActivationButtons = new String[]{"OK", "Change Product Key"};
                                }
                            } else {
                                windowsActivationButtons = new String[]{"Set Product Key", "OK"};
                            }
                        }

                        int windowsActivationResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html>" + windowsActivationOutput + "</html>", "QA Helper  —  Windows Activation", JOptionPane.DEFAULT_OPTION, (isActivated ? (possibleNonRefurbProductKey ? JOptionPane.ERROR_MESSAGE : JOptionPane.INFORMATION_MESSAGE) : JOptionPane.WARNING_MESSAGE), new TwemojiImage("Window", qaHelperWindow).toImageIcon(), windowsActivationButtons, windowsActivationButtons[0]);

                        String windowsActivationResponseString = "OK";
                        if (windowsActivationResponse > -1) {
                            windowsActivationResponseString = windowsActivationButtons[windowsActivationResponse];
                        }

                        if (windowsActivationResponseString.contains("Product Key") || windowsActivationResponseString.contains("Activate Windows")) {
                            String currentProductKey = "";
                            String savedProductKey = "";
                            String savedPreExistingCoaID = "";

                            boolean previousProductKeyIsSaved = windowsActivationOutput.contains("Previously Used Product Key for PID \"" + pid + "\"");
                            boolean currentProductKeyIsSaved = ((windowsActivationOutput.contains("SAVED TO PCsCRM FOR PID \"" + pid + "\"</i>") && !windowsActivationOutput.contains("NOT SAVED")));

                            boolean isDPK = ((currentProductKeyIsSaved && windowsActivationOutput.contains("ID FOR THIS DPK"))
                                    || (previousProductKeyIsSaved && windowsActivationOutput.contains("<u>Digital Product Key</u>"))
                                    || (isActivated && !possibleNonRefurbProductKey && windowsActivationOutput.contains("OEM:DM")));

                            if (previousProductKeyIsSaved || currentProductKeyIsSaved || (isActivated && !possibleNonRefurbProductKey)) {
                                for (String thisWindowsActivationOutputLine : windowsActivationOutput.split("<br/>")) {
                                    if (thisWindowsActivationOutputLine.contains(":</b> ")) {
                                        String thisWindowsActivationOutputProperty = thisWindowsActivationOutputLine.substring(thisWindowsActivationOutputLine.indexOf(":</b> ") + 6).trim();

                                        if (!thisWindowsActivationOutputProperty.isEmpty()) {
                                            if (thisWindowsActivationOutputLine.startsWith("<b>Product Key in Registry:</b>")) {
                                                currentProductKey = thisWindowsActivationOutputProperty;

                                                if (currentProductKeyIsSaved) {
                                                    savedProductKey = currentProductKey; // If the current product key is not the saved product key this variable with be overwritten.
                                                }
                                            } else if (thisWindowsActivationOutputLine.startsWith("<b>Previously Used Product Key")) {
                                                savedProductKey = thisWindowsActivationOutputProperty;
                                            } else if (thisWindowsActivationOutputLine.startsWith("<b>Pre-Existing COA ID / COA Serial Number")) {
                                                savedPreExistingCoaID = thisWindowsActivationOutputProperty;

                                                break;
                                            }
                                        }
                                    }
                                }
                            }

                            didContinueActivateWindows = true;

                            if (windowsActivationResponseString.equals("Re-Activate Windows")) {
                                if (isDPK) {
                                    if (new File("\\Install\\DPK\\Logs\\oa3tool-assemble.xml").exists()) {
                                        retrieveAndApplyDigitalProductKey();
                                    } else {
                                        playAlertSound("error");
                                        sendErrorEmail("Cannot Re-Activate Digital Product Key Since DPK Logs Not Found");
                                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Cannot Re-Activate Digital Product Key Since DPK Logs Not Found</b><br/><br/>THIS SHOULD NOT HAVE HAPPENED<br/><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  Cannot Re-Activate DPK", JOptionPane.ERROR_MESSAGE);
                                        setActionsEnabled(true);
                                    }
                                } else {
                                    activateWindowsWithProductKey(currentProductKey, savedProductKey, (isDPK ? "DIGITALPRODUCTKEY" : savedPreExistingCoaID), "", true);
                                }
                            } else {
                                boolean computerCameWithWindowsInstalled = isActivated;

                                if (!computerCameWithWindowsInstalled) {
                                    playAlertSound("beep");

                                    String[] confirmGMLorCOAbuttons = new String[]{"Cancel", "Confirm GML", "Confirm COA"};
                                    int confirmGMLorCOAresponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b style='color: " + attentionColorHTML + "'>Windows can only be installed and licensed with a Refurbished DPK on computers that originally shipped with Windows.</b><br/><br/><b>You must manually verify that a GML or COA sticker is on this computer since an existing original DPK was NOT detected in the Registry or SMBIOS.</b><br/><br/>Does this computer have a Genuine Microsoft Label (GML) or Certificate of Authenticity (COA) sticker for any of the following Windows versions anywhere on its case?<br/><br/><b style='color: " + verifiedColorHTML + "'>Windows XP, Windows Vista, Windows 7 (Starter, Home Basic, Home Premium, Pro, or Ultimate),<br/>Windows 8 or 8.1 (Home or Pro), Windows 10 (Home or Pro), or Windows 11 (Home or Pro)</b><br/><br/><i>If this computer DOES NOT have a GML or COA sticker on it, Windows CANNOT be licensed with a Refurbished DPK.</i></html>", "QA Helper  —  Confirm Windows GML or COA", JOptionPane.DEFAULT_OPTION, JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Window", qaHelperWindow).toImageIcon(), confirmGMLorCOAbuttons, confirmGMLorCOAbuttons[0]);

                                    String confirmGMLorCOAresponseString = "Cancel";
                                    if (confirmGMLorCOAresponse > -1) {
                                        confirmGMLorCOAresponseString = confirmGMLorCOAbuttons[confirmGMLorCOAresponse];
                                    }

                                    if (confirmGMLorCOAresponseString.contains("COA")) {
                                        boolean openManualWindowsActivation = (JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>Since this computer has a Physical COA on it, manually activate Windows with<br/>the Product Key on the Physical COA before applying a Refurbished DPK.</b><br/><br/>After you have manually activated Windows, come back to QA Helper and<br/>click the \"Check Windows Activation / Activate Windows\" button again.<br/><br/><i>If this computer DOES NOT have a GML or COA sticker on it,<br/>Windows CANNOT be licensed with a Refurbished DPK.</i></html>", "QA Helper  —  Manually Activate Windows", JOptionPane.YES_NO_OPTION, JOptionPane.ERROR_MESSAGE, new TwemojiImage("Window", qaHelperWindow).toImageIcon(), new String[]{"Open Windows Manual Activation Prompt", "Cancel"}, "Open Windows Manual Activation Prompt") == JOptionPane.YES_OPTION);

                                        if (openManualWindowsActivation) {
                                            try {
                                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\slui.exe", "3"});
                                            } catch (IOException sluiException) {
                                                if (isTestMode) {
                                                    System.out.println("sluiException: " + sluiException);
                                                }
                                            }
                                        }
                                    } else if (confirmGMLorCOAresponseString.contains("GML")) {
                                        computerCameWithWindowsInstalled = true;
                                    }
                                }

                                if (computerCameWithWindowsInstalled) {
                                    // Refurbished DPKs can only be used on computer that originally shipped with some version of Windows.
                                    // So, if Windows is already activated, it means it has a non-refurb (such as retail or upgrade) DPK (from the SMBIOS or Registry) which would only happen if it originally shipped with Windows.
                                    // Or, it means a Refurbished Product Key has already been applied by us, which should be allowed to continue since that means this check passed the first time around.
                                    // Also, allow the technician to bypass this check by confirming the computer has a physical GML or COA sticker which would also mean that it originally shipped with an OLDER Windows (https://devicepartner.microsoft.com/en-us/communications/comm-windows-ends-installation-path-for-free-windows-7-8-upgrade).
                                    // NOTICE: This new check to only allow Windows to licensed if a non-refurb DPK already exists makes some old code paths from when physical COA were used never be possible to get hit. But leaving that old code in place for now until we are sure we don't want to allow other scenarios.

                                    if (!isDPK || new File("\\Install\\DPK\\REVERTED").exists()) { // Creating "\Install\DPK\REVERTED" allows a new DPK to be applied after confirming a previous DPK has been reverted in MSC.
                                        if (new File("\\Install\\DPK\\REVERTED").exists()) {
                                            writeToHelperLogFile("Reverted DPK");

                                            new File("\\Install\\DPK\\REVERTED").delete(); // If reverted override is set, make sure it only applies to setting a single product key.

                                            try {
                                                // If "\Install\DPK\REVERTED" was not an empty folder (if the "Logs" folder was renamed), need to make sure that gets delete since delete() doesn't handle that.
                                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "RMDIR /S /Q \"\\Install\\DPK\\REVERTED\\\""}).waitFor(); // Easier to just use batch to delete a folder and contents than using Java.
                                            } catch (IOException rmdirDPKrevertedException) {
                                                if (isTestMode) {
                                                    System.out.println("rmdirDPKrevertedException: " + rmdirDPKrevertedException);
                                                }
                                            }

                                            if (new File("\\Install\\DPK\\Logs\\").exists()) {
                                                // If reverted, delete logs so that a previous DPK in an oa3tool-assemble.xml is no re-used.
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "RMDIR /S /Q \"\\Install\\DPK\\Logs\\\""}).waitFor(); // Easier to just use batch to delete a folder and contents than using Java.
                                                } catch (IOException rmdirDPKlogsException) {
                                                    if (isTestMode) {
                                                        System.out.println("rmdirDPKlogsException: " + rmdirDPKlogsException);
                                                    }
                                                }
                                            }
                                        }

                                        if (new File("\\Install\\DPK\\oa3tool.exe").exists()) {
                                            // NOTE: NO LONGER ALLOWING USING REFURB PROCUCT KEYS FROM PHYSICAL REFURB COAs SINCE WE ARE 100% DPKs NOW. BUT LEAVING CODE COMMENTED OUT INSTEAD OF REMOVED IN CASE IT IS USEFUL IN THE FUTURE FOR REFERENCE OR TESTING ETC.
                                            String[] productKeyTypeDialogButtons = new String[]{/*"Use Product Key from Physical COA", */"Retrieve and Apply Refurbished DPK", "Cancel"};
                                            int productKeyTypeResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>Would you like to retrieve and apply a Refurbished Digital Product Key to Activate Windows?</b></html>", "QA Helper  —  Confirm Refurb DPK", JOptionPane.DEFAULT_OPTION, JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("OldKey", qaHelperWindow).toImageIcon(32), productKeyTypeDialogButtons, productKeyTypeDialogButtons[0]);

                                            String productKeyTypeResponseString = "Cancel";
                                            if (productKeyTypeResponse > -1) {
                                                productKeyTypeResponseString = productKeyTypeDialogButtons[productKeyTypeResponse];
                                            }

                                            if (productKeyTypeResponseString.endsWith("DPK")) {
                                                if (!savedProductKey.isEmpty()) {
                                                    int confirmChangeProductKeyPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow,
                                                            "<html><b>Are you sure you want to retrieve and apply a new Refurbished Digital Product Key?</b>"
                                                            + "<br/><br/><center>"
                                                            + new TwemojiImage("Collision", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>THIS WILL OVERWRITE THE SAVED PRODUCT KEY IN PCsCRM (<u>" + savedProductKey + "</u>) FOR PID \"" + pid + "\"</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                                            + "<br/><br/>"
                                                            + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>IF THE SAVED PRODUCT KEY IS NOT CORRECT, YOU MAY HAVE LOGGED IN WITH THE WRONG PID</b> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                                                            + "</center></html>", "QA Helper  —  Confirm Overwriting Saved Product Key in PCsCRM", JOptionPane.OK_CANCEL_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("OldKey", qaHelperWindow).toImageIcon(32));

                                                    if (confirmChangeProductKeyPromptReturn == JOptionPane.OK_OPTION) {
                                                        retrieveAndApplyDigitalProductKey();
                                                    } else {
                                                        setActionsEnabled(true);
                                                    }
                                                } else {
                                                    retrieveAndApplyDigitalProductKey();
                                                }
                                                //} else if (productKeyTypeResponseString.endsWith("COA")) {
                                                //    activateWindowsWithProductKey(currentProductKey, savedProductKey, savedPreExistingCoaID, "", false);
                                            } else {
                                                setActionsEnabled(true);
                                            }
                                        } else {
                                            activateWindowsWithProductKey(currentProductKey, savedProductKey, savedPreExistingCoaID, "", false);
                                        }
                                    } else {
                                        playAlertSound("error");

                                        if (!isActivated || possibleNonRefurbProductKey) {
                                            sendErrorEmail("Cannot Re-Apply Digital Product Key for This PID - MUST REVERT FIRST");
                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Cannot Re-Apply Digital Product Key for This PID</b><br/><br/>The previously applied DPK must be reverted before a new DPK can be applied to this computer.<br/><br/><i>Please contact Free Geek I.T. to be able to apply a new DPK.</i></html>", "QA Helper  —  Cannot Re-Apply DPK", JOptionPane.ERROR_MESSAGE);
                                            // After a DPK has been confirmed to be reverted in MSC, a new DPK can be applied to this computer by creating a "\Install\DPK\REVERTED" file or folder and trying again.
                                        } else {
                                            sendErrorEmail("Cannot Change Product Key After Applying Digital Product Key");
                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Cannot Change Product Key After Applying Digital Product Key</b><br/><br/><i>Please contact Free Geek I.T. if there is an issue with this DPK.</i></html>", "QA Helper  —  Cannot Change DPK", JOptionPane.ERROR_MESSAGE);
                                        }

                                        setActionsEnabled(true);
                                    }
                                } else {
                                    setActionsEnabled(true);
                                }
                            }
                        } else {
                            if (!isWindowsActivationVerified && btnVerifyWindowsActivation.isVisible() && btnVerifyWindowsActivation.isEnabled()) {
                                if (isActivated && !possibleNonRefurbProductKey) {
                                    btnVerifyWindowsActivationActionPerformed(null);
                                } else {
                                    focusNextTestTaskVerifyButton(btnCheckWindowsActivation);
                                }
                            }
                        }
                    } catch (HeadlessException | InterruptedException | ExecutionException checkWindowsActivationException) {
                        if (isTestMode) {
                            System.out.println("checkWindowsActivationException: " + checkWindowsActivationException);
                        }

                        sendErrorEmail("checkWindowsActivationException: " + checkWindowsActivationException);

                        playAlertSound("error");
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>UNKNOWN ERROR CHECKING WINDOWS ACTIVATION</b><br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Check Windows Activation Error", JOptionPane.ERROR_MESSAGE);
                    }

                    if (!didContinueActivateWindows) {
                        setActionsEnabled(true);
                    }
                }
            }).execute();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnCheckWindowsActivationActionPerformed

    private void retrieveAndApplyDigitalProductKey() {
        if (isLoggedIn && isWindows && !isWindowsPE && new File("\\Install\\DPK\\oa3tool.exe").exists()) {
            setActionsEnabled(false);

            loadingWindow.setLoadingTextAndDisplay("QA Helper is Retrieving Digital Product Key", "Working", "OldKey");

            (new SwingWorker<String, Void>() {
                @Override
                protected String doInBackground() throws Exception {
                    if (computerSpecs.getSerialIsMAC() || computerSpecs.getFullSerial().isEmpty() || computerSpecs.getFullSerial().equals("N/A")) {
                        return "INVALID COMPUTER SERIAL";
                    }

                    if (!new File("\\Install\\DPK\\config.txt").exists()) {
                        return "NO DPK CONFIG";
                    }

                    String serverAddress = "";
                    String mscPort = "";
                    String businessID = "";
                    String licensablePartNumber = "";
                    String licensablePartNumberWin11 = "";

                    try {
                        List<String> dpkConfigLines = Files.readAllLines(Paths.get("\\Install\\DPK\\config.txt"), StandardCharsets.UTF_8);
                        for (String thisDPKconfigLine : dpkConfigLines) {
                            if (thisDPKconfigLine.startsWith("Server Address:")) {
                                serverAddress = thisDPKconfigLine.substring(thisDPKconfigLine.indexOf(":") + 1).trim();
                            } else if (thisDPKconfigLine.startsWith("MSC Port:")) {
                                mscPort = thisDPKconfigLine.substring(thisDPKconfigLine.indexOf(":") + 1).trim();
                            } else if (thisDPKconfigLine.startsWith("MSC Business ID:")) {
                                businessID = thisDPKconfigLine.substring(thisDPKconfigLine.indexOf(":") + 1).trim();
                            } else if (thisDPKconfigLine.startsWith("MSC Licensable Part Number:")) { // This is the Win 10 Pro LicensablePartNumber
                                licensablePartNumber = thisDPKconfigLine.substring(thisDPKconfigLine.indexOf(":") + 1).trim();
                            } else if (thisDPKconfigLine.startsWith("MSC Licensable Part Number (Win 11 Pro):")) { // This is the Win 11 Pro LicensablePartNumber
                                licensablePartNumberWin11 = thisDPKconfigLine.substring(thisDPKconfigLine.indexOf(":") + 1).trim();
                            }
                        }
                    } catch (IOException readDPKconfigException) {
                        if (isTestMode) {
                            System.out.println("readDPKconfigException: " + readDPKconfigException);
                        }
                    }

                    if (isWindows11) {
                        licensablePartNumber = licensablePartNumberWin11;
                    }

                    if (serverAddress.isEmpty() || mscPort.isEmpty() || businessID.isEmpty() || licensablePartNumber.isEmpty()) {
                        return "INVALID DPK CONFIG";
                    }

                    String dpkLogsPath = "\\Install\\DPK\\Logs\\";

                    boolean alreadyRetrievedDPK = new File(dpkLogsPath + "oa3tool-assemble.xml").exists();

                    if (alreadyRetrievedDPK || new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object System.Net.Sockets.TcpClient).ConnectAsync('" + serverAddress + "', '" + mscPort + "').Wait(1000)"}).getFirstOutputLine().equals("True")) { // (New-Object System.Net.Sockets.TcpClient).ConnectAsync().Wait(1000) is MUCH faster than Test-NetConnection to check a port: https://copdips.com/2019/09/fast-tcp-port-check-in-powershell.html
                        if (!new File(dpkLogsPath).exists()) {
                            new File(dpkLogsPath).mkdirs();
                        }

                        String oa3toolAssembleConfigPath = dpkLogsPath + "oa3tool-assemble-config.xml";
                        File oa3toolAssembleConfigFile = new File(oa3toolAssembleConfigPath);

                        if (!alreadyRetrievedDPK) {
                            if (oa3toolAssembleConfigFile.exists()) {
                                oa3toolAssembleConfigFile.delete();
                            }

                            try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(oa3toolAssembleConfigFile))) {
                                // https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/oa3-creating-configuration-file#to-create-the-server-based-configuration-file
                                bufferedWriter.write("<?xml version=\"1.0\"?>\n"
                                        + "<OA3>\n"
                                        + "  <ServerBased>\n"
                                        + "    <KeyProviderServerLocation>\n"
                                        + "      <IPAddress>" + serverAddress + "</IPAddress>\n"
                                        + "      <ProtocolSequence>ncacn_ip_tcp</ProtocolSequence>\n"
                                        + "      <EndPoint>" + mscPort + "</EndPoint>\n"
                                        + "      <Options />\n"
                                        + "    </KeyProviderServerLocation>\n"
                                        + "    <Parameters>\n"
                                        + "      <Parameter name=\"LicensablePartNumber\" value=\"" + licensablePartNumber + "\" />\n"
                                        + "      <OEMOptionalInfo />\n"
                                        + "      <BusinessID>" + businessID + "</BusinessID>\n"
                                        + "    </Parameters>\n"
                                        + "  </ServerBased>\n"
                                        + "  <OutputData>\n"
                                        + "    <AssembledBinaryFile>" + dpkLogsPath + "oa3tool-assemble.bin</AssembledBinaryFile>\n"
                                        + "    <ReportedXMLFile>" + dpkLogsPath + "oa3tool-assemble.xml</ReportedXMLFile>\n"
                                        + "  </OutputData>\n"
                                        + "</OA3>");
                            } catch (IOException writeOa3toolAssembleConfigException) {
                                if (isTestMode) {
                                    System.out.println("writeOa3toolAssembleConfigException: " + writeOa3toolAssembleConfigException);
                                }
                            }
                        }

                        if (alreadyRetrievedDPK || oa3toolAssembleConfigFile.exists()) {
                            String oa3toolAssembleOutput = "";
                            if (!alreadyRetrievedDPK) {
                                String[] oa3toolAssembleOuputLines = new CommandReader(new String[]{"\\Install\\DPK\\oa3tool.exe", "/Assemble", "/ConfigFile=\"" + oa3toolAssembleConfigPath + "\""}).getOutputLinesContaining(" "); // Matching lines that contain spaces will get rid of empty lines.
                                if (!isTestMode) {
                                    oa3toolAssembleConfigFile.delete();
                                }

                                if (new File(dpkLogsPath + "oa3tool-assemble.bin").exists()) {
                                    new File(dpkLogsPath + "oa3tool-assemble.bin").delete(); // We don't need this file since we are not flashing DPKs into BIOS.
                                }

                                oa3toolAssembleOuputLines = Arrays.copyOfRange(oa3toolAssembleOuputLines, 3, oa3toolAssembleOuputLines.length); // Remove the header from the output.
                                oa3toolAssembleOutput = String.join("<br/>", oa3toolAssembleOuputLines);
                            }

                            if (alreadyRetrievedDPK || oa3toolAssembleOutput.equals("    The OEM Activation Tool 3.0 successfully completed its required processes.")) {
                                try {
                                    String oa3toolAssembleContents = String.join("", Files.readAllLines(Paths.get(dpkLogsPath + "oa3tool-assemble.xml"), StandardCharsets.UTF_8)).replace(" ", ""); // Remove all spaces because "ProductKeyID" value could have trailing spaces.
                                    int productKeyOpenTagIndex = oa3toolAssembleContents.indexOf("<ProductKey>");
                                    int productKeyCloseTagIndex = oa3toolAssembleContents.indexOf("</ProductKey>");
                                    if ((productKeyOpenTagIndex > 0) && (productKeyCloseTagIndex > 0) && ((productKeyCloseTagIndex - productKeyOpenTagIndex) == 41)) {
                                        String digitalProductKey = oa3toolAssembleContents.substring(productKeyOpenTagIndex + 12, productKeyCloseTagIndex);
                                        if (!alreadyRetrievedDPK) {
                                            logDebugSpecs("DPK " + digitalProductKey.substring(digitalProductKey.length() - 5) + " Retrieved");
                                        }

                                        return "DPK: " + digitalProductKey;
                                    }
                                } catch (IOException readOa3toolAssembleXMLcontentsException) {
                                    if (isTestMode) {
                                        System.out.println("readOa3toolAssembleXMLcontentsException: " + readOa3toolAssembleXMLcontentsException);
                                    }
                                }

                                return "ERROR EXTRACTING DPK";
                            } else {
                                return "ERROR RETRIEVING DPK: " + oa3toolAssembleOutput;
                            }
                        } else {
                            return "FAILED TO CREATE OA3 CONFIG";
                        }
                    } else {
                        return "FAILED TO CONNECT TO MSC";
                    }
                }

                @Override
                protected void done() {
                    loadingWindow.closeWindow();

                    try {
                        String retrieveDPKoutput = get();

                        if (retrieveDPKoutput.startsWith("DPK: ")) {
                            activateWindowsWithProductKey(retrieveDPKoutput.substring((retrieveDPKoutput.indexOf(": ") + 2)), "", "DIGITALPRODUCTKEY", "", true);
                        } else {
                            playAlertSound("error");

                            sendErrorEmail(retrieveDPKoutput);

                            if (retrieveDPKoutput.equals("INVALID COMPUTER SERIAL")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Invalid Serial Number for Digital Product Key</b><br/><br/>Since this computer does not have a computer or motherboard serial number, it cannot have a Digital Product Key applied to it.</html>", "QA Helper  —  Invalid Serial for Digital Product Key", JOptionPane.ERROR_MESSAGE);
                            } else if (retrieveDPKoutput.equals("NO DPK CONFIG")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>No Digital Product Key Configuration Found</b><br/><br/>THIS SHOULD NOT HAVE HAPPENED<br/><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  No Digital Product Key Config", JOptionPane.ERROR_MESSAGE);
                            } else if (retrieveDPKoutput.equals("INVALID DPK CONFIG")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Invalid Digital Product Key Configuration</b><br/><br/>THIS SHOULD NOT HAVE HAPPENED<br/><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  Invalid Digital Product Key Config", JOptionPane.ERROR_MESSAGE);
                            } else if (retrieveDPKoutput.equals("ERROR EXTRACTING DPK")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Error Extracting Digital Product Key From OA3 Tool Output</b><br/><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  Extract Digital Product Key Error", JOptionPane.ERROR_MESSAGE);
                            } else if (retrieveDPKoutput.startsWith("ERROR RETRIEVING DPK: ")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Error Retrieving Windows " + (isWindows11 ? "11" : "10") + " Pro Digital Product Key from MSC</b><br/><br/><pre>" + retrieveDPKoutput.substring((retrieveDPKoutput.indexOf(": ") + 2)) + "</pre><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  Retrieve Digital Product Key Error", JOptionPane.ERROR_MESSAGE);
                            } else if (retrieveDPKoutput.equals("FAILED TO CREATE OA3 CONFIG")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Error Creating OA3 Tool Assemble Configuration File for DPK</b><br/><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  OA3 Config for DPK Error", JOptionPane.ERROR_MESSAGE);
                            } else if (retrieveDPKoutput.equals("FAILED TO CONNECT TO MSC")) {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b style='color: " + warningColorHTML + "'>Local Free Geek Network Is Required to Retrieve Digital Product Key</b>"
                                        + "<br/><br/>"
                                        + "<i>Failed to Connect to MSC</i>"
                                        + "<br/><br/>"
                                        + "Make sure you're connected to the \"FG Reuse\" Wi-Fi network or plugged in with an Ethernet cable at Free Geek."
                                        + "<br/><br/>"
                                        + "<i>Please Inform Free Geek I.T. If This Error Continues While Connected to Local Free Geek Network</i></html>", "QA Helper  —  Retrieve Digital Product Key Error", JOptionPane.ERROR_MESSAGE);
                            } else {
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>" + retrieveDPKoutput + "</b><br/><br/><i>Please Inform Free Geek I.T.</i></html>", "QA Helper  —  Other Digital Product Key Error", JOptionPane.ERROR_MESSAGE);
                            }

                            setActionsEnabled(true);
                        }
                    } catch (HeadlessException | InterruptedException | ExecutionException retrieveDigitalProductKeyException) {
                        if (isTestMode) {
                            System.out.println("retrieveDigitalProductKeyException: " + retrieveDigitalProductKeyException);
                        }

                        playAlertSound("error");
                        sendErrorEmail("UNKNOWN ERROR RETRIEVING DIGITAL PRODUCT KEY");
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>UNKNOWN ERROR RETRIEVING DIGITAL PRODUCT KEY</b><br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Retrieve Digital Product Key Error", JOptionPane.ERROR_MESSAGE);

                        setActionsEnabled(true);
                    }
                }
            }).execute();
        } else {
            playAlertSound("beep");
            setActionsEnabled(true);
        }
    }

    private void activateWindowsWithProductKey(String preFilledProductKey, String savedProductKey, String savedPreExistingCoaID, String lastActivationError, boolean activateWithoutPrompting) {
        if (isLoggedIn && isWindows && !isWindowsPE) {
            setActionsEnabled(false);

            String newProductKey = (preFilledProductKey.isEmpty() ? savedProductKey : preFilledProductKey);
            if (activateWithoutPrompting && newProductKey.length() != 29) {
                activateWithoutPrompting = false;
            }

            MaskFormatter windowsPreExistingCoaIdFormatter = null;
            try {
                windowsPreExistingCoaIdFormatter = new MaskFormatter("#####-###-###-###");
                windowsPreExistingCoaIdFormatter.setPlaceholderCharacter('.');
                windowsPreExistingCoaIdFormatter.setCommitsOnValidEdit(true);
            } catch (ParseException windowsPreExistingCoaIdFormatterException) {
                if (isTestMode) {
                    System.out.println("windowsPreExistingCoaIdFormatterException: " + windowsPreExistingCoaIdFormatterException);
                }
            }
            JFormattedTextField preExistingCoaIdField = new JFormattedTextField(windowsPreExistingCoaIdFormatter);
            preExistingCoaIdField.putClientProperty("JTextField.showClearButton", true);
            preExistingCoaIdField.setFont(new Font(Font.MONOSPACED, Font.BOLD, preExistingCoaIdField.getFont().getSize() + 5));
            preExistingCoaIdField.setHorizontalAlignment(JTextField.CENTER);
            preExistingCoaIdField.setColumns(17);

            preExistingCoaIdField.setText(savedPreExistingCoaID.equals("00999-999-000-777") ? "" : savedPreExistingCoaID);

            Object[] preExistingCoaIdFields = new Object[]{
                "<html><b>Enter Pre-Existing COA ID / COA Serial Number:</b></html>",
                preExistingCoaIdField,
                "<html><center><i>(numbers only and dashes are included automatically)</i>"
                + "<br/><br/>"
                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>THIS IS <i>NOT</i> FOR THE COA ID ON THE <i>NEW</i> COA STICKER</b> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                + "</center></html>"
            };

            JOptionPane preExistingCoaIdPromptPane = new JOptionPane(preExistingCoaIdFields, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION, new TwemojiImage("IDButton", qaHelperWindow).toImageIcon(32)) {
                @Override
                public void selectInitialValue() {
                    preExistingCoaIdField.requestFocusInWindow();
                }
            };

            MaskFormatter windowsProductKeyFormatter = null;
            try {
                windowsProductKeyFormatter = new MaskFormatter("AAAAA-AAAAA-AAAAA-AAAAA-AAAAA");
                windowsProductKeyFormatter.setPlaceholderCharacter('.');
                windowsProductKeyFormatter.setCommitsOnValidEdit(true);
            } catch (ParseException windowsProductKeyFormatterException) {
                if (isTestMode) {
                    System.out.println("windowsProductKeyFormatterException: " + windowsProductKeyFormatterException);
                }
            }
            JFormattedTextField newProductKeyField = new JFormattedTextField(windowsProductKeyFormatter);
            newProductKeyField.putClientProperty("JTextField.showClearButton", true);
            newProductKeyField.setFont(new Font(Font.MONOSPACED, Font.BOLD, newProductKeyField.getFont().getSize() + 5));
            newProductKeyField.setHorizontalAlignment(JTextField.CENTER);
            newProductKeyField.setColumns(29);

            if (!newProductKey.startsWith("XXXXX-XXXXX-XXXXX-XXXXX-")) {
                newProductKeyField.setText(newProductKey);
            }

            Object[] newProductKeyPromptFields = new Object[]{
                "<html><b>Enter Product Key to Activate Windows:</b></html>",
                newProductKeyField,
                "<html><center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>(case doesn't matter and dashes are included automatically)</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + (lastActivationError.isEmpty() ? "" : "<br/><br/>" + lastActivationError) + "</center></html>"
            }; // Add &nbsp;'s (non-breaking spaces) before and after the line below the text field to make the window width wider to properly fit the text field with the clear button.

            JOptionPane newProductKeyPromptPane = new JOptionPane(newProductKeyPromptFields, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION, new TwemojiImage("OldKey", qaHelperWindow).toImageIcon(32)) {
                @Override
                public void selectInitialValue() {
                    newProductKeyField.requestFocusInWindow();
                }
            };

            boolean canceledPreExistingCoaIdPrompt = false;
            String confirmedPreExistingCoaID = "";
            if (savedPreExistingCoaID.equals("DIGITALPRODUCTKEY")) {
                confirmedPreExistingCoaID = savedPreExistingCoaID;
            } else {
                // Always prompt for pre-existing COA (UNLESS APPLYING A DPK), even if re-activating without prompting for Product Key because that means the Product Key (and possible pre-existing COA ID) was not saved in PCsCRM.
                if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Does this computer have a pre-existing Windows COA sticker on it?</b><br/><br/>"
                        + new TwemojiImage("Eyes", qaHelperWindow).toImgTag("left") + " <i>Thoroughly examine all surfaces of this computer (as well as under the battery for laptops) for a pre-existing Windows COA sticker.</i></html>", "QA Helper  —  Confirm Pre-Existing COA", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("IDButton", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                    for (;;) {
                        preExistingCoaIdPromptPane.createDialog(qaHelperWindow, "QA Helper  —  Pre-Existing COA ID").setVisible(true);

                        if (preExistingCoaIdPromptPane.getValue() != null && (int) preExistingCoaIdPromptPane.getValue() == JOptionPane.OK_OPTION) {
                            if (!preExistingCoaIdField.getText().replaceAll("[^0-9-]", "").isEmpty()) {
                                String possiblePreExistingCoaID = preExistingCoaIdField.getText().replaceAll("[^0-9-]", "");

                                if (possiblePreExistingCoaID.length() == 17) {
                                    confirmedPreExistingCoaID = possiblePreExistingCoaID;
                                    break;
                                }
                            }
                        } else {
                            canceledPreExistingCoaIdPrompt = true;
                            break;
                        }
                    }
                }
            }

            if (!canceledPreExistingCoaIdPrompt) {
                // "00999-999-000-777" is Microsofts specified placeholder if the PC does not have a pre-existing COA: https://www.msregrefurb.com/RRPSite/Information/ProgramGuide/ProgramGuide_en.pdf
                final String preExistingCoaID = (confirmedPreExistingCoaID.isEmpty() ? "00999-999-000-777" : confirmedPreExistingCoaID);

                if (!activateWithoutPrompting) {
                    newProductKeyPromptPane.createDialog(qaHelperWindow, "QA Helper  —  Activate Windows").setVisible(true);
                }

                // The following code verifies and reformats the product key excessively from before I implemented MaskFormatter. Leaving it in place because it doesn't hurt.
                if (activateWithoutPrompting || (newProductKeyPromptPane.getValue() != null && (int) newProductKeyPromptPane.getValue() == JOptionPane.OK_OPTION && !newProductKeyField.getText().replaceAll("[^A-Za-z0-9]", "").isEmpty())) {
                    if (!activateWithoutPrompting) {
                        newProductKey = newProductKeyField.getText().replaceAll("[^A-Za-z0-9]", "").toUpperCase().replaceAll("(.{5})", "$1 ").trim().replace(" ", "-");
                    }

                    if (newProductKey.length() == 29) {
                        boolean shouldSetNewProductKey = true;

                        if (!savedProductKey.isEmpty() && !newProductKey.equals(savedProductKey)) {
                            int confirmChangeProductKeyPromptReturn = JOptionPane.showConfirmDialog(qaHelperWindow,
                                    "<html><b>Are you sure you want to set the product key to <u>" + newProductKey + "</u>?</b>"
                                    + "<br/><br/><center>"
                                    + new TwemojiImage("Collision", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>THIS WILL OVERWRITE THE SAVED PRODUCT KEY IN PCsCRM (<u>" + savedProductKey + "</u>) FOR PID \"" + pid + "\"</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                    + "<br/><br/>"
                                    + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>IF THE SAVED PRODUCT KEY IS NOT CORRECT, YOU MAY HAVE LOGGED IN WITH THE WRONG PID</b> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right")
                                    + "</center></html>", "QA Helper  —  Confirm Overwriting Saved Product Key in PCsCRM", JOptionPane.OK_CANCEL_OPTION, JOptionPane.WARNING_MESSAGE, new TwemojiImage("OldKey", qaHelperWindow).toImageIcon(32));

                            if (confirmChangeProductKeyPromptReturn != JOptionPane.OK_OPTION) {
                                shouldSetNewProductKey = false;
                            }
                        }

                        if (shouldSetNewProductKey) {
                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Activating Windows", "Working", "OldKey");

                            final String activateWithProductKey = newProductKey;
                            final String productKeyEnding = activateWithProductKey.substring(activateWithProductKey.length() - 5);

                            (new SwingWorker<String, Void>() {
                                @Override
                                protected String doInBackground() throws Exception {
                                    // Can't only check for "Sent = 1, Received = 1" from ping on Windows because "Destination host unreachable" error will show no packet loss.
                                    boolean canConnectToMicrosoft = (new CommandReader(new String[]{"\\Windows\\System32\\PING.EXE", "-w", "5", "-n", "1", "www.microsoft.com"}).getOutputLinesContaining(new String[]{"TTL=", "Sent = 1, Received = 1", "round trip times"}).length == 3);

                                    if (canConnectToMicrosoft) {
                                        String slmgrIpkOutput = String.join("\n", new CommandReader(new String[]{"\\Windows\\System32\\cscript.exe", "/nologo", "\\Windows\\System32\\slmgr.vbs", "/ipk", activateWithProductKey}).getOutputLines()).trim();

                                        if (slmgrIpkOutput.equals("Installed product key " + activateWithProductKey + " successfully.")) {
                                            String slmgrAtoOutput = String.join("\n", new CommandReader(new String[]{"\\Windows\\System32\\cscript.exe", "/nologo", "\\Windows\\System32\\slmgr.vbs", "/ato"}).getOutputLines()).trim();

                                            if (slmgrAtoOutput.endsWith("Product activated successfully.")) {
                                                String windowsActivationInfo = computerSpecs.getWindowsActivationInfo(isTestMode, isLoggedIn, false); // Do not obscure DPKs from this output so that we can verify the entire correct Product Key before continuing.
                                                // The following code does a lot of not ideal string parsing because getWindowsActivationInfo was originally used just for a simple
                                                // Activation Info output display, but things slowly evolved and a lot more complex stuff if being done and getWindowsActivationInfo
                                                // should really be broken out to its own class with sepearate properties to be able to make the following code much cleaner and simpler.

                                                boolean isActivated = windowsActivationInfo.contains("Licensed");
                                                boolean possibleNonRefurbProductKey = windowsActivationInfo.contains("ACTIVATED WITH A NON-REFURBISHED PC PRODUCT KEY");

                                                if (isActivated && !possibleNonRefurbProductKey && windowsActivationInfo.contains("<b>Product Key in Registry:</b> " + activateWithProductKey)) {
                                                    slmgrIpkOutput += " And activated Windows.";

                                                    if (preExistingCoaID.equals("DIGITALPRODUCTKEY")) {
                                                        logDebugSpecs("DPK " + productKeyEnding + " Activated");
                                                    }

                                                    boolean savedProductKeyToPCsCRM = false;

                                                    String coaID = ""; // PCs for People calls this Serial but MS refers to is COA ID and maybe used to call it COA Serial Number
                                                    String productKeyID = ""; // This same COA ID is now called "Product Key ID" for DPKs and is just a number with no dashes.

                                                    for (String thisWindowsActivationInfoLine : windowsActivationInfo.split("<br/>")) {
                                                        if (thisWindowsActivationInfoLine.contains(":</b> ")) {
                                                            String thisWindowsActivationInfoProperty = thisWindowsActivationInfoLine.substring(thisWindowsActivationInfoLine.indexOf(":</b> ") + 6).trim();

                                                            if (!thisWindowsActivationInfoProperty.isEmpty()) {
                                                                if (thisWindowsActivationInfoLine.startsWith("<b>COA ID")) {
                                                                    coaID = thisWindowsActivationInfoProperty;
                                                                } else if (thisWindowsActivationInfoLine.startsWith("<b>Product Key ID:</b>")) {
                                                                    productKeyID = thisWindowsActivationInfoProperty;
                                                                    break;
                                                                }
                                                            }
                                                        }
                                                    }

                                                    if (!preExistingCoaID.isEmpty() && !coaID.isEmpty() && !productKeyID.isEmpty() && !activateWithProductKey.isEmpty() && logComputerSpecs(true)) {
                                                        // logComputerSpecs(true) is run before saving a Product Key so that the computer serial associated with the Product Key is saved as well AND Windows license flag gets marked as TRUE.
                                                        // If logComputerSpecs(true) fails, then the Product Key won't be saved which is good because errors will be shown and technician won't be able to "statusNames[12]" until it's all saved.

                                                        boolean didUploadCBRifDPK = true;
                                                        if (preExistingCoaID.equals("DIGITALPRODUCTKEY")) {
                                                            didUploadCBRifDPK = false;

                                                            String dpkLogsPath = "\\Install\\DPK\\Logs\\";

                                                            String productKeyIDfromOa3Assemble = "";
                                                            try {
                                                                String oa3toolAssembleContents = String.join("", Files.readAllLines(Paths.get(dpkLogsPath + "oa3tool-assemble.xml"), StandardCharsets.UTF_8)).replace(" ", ""); // Remove all spaces because "ProductKeyID" value could have trailing spaces.
                                                                int productKeyIdOpenTagIndex = oa3toolAssembleContents.indexOf("<ProductKeyID>");
                                                                int productKeyIdCloseTagIndex = oa3toolAssembleContents.indexOf("</ProductKeyID>");
                                                                if ((productKeyIdOpenTagIndex > 0) && (productKeyIdCloseTagIndex > 0) && ((productKeyIdCloseTagIndex - productKeyIdOpenTagIndex) == 27)) {
                                                                    productKeyIDfromOa3Assemble = oa3toolAssembleContents.substring(productKeyIdOpenTagIndex + 14, productKeyIdCloseTagIndex);
                                                                }
                                                            } catch (IOException readOa3toolAssembleXMLcontentsException) {
                                                                if (isTestMode) {
                                                                    System.out.println("readOa3toolAssembleXMLcontentsException: " + readOa3toolAssembleXMLcontentsException);
                                                                }
                                                            }

                                                            if (!productKeyIDfromOa3Assemble.isEmpty() && productKeyID.equals(productKeyIDfromOa3Assemble)) {
                                                                String oa3toolReportConfigPath = dpkLogsPath + "oa3tool-report-config.xml";
                                                                File oa3toolReportConfigFile = new File(oa3toolReportConfigPath);

                                                                if (oa3toolReportConfigFile.exists()) {
                                                                    oa3toolReportConfigFile.delete();
                                                                }

                                                                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(oa3toolReportConfigFile))) {
                                                                    // https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/oa3-creating-configuration-file#to-create-the-file-based-configuration-file
                                                                    bufferedWriter.write("<?xml version=\"1.0\"?>\n"
                                                                            + "<OA3>\n"
                                                                            + "  <FileBased>\n"
                                                                            + "    <InputKeyXMLFile>" + dpkLogsPath + "oa3tool-assemble.xml</InputKeyXMLFile>\n"
                                                                            + "  </FileBased>\n"
                                                                            + "  <OutputData>\n"
                                                                            + "    <AssembledBinaryFile>" + dpkLogsPath + "oa3tool-report.bin</AssembledBinaryFile>\n"
                                                                            + "    <ReportedXMLFile>" + dpkLogsPath + "oa3tool-report.xml</ReportedXMLFile>\n"
                                                                            + "  </OutputData>\n"
                                                                            + "</OA3>");
                                                                } catch (IOException writeOa3toolAssembleConfigException) {
                                                                    if (isTestMode) {
                                                                        System.out.println("writeOa3toolAssembleConfigException: " + writeOa3toolAssembleConfigException);
                                                                    }
                                                                }

                                                                if (oa3toolReportConfigFile.exists()) {
                                                                    ArrayList<String> oa3toolReportCommand = new ArrayList<>();
                                                                    oa3toolReportCommand.addAll(Arrays.asList("\\Install\\DPK\\oa3tool.exe", "/Report", "/NoKeyCheck", "/ConfigFile=\"" + oa3toolReportConfigPath + "\""));
                                                                    if (isTestMode) {
                                                                        oa3toolReportCommand.add("/LogTrace=\"" + dpkLogsPath + "oa3tool-report-log-trace.txt\"");
                                                                    }

                                                                    String[] oa3toolReportOuputLines = new CommandReader(oa3toolReportCommand.toArray(String[]::new)).getOutputLinesContaining(" "); // Matching lines that contain spaces will get rid of empty lines.
                                                                    if (!isTestMode) {
                                                                        oa3toolReportConfigFile.delete();
                                                                    }

                                                                    if (new File(dpkLogsPath + "oa3tool-report.bin").exists()) {
                                                                        new File(dpkLogsPath + "oa3tool-report.bin").delete(); // We don't need this file since we are not flashing DPKs into BIOS. (This one actually appears to not get created anyways.)
                                                                    }

                                                                    oa3toolReportOuputLines = Arrays.copyOfRange(oa3toolReportOuputLines, 3, oa3toolReportOuputLines.length); // Remove the header from the output.
                                                                    String oa3toolReportOutput = String.join("<br/>", oa3toolReportOuputLines);

                                                                    if (oa3toolReportOutput.equals("    The OEM Activation Tool 3.0 successfully completed its required processes.")) {
                                                                        String hardwareHash = "";

                                                                        try {
                                                                            List<String> oa3toolReportLines = Files.readAllLines(Paths.get(dpkLogsPath + "oa3tool-report.xml"), StandardCharsets.UTF_8);
                                                                            for (String thisOa3toolReportLine : oa3toolReportLines) {
                                                                                if (thisOa3toolReportLine.contains("<HardwareHash>")) { // Unlike other XML outputs from oa3tool, this file has all XML keys on a single line.
                                                                                    hardwareHash = thisOa3toolReportLine.substring((thisOa3toolReportLine.indexOf("<HardwareHash>") + 14), thisOa3toolReportLine.indexOf("</HardwareHash>"));
                                                                                    break;
                                                                                }
                                                                            }
                                                                        } catch (IOException readOa3toolReportXMLcontentsException) {
                                                                            if (isTestMode) {
                                                                                System.out.println("readOa3toolReportXMLcontentsException: " + readOa3toolReportXMLcontentsException);
                                                                            }
                                                                        }

                                                                        if (!hardwareHash.isEmpty()) {
                                                                            String cbrFilename = "CBR+" + productKeyID + "+" + computerSpecs.getFullSerial() + "+" + pid + ".xml";
                                                                            String cbrToUploadPath = dpkLogsPath + cbrFilename;
                                                                            File cbrToUploadFile = new File(cbrToUploadPath);

                                                                            if (cbrToUploadFile.exists()) {
                                                                                cbrToUploadFile.delete();
                                                                            }

                                                                            try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(cbrToUploadFile))) {
                                                                                // Sort of based on this: https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/oa3-creating-configuration-file#to-create-the-file-based-input-xml-file
                                                                                // This XML I am building is really based on what was being constructed by the original script from Blair to upload to the MSC VM to be reported to MS via CBR.
                                                                                bufferedWriter.write("<?xml version=\"1.0\"?>\n"
                                                                                        + "<Key>\n"
                                                                                        + "  <ProductKeyID>" + productKeyID + "</ProductKeyID>\n"
                                                                                        + "  <ProductKeyState>3</ProductKeyState>\n" // ProductKeyState 3 = BOUND
                                                                                        + "  <HardwareHash>" + hardwareHash + "</HardwareHash>\n"
                                                                                        + "  <OEMOptionalInfo />\n"
                                                                                        + "  <SerialNumber>" + computerSpecs.getFullSerial() + "</SerialNumber>\n"
                                                                                        + "</Key>");
                                                                            } catch (IOException writeCBRtoUploadException) {
                                                                                if (isTestMode) {
                                                                                    System.out.println("writeCBRtoUploadException: " + writeCBRtoUploadException);
                                                                                }
                                                                            }

                                                                            if (cbrToUploadFile.exists()) {
                                                                                if (!new File("\\Install\\DPK\\config.txt").exists()) {
                                                                                    return "DPK ERROR: NO SFTP CONFIG TO UPLOAD CBR";
                                                                                }

                                                                                String sftpAddress = "";
                                                                                String sftpPort = "";
                                                                                String sftpUser = "";
                                                                                String sftpPrivateKey = "";
                                                                                boolean isReadingSFTPprivateKey = false;

                                                                                try {
                                                                                    List<String> sftpConfigLines = Files.readAllLines(Paths.get("\\Install\\DPK\\config.txt"), StandardCharsets.UTF_8);
                                                                                    for (String thisSFTPconfigLine : sftpConfigLines) {
                                                                                        if (thisSFTPconfigLine.startsWith("Server Address:")) {
                                                                                            sftpAddress = thisSFTPconfigLine.substring(thisSFTPconfigLine.indexOf(":") + 1).trim();
                                                                                        } else if (thisSFTPconfigLine.startsWith("SFTP Port:")) {
                                                                                            sftpPort = thisSFTPconfigLine.substring(thisSFTPconfigLine.indexOf(":") + 1).trim();
                                                                                        } else if (thisSFTPconfigLine.startsWith("SFTP User:")) {
                                                                                            sftpUser = thisSFTPconfigLine.substring(thisSFTPconfigLine.indexOf(":") + 1).trim();
                                                                                        } else if (thisSFTPconfigLine.startsWith("SFTP Private Key:")) {
                                                                                            sftpPrivateKey = thisSFTPconfigLine.substring(thisSFTPconfigLine.indexOf(":") + 1).trim();
                                                                                            isReadingSFTPprivateKey = true;
                                                                                        } else if (isReadingSFTPprivateKey) {
                                                                                            sftpPrivateKey += "\n" + thisSFTPconfigLine;

                                                                                            if (thisSFTPconfigLine.equals("-----END RSA PRIVATE KEY-----")) {
                                                                                                isReadingSFTPprivateKey = false;
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                } catch (IOException readSFTPconfigException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("readSFTPconfigException: " + readSFTPconfigException);
                                                                                    }
                                                                                }

                                                                                if (sftpAddress.isEmpty() || sftpPort.isEmpty() || sftpUser.isEmpty() || sftpPrivateKey.isEmpty()) {
                                                                                    return "DPK ERROR: INVALID SFTP CONFIG TO UPLOAD CBR";
                                                                                }

                                                                                if (!new CommandReader(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object System.Net.Sockets.TcpClient).ConnectAsync('" + sftpAddress + "', '" + sftpPort + "').Wait(1000)"}).getFirstOutputLine().equals("True")) { // (New-Object System.Net.Sockets.TcpClient).ConnectAsync().Wait(1000) is MUCH faster than Test-NetConnection to check a port: https://copdips.com/2019/09/fast-tcp-port-check-in-powershell.html
                                                                                    return "DPK ERROR: FAILED TO CONNECT TO SFTP TO UPLOAD CBR";
                                                                                }

                                                                                String sftpDirCommandPath = dpkLogsPath + "sftp-dir-command.txt";
                                                                                File sftpDirCommandFile = new File(sftpDirCommandPath);

                                                                                if (sftpDirCommandFile.exists()) {
                                                                                    sftpDirCommandFile.delete();
                                                                                }

                                                                                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(sftpDirCommandFile))) {
                                                                                    bufferedWriter.write("dir -1");
                                                                                } catch (IOException writeSFTPdirCommandException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("writeSFTPdirCommandException: " + writeSFTPdirCommandException);
                                                                                    }
                                                                                }

                                                                                String sftpPutCommandPath = dpkLogsPath + "sftp-put-command.txt";
                                                                                File sftpPutCommandFile = new File(sftpPutCommandPath);

                                                                                if (sftpPutCommandFile.exists()) {
                                                                                    sftpPutCommandFile.delete();
                                                                                }

                                                                                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(sftpPutCommandFile))) {
                                                                                    bufferedWriter.write("put \"" + cbrToUploadPath + "\"");
                                                                                } catch (IOException writeSFTPputCommandException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("writeSFTPputCommandException: " + writeSFTPputCommandException);
                                                                                    }
                                                                                }

                                                                                String sftpPrivateKeyPath = dpkLogsPath + "sftp-private.key";
                                                                                File sftpPrivateKeyFile = new File(sftpPrivateKeyPath);

                                                                                if (sftpPrivateKeyFile.exists()) {
                                                                                    sftpPrivateKeyFile.delete();
                                                                                }

                                                                                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(sftpPrivateKeyFile))) {
                                                                                    bufferedWriter.write(sftpPrivateKey);

                                                                                    // Must set ACL to restrict access to private key or sftp will fail.
                                                                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$sftpPrivateKeyACL = Get-Acl '" + sftpPrivateKeyPath + "'\n"
                                                                                        + "$sftpPrivateKeyACL.SetAccessRuleProtection($true, $false)\n"
                                                                                        + "$sftpPrivateKeyACL.SetAccessRule((New-Object System.Security.AccessControl.FileSystemAccessRule('Administrators', 'FullControl', 'Allow')))\n"
                                                                                        + "$sftpPrivateKeyACL.SetAccessRule((New-Object System.Security.AccessControl.FileSystemAccessRule('SYSTEM', 'FullControl', 'Allow')))\n"
                                                                                        + "$sftpPrivateKeyACL | Set-Acl"
                                                                                    }).waitFor();
                                                                                } catch (IOException writeSFTPprivateKeyException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("writeSFTPprivateKeyException: " + writeSFTPprivateKeyException);
                                                                                    }
                                                                                }

                                                                                if (!sftpDirCommandFile.exists() || !sftpPutCommandFile.exists() || !sftpPrivateKeyFile.exists()) {
                                                                                    return "DPK ERROR: ERROR CREATING SFTP COMMAND OR KEY FILES";
                                                                                }

                                                                                String cbrUploadError = "";

                                                                                String[] cbrDirOuputLinesBefore = new CommandReader("\\Windows\\System32\\OpenSSH\\sftp.exe -P " + sftpPort + " -b \"" + sftpDirCommandFile + "\" -i \"" + sftpPrivateKeyPath + "\" -o StrictHostKeyChecking=no " + sftpUser + "@" + sftpAddress + " 2>&1").getOutputLines();

                                                                                if (cbrDirOuputLinesBefore.length > 0 && (cbrDirOuputLinesBefore[0].equals("sftp> dir -1") || (cbrDirOuputLinesBefore[0].startsWith("Warning: Permanently added") && cbrDirOuputLinesBefore[1].equals("sftp> dir -1")))) { // Line 0 will contain an error if something went wrong with the "dir" command, unless is first connection then will have a warning about adding to list of known hosts.
                                                                                    for (String thisCbrDirOuputLineBefore : cbrDirOuputLinesBefore) {
                                                                                        if (!thisCbrDirOuputLineBefore.equals(cbrFilename)) { // It's fine if the exact CBR already exists, it will be overwritten to contain the latest hardware hash.
                                                                                            if (thisCbrDirOuputLineBefore.startsWith("CBR+" + productKeyID + "+")) {
                                                                                                cbrUploadError = "NOT UPLOADING CBR - DPK ID CONFLICT:<br/> Current CBR: " + cbrFilename + "<br/>Existing CBR: " + thisCbrDirOuputLineBefore;
                                                                                                break;
                                                                                            } else if (thisCbrDirOuputLineBefore.contains("+" + computerSpecs.getFullSerial() + "+")) {
                                                                                                cbrUploadError = "NOT UPLOADING CBR - SERIAL CONFLICT:<br/> Current CBR: " + cbrFilename + "<br/>Existing CBR: " + thisCbrDirOuputLineBefore;
                                                                                                break;
                                                                                            } else if (thisCbrDirOuputLineBefore.endsWith("+" + pid + ".xml")) {
                                                                                                cbrUploadError = "NOT UPLOADING CBR - PID CONFLICT:<br/> Current CBR:  " + cbrFilename + "<br/>Existing CBR: " + thisCbrDirOuputLineBefore;
                                                                                                break;
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                } else {
                                                                                    cbrUploadError = "FAILED TO CHECK EXISTING CBR FILES:<br/>" + String.join("<br/>", cbrDirOuputLinesBefore);
                                                                                }

                                                                                if (cbrUploadError.isEmpty()) {
                                                                                    String[] uploadCBRouputLines = new CommandReader("\\Windows\\System32\\OpenSSH\\sftp.exe -P " + sftpPort + " -b \"" + sftpPutCommandFile + "\" -i \"" + sftpPrivateKeyPath + "\" -o StrictHostKeyChecking=no " + sftpUser + "@" + sftpAddress + " 2>&1").getOutputLines();

                                                                                    if (String.join("", uploadCBRouputLines).equals("sftp> put \"" + cbrToUploadPath.replace("\\", "/") + "\"")) { // If an error occurred, there will be more text in the output.
                                                                                        String[] cbrDirOuputLinesAfter = new CommandReader("\\Windows\\System32\\OpenSSH\\sftp.exe -P " + sftpPort + " -b \"" + sftpDirCommandFile + "\" -i \"" + sftpPrivateKeyPath + "\" -o StrictHostKeyChecking=no " + sftpUser + "@" + sftpAddress + " 2>&1").getOutputLines();

                                                                                        if (cbrDirOuputLinesAfter.length > 0 && cbrDirOuputLinesAfter[0].equals("sftp> dir -1")) { // Line 0 will contain an error if something went wrong with the "dir" command.
                                                                                            if (String.join("", cbrDirOuputLinesAfter).contains(cbrFilename)) {
                                                                                                slmgrIpkOutput += " And uploaded CBR for DPK.";
                                                                                                writeToHelperLogFile("Uploaded CBR for DPK: " + cbrFilename);
                                                                                                logDebugSpecs("DPK " + productKeyEnding + " CBR Uploaded");
                                                                                                didUploadCBRifDPK = true;
                                                                                            } else {
                                                                                                cbrUploadError = "FAILED TO CONFIRM CBR UPLOAD";
                                                                                            }
                                                                                        } else {
                                                                                            cbrUploadError = "FAILED TO CONFIRM CBR UPLOAD:<br/>" + String.join("<br/>", cbrDirOuputLinesAfter);
                                                                                        }
                                                                                    } else {
                                                                                        cbrUploadError = "FAILED TO UPLOAD CBR:<br/>" + String.join("<br/>", uploadCBRouputLines);
                                                                                    }
                                                                                }

                                                                                if (sftpPrivateKeyFile.exists()) {
                                                                                    sftpPrivateKeyFile.delete();
                                                                                }

                                                                                if (!isTestMode) {
                                                                                    if (sftpDirCommandFile.exists()) {
                                                                                        sftpDirCommandFile.delete();
                                                                                    }

                                                                                    if (sftpPutCommandFile.exists()) {
                                                                                        sftpPutCommandFile.delete();
                                                                                    }
                                                                                }

                                                                                if (!cbrUploadError.isEmpty()) {
                                                                                    return "DPK ERROR: " + cbrUploadError;
                                                                                }
                                                                            } else {
                                                                                return "DPK ERROR: ERROR CREATING CBR TO UPLOAD";
                                                                            }
                                                                        } else {
                                                                            return "DPK ERROR: FAILED TO EXTRACT OA3 HARDWARE HASH";
                                                                        }
                                                                    } else {
                                                                        return "DPK ERROR: FAILED TO GENERATE OA3 HARDWARE HASH:<br/>" + oa3toolReportOutput;
                                                                    }
                                                                } else {
                                                                    return "DPK ERROR: FAILED TO CREATE OA3 CONFIG FOR HARDWARE HASH";
                                                                }
                                                            } else {
                                                                return "DPK ERROR: INVALID PRODUCT KEY ID FOR CBR:<br/> PKID for CBR: " + (productKeyID.isEmpty() ? "N/A" : productKeyID) + "<br/>PKID from OA3: " + (productKeyIDfromOa3Assemble.isEmpty() ? "N/A" : productKeyIDfromOa3Assemble);
                                                            }
                                                        }

                                                        if (didUploadCBRifDPK) {
                                                            // For DPKs, will only save product key to PCsCRM if successfully uploaded the CBR which is required for all DPKs.
                                                            // This also means that the existing logic will block "statusNames[12]" until the CBR has been uploaded (but also added check for "Uploaded CBR for DPK" log entry before allowing "statusNames[12]" for DPKs).

                                                            try {
                                                                savedProductKeyToPCsCRM = PCsCRMManager.setWindowsProductKeyInfoForPID(
                                                                        pid,
                                                                        (preExistingCoaID.equals(coaID) ? "00999-999-000-777" : preExistingCoaID),
                                                                        coaID,
                                                                        (preExistingCoaID.equals("DIGITALPRODUCTKEY") ? "XXXXX-XXXXX-XXXXX-XXXXX-" + productKeyEnding : activateWithProductKey), // Do not save entire Refurb DPKs in PCSCRM since MS may not like that and we don't want to ever be able to re-apply them on re-installations (we would want to revert them and issue a new one).
                                                                        isTestMode);
                                                            } catch (Exception saveProductKeyException) {
                                                                if (isTestMode) {
                                                                    System.out.println("saveProductKeyException: " + saveProductKeyException);
                                                                }

                                                                sendErrorEmail("saveProductKeyException: " + saveProductKeyException);
                                                            }
                                                        }
                                                    }

                                                    if (!savedProductKeyToPCsCRM) {
                                                        return "FAILED TO SAVE PRODUCT KEY TO PCsCRM";
                                                    } else {
                                                        slmgrIpkOutput += " And saved Product Key.";

                                                        if (preExistingCoaID.equals("DIGITALPRODUCTKEY")) {
                                                            logDebugSpecs("DPK " + productKeyEnding + " Logged to PCsCRM");
                                                        }
                                                    }
                                                } else {
                                                    return "WINDOWS NOT PROPERLY ACTIVATED";
                                                }
                                            } else {
                                                return slmgrAtoOutput;
                                            }
                                        }

                                        return slmgrIpkOutput;
                                    }

                                    return "NO INTERNET";
                                }

                                @Override
                                protected void done() {
                                    loadingWindow.closeWindow();

                                    try {
                                        String activateWindowsOutput = get();

                                        if ((!preExistingCoaID.equals("DIGITALPRODUCTKEY") && activateWindowsOutput.equals("Installed product key " + activateWithProductKey + " successfully. And activated Windows. And saved Product Key."))
                                                || (preExistingCoaID.equals("DIGITALPRODUCTKEY") && activateWindowsOutput.equals("Installed product key " + activateWithProductKey + " successfully. And activated Windows. And uploaded CBR for DPK. And saved Product Key."))) {
                                            // Instead of showing an seperate success message, just reload the full activation info and let that be the success message.
                                            btnCheckWindowsActivationActionPerformed(null);
                                        } else {
                                            sendErrorEmail(activateWindowsOutput);

                                            activateWindowsOutput = activateWindowsOutput.replace("\n", "<br/>");
                                            String longErrorMessage = "<b style='color: " + errorColorHTML + "'>Failed to Activate Windows with Product Key:</b>"
                                                    + "<br/>"
                                                    + activateWithProductKey
                                                    + "<br/><br/>"
                                                    + "<b>Windows Activation Error Message:</b>"
                                                    + "<br/>"
                                                    + "<pre>" + activateWindowsOutput.replace("Error: ", "") + "</pre>";
                                            String shortErrorMessage = new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>WINDOWS ACTIVATION FAILED - TRY AGAIN</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");

                                            if (activateWindowsOutput.startsWith("DPK ERROR: ")) {
                                                longErrorMessage = "<b><span style='color: " + successColorHTML + "'>Activated Windows</span>, but <span style='color: " + errorColorHTML + "'>Failed to Finalize DPK</span>:</b>"
                                                        + "<br/><br/>"
                                                        + "<pre>" + activateWindowsOutput.substring(11) + "</pre>"
                                                        + "<br/><i>Please Inform Free Geek I.T.</i>";

                                                shortErrorMessage = ""; // shortErrorMessage is not used for DPKs since will always activateWithoutPrompting
                                            } else {
                                                switch (activateWindowsOutput) {
                                                    case "NO INTERNET":
                                                        longErrorMessage = "<b style='color: " + warningColorHTML + "'>Internet Is Required to Activate Windows</b>"
                                                                + "<br/><br/>"
                                                                + "<i>Failed to Connect to Microsoft.com</i>";
                                                        shortErrorMessage = new TwemojiImage("SatelliteAntenna", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>INTERNET REQUIRED TO ACTIVATE WINDOWS - TRY AGAIN</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                                                        break;
                                                    case "WINDOWS NOT PROPERLY ACTIVATED":
                                                        longErrorMessage = "<b><span style='color: " + successColorHTML + "'>Installed Product Key</span>, but <span style='color: " + errorColorHTML + "'>Failed to Properly Activate Windows</span>:</b>"
                                                                + "<br/>" + activateWithProductKey
                                                                + "<br/><br/>"
                                                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>WINDOWS MUST BE PROPERLY ACTIVATED TO CONTINUE - TRY AGAIN</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                                                        shortErrorMessage = new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>" + activateWindowsOutput + " - TRY AGAIN</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                                                        break;
                                                    case "FAILED TO SAVE PRODUCT KEY TO PCsCRM":
                                                        longErrorMessage = "<b><span style='color: " + successColorHTML + "'>Activated Windows</span>, but <span style='color: " + errorColorHTML + "'>Failed to Save Product Key to PCsCRM</span>:</b>"
                                                                + "<br/>"
                                                                + activateWithProductKey
                                                                + "<br/><br/>"
                                                                + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>THE PRODUCT KEY MUST BE SAVED TO PCsCRM TO CONTINUE - TRY AGAIN</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                                                        shortErrorMessage = new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>" + activateWindowsOutput + " - TRY AGAIN</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                                                        break;
                                                    default:
                                                        break;
                                                }
                                            }

                                            if (!savedProductKey.isEmpty() && !activateWithProductKey.equals(savedProductKey)) {
                                                longErrorMessage += (longErrorMessage.endsWith("</pre>") ? "" : "<br/>") + "<br/>" // Only one <br/> after </pre> since it has bottom padding.
                                                        + new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i>THE PRODUCT KEY SAVED IN PCsCRM <b>WAS NOT OVERWRITTEN</b> SINCE ACTIVATION FAILED</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right");
                                            }

                                            playAlertSound("error");
                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + longErrorMessage + "</html>", "QA Helper  —  Activate Windows Error", JOptionPane.ERROR_MESSAGE);

                                            activateWindowsWithProductKey(activateWithProductKey, savedProductKey, preExistingCoaID, shortErrorMessage, preExistingCoaID.equals("DIGITALPRODUCTKEY"));// Try again with activateWithoutPrompting if re-attempting after a CBR upload error or something with a DPK.
                                        }
                                    } catch (HeadlessException | InterruptedException | ExecutionException activateWindowsException) {
                                        if (isTestMode) {
                                            System.out.println("activateWindowsException: " + activateWindowsException);
                                        }

                                        sendErrorEmail("activateWindowsException: " + activateWindowsException);

                                        playAlertSound("error");
                                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>UNKNOWN ERROR ACTIVATING WINDOWS</b><br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Activate Windows Error", JOptionPane.ERROR_MESSAGE);

                                        activateWindowsWithProductKey(activateWithProductKey, savedProductKey, preExistingCoaID, new TwemojiImage("ExclamationQuestionMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'>UNKNOWN ERROR ACTIVATING WINDOWS - TRY AGAIN</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right"), false);
                                    }
                                }
                            }).execute();
                        } else {
                            activateWindowsWithProductKey(newProductKey, savedProductKey, preExistingCoaID, "", false);
                        }
                    } else {
                        activateWindowsWithProductKey(newProductKeyField.getText().replaceAll("[^A-Za-z0-9-]", ""), savedProductKey, preExistingCoaID, new TwemojiImage("BackhandIndexPointingRight", qaHelperWindow).toImgTag("left") + " <i style='color: " + warningColorHTML + "'>PRODUCT KEY MUST BE 25 CHARACTERS (NOT COUNTING THE DASHES)</i> " + new TwemojiImage("BackhandIndexPointingLeft", qaHelperWindow).toImgTag("right"), false);
                    }
                } else {
                    setActionsEnabled(true);
                }
            } else {
                setActionsEnabled(true);
            }
        } else {
            playAlertSound("beep");
            setActionsEnabled(true);
        }
    }

    private void btnVerifyWindowsActivationActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyWindowsActivationActionPerformed
        if ((actionsEnabled || (evt == null)) && isWindows && !isWindowsPE) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isWindowsActivationVerified ? "UNVERIFY" : "verify") + "</i> that Windows is Activated with the correct Product Key?</b></html>", "QA Helper  —  Confirm " + (isWindowsActivationVerified ? "Unverify" : "Verify") + " Windows Activation", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isWindowsActivationVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isWindowsActivationVerified = !isWindowsActivationVerified;

                writeToHelperLogFile("Task: Windows Activation " + (isWindowsActivationVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyWindowsActivation.setText((isWindowsActivationVerified ? "Verified" : "Verify"));
                btnVerifyWindowsActivation.setFont(btnVerifyWindowsActivation.getFont().deriveFont((isWindowsActivationVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyWindowsActivation.setForeground(isWindowsActivationVerified ? verifiedColor : defaultColor);
                btnVerifyWindowsActivation.setBorderPainted(!isWindowsActivationVerified);

                new LinuxAutoScripts("Windows Activation " + (isWindowsActivationVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyWindowsActivation);
            } else {
                focusNextTestTaskVerifyButton(btnCheckWindowsActivation);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyWindowsActivationActionPerformed

    private void btnCheckRemoteManagementActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCheckRemoteManagementActionPerformed
        if (actionsEnabled && isMacOS) {
            setActionsEnabled(false);

            String systemSerialNumber = new CommandReader(new String[]{"/bin/bash", "-c", "/usr/libexec/PlistBuddy -c 'Print :0:IOPlatformSerialNumber' /dev/stdin <<< \"$(/usr/sbin/ioreg -arc IOPlatformExpertDevice -k IOPlatformSerialNumber -d 1)\""}).getFirstOutputLine();
            if (!systemSerialNumber.isEmpty()) {
                if (isLoggedIn) {
                    boolean canConnectToApple = !new CommandReader(new String[]{"/sbin/ping", "-t", "5", "-c", "1", "www.apple.com"}).getFirstOutputLineContaining("1 packets transmitted, 1 ").isEmpty();

                    if (canConnectToApple) {
                        // Only try to get DEP status if we have internet.
                        String possibleAdminUsername = new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine();
                        List<String> adminUsernames = Arrays.asList(new CommandReader(new String[]{"/bin/bash", "-c", "/usr/libexec/PlistBuddy -c 'Print :dsAttrTypeStandard\\:GroupMembership' /dev/stdin <<< \"$(/usr/bin/dscl -plist . -read /Groups/admin GroupMembership)\" | /usr/bin/awk '(($NF != \"{\") && ($NF != \"root\") && ($NF != \"}\")) { print $NF }'"}).getOutputLines());
                        if (!adminUsernames.isEmpty() && !adminUsernames.contains(possibleAdminUsername)) {
                            possibleAdminUsername = adminUsernames.get(0);
                        }
                        final String shortAdminUsernameForRemoteManagement = possibleAdminUsername;
                        final String fullAdminUsernameForRemoteManagement = new CommandReader(new String[]{"/usr/bin/id", "-F", shortAdminUsernameForRemoteManagement}).getFirstOutputLine();

                        boolean didCancelPasswordPrompt = false;

                        String possibleAdminPasswordForRemoteManagement = "";
                        if (shortAdminUsernameForRemoteManagement.equals("fg-admin") || shortAdminUsernameForRemoteManagement.equals("Staff")) {
                            ArrayList<String> possibleAdminPasswordsForRemoteManagement = new ArrayList<>();
                            possibleAdminPasswordsForRemoteManagement.add(privateStrings.getCurrentFreeGeekPassword());
                            possibleAdminPasswordsForRemoteManagement.add(privateStrings.getPreviousFreeGeekPassword());
                            for (String thisPossibleAdminPasswordForRemoteManagement : possibleAdminPasswordsForRemoteManagement) {
                                if (new CommandReader("/usr/bin/dscl . -authonly '" + shortAdminUsernameForRemoteManagement.replace("'", "'\\''") + "' '" + thisPossibleAdminPasswordForRemoteManagement.replace("'", "'\\''") + "' && echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")) {
                                    possibleAdminPasswordForRemoteManagement = thisPossibleAdminPasswordForRemoteManagement;
                                    break;
                                }
                            }
                        }

                        if (possibleAdminPasswordForRemoteManagement.isEmpty()) {
                            JPasswordField passwordField = new JPasswordField();
                            passwordField.putClientProperty("JTextField.showClearButton", true);

                            Object[] passwordPromptFields = new Object[]{
                                "<html><b>Enter Admin Password for \"" + fullAdminUsernameForRemoteManagement + "\" to <i>Check Remote Management (ADE/DEP/MDM)</i>:</b></html>",
                                passwordField
                            };

                            JOptionPane passwordPromptPane = new JOptionPane(passwordPromptFields, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION) {
                                @Override
                                public void selectInitialValue() {
                                    passwordField.requestFocusInWindow();
                                }
                            };

                            passwordPromptPane.createDialog(qaHelperWindow, "QA Helper  —  Admin Password").setVisible(true);

                            if (passwordPromptPane.getValue() != null && (int) passwordPromptPane.getValue() == JOptionPane.OK_OPTION) {
                                possibleAdminPasswordForRemoteManagement = new String(passwordField.getPassword());
                            } else {
                                didCancelPasswordPrompt = true;
                            }
                        }

                        if (!didCancelPasswordPrompt) {
                            final String adminPasswordForRemoteManagement = possibleAdminPasswordForRemoteManagement;
                            if (new CommandReader("/usr/bin/dscl . -authonly '" + shortAdminUsernameForRemoteManagement.replace("'", "'\\''") + "' '" + adminPasswordForRemoteManagement.replace("'", "'\\''") + "' && echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>")) {
                                loadingWindow.setLoadingTextAndDisplay("QA Helper is Checking Remote Management", "Working", "LockedWithKey");

                                (new SwingWorker<String[], Void>() {
                                    @Override
                                    protected String[] doInBackground() throws Exception {
                                        // Don't know how to get output as PLIST on El Capitan so just using the text output for easier cross OS support.

                                        // First, try the High Sierra and Newer DEP renew and output command.
                                        String[] remoteManagementOutputLines = new CommandReader(new String[]{"/usr/bin/osascript", "-e", "do shell script \"/usr/bin/profiles renew -type enrollment; /usr/bin/profiles show -type enrollment 2>&1; exit 0\" user name \"" + shortAdminUsernameForRemoteManagement.replace("\\", "\\\\").replace("\"", "\\\"") + "\" password \"" + adminPasswordForRemoteManagement.replace("\\", "\\\\").replace("\"", "\\\"") + "\" with administrator privileges"}).getOutputLines();

                                        if ((remoteManagementOutputLines.length > 0) && !String.join("\n", remoteManagementOutputLines).contains("profiles: invalid option -- t")) { // Invalid option error will happen if running on Sierra or older, so need to fallback to "mdmclient dep nag".
                                            if (remoteManagementOutputLines[0].contains(" - Request too soon.")) { // macOS 12.3 adds client side "profiles show" rate limiting of once every 23 hours: https://derflounder.wordpress.com/2022/03/22/profiles-command-includes-client-side-rate-limitation-for-certain-functions-on-macos-12-3/
                                                if (new File(macBuildInfoPath + ".fgLastRemoteManagementCheckOutput").exists()) {
                                                    String[] cachedRemoteManagementOutputLines = Files.readAllLines(Paths.get(macBuildInfoPath + ".fgLastRemoteManagementCheckOutput"), StandardCharsets.UTF_8).toArray(String[]::new);
                                                    if (cachedRemoteManagementOutputLines.length > 0) {
                                                        remoteManagementOutputLines = cachedRemoteManagementOutputLines;
                                                    }
                                                }
                                            } else { // So always cache the last "profiles show" output so we can show the last valid results in case it's checked again within 23 hours.
                                                if (!new File(macBuildInfoPath).exists()) {
                                                    new File(macBuildInfoPath).mkdirs();
                                                }
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "do shell script (\"printf '%s\\n' \" & (quoted form of \"" + String.join("\n", remoteManagementOutputLines).replace("\\", "\\\\").replace("\"", "\\\"") + "\") & \" > \" & (quoted form of \"" + macBuildInfoPath.replace("\\", "\\\\").replace("\"", "\\\"") + ".fgLastRemoteManagementCheckOutput\")) user name \"" + shortAdminUsernameForRemoteManagement.replace("\\", "\\\\").replace("\"", "\\\"") + "\" password \"" + adminPasswordForRemoteManagement.replace("\\", "\\\\").replace("\"", "\\\"") + "\" with administrator privileges"});
                                                } catch (IOException cacheRemoteManagementOutputException) {
                                                    if (isTestMode) {
                                                        System.out.println("cacheRemoteManagementOutputException: " + cacheRemoteManagementOutputException);
                                                    }
                                                }
                                            }
                                        } else {
                                            for (int i = 0; i < 5; i++) {
                                                // Next, try the El Capitan and Sierra DEP renew and output command.
                                                // Sometimes fails with segmentation fault or can't connect.
                                                String[] mdmclientDepNagReplyLines = new CommandReader(new String[]{"/usr/bin/osascript", "-e", "do shell script \"/usr/libexec/mdmclient dep nag 2>&1\" user name \"" + shortAdminUsernameForRemoteManagement.replace("\\", "\\\\").replace("\"", "\\\"") + "\" password \"" + adminPasswordForRemoteManagement.replace("\\", "\\\\").replace("\"", "\\\"") + "\" with administrator privileges"}).getOutputLines();

                                                if (mdmclientDepNagReplyLines.length > 0 && mdmclientDepNagReplyLines[0].contains("Activation record: {")) {
                                                    remoteManagementOutputLines = mdmclientDepNagReplyLines;
                                                    break;
                                                } else {
                                                    TimeUnit.SECONDS.sleep(i);
                                                }
                                            }
                                        }

                                        return remoteManagementOutputLines;
                                    }

                                    @Override
                                    protected void done() {
                                        loadingWindow.closeWindow();

                                        try {
                                            String[] remoteManagementOutputLines = get();

                                            if ((remoteManagementOutputLines.length > 0) && (!remoteManagementOutputLines[0].contains("Error fetching Device Enrollment configuration") || remoteManagementOutputLines[0].contains("Client is not DEP enabled.") || remoteManagementOutputLines[0].contains("Bad response from apsd: Connection interrupted"))) { // NOTE: This "Bad response from apsd" error will often be returned when the device IS NOT Remote Managed, so don't show it as an error so that technicians don't get confused (it will be considered success below since the output will only contain 2 lines).
                                                if (remoteManagementOutputLines.length > 3) {
                                                    String remoteManagementOrganizationName = "UNKNOWN ORGANIZATION";
                                                    ArrayList<String> remoteManagementOrganizationContactInfo = new ArrayList<>();

                                                    ArrayList<String> logRemoteManagedMacCommand = new ArrayList<>();
                                                    logRemoteManagedMacCommand.addAll(Arrays.asList("/usr/bin/curl", "--connect-timeout", "5", "-sfL", privateStrings.logRemoteManagedMacURL(),
                                                            "--data-urlencode", "source=QA Helper",
                                                            "--data-urlencode", "pid=" + pid,
                                                            "--data-urlencode", "model=" + computerSpecs.getMacShortModelName() + " (" + computerSpecs.getMacModelIdentifier() + ")",
                                                            "--data-urlencode", "serial=" + computerSpecs.getSerial()));

                                                    for (String thisRemoteManagementOutputLine : remoteManagementOutputLines) {
                                                        if (thisRemoteManagementOutputLine.contains("OrganizationName = ")) {
                                                            remoteManagementOrganizationName = thisRemoteManagementOutputLine.substring(thisRemoteManagementOutputLine.indexOf(" = ") + 3, thisRemoteManagementOutputLine.lastIndexOf(";")).replaceAll("^[ \"]+", "").replaceAll("[ \"]+$", ""); // Trim all leading and trailing spaces and quotes.
                                                            logRemoteManagedMacCommand.addAll(Arrays.asList("--data-urlencode", "organization=" + remoteManagementOrganizationName));
                                                        } else if (thisRemoteManagementOutputLine.contains("OrganizationDepartment = ") || thisRemoteManagementOutputLine.contains("OrganizationEmail = ") || thisRemoteManagementOutputLine.contains("OrganizationSupportEmail = ") || thisRemoteManagementOutputLine.contains("OrganizationPhone = ") || thisRemoteManagementOutputLine.contains("OrganizationSupportPhone = ")) {
                                                            String thisRemoteManagementContantInfo = thisRemoteManagementOutputLine.substring(thisRemoteManagementOutputLine.indexOf(" = ") + 3, thisRemoteManagementOutputLine.lastIndexOf(";")).replaceAll("^[ \"]+", "").replaceAll("[ \"]+$", ""); // Trim all leading and trailing spaces and quotes.
                                                            if (!thisRemoteManagementContantInfo.isEmpty() && !remoteManagementOrganizationContactInfo.contains(thisRemoteManagementContantInfo)) {
                                                                remoteManagementOrganizationContactInfo.add(thisRemoteManagementContantInfo);
                                                            }

                                                            String logKeyName = "department";
                                                            if (thisRemoteManagementOutputLine.contains("OrganizationEmail = ")) {
                                                                logKeyName = "email";
                                                            } else if (thisRemoteManagementOutputLine.contains("OrganizationSupportEmail = ")) {
                                                                logKeyName = "support_email";
                                                            } else if (thisRemoteManagementOutputLine.contains("OrganizationPhone = ")) {
                                                                logKeyName = "phone";
                                                            } else if (thisRemoteManagementOutputLine.contains("OrganizationSupportPhone = ")) {
                                                                logKeyName = "support_phone";
                                                            }
                                                            logRemoteManagedMacCommand.addAll(Arrays.asList("--data-urlencode", logKeyName + "=" + thisRemoteManagementContantInfo));
                                                        }
                                                    }

                                                    for (;;) {
                                                        String logRemoteManagedMacResult = new CommandReader(logRemoteManagedMacCommand.toArray(String[]::new)).getFirstOutputLine();
                                                        if (logRemoteManagedMacResult.endsWith("LOGGED")) { // TODO: Do "curl" in Java. Eventually.
                                                            break;
                                                        }

                                                        if (logRemoteManagedMacResult.isEmpty()) {
                                                            logRemoteManagedMacResult = "UNKNOWN ERROR";
                                                        }

                                                        sendErrorEmail("Failed to Log Remote Managed Mac - " + logRemoteManagedMacResult);

                                                        playAlertSound("error");
                                                        JOptionPane.showMessageDialog(null, "<html><b>Failed to Log Remote Managed Mac<br/><br/>ERROR: " + logRemoteManagedMacResult + "<br/><br/>You must be connected to the internet to be able to log this Remote Managed Mac.</b><br/><br/>"
                                                                + "Make sure you're connected to either a Wi-Fi network or plugged in with an Ethernet cable.<br/><br/>"
                                                                + "If this Mac does not have an Ethernet port, use a Thunderbolt or USB to Ethernet adapter.<br/><br/>"
                                                                + "Once you're connected to Wi-Fi or Ethernet, it may take a few moments for the internet connection to be established.<br/><br/>"
                                                                + "If it takes more than a few minutes, consult an instructor or inform Free Geek I.T.</html>", "QA Helper  —  Log Remote Managed Mac Error", JOptionPane.ERROR_MESSAGE);
                                                        TimeUnit.SECONDS.sleep(1);
                                                    }

                                                    String remoteManagementOrganizationContactInfoDisplay = "<i>NO CONTACT INFORMATION</i>";
                                                    if (!remoteManagementOrganizationContactInfo.isEmpty()) {
                                                        remoteManagementOrganizationContactInfoDisplay = String.join("</li><li>", remoteManagementOrganizationContactInfo);
                                                    }

                                                    playAlertSound("error");
                                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><center>"
                                                            + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>REMOTE MANAGEMENT IS ENABLED ON THIS MAC</b> " + new TwemojiImage("Warning", qaHelperWindow).toImgTag("right")
                                                            + "<br/><br/>"
                                                            + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("left") + " <b style='color: " + errorColorHTML + "'><i>MACS WITH REMOTE MANAGEMENT ENABLED CANNOT BE SOLD</i></b> " + new TwemojiImage("CrossMark", qaHelperWindow).toImgTag("right")
                                                            + "</center><br/><br/>"
                                                            + new TwemojiImage("Locked", qaHelperWindow).toImgTag("left") + " THIS MAC IS MANAGED BY <b>" + remoteManagementOrganizationName + "</b>"
                                                            + "<br/><br/>"
                                                            + new TwemojiImage("Key", qaHelperWindow).toImgTag("left") + " ONLY <b>" + remoteManagementOrganizationName + "</b> CAN DISABLE REMOTE MANAGEMENT"
                                                            + "<br/><br/>"
                                                            + new TwemojiImage("Telephone", qaHelperWindow).toImgTag("left") + " <b>" + remoteManagementOrganizationName + "</b> MUST BE CONTACTED TO DISABLE REMOTE MANAGEMENT:"
                                                            + "<ul style='margin-left: 20px'><li>" + remoteManagementOrganizationContactInfoDisplay + "</li></ul>"
                                                            + "<br/>"
                                                            + new TwemojiImage("IDButton", qaHelperWindow).toImgTag("left") + " The Serial Number for this Mac is <b>" + computerSpecs.getFullSerial() + "</b>"
                                                            + "<br/><br/><br/><center>"
                                                            + new TwemojiImage("Memo", qaHelperWindow).toImgTag("left") + " <i>THIS MAC AND CONTACT INFO HAS BEEN LOGGED</i> " + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("right")
                                                            + "</center></html>", "QA Helper  —  Check Remote Management", JOptionPane.WARNING_MESSAGE, new TwemojiImage("LockedWithKey", qaHelperWindow).toImageIcon());
                                                } else {
                                                    playAlertSound("success");
                                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + new TwemojiImage("CheckMarkButton", qaHelperWindow).toImgTag("left") + " <b style='color: " + successColorHTML + "'>Remote Management <i>IS NOT</i> Enabled</b></html>", "QA Helper  —  Check Remote Management", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Unlocked", qaHelperWindow).toImageIcon(32));

                                                    if (!isRemoteManagementVerified && btnVerifyRemoteManagement.isVisible() && btnVerifyRemoteManagement.isEnabled()) {
                                                        btnVerifyRemoteManagementActionPerformed(null);
                                                    }
                                                }
                                            } else {
                                                playAlertSound("error");
                                                String remoteManagementCheckErrorMessage = "<b>ERROR CHECKING REMOTE MANAGEMENT</b><br/><br/><u>REMOTE MANAGEMENT CHECK OUTPUT:</u><br/>" + String.join("<br/>", remoteManagementOutputLines);
                                                sendErrorEmail(remoteManagementCheckErrorMessage);
                                                JOptionPane.showMessageDialog(qaHelperWindow, "<html>" + remoteManagementCheckErrorMessage + "<br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Check Remote Management Error", JOptionPane.ERROR_MESSAGE);
                                            }
                                        } catch (HeadlessException | InterruptedException | ExecutionException checkRemoteManagementException) {
                                            if (isTestMode) {
                                                System.out.println("checkRemoteManagementException: " + checkRemoteManagementException);
                                            }
                                            playAlertSound("error");
                                            sendErrorEmail("UNKNOWN ERROR CHECKING REMOTE MANAGEMENT");
                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>UNKNOWN ERROR CHECKING REMOTE MANAGEMENT</b><br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Check Remote Management Error", JOptionPane.ERROR_MESSAGE);
                                        }

                                        setActionsEnabled(true);
                                    }
                                }).execute();
                            } else {
                                playAlertSound("error");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Incorrect Admin Password for \"" + fullAdminUsernameForRemoteManagement + "\"</b></html>", "QA Helper  —  Incorrect Password", JOptionPane.WARNING_MESSAGE);
                                setActionsEnabled(true);
                            }
                        } else {
                            setActionsEnabled(true);
                            focusNextTestTaskVerifyButton(btnCheckRemoteManagement);
                        }
                    } else {
                        playAlertSound("error");
                        JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Internet Is Required to Check Remote Management</b><br/><br/><i>Failed to Connect to Apple.com</i></html>", "QA Helper  —  Check Remote Management Error", JOptionPane.WARNING_MESSAGE);
                        setActionsEnabled(true);
                    }
                } else {
                    playAlertSound("beep");
                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>You Must <i>LOG IN</i> to Check Remote Management</b></html>", "QA Helper  —  Log In to Check Remote Management", JOptionPane.WARNING_MESSAGE, new TwemojiImage("LockedWithKey", qaHelperWindow).toImageIcon(32));
                    setActionsEnabled(true);
                }
            } else {
                playAlertSound("beep");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Somehow, this Mac <i>DOES NOT</i> have a System Serial Number.</b><br/><br/><i>Without a System Serial Number, Remote Management cannot be checked.</i><br/><br/>But also, without a System Serial Number, it is <i>IMPOSSIBLE</i> for Remote Management to be enabled.</html>", "QA Helper  —  Check Remote Management Impossible", JOptionPane.WARNING_MESSAGE, new TwemojiImage("ExclamationQuestionMark", qaHelperWindow).toImageIcon(32));
                setActionsEnabled(true);
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnCheckRemoteManagementActionPerformed

    private void btnVerifyRemoteManagementActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerifyRemoteManagementActionPerformed
        if ((actionsEnabled || (evt == null)) && isMacOS && isLoggedIn) {
            setActionsEnabled(false);

            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>" + ((evt == null) ? "Would you like " : "Are you sure you want ") + "to <i>" + (isRemoteManagementVerified ? "UNVERIFY" : "verify") + "</i> that remote management is not enabled?</b></html>", "QA Helper  —  Confirm " + (isRemoteManagementVerified ? "Unverify" : "Verify") + " Remote Management", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage((isRemoteManagementVerified ? "CrossMark" : "CheckBoxWithCheck"), qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                isRemoteManagementVerified = !isRemoteManagementVerified;

                writeToHelperLogFile("Task: Remote Management " + (isRemoteManagementVerified ? "Verified" : "UNVERIFIED"));

                btnVerifyRemoteManagement.setText((isRemoteManagementVerified ? "Verified" : "Verify"));
                btnVerifyRemoteManagement.setFont(btnVerifyRemoteManagement.getFont().deriveFont((isRemoteManagementVerified ? Font.BOLD : lblVersion.getFont().getStyle())));
                btnVerifyRemoteManagement.setForeground(isRemoteManagementVerified ? verifiedColor : defaultColor);
                btnVerifyRemoteManagement.setBorderPainted(!isRemoteManagementVerified);

                new LinuxAutoScripts("Remote Management " + (isRemoteManagementVerified ? "Verified" : "Unverified"), adminPassword);

                focusNextTestTaskVerifyButton(btnVerifyRemoteManagement);
            } else {
                focusNextTestTaskVerifyButton(btnCheckRemoteManagement);
            }

            setActionsEnabled(true);
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnVerifyRemoteManagementActionPerformed

    private void btnReloadSpecsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReloadSpecsActionPerformed
        if (actionsEnabled)
            reload();
        else
            playAlertSound("beep");
    }//GEN-LAST:event_btnReloadSpecsActionPerformed

    private void btnSaveSpecsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveSpecsActionPerformed
        if (actionsEnabled && !isWindowsPE) {
            setActionsEnabled(false);

            String specsToSave = "Brand: " + computerSpecs.getFullBrand() + "\n"
                    + "Model: " + computerSpecs.getFullModel() + "\n"
                    + "Serial: " + computerSpecs.getFullSerial() + "\n"
                    + "MAC: " + computerSpecs.getEthernetMAC() + "\n"
                    + "\n"
                    + "CPU: " + computerSpecs.getFullCPU() + "\n"
                    + "RAM: " + computerSpecs.getFullRAM() + "\n"
                    + "GPU: " + computerSpecs.getFullGPU() + (computerSpecs.getGPUerrorString().isEmpty() ? "" : " - " + computerSpecs.getGPUerrorString()) + "\n"
                    + "Audio: " + computerSpecs.getFullAudio() + (computerSpecs.getAudioErrorString().isEmpty() ? "" : " - " + computerSpecs.getAudioErrorString()) + "\n"
                    + "Wireless: " + computerSpecs.getWireless() + (computerSpecs.getWirelessErrorString().isEmpty() ? "" : " - " + computerSpecs.getWirelessErrorString()) + "\n";

            if (computerSpecs.isLaptop()) {
                String batteryHealthWarningString = computerSpecs.getBatteryHealthWarning();
                String batteryHealthErrorString = computerSpecs.getBatteryHealthError();
                specsToSave += "\n"
                        + "Battery: " + computerSpecs.getBatteryCapacity() + "\n"
                        + "Battery Health Warning: " + (batteryHealthWarningString.isEmpty() ? "None" : batteryHealthWarningString) + "\n"
                        + "Battery Health Error: " + (batteryHealthErrorString.isEmpty() ? "None" : batteryHealthErrorString) + "\n";
            }

            if (computerSpecs.hasScreen()) {
                specsToSave += "\n"
                        + "Screen Size: " + computerSpecs.getFullScreenSize() + computerSpecs.getScreenErrorString() + "\n";
            }

            if (!computerSpecs.getFullDiscDrive().equals("N/A")) {
                specsToSave += "\n"
                        + "Disc Drive: " + computerSpecs.getFullDiscDrive() + "\n"
                        + "Disc Drive Can Burn CDs: " + (computerSpecs.discDriveCanBurnCDs() ? "Yes" : "No") + "\n"
                        + "Disc Drive Can Burn DVDs: " + (computerSpecs.discDriveCanBurnDVDs() ? "Yes" : "No") + "\n";
            }

            if (!computerSpecs.getFullStorage().equals("N/A")) {
                specsToSave += "\n"
                        + "Storage: " + computerSpecs.getFullStorage() + "\n";

                if (!computerSpecs.getDriveHealth().equals("N/A")) {
                    specsToSave += "Drives Health Warning: " + (computerSpecs.getDriveHealthWarning() ? "Yes" : "No") + "\n"
                            + "Drive Health:" + "\n"
                            + computerSpecs.getDriveHealth() + "\n";
                }
            }

            String saveSpecsDirectoryPath = System.getProperty("user.home") + (isWindows ? "\\" : "/") + "Desktop" + (isWindows ? "\\" : "/");

            if (isWindows && !new File(saveSpecsDirectoryPath).exists()) {
                saveSpecsDirectoryPath = (new File(System.getProperty("user.home") + "\\OneDrive\\Desktop").exists()
                        ? System.getProperty("user.home") + "\\OneDrive\\Desktop\\"
                        : "\\Install\\");
            }

            String saveSpecsFilename = "QA Helper - Computer Specs.txt";

            File saveSpecsDirectory = new File(saveSpecsDirectoryPath);
            saveSpecsDirectory.mkdirs();
            File saveSpecsFile = new File(saveSpecsDirectoryPath, saveSpecsFilename);

            try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(saveSpecsFile))) {
                bufferedWriter.write(specsToSave);

                playAlertSound("success");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>The current computer specs have been saved into the following file:</b><br/><br/>" + saveSpecsFile.getPath() + "</html>", "QA Helper  —  Save Computer Specs", JOptionPane.INFORMATION_MESSAGE, new TwemojiImage("Memo", qaHelperWindow).toImageIcon(32));
            } catch (Exception writeSpecsFileException) {
                if (isTestMode) {
                    System.out.println("writeSpecsFileException: " + writeSpecsFileException);
                }

                playAlertSound("error");
                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>ERROR SAVING COMPUTER SPECS INTO THE FOLLOWING FILE:</b><br/><br/>" + saveSpecsFile.getPath() + "<br/><br/><i>Please Try Again</i></html>", "QA Helper  —  Save Computer Specs Error", JOptionPane.WARNING_MESSAGE);
            }

            setActionsEnabled(true);
        } else
            playAlertSound("beep");
    }//GEN-LAST:event_btnSaveSpecsActionPerformed

    private void btnSystemInfoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSystemInfoActionPerformed
        // Intentionally allow opening System Info even if actions are not enabled, except when running CPU Stress Test.
        if (!isWindowsPE && (!loadingWindow.isVisible() || !loadingWindow.getLoadingText().startsWith("QA Helper is Stressing CPU"))) {
            try {
                if (isWindows) {
                    if (new CommandReader(new String[]{"\\Windows\\System32\\tasklist.exe", "/nh", "/fi", "IMAGENAME eq msinfo32.exe"}).getFirstOutputLineContaining("msinfo32.exe").isEmpty()) {
                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\msinfo32.exe"});
                    } else {
                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "(New-Object -ComObject Wscript.Shell).AppActivate('System Information')"});
                    }
                } else if (isLinux) {
                    if (new File("/usr/bin/mintreport").exists()) { // Open System Reports (which contains a detailed "System information" section).
                        if (!new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("System Reports").isEmpty()) {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/wmctrl", "-Fa", "System Reports"});
                        } else {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/mintreport"});
                        }
                    } else {
                        playAlertSound("beep");
                    }

                    if (new File("/usr/bin/cinnamon-settings").exists()) { // "cinnamon-settings" won't exist on MATE, but if we are on Cinnamon ALSO open it.
                        if (!new CommandReader(new String[]{"/usr/bin/wmctrl", "-l"}).getFirstOutputLineContaining("System Info").isEmpty()) {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/wmctrl", "-Fa", "System Info"});
                        } else {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/cinnamon-settings", "info"});
                        }
                    }
                } else if (isMacOS) {
                    Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-b", "com.apple.SystemProfiler"});
                }
            } catch (IOException openSystemInfoException) {
                if (isTestMode) {
                    System.out.println("openSystemInfoException: " + openSystemInfoException);
                }
                playAlertSound("error");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnSystemInfoActionPerformed

    private void btnPIDHistoryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPIDHistoryActionPerformed
        if (actionsEnabled && isLoggedIn) {
            setActionsEnabled(false);

            loadingWindow.setLoadingTextAndDisplay("QA Helper is Retrieving PID History", "Working", "MagnifyingGlassTiltedLeft");

            (new SwingWorker<Void, Void>() {
                @Override
                protected Void doInBackground() throws Exception {
                    getHistory(true);

                    return null;
                }

                @Override
                protected void done() {
                    loadingWindow.closeWindow();

                    setActionsEnabled(true, false); // Don't set shouldFocusWindow so that historyWindow stays in front
                }
            }).execute();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnPIDHistoryActionPerformed

    private void btnCreditsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCreditsActionPerformed
        creditsWindow.showCreditsWindow();
    }//GEN-LAST:event_btnCreditsActionPerformed

    private void btnDoneTestingActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDoneTestingActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            if (!isLoggedIn) {
                if (btnDoneTesting.getText().equals("Options") && !isWindows) {
                    String[] statusNames = privateStrings.getPCsCRMStatusNames();
                    // hideLoginAndTasks is never set to true on Windows, so this will never actually be an option on Windows.
                    ArrayList<String> optionsDialogButtons = new ArrayList<>();
                    optionsDialogButtons.addAll(Arrays.asList(((isLinuxUbiquityMode || isWindowsPE) ? "Install OS" : "Quit"), "Show Login & Tasks"));
                    if (isMacOS) {
                        if (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists()) {
                            optionsDialogButtons.add("Cleanup After " + statusNames[12]);
                        } else if (new File("/Users/fg-demo/Applications/Free Geek Reset.app").exists()) {
                            optionsDialogButtons.add("Reset This Mac");
                        }
                    }
                    optionsDialogButtons.addAll(Arrays.asList("Set Price", "Mark as Sold", "Nothing"));

                    int optionsDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>What would you like to do?</b></html>", "QA Helper  —  Options", JOptionPane.DEFAULT_OPTION, JOptionPane.QUESTION_MESSAGE, null, optionsDialogButtons.toArray(), optionsDialogButtons.get(0));
                    String optionsDialogResponseString = "Nothing";
                    if (optionsDialogResponse > -1) {
                        optionsDialogResponseString = optionsDialogButtons.get(optionsDialogResponse);
                    }

                    if (optionsDialogResponseString.equals(((isLinuxUbiquityMode || isWindowsPE) ? "Install OS" : "Quit"))) {
                        System.exit(0);
                    } else if (isMacOS && (optionsDialogResponseString.equals("Cleanup After " + statusNames[12]) || optionsDialogResponseString.equals("Reset This Mac"))) {
                        try {
                            Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", "/Users/fg-demo/Applications/" + (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists() ? "Cleanup After " + statusNames[12] : "Free Geek Reset") + ".app"});
                        } catch (IOException launchCleanupOrResetAppError) {
                            System.out.println("launchCleanupOrResetAppError: " + launchCleanupOrResetAppError);
                        }
                        System.exit(0);
                    } else if (!optionsDialogResponseString.equals("Nothing")) {
                        // If Windows support for hideLoginAndTasks is ever added, this will need to be dealt with
                        String possibleAdminUsername = new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine();
                        if (isMacOS) {
                            List<String> adminUsernames = Arrays.asList(new CommandReader(new String[]{"/bin/bash", "-c", "/usr/libexec/PlistBuddy -c 'Print :dsAttrTypeStandard\\:GroupMembership' /dev/stdin <<< \"$(/usr/bin/dscl -plist . -read /Groups/admin GroupMembership)\" | /usr/bin/awk '(($NF != \"{\") && ($NF != \"root\") && ($NF != \"}\")) { print $NF }'"}).getOutputLines());
                            if (!adminUsernames.isEmpty() && !adminUsernames.contains(possibleAdminUsername)) {
                                possibleAdminUsername = adminUsernames.get(0);
                            }
                        }
                        final String shortAdminUsernameForTask = possibleAdminUsername;
                        final String fullAdminUsernameForTask = (isMacOS ? new CommandReader(new String[]{"/usr/bin/id", "-F", shortAdminUsernameForTask}).getFirstOutputLine() : (isLinux ? new CommandReader(new String[]{"/usr/bin/getent", "passwd", shortAdminUsernameForTask}).getFirstOutputLine().split(":")[4].replace(",", "") : shortAdminUsernameForTask));

                        JPasswordField passwordField = new JPasswordField();
                        passwordField.putClientProperty("JTextField.showClearButton", true);

                        Object[] passwordPromptFields = new Object[]{
                            "<html><b>Enter Admin Password for \"" + fullAdminUsernameForTask + "\" to <i>" + optionsDialogResponseString + "</i>:</b></html>",
                            passwordField
                        };

                        JOptionPane passwordPromptPane = new JOptionPane(passwordPromptFields, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION) {
                            @Override
                            public void selectInitialValue() {
                                passwordField.requestFocusInWindow();
                            }
                        };

                        passwordPromptPane.createDialog(qaHelperWindow, "QA Helper  —  Admin Password").setVisible(true);

                        if (passwordPromptPane.getValue() != null && (int) passwordPromptPane.getValue() == JOptionPane.OK_OPTION) {
                            String adminPasswordForTask = new String(passwordField.getPassword());

                            if ((isLinux && new CommandReader("printf '%s\\n' '" + adminPasswordForTask.replace("'", "'\\''") + "' | /usr/bin/sudo -Sk echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>"))
                                    || (!isLinux && new CommandReader("/usr/bin/dscl . -authonly '" + shortAdminUsernameForTask.replace("'", "'\\''") + "' '" + adminPasswordForTask.replace("'", "'\\''") + "' && echo '<CORRECT>'").getFirstOutputLine().equals("<CORRECT>"))) {
                                switch (optionsDialogResponseString) {
                                    case "Show Login & Tasks":
                                        hideLoginAndTasks = false;
                                        displayComputerSpecs();
                                        focusNextTestTaskVerifyButton(null);
                                        hideLoginAndTasks = true;
                                        break;
                                    case "Set Price":
                                        NumberFormatter priceFormatter = new NumberFormatter(NumberFormat.getNumberInstance());
                                        priceFormatter.setValueClass(Integer.class);
                                        priceFormatter.setMinimum(1);
                                        priceFormatter.setMaximum(9999);
                                        priceFormatter.setAllowsInvalid(false);
                                        priceFormatter.setCommitsOnValidEdit(true);

                                        JFormattedTextField pricePromptField = new JFormattedTextField(priceFormatter);
                                        pricePromptField.setColumns(5);

                                        JPanel pricePromptPanel = new JPanel(); // Create JPanel and add components to for horizonal layout instead of vertical.
                                        pricePromptPanel.add(new JLabel("<html><b>Enter Price:</b> $</html>"));
                                        pricePromptPanel.add(pricePromptField);
                                        pricePromptPanel.add(new JLabel("<html><i>(dollars only, no cents)</i></html>"));

                                        JOptionPane pricePromptPane = new JOptionPane(pricePromptPanel, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION, new TwemojiImage("DollarBanknote", qaHelperWindow).toImageIcon(32)) {
                                            @Override
                                            public void selectInitialValue() {
                                                pricePromptField.requestFocusInWindow();
                                            }
                                        };

                                        pricePromptPane.createDialog(qaHelperWindow, "QA Helper  —  Set Price").setVisible(true);

                                        String newPrice = "$" + pricePromptField.getText().replaceAll("[^0-9,]", "");

                                        if (pricePromptPane.getValue() != null && (int) pricePromptPane.getValue() == JOptionPane.OK_OPTION && !newPrice.equals("$")
                                                && JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to set the price to <u>" + newPrice + "</u>?</b></html>", "QA Helper  —  Confirm Price", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("DollarBanknote", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                                            writeToHelperLogFile("Price: " + newPrice);

                                            isSold = false;
                                            displayPrice = newPrice;

                                            displayComputerSpecs(); // Update displayed price
                                        }
                                        break;
                                    case "Mark as Sold":
                                        String markAsSoldConfirmationMessage = "<html><b>Are you sure you want to mark this computer as sold?</b></html>";
                                        JCheckBox runOemConfigPrepareCheckbox = new JCheckBox("Prepare for Shipping to End User (Run \"oem-config-prepare\")");
                                        runOemConfigPrepareCheckbox.setSelected(true);
                                        boolean showRunOemConfigPrepareCheckbox = (isLinux && !isLinuxLiveBoot && new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine().equals("oem"));
                                        Object[] markAsSoldConfirmationMessageAndOptions = new Object[]{markAsSoldConfirmationMessage, (showRunOemConfigPrepareCheckbox ? " " : ""), (showRunOemConfigPrepareCheckbox ? runOemConfigPrepareCheckbox : "")};
                                        if (JOptionPane.showConfirmDialog(qaHelperWindow, markAsSoldConfirmationMessageAndOptions, "QA Helper  —  Confirm Mark as Sold", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("Receipt", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                                            writeToHelperLogFile("Sold");

                                            isSold = true;

                                            displayComputerSpecs(); // Update sold display

                                            if (isMacOS && new File("/Users/fg-demo/Applications/Free Geek Reset.app").exists()) {
                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", "/Users/fg-demo/Applications/" + (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists() ? "Cleanup After " + statusNames[12] : "Free Geek Reset") + ".app"});
                                                } catch (IOException launchCleanupOrResetAppError) {
                                                    System.out.println("launchCleanupOrResetAppError: " + launchCleanupOrResetAppError);
                                                }

                                                System.exit(0);
                                            } else {
                                                if (showRunOemConfigPrepareCheckbox && runOemConfigPrepareCheckbox.isSelected()) {
                                                    runOemConfigPrepare();
                                                }

                                                new LinuxAutoScripts("Sold", adminPassword);
                                            }
                                        }
                                        break;
                                    default:
                                        break;
                                }
                            } else {
                                playAlertSound("error");
                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Incorrect Admin Password for \"" + fullAdminUsernameForTask + "\"</b></html>", "QA Helper  —  Incorrect Password", JOptionPane.WARNING_MESSAGE);
                            }
                        }
                    }

                    setActionsEnabled(true);
                } else {
                    System.exit(0);
                }
            } else {
                String[] statusNames = privateStrings.getPCsCRMStatusNames();
                String currentStatus = getHistory(false)[0];
                if (!currentStatus.equals("UNKNOWN STATUS") && !currentStatus.equals(statusNames[2]) && !currentStatus.equals(statusNames[3])) {
                    System.exit(0);
                } else if (!isReloading) {
                    ArrayList<String> doneTestingDialogButtons = new ArrayList<>();

                    if (isLinuxUbiquityMode || isWindowsPE) {
                        doneTestingDialogButtons.add("Install OS");
                    }
                    // TODO: Decide whether setting to the "statusNames[2]" status should ever be an option.
                    //if (currentStatus.equals(statusNames[3])) doneTestingDialogButtons.add("Set Status to \"" + statusNames[2] + "\"");
                    doneTestingDialogButtons.add("Set Status to \"" + statusNames[12] + "\"");
                    if (!isLinuxUbiquityMode && !isWindowsPE) {
                        doneTestingDialogButtons.add("Quit");
                    }
                    doneTestingDialogButtons.addAll(Arrays.asList("Shut Down", "Reboot", "Cancel"));

                    int doneTestingDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>What would you like to do next?</b></html>", "QA Helper  —  Done Testing", JOptionPane.DEFAULT_OPTION, JOptionPane.QUESTION_MESSAGE, null, doneTestingDialogButtons.toArray(), doneTestingDialogButtons.get(0));

                    String doneTestingResponseString = "Cancel";
                    if (doneTestingDialogResponse > -1) {
                        doneTestingResponseString = doneTestingDialogButtons.get(doneTestingDialogResponse);
                    }

                    if (doneTestingResponseString.equals("Cancel")) {
                        setActionsEnabled(true);
                    } else if (doneTestingResponseString.equals("Shut Down")) {
                        if (isLinux) {
                            try {
                                while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                    TimeUnit.SECONDS.sleep(2);
                                }

                                Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "now"}).waitFor();
                                TimeUnit.SECONDS.sleep(2);
                            } catch (IOException | InterruptedException shutDownNowException) {
                                if (isTestMode) {
                                    System.out.println("shutDownNowException: " + shutDownNowException);
                                }
                            }
                        } else if (isWindows) {
                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Computer"}).waitFor();
                                TimeUnit.SECONDS.sleep(2);
                            } catch (IOException | InterruptedException stopComputerException) {
                                if (isTestMode) {
                                    System.out.println("stopComputerException: " + stopComputerException);
                                }
                            }
                        } else if (isMacOS) {
                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to shut down with state saving preference"}).waitFor();
                                TimeUnit.SECONDS.sleep(2);
                            } catch (IOException | InterruptedException osascriptShutDownException) {
                                if (isTestMode) {
                                    System.out.println("osascriptShutDownException: " + osascriptShutDownException);
                                }
                            }
                        }

                        System.exit(0);
                    } else if (doneTestingResponseString.equals("Reboot")) {
                        if (isLinux) {
                            try {
                                while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                    TimeUnit.SECONDS.sleep(2);
                                }

                                Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "-r", "now"}).waitFor();
                                TimeUnit.SECONDS.sleep(2);
                            } catch (IOException | InterruptedException rebootNowException) {
                                if (isTestMode) {
                                    System.out.println("rebootNowException: " + rebootNowException);
                                }
                            }
                        } else if (isWindows) {
                            try {
                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Restart-Computer"}).waitFor();
                                TimeUnit.SECONDS.sleep(2);
                            } catch (IOException | InterruptedException restartComputerException) {
                                if (isTestMode) {
                                    System.out.println("restartComputerException: " + restartComputerException);
                                }
                            }
                        } else if (isMacOS) {
                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to restart with state saving preference"}).waitFor();
                                TimeUnit.SECONDS.sleep(2);
                            } catch (IOException | InterruptedException osascriptRestartException) {
                                if (isTestMode) {
                                    System.out.println("osascriptRestartException: " + osascriptRestartException);
                                }
                            }
                        }

                        System.exit(0);
                    } else if (doneTestingResponseString.equals("Set Status to \"" + statusNames[2] + "\"")) { // THIS IS NOT CURRENTLY USED
                        if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to set the status for PID \"" + pid + "\" to <u>" + statusNames[2] + "</u>?</b></html>", "QA Helper  —  Confirm " + statusNames[2], JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("CheckBoxWithCheck", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                            loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
                            setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);

                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Updating Status to " + statusNames[2], "Working", "CheckBoxWithCheck");

                            (new SwingWorker<String, Void>() {
                                @Override
                                protected String doInBackground() throws Exception {
                                    if (logComputerSpecs()) {
                                        if (updateStatus(statusNames[2], currentStatus) == null) {
                                            return "failed";
                                        }

                                        return "success";
                                    } else {
                                        return "failed";
                                    }
                                }

                                @Override
                                protected void done() {
                                    try {
                                        String returnValue = get();

                                        if (returnValue.equals("success")) {
                                            displayComputerSpecs(); // TODO: getHistory in background and pass to displayComputerSpecs() instead of relying on displayComputerSpecs() to get it on main thread to update displayed status.

                                            loadingWindow.closeWindow();
                                            playAlertSound("success");
                                            String[] successfullyUpdatedStatusDialogButtons = new String[]{((isLinuxUbiquityMode || isWindowsPE) ? "Install OS" : "Quit"), "Shut Down", "Keep Using QA Helper"};

                                            int successfullyUpdatedStatusDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>Successfully Updated Status for PID \"" + pid + "\" to <u>" + statusNames[2] + "</u></b><br/><br/><i>What would you like to do next?</i></html>", "QA Helper  —  Status Updated", (!isMacOS ? JOptionPane.YES_NO_CANCEL_OPTION : JOptionPane.YES_NO_OPTION), JOptionPane.QUESTION_MESSAGE, new TwemojiImage("CheckBoxWithCheck", qaHelperWindow).toImageIcon(32), successfullyUpdatedStatusDialogButtons, successfullyUpdatedStatusDialogButtons[0]);
                                            switch (successfullyUpdatedStatusDialogResponse) {
                                                case JOptionPane.YES_OPTION:
                                                    System.exit(0);
                                                    break;
                                                case JOptionPane.NO_OPTION:
                                                case -1:
                                                    if (isLinux) {
                                                        try {
                                                            while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                                                TimeUnit.SECONDS.sleep(2);
                                                            }

                                                            Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "now"}).waitFor();
                                                            TimeUnit.SECONDS.sleep(2);
                                                        } catch (IOException | InterruptedException shutDownNowException) {
                                                            if (isTestMode) {
                                                                System.out.println("shutDownNowException: " + shutDownNowException);
                                                            }
                                                        }
                                                    } else if (isWindows) {
                                                        try {
                                                            Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Computer"}).waitFor();
                                                            TimeUnit.SECONDS.sleep(2);
                                                        } catch (IOException | InterruptedException stopComputerException) {
                                                            if (isTestMode) {
                                                                System.out.println("stopComputerException: " + stopComputerException);
                                                            }
                                                        }
                                                    } else if (isMacOS) {
                                                        try {
                                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to shut down with state saving preference"}).waitFor();
                                                            TimeUnit.SECONDS.sleep(2);
                                                        } catch (IOException | InterruptedException osascriptShutDownException) {
                                                            if (isTestMode) {
                                                                System.out.println("osascriptShutDownException: " + osascriptShutDownException);
                                                            }
                                                        }
                                                    }

                                                    System.exit(0);
                                                    break;
                                                default:
                                                    break;
                                            }
                                        } else if (returnValue.equals("failed")) {
                                            loadingWindow.closeWindow();
                                            playAlertSound("error");
                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Log Specs and/or Update Status to <u>" + statusNames[2] + "</u></b></html>", "QA Helper  —  Update Status Error", JOptionPane.ERROR_MESSAGE);
                                        }
                                    } catch (HeadlessException | InterruptedException | ExecutionException setStatusToRefurbishCompleteException) {
                                        if (isTestMode) {
                                            System.out.println("setStatusToRefurbishCompleteException: " + setStatusToRefurbishCompleteException);
                                        }
                                    }

                                    loadingWindow.closeWindow();

                                    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                                    loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

                                    setActionsEnabled(true);
                                }
                            }).execute();
                        } else {
                            setActionsEnabled(true);
                        }
                    } else if (doneTestingResponseString.equals("Set Status to \"" + statusNames[12] + "\"")) {
                        String qaDoneConfirmationMessage = "<html><b>Are you sure you want to set the status for PID \"" + pid + "\" to <u>" + statusNames[12] + "</u>?</b></html>";

                        JCheckBox changeFreeGeekPasswordCheckbox = new JCheckBox("Change Admin Password to Free Geek Store Password");
                        JCheckBox runOemConfigPrepareCheckbox = new JCheckBox("Prepare for Shipping to End User (Run \"oem-config-prepare\")");

                        boolean showChangeFreeGeekPasswordCheckbox = (isLinux && !isLinuxLiveBoot && pid.startsWith("FG") && adminPassword.equals(privateStrings.getInsecureFreeGeekPassword()));
                        boolean showRunOemConfigPrepareCheckbox = (isLinux && !isLinuxLiveBoot && new CommandReader(new String[]{"/usr/bin/id", "-un"}).getFirstOutputLine().equals("oem"));

                        Object[] qaDoneConfirmationMessageAndOptions = new Object[]{qaDoneConfirmationMessage, ((showChangeFreeGeekPasswordCheckbox || showRunOemConfigPrepareCheckbox) ? " " : ""), (showChangeFreeGeekPasswordCheckbox ? changeFreeGeekPasswordCheckbox : ""), (showRunOemConfigPrepareCheckbox ? runOemConfigPrepareCheckbox : "")};

                        if (JOptionPane.showConfirmDialog(qaHelperWindow, qaDoneConfirmationMessageAndOptions, "QA Helper  —  Confirm " + statusNames[12], JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("CheckMarkButton", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                            loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
                            setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);

                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Confirming Ready for " + statusNames[12], "Working", "CheckMarkButton");

                            (new SwingWorker<String, Void>() {
                                @Override
                                protected String doInBackground() throws Exception {
                                    boolean qaCompleteAllowed = true;
                                    boolean hasDPK = false;

                                    if (!isTestMode) {
                                        if (isWindows) {
                                            // Do not confirm Windows Activation when in test mode.

                                            try {
                                                HashMap<String, String> windowsProductKeyInfoSavedInPCsCRM = PCsCRMManager.getWindowsProductKeyInfoForPID(pid, isTestMode);
                                                String productKeySavedInPCsCRM = windowsProductKeyInfoSavedInPCsCRM.get("productKey");

                                                if (productKeySavedInPCsCRM.isEmpty()) {
                                                    qaCompleteAllowed = false;
                                                } else {
                                                    String preExistingCoaIdSavedInPCsCRM = windowsProductKeyInfoSavedInPCsCRM.get("oldCoaID");
                                                    String newCoaIdSavedInPCsCRM = windowsProductKeyInfoSavedInPCsCRM.get("newCoaID");

                                                    String windowsActivationInfo = computerSpecs.getWindowsActivationInfo(isTestMode, isLoggedIn);
                                                    // The following code does a lot of not ideal string parsing because getWindowsActivationInfo was originally used just for a simple
                                                    // Activation Info output display, but things slowly evolved and a lot more complex stuff if being done and getWindowsActivationInfo
                                                    // should really be broken out to its own class with sepearate properties to be able to make the following code much cleaner and simpler.

                                                    boolean isActivated = windowsActivationInfo.contains("Licensed");
                                                    boolean possibleNonRefurbProductKey = windowsActivationInfo.contains("ACTIVATED WITH A NON-REFURBISHED PC PRODUCT KEY");

                                                    if (!isActivated || possibleNonRefurbProductKey || !windowsActivationInfo.contains("<b>COA ID / COA Serial Number:</b> " + newCoaIdSavedInPCsCRM) || !windowsActivationInfo.contains("<b>Product Key in Registry:</b> " + productKeySavedInPCsCRM)) {
                                                        qaCompleteAllowed = false;
                                                    } else if (windowsActivationInfo.contains("OEM:DM") || preExistingCoaIdSavedInPCsCRM.equals("DIGITALPRODUCTKEY")) { // Make sure CBR has been uploaded for DPKs.
                                                        hasDPK = true;

                                                        if (new File(helperLogFilePath).exists()) {
                                                            try {
                                                                String productKeyID = "";

                                                                for (String thisWindowsActivationInfoLine : windowsActivationInfo.split("<br/>")) {
                                                                    if (thisWindowsActivationInfoLine.contains(":</b> ")) {
                                                                        String thisWindowsActivationInfoProperty = thisWindowsActivationInfoLine.substring(thisWindowsActivationInfoLine.indexOf(":</b> ") + 6).trim();

                                                                        if (!thisWindowsActivationInfoProperty.isEmpty()) {
                                                                            if (thisWindowsActivationInfoLine.startsWith("<b>Product Key ID:</b>")) {
                                                                                productKeyID = thisWindowsActivationInfoProperty;
                                                                                break;
                                                                            }
                                                                        }
                                                                    }
                                                                }

                                                                boolean didUploadCBRforDPK = false;
                                                                List<String> allHelperLogLines = Files.readAllLines(Paths.get(helperLogFilePath), StandardCharsets.UTF_8);
                                                                for (String thisHelperLogLine : allHelperLogLines) {
                                                                    if (thisHelperLogLine.startsWith("Uploaded CBR for DPK: CBR+" + productKeyID + "+" + computerSpecs.getFullSerial() + "+" + pid + ".xml")) {
                                                                        didUploadCBRforDPK = true;
                                                                    } else if (thisHelperLogLine.startsWith("Reverted DPK")) {
                                                                        didUploadCBRforDPK = false;
                                                                    }
                                                                }

                                                                if (!didUploadCBRforDPK) {
                                                                    qaCompleteAllowed = false;
                                                                }
                                                            } catch (IOException readLogForCBRexception) {
                                                                if (isTestMode) {
                                                                    System.out.println("readLogForCBRexception: " + readLogForCBRexception);
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            } catch (Exception checkSavedProductKeyForQACompleteException) {
                                                if (isTestMode) {
                                                    System.out.println("checkSavedProductKeyForQACompleteException: " + checkSavedProductKeyForQACompleteException);
                                                }

                                                sendErrorEmail("checkSavedProductKeyForQACompleteException: " + checkSavedProductKeyForQACompleteException);

                                                qaCompleteAllowed = false;
                                            }
                                        } else if (isMacOS && new File("/Users/fg-demo/Applications/Free Geek Setup.app").exists()) { // Will never get here anymore since not allowed to load at all when Free Geek Setup hasn't run, but leave it here just in case it's needed again in the future.
                                            // Do not confirm Free Geek Setup has run when in test mode.
                                            qaCompleteAllowed = false;
                                        }
                                    }

                                    return ((qaCompleteAllowed ? "allowed" : "not-allowed") + (hasDPK ? "+dpk" : ""));
                                }

                                @Override
                                protected void done() {
                                    boolean qaCompleteAllowed = false;
                                    boolean dpkGmrlStickerConfirmed = true;

                                    try {
                                        String returnValue = get();

                                        if (returnValue.startsWith("allowed")) {
                                            if (returnValue.contains("+dpk")) {
                                                dpkGmrlStickerConfirmed = false;

                                                loadingWindow.closeWindow();

                                                JTextField dpkGmrlStickerConfirmationField = new JTextField();
                                                dpkGmrlStickerConfirmationField.putClientProperty("JTextField.showClearButton", true);
                                                dpkGmrlStickerConfirmationField.setTransferHandler(null); // Disable pasting into field.
                                                Object[] dpkGmrlStickerConfirmationFields = new Object[]{
                                                    "<html><b>Since a DPK has been applied, a \"Genuine Microsoft Refurbisher Label\" (GMRL) sticker must be affixed to this computer<br/><i>and any existing COA or GML stickers must be removed and destroyed or any Product Keys must be crossed out so they are unreadable</i>.</b><br/><br/><u>Desktops:</u> Affix the GMRL on the <u>back of the case</u> <i>(<b>not</b> the front)</i> without covering any regulatory information, other stickers, logos, or text.<br/><u>Laptops:</u> Affix the GMRL <u>under the battery or on the bottom of the case</u> without covering any regulatory information, other stickers, logos, or text.<br/><br/><u>Also, you must remove and destroy any existing COA or GML stickers or cross out any Product Keys so they are unreadable.</u><br/><br/><i>Type \"<b>GMRL</b>\" after confirming a \"Genuine Microsoft Refurbisher Label\" sticker has been affixed to this computer<br/>and any existing COA or GML stickers have been removed and destroyed or any Product Keys have been crossed out so they are unreadable:</i></html>",
                                                    dpkGmrlStickerConfirmationField
                                                };

                                                JOptionPane dpkGmrlStickerConfirmationPane = new JOptionPane(dpkGmrlStickerConfirmationFields, JOptionPane.WARNING_MESSAGE, JOptionPane.OK_CANCEL_OPTION, new TwemojiImage("Window", qaHelperWindow).toImageIcon(32)) {
                                                    @Override
                                                    public void selectInitialValue() {
                                                        dpkGmrlStickerConfirmationField.requestFocusInWindow();
                                                    }
                                                };

                                                dpkGmrlStickerConfirmationPane.createDialog(qaHelperWindow, "QA Helper  —  Confirm GMRL for DPK").setVisible(true);

                                                if (dpkGmrlStickerConfirmationPane.getValue() != null && (int) dpkGmrlStickerConfirmationPane.getValue() == JOptionPane.OK_OPTION && dpkGmrlStickerConfirmationField.getText().trim().toUpperCase().equals("GMRL")) {
                                                    dpkGmrlStickerConfirmed = true;
                                                    qaCompleteAllowed = true;
                                                }
                                            } else {
                                                qaCompleteAllowed = true;
                                            }
                                        }

                                        if (qaCompleteAllowed && dpkGmrlStickerConfirmed) {
                                            loadingWindow.setLoadingTextAndDisplay("QA Helper is Updating Status to " + statusNames[12], "Working", "CheckMarkButton");

                                            (new SwingWorker<String, Void>() {
                                                @Override
                                                protected String doInBackground() throws Exception {
                                                    if (logComputerSpecs()) {
                                                        String returnStatus = "success";

                                                        if (showChangeFreeGeekPasswordCheckbox && changeFreeGeekPasswordCheckbox.isSelected()) {
                                                            // Change password before running updateStatus for root auto-scripts to work.
                                                            String freeGeekStorePassword = privateStrings.getCurrentFreeGeekPassword();
                                                            String freeGeekStorePasswordQuotedForShell = "'" + freeGeekStorePassword.replace("'", "'\\''") + "'";
                                                            if (!new CommandReader("printf '%s\\n' " + adminPasswordQuotedForShell + " " + freeGeekStorePasswordQuotedForShell + " " + freeGeekStorePasswordQuotedForShell + " | /usr/bin/passwd 2>&1").getFirstOutputLineContaining("password updated successfully").isEmpty()) {
                                                                adminPassword = freeGeekStorePassword;
                                                                adminPasswordQuotedForShell = freeGeekStorePasswordQuotedForShell;
                                                                returnStatus += "+password-success";
                                                            } else {
                                                                returnStatus += "+password-failed";
                                                            }
                                                        }

                                                        if (!currentStatus.equals(statusNames[2])) {
                                                            if (updateStatus(statusNames[2], currentStatus) == null) {
                                                                return "update-failed";
                                                            }

                                                            TimeUnit.SECONDS.sleep(1); // Wait a second after sending "statusNames[2]" to make sure "statusNames[12]" always comes after when pulled from history.
                                                        }

                                                        if (updateStatus(statusNames[12], statusNames[2]) == null) {
                                                            return "update-failed";
                                                        }

                                                        installUndoOemConfigPrepareScript();

                                                        if (showRunOemConfigPrepareCheckbox && runOemConfigPrepareCheckbox.isSelected()) {
                                                            returnStatus += (runOemConfigPrepare() ? "+oem-config-prepare-success" : "+oem-config-prepare-failed");
                                                        }

                                                        return returnStatus;
                                                    } else {
                                                        return "update-failed";
                                                    }
                                                }

                                                @Override
                                                protected void done() {
                                                    try {
                                                        String returnValue = get();

                                                        displayComputerSpecs(); // Always update display in case "statusNames[2]" worked but "statusNames[12]" failed.
                                                        //TODO: getHistory in background and pass to displayComputerSpecs() instead of relying on displayComputerSpecs() to get it on main thread to update displayed status.

                                                        if (returnValue.startsWith("success")) {
                                                            if (isLinux) {
                                                                if (returnValue.contains("+oem-config-prepare")) {
                                                                    if (returnValue.contains("+oem-config-prepare-success")) {
                                                                        try {
                                                                            Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "/bin/sleep 1; /usr/bin/wmctrl -a oem-config-prepare"});
                                                                        } catch (IOException showOemConfigPrepareDialogException) {
                                                                            if (isTestMode) {
                                                                                System.out.println("showOemConfigPrepareDialogException: " + showOemConfigPrepareDialogException);
                                                                            }
                                                                        }
                                                                    } else {
                                                                        loadingWindow.closeWindow();
                                                                        playAlertSound("error");

                                                                        if (!new File("/usr/sbin/oem-config-prepare").exists()) {
                                                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Install \"oem-config-gtk\" to be able to Run \"oem-config-prepare\"</b><br/><br/><i>To manually install \"oem-config-gtk\", open Terminal and run:</i><br/><pre>sudo apt install oem-config-gtk</pre><br/>After \"oem-config-gtk\" is installed, you can run \"oem-config-prepare\" manually by selecting <b>Prepare for shipping to end user</b> from the <b>system applicatons menu</b>.</html>", "QA Helper  —  Install Prepare for Shipping to End User Error", JOptionPane.ERROR_MESSAGE);
                                                                        } else {
                                                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Run \"oem-config-prepare\"</b><br/><br/>You can run \"oem-config-prepare\" manually by selecting <b>Prepare for shipping to end user</b> from the <b>system applicatons menu</b>.</html>", "QA Helper  —  Run Prepare for Shipping to End User Error", JOptionPane.ERROR_MESSAGE);
                                                                        }
                                                                    }
                                                                }
                                                            } else if (isWindows) {
                                                                // Delete Drivers Cache Model Name file after "statusNames[12]" and re-create it in case any hardware has changed since installation.
                                                                File driversCacheModelNameFile = new File(windowsBuildInfoPath + "Drivers Cache Model Name.txt");
                                                                if (driversCacheModelNameFile.exists()) {
                                                                    driversCacheModelNameFile.delete();
                                                                }

                                                                createWindowsDriversCacheModelNameFile();
                                                            }

                                                            String updatedFreeGeekAdminPasswordNote = "";
                                                            if (returnValue.contains("+password-success")) {
                                                                updatedFreeGeekAdminPasswordNote = "<br/><br/>"
                                                                        + new TwemojiImage("ThumbsUp", qaHelperWindow).toImgTag("left") + " Successfully updated admin password to Free Geek Store password."
                                                                        + "<br/>";
                                                                playAlertSound("success");
                                                            } else if (returnValue.contains("+password-failed")) {
                                                                playAlertSound("error");
                                                                updatedFreeGeekAdminPasswordNote = "<br/><br/>"
                                                                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>Failed to update admin password to Free Geek Store password.</b>"
                                                                        + "<br/>"
                                                                        + new TwemojiImage("Keyboard", qaHelperWindow).toImgTag("left") + " <i>TO UPDATE ADMIN PASSWORD MANUALLY, RUN \"passwd\" IN TERMINAL</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                                                        + "<br/>";
                                                            } else {
                                                                playAlertSound("success");
                                                            }

                                                            loadingWindow.closeWindow();

                                                            ArrayList<String> successfullyUpdatedStatusDialogButtons = new ArrayList<>();

                                                            if (!isWindowsPE || (isWindowsRE && new File("\\Install\\Diagnostic Tools\\Web Browser (PE).exe").exists())) {
                                                                successfullyUpdatedStatusDialogButtons.add("Open Inventory Manager on PCsCRM.com");
                                                            }

                                                            if (isMacOS) {
                                                                if (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists()) {
                                                                    successfullyUpdatedStatusDialogButtons.add("Cleanup After " + statusNames[12]);
                                                                } else if (new File("/Users/fg-demo/Applications/Free Geek Reset.app").exists()) {
                                                                    successfullyUpdatedStatusDialogButtons.add("Reset This Mac");
                                                                }
                                                            }

                                                            boolean didAddCompleteWindowsButton = false;
                                                            if (isWindows && !isWindowsPE && new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
                                                                // Want Inventory Manager to be primary here and Complete Windows secondary.
                                                                successfullyUpdatedStatusDialogButtons.add("Run \"Complete Windows\" Script & Shut Down");
                                                                didAddCompleteWindowsButton = true;
                                                            }

                                                            successfullyUpdatedStatusDialogButtons.add(((isLinuxUbiquityMode || isWindowsPE) ? "Install OS" : "Quit"));

                                                            if (!didAddCompleteWindowsButton) {
                                                                successfullyUpdatedStatusDialogButtons.addAll(Arrays.asList("Shut Down", "Reboot")); // Don't want separate Shut Down button when Complete Windows button is shown.
                                                            }
                                                            successfullyUpdatedStatusDialogButtons.add("Keep Using QA Helper");

                                                            int successfullyUpdatedStatusDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, "<html><b>Successfully Updated Status for PID \"" + pid + "\" to <u>" + statusNames[12] + "<u></b>" + updatedFreeGeekAdminPasswordNote + "<br/><br/><i>What would you like to do next?</i></html>", "QA Helper  —  Status Updated", JOptionPane.DEFAULT_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("CheckMarkButton", qaHelperWindow).toImageIcon(32), successfullyUpdatedStatusDialogButtons.toArray(), successfullyUpdatedStatusDialogButtons.get(0));

                                                            String successfullyUpdatedStatusDialogResponseString = "Keep Using QA Helper";
                                                            if (successfullyUpdatedStatusDialogResponse > -1) {
                                                                successfullyUpdatedStatusDialogResponseString = successfullyUpdatedStatusDialogButtons.get(successfullyUpdatedStatusDialogResponse);
                                                            }

                                                            if (successfullyUpdatedStatusDialogResponseString.equals("Open Inventory Manager on PCsCRM.com")) {
                                                                loadingWindow.setLoadingTextAndDisplay("QA Helper is Opening Inventory Manager on PCsCRM.com", "Working", "Memo");

                                                                (new SwingWorker<String, Void>() {
                                                                    @Override
                                                                    protected String doInBackground() throws Exception {

                                                                        boolean enoughRAMforInventoryManager = true;

                                                                        if (isLinuxBootedToRAM) {
                                                                            // There may not be enough free RAM for Firefox when booted "toram"
                                                                            try {
                                                                                enoughRAMforInventoryManager = (2000000000 <= Long.parseLong(new CommandReader("/usr/bin/free -b | /usr/bin/awk '($1 == \"Mem:\") { print $4; exit }'").getFirstOutputLine()));
                                                                            } catch (NumberFormatException getFreeMemoryException) {
                                                                                if (isTestMode) {
                                                                                    System.out.println("getFreeMemoryException: " + getFreeMemoryException);
                                                                                }
                                                                            }
                                                                        }

                                                                        String returnStatus = (enoughRAMforInventoryManager ? "enoughRAMforInventoryManager" : "");

                                                                        if (enoughRAMforInventoryManager) {
                                                                            String pcsCrmInventoryManagerURL = "https://" + (isTestMode ? "test." : "") + "pcscrm.com/inventory/editInventoryIDs";
                                                                            String hiddenPCsCRMloginInputs = "";

                                                                            for (int i = 0; i < 5; i++) {
                                                                                hiddenPCsCRMloginInputs = String.join("\n", new CommandReader((isWindows ? new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12, [Net.SecurityProtocolType]::Ssl3; (Invoke-WebRequest " + pcsCrmInventoryManagerURL + " -UseBasicParsing -TimeoutSec 5).Content"} : new String[]{"/usr/bin/curl", "-m", "5", "-sfL", pcsCrmInventoryManagerURL})).getOutputLinesContaining("<input type=\"hidden\"")); // TODO: Do in Java. Eventually.

                                                                                if (!hiddenPCsCRMloginInputs.isEmpty()) {
                                                                                    if (hiddenPCsCRMloginInputs.contains("__EVENTTARGET")) {
                                                                                        // Using Invoke-WebRequest includes an empty __EVENTTARGET which overrides our wanted __EVENTTARGET
                                                                                        hiddenPCsCRMloginInputs = hiddenPCsCRMloginInputs.replace("<input type=\"hidden\" name=\"__EVENTTARGET\" id=\"__EVENTTARGET\" value=\"\" />", "");
                                                                                    }

                                                                                    break;
                                                                                }
                                                                            }

                                                                            if (!hiddenPCsCRMloginInputs.isEmpty()) {
                                                                                try {
                                                                                    File pcsCrmInventoryManagerTempFile = File.createTempFile("qa_helper-pcscrm_inventory_manager", ".html");
                                                                                    pcsCrmInventoryManagerTempFile.deleteOnExit();

                                                                                    try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(pcsCrmInventoryManagerTempFile))) {
                                                                                        bufferedWriter.write("<!DOCTYPE html>"
                                                                                                + "<html>"
                                                                                                + "<head><title>New Login Page</title></head>"
                                                                                                + "<body onload=\"javascript:document.getElementById('pcscrmLogInToInventoryManager').submit();\">"
                                                                                                + "<form id=\"pcscrmLogInToInventoryManager\" action=\"https://" + (isTestMode ? "test." : "") + "pcscrm.com/login.aspx?ReturnUrl=%2finventory%2feditInventoryIDs\" method=\"post\">"
                                                                                                + "<input type=\"hidden\" name=\"__EVENTTARGET\" id=\"__EVENTTARGET\" value=\"lbLogin\">"
                                                                                                + hiddenPCsCRMloginInputs
                                                                                                + "<input name=\"txtUsername\" type=\"hidden\" id=\"txtUsername\" value=\"" + username + "\" />"
                                                                                                + "<input name=\"txtPassword\" type=\"hidden\" maxlength=\"15\" id=\"txtPassword\" value=\"" + new String(pswPassword.getPassword()) + "\" />"
                                                                                                + "</form>"
                                                                                                + "</body>"
                                                                                                + "</html>");
                                                                                    } catch (Exception writePcsCrmInventoryManagerTempFileException) {
                                                                                        if (isTestMode) {
                                                                                            System.out.println("writePcsCrmInventoryManagerTempFileException: " + writePcsCrmInventoryManagerTempFileException);
                                                                                        }
                                                                                    }

                                                                                    pcsCrmInventoryManagerURL = pcsCrmInventoryManagerTempFile.toURI().toString();
                                                                                    returnStatus += "+didAutoLoginToInventoryManager";
                                                                                } catch (IOException createPcsCrmInventoryManagerTempFileException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("createPcsCrmInventoryManagerTempFileException: " + createPcsCrmInventoryManagerTempFileException);
                                                                                    }
                                                                                }
                                                                            }

                                                                            boolean xclipWasInstalled = false;
                                                                            boolean xclipIsInstalled = false;

                                                                            if (isLinux) {
                                                                                while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                                                                    TimeUnit.SECONDS.sleep(2);
                                                                                }

                                                                                xclipWasInstalled = !new CommandReader("/usr/bin/xclip -version 2>&1").getFirstOutputLineContaining(".").isEmpty();
                                                                                xclipIsInstalled = xclipWasInstalled;

                                                                                if (!xclipIsInstalled) {
                                                                                    try {
                                                                                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get install --no-install-recommends -qq xclip"}).waitFor();
                                                                                        xclipIsInstalled = !new CommandReader("/usr/bin/xclip -version 2>&1").getFirstOutputLineContaining(".").isEmpty();
                                                                                    } catch (IOException | InterruptedException installXclipException) {
                                                                                        if (isTestMode) {
                                                                                            System.out.println("installXclipException: " + installXclipException);
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }

                                                                            try {
                                                                                if (xclipIsInstalled) {
                                                                                    // Java Clipboard get cleared when app quits on Linux. So use xclip instead.
                                                                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' '" + pid.replace("'", "'\\''") + "' | /usr/bin/xclip -sel clip"}).waitFor();
                                                                                } else {
                                                                                    Toolkit.getDefaultToolkit().getSystemClipboard().setContents(new StringSelection(pid + "\n"), null);
                                                                                }

                                                                                returnStatus += "+didSetPIDtoClipboard";
                                                                            } catch (IllegalStateException | HeadlessException | IOException | InterruptedException setClipboardException) {
                                                                                if (isTestMode) {
                                                                                    System.out.println("setClipboardException: " + setClipboardException);
                                                                                }
                                                                            }

                                                                            if (!xclipWasInstalled && xclipIsInstalled) {
                                                                                try {
                                                                                    Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk /usr/bin/apt-get purge --auto-remove -qq xclip"}).waitFor();
                                                                                } catch (IOException | InterruptedException uninstallXclipException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("uninstallXclipException: " + uninstallXclipException);
                                                                                    }
                                                                                }
                                                                            }

                                                                            if (isLinux) {
                                                                                boolean didLaunchChrome = false;
                                                                                if (new File("/usr/bin/google-chrome-stable").exists() && !isLinuxUbiquityMode) { // Do not try to launch Chrome and only use Firefox when in Ubiquity mode (even if it has been pre-installed) since Firefox is simpler to launch without the app showing prompts.
                                                                                    try {
                                                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/google-chrome-stable", "--password-store=basic", "--start-maximized", "--incognito", pcsCrmInventoryManagerURL});
                                                                                        didLaunchChrome = true;
                                                                                    } catch (IOException chromeException) {
                                                                                        if (isTestMode) {
                                                                                            System.out.println("chromeException: " + chromeException);
                                                                                        }
                                                                                    }
                                                                                }

                                                                                if (!didLaunchChrome) {
                                                                                    try {
                                                                                        if (isLinuxUbiquityMode) { // Sometimes Firefox hangs/freezes in Linux pre-install enviroment, so quit all Firefox instances before launching a new one.
                                                                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/pkill", "firefox"});
                                                                                        }

                                                                                        // Run Firefox as sudo in pre-install environment to fix an issue launching Firefox
                                                                                        Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", (isLinuxUbiquityMode ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "") + "/usr/bin/firefox -private " + pcsCrmInventoryManagerURL});
                                                                                    } catch (IOException firefoxException) {
                                                                                        if (isTestMode) {
                                                                                            System.out.println("firefoxException: " + firefoxException);
                                                                                        }

                                                                                        try {
                                                                                            Runtime.getRuntime().exec(new String[]{"/usr/bin/xdg-open", pcsCrmInventoryManagerURL});
                                                                                        } catch (IOException xdgOpenException) {
                                                                                            if (isTestMode) {
                                                                                                System.out.println("xdgOpenException: " + xdgOpenException);
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                }
                                                                            } else if (isWindowsRE && new File("\\Install\\Diagnostic Tools\\Web Browser (PE).exe").exists()) {
                                                                                if (new File("\\Windows\\System32\\links.xml").exists()) {
                                                                                    new File("\\Windows\\System32\\links.xml").delete();
                                                                                }

                                                                                File webBrowserPElinksFile = new File("\\Windows\\System32\\", "links.xml");

                                                                                try (BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(webBrowserPElinksFile))) {
                                                                                    bufferedWriter.write("<Items version=\"1.0\" application=\"Web Browser (PE)\">\n"
                                                                                            + "  <Homepage>\n"
                                                                                            + "    <Home>" + pcsCrmInventoryManagerURL.replace("file:/", "file:///") + "</Home>\n"
                                                                                            + "  </Homepage>\n"
                                                                                            + "  <Favorites />\n"
                                                                                            + "</Items>");
                                                                                } catch (Exception writeWebBrowserPElinksFileException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("writeWebBrowserPElinksFileException: " + writeWebBrowserPElinksFileException);
                                                                                    }

                                                                                    playAlertSound("beep");
                                                                                }

                                                                                try {
                                                                                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \"Web Browser\" \"\\Install\\Diagnostic Tools\\Web Browser (PE).exe\""}).waitFor();
                                                                                } catch (IOException | InterruptedException openWebBrowserPEexception) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("openWebBrowserPEexception: " + openWebBrowserPEexception);
                                                                                    }
                                                                                }
                                                                            } else {
                                                                                try {
                                                                                    Desktop.getDesktop().browse(new URI(pcsCrmInventoryManagerURL));
                                                                                } catch (IOException | URISyntaxException openPcsCrmInventoryManagerException) {
                                                                                    if (isTestMode) {
                                                                                        System.out.println("openPcsCrmInventoryManagerException: " + openPcsCrmInventoryManagerException);
                                                                                    }
                                                                                }
                                                                            }

                                                                            TimeUnit.SECONDS.sleep(2);
                                                                        }

                                                                        return returnStatus;
                                                                    }

                                                                    @Override
                                                                    protected void done() {
                                                                        try {
                                                                            String returnValue = get();

                                                                            loadingWindow.closeWindow();

                                                                            if (isWindowsPE) {
                                                                                // Do not focus window or present next prompt on WinRE since QA Helper should just be minimized to allow "Web Browser (PE)" to be frontmost instead.
                                                                                setState(Frame.ICONIFIED);
                                                                            } else {
                                                                                focusWindow();

                                                                                ArrayList<String> openedInventoryManagerDialogButtons = new ArrayList<>();

                                                                                if (returnValue.contains("enoughRAMforInventoryManager")) {
                                                                                    openedInventoryManagerDialogButtons.add("Bring Inventory Manager to Front");
                                                                                }

                                                                                if (isMacOS) {
                                                                                    if (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists()) {
                                                                                        openedInventoryManagerDialogButtons.add("Cleanup After " + statusNames[12]);
                                                                                    } else if (new File("/Users/fg-demo/Applications/Free Geek Reset.app").exists()) {
                                                                                        openedInventoryManagerDialogButtons.add("Reset This Mac");
                                                                                    }
                                                                                }

                                                                                boolean didAddCompleteWindowsButton = false;
                                                                                if (isWindows && new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
                                                                                    // Want Inventory Manager to be primary here and Complete Windows secondary.
                                                                                    openedInventoryManagerDialogButtons.add("Run \"Complete Windows\" Script & Shut Down");
                                                                                    didAddCompleteWindowsButton = true;
                                                                                }

                                                                                openedInventoryManagerDialogButtons.add(((isLinuxUbiquityMode || isWindowsPE) ? "Install OS" : "Quit"));

                                                                                if (!didAddCompleteWindowsButton) {
                                                                                    openedInventoryManagerDialogButtons.addAll(Arrays.asList("Shut Down", "Reboot")); // Don't want separate Shut Down button when Complete Windows button is shown.
                                                                                }
                                                                                openedInventoryManagerDialogButtons.add("Keep Using QA Helper");

                                                                                playAlertSound((returnValue.contains("enoughRAMforInventoryManager") && returnValue.contains("didAutoLoginToInventoryManager") && returnValue.contains("didSetPIDtoClipboard") ? "success" : "beep"));

                                                                                String openedInventoryManagerDialogMessage = "<html>"
                                                                                        + (returnValue.contains("enoughRAMforInventoryManager")
                                                                                        ? "<b>Opened " + (returnValue.contains("didAutoLoginToInventoryManager") ? "and Logged In to " : "") + "the Inventory Manager on PCsCRM.com</b>"
                                                                                        + (returnValue.contains("didAutoLoginToInventoryManager") ? "" : "<br/><br/>"
                                                                                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>Unable to automatically log in to the Inventory Manager on PCsCRM.com.</b>"
                                                                                        + "<br/>"
                                                                                        + new TwemojiImage("Keyboard", qaHelperWindow).toImgTag("left") + " <i>YOU WILL NEED TO LOG IN MANUALLY</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right"))
                                                                                        + (returnValue.contains("didSetPIDtoClipboard")
                                                                                        ? "<br/><br/>"
                                                                                        + new TwemojiImage("Clipboard", qaHelperWindow).toImgTag("left") + " The PID \"" + pid + "\" has been copied to the clipboard so you can paste it into the \"Computer ID\" text area."
                                                                                        : "<br/><br/>"
                                                                                        + new TwemojiImage("Warning", qaHelperWindow).toImgTag("left") + " <b style='color: " + warningColorHTML + "'>Unable to copy the PID \"" + pid + "\" to the clipboard.</b>"
                                                                                        + "<br/>"
                                                                                        + new TwemojiImage("Keyboard", qaHelperWindow).toImgTag("left") + " <i>YOU WILL NEED TO TYPE IT IN MANUALLY TO THE \"Computer ID\" TEXT AREA</i> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right"))
                                                                                        + "<br/><br/>"
                                                                                        + new TwemojiImage("Keyboard", qaHelperWindow).toImgTag("left") + " <b style='color: " + attentionColorHTML + "'>NOW, YOU MUST MANUALLY SET THE PRODUCT TO THE CORRECT VALUE FOR PID \"" + pid + "\" IN THE INVENTORY MANAGER</b> " + new TwemojiImage("DoubleExclamationMark", qaHelperWindow).toImgTag("right")
                                                                                        : "<b>Not Enough Free RAM to Open the Inventory Manager on PCsCRM.com in Firefox</b><br/><br/><i>You can open the Inventory Manager on PCsCRM.com on another computer or after you've installed the OS.</i>") + "<br/><br/><br/><i>What would you like to do next?</i>"
                                                                                        + "</html>";

                                                                                while (true) {
                                                                                    int openedInventoryManagerDialogResponse = JOptionPane.showOptionDialog(qaHelperWindow, openedInventoryManagerDialogMessage, "QA Helper  —  " + (returnValue.contains("enoughRAMforInventoryManager") ? "Opened" : "Cannot Open") + " Inventory Manager", JOptionPane.DEFAULT_OPTION, ((returnValue.contains("enoughRAMforInventoryManager") && returnValue.contains("didAutoLoginToInventoryManager") && returnValue.contains("didSetPIDtoClipboard")) ? JOptionPane.INFORMATION_MESSAGE : JOptionPane.WARNING_MESSAGE), new TwemojiImage("Memo", qaHelperWindow).toImageIcon(32), openedInventoryManagerDialogButtons.toArray(), openedInventoryManagerDialogButtons.get(0));

                                                                                    String openedInventoryManagerDialogResponseString = "Keep Using QA Helper";
                                                                                    if (openedInventoryManagerDialogResponse > -1) {
                                                                                        openedInventoryManagerDialogResponseString = openedInventoryManagerDialogButtons.get(openedInventoryManagerDialogResponse);
                                                                                    }

                                                                                    if (openedInventoryManagerDialogResponseString.equals("Cleanup After " + statusNames[12]) || openedInventoryManagerDialogResponseString.equals("Reset This Mac")) {
                                                                                        if (isMacOS) {
                                                                                            try {
                                                                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", "/Users/fg-demo/Applications/" + (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists() ? "Cleanup After " + statusNames[12] : "Free Geek Reset") + ".app"});
                                                                                            } catch (IOException launchCleanupOrResetAppError) {
                                                                                                System.out.println("launchCleanupOrResetAppError: " + launchCleanupOrResetAppError);
                                                                                            }
                                                                                        }

                                                                                        System.exit(0);
                                                                                    } else if (openedInventoryManagerDialogResponseString.equals("Install OS") || openedInventoryManagerDialogResponseString.equals("Quit")) {
                                                                                        System.exit(0);
                                                                                    } else if (openedInventoryManagerDialogResponseString.equals("Run \"Complete Windows\" Script & Shut Down")) {
                                                                                        if (isWindows && new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
                                                                                            try {
                                                                                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -WindowStyle Maximized -ExecutionPolicy Unrestricted -File \"\\Install\\Scripts\\Complete Windows.ps1\""});
                                                                                                TimeUnit.SECONDS.sleep(1);
                                                                                                writeToHelperLogFile("Ran Complete Windows");
                                                                                                logDebugSpecs("Ran Complete Windows");
                                                                                                TimeUnit.SECONDS.sleep(1);
                                                                                                System.exit(0);
                                                                                            } catch (IOException | InterruptedException runCompleteWindowsException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("runCompleteWindowsException: " + runCompleteWindowsException);
                                                                                                }
                                                                                            }
                                                                                        } else {
                                                                                            playAlertSound("beep");
                                                                                        }
                                                                                    } else if (openedInventoryManagerDialogResponseString.equals("Shut Down")) {
                                                                                        if (isLinux) {
                                                                                            try {
                                                                                                while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                                                                                    TimeUnit.SECONDS.sleep(2);
                                                                                                }

                                                                                                Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "now"}).waitFor();
                                                                                                TimeUnit.SECONDS.sleep(2);
                                                                                            } catch (IOException | InterruptedException shutDownNowException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("shutDownNowException: " + shutDownNowException);
                                                                                                }
                                                                                            }
                                                                                        } else if (isWindows) {
                                                                                            try {
                                                                                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Computer"}).waitFor();
                                                                                                TimeUnit.SECONDS.sleep(2);
                                                                                            } catch (IOException | InterruptedException stopComputerException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("stopComputerException: " + stopComputerException);
                                                                                                }
                                                                                            }
                                                                                        } else if (isMacOS) {
                                                                                            try {
                                                                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to shut down with state saving preference"}).waitFor();
                                                                                                TimeUnit.SECONDS.sleep(2);
                                                                                            } catch (IOException | InterruptedException osascriptShutDownException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("osascriptShutDownException: " + osascriptShutDownException);
                                                                                                }
                                                                                            }
                                                                                        }

                                                                                        System.exit(0);
                                                                                    } else if (openedInventoryManagerDialogResponseString.equals("Reboot")) {
                                                                                        if (isLinux) {
                                                                                            try {
                                                                                                while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                                                                                    TimeUnit.SECONDS.sleep(2);
                                                                                                }

                                                                                                Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "-r", "now"}).waitFor();
                                                                                                TimeUnit.SECONDS.sleep(2);
                                                                                            } catch (IOException | InterruptedException rebootNowException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("rebootNowException: " + rebootNowException);
                                                                                                }
                                                                                            }
                                                                                        } else if (isWindows) {
                                                                                            try {
                                                                                                Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Restart-Computer"}).waitFor();
                                                                                                TimeUnit.SECONDS.sleep(2);
                                                                                            } catch (IOException | InterruptedException restartComputerException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("restartComputerException: " + restartComputerException);
                                                                                                }
                                                                                            }
                                                                                        } else if (isMacOS) {
                                                                                            try {
                                                                                                Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to restart with state saving preference"}).waitFor();
                                                                                                TimeUnit.SECONDS.sleep(2);
                                                                                            } catch (IOException | InterruptedException osascriptRestartException) {
                                                                                                if (isTestMode) {
                                                                                                    System.out.println("osascriptRestartException: " + osascriptRestartException);
                                                                                                }
                                                                                            }
                                                                                        }

                                                                                        System.exit(0);
                                                                                    }

                                                                                    if (openedInventoryManagerDialogResponseString.equals("Bring Inventory Manager to Front")) {
                                                                                        try {
                                                                                            Runtime.getRuntime().exec((isWindows
                                                                                                    // Based On: https://stackoverflow.com/a/58548853
                                                                                                    // This new method is much better than the previous AppActivate method (which seems to not work with Legacy Edge), but still also do the AppActive method since it seems to maybe not work as well on Windows 11.
                                                                                                    ? new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "$focusWindowFunctionTypes = Add-Type -PassThru -Name FocusWindow -MemberDefinition @'\n"
                                                                                                        + "[DllImport(\\\"user32.dll\\\")] public static extern bool SetForegroundWindow(IntPtr hWnd);\n"
                                                                                                        + "[DllImport(\\\"user32.dll\\\")] public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);\n"
                                                                                                        + "[DllImport(\\\"user32.dll\\\")] public static extern bool IsIconic(IntPtr hWnd);\n"
                                                                                                        + "'@\n"
                                                                                                        + "Start-Sleep 1\n"
                                                                                                        + "$browserHandle = (Get-Process | Where-Object { ($_.MainWindowTitle -like '*New Login Page*') -or ($_.MainWindowTitle -like '*Edit InventoryIDs*') }).MainWindowHandle\n"
                                                                                                        + "if ($browserHandle) {\n"
                                                                                                        + "$browserHandle = $browserHandle[0]\n" // In case there are multiple matching windows open   
                                                                                                        + "$focusWindowFunctionTypes::SetForegroundWindow($browserHandle) | Out-Null\n"
                                                                                                        + "if ($focusWindowFunctionTypes::IsIconic($browserHandle)) {\n"
                                                                                                        + "$focusWindowFunctionTypes::ShowWindow($browserHandle, 9) | Out-Null\n"
                                                                                                        + "}\n"
                                                                                                        + "}\n"
                                                                                                        + "$WshellScript = (New-Object -ComObject Wscript.Shell); if (-not $WshellScript.AppActivate('New Login Page')) { $WshellScript.AppActivate('Edit InventoryIDs') }\"}"
                                                                                                    }
                                                                                                    : new String[]{"/bin/sh", "-c", "/bin/sleep 1; " + (isLinux ? "/usr/bin/wmctrl -a 'New Login Page' || /usr/bin/wmctrl -a 'Edit InventoryIDs' || /usr/bin/wmctrl -a 'Firefox' || /usr/bin/xdg-open 'https://" + (isTestMode ? "test." : "") + "pcscrm.com/inventory/editInventoryIDs'" : "/usr/bin/open -b com.apple.Safari")}));

                                                                                            TimeUnit.MILLISECONDS.sleep(500);
                                                                                        } catch (IOException bringInventoryManagerToFrontException) {
                                                                                            if (isTestMode) {
                                                                                                System.out.println("bringInventoryManagerToFrontException: " + bringInventoryManagerToFrontException);
                                                                                            }
                                                                                        }
                                                                                    } else {
                                                                                        break;
                                                                                    }
                                                                                }
                                                                            }
                                                                        } catch (HeadlessException | InterruptedException | ExecutionException pcsCrmInventoryManagerException) {
                                                                            if (isTestMode) {
                                                                                System.out.println("pcsCrmInventoryManagerException: " + pcsCrmInventoryManagerException);
                                                                            }
                                                                        }

                                                                        setActionsEnabled(true, !isWindowsPE);
                                                                    }
                                                                }).execute();
                                                            } else if (successfullyUpdatedStatusDialogResponseString.equals("Cleanup After " + statusNames[12]) || successfullyUpdatedStatusDialogResponseString.equals("Reset This Mac")) {
                                                                if (isMacOS) {
                                                                    try {
                                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", "/Users/fg-demo/Applications/" + (new File("/Users/fg-demo/Applications/Cleanup After " + statusNames[12] + ".app").exists() ? "Cleanup After " + statusNames[12] : "Free Geek Reset") + ".app"});
                                                                    } catch (IOException launchCleanupOrResetAppError) {
                                                                        System.out.println("launchCleanupOrResetAppError: " + launchCleanupOrResetAppError);
                                                                    }
                                                                }

                                                                System.exit(0);
                                                            } else if (successfullyUpdatedStatusDialogResponseString.equals("Install OS") || successfullyUpdatedStatusDialogResponseString.equals("Quit")) {
                                                                System.exit(0);
                                                            } else if (successfullyUpdatedStatusDialogResponseString.equals("Run \"Complete Windows\" Script & Shut Down")) {
                                                                if (isWindows && new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
                                                                    try {
                                                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -WindowStyle Maximized -ExecutionPolicy Unrestricted -File \"\\Install\\Scripts\\Complete Windows.ps1\""});
                                                                        TimeUnit.SECONDS.sleep(1);
                                                                        writeToHelperLogFile("Ran Complete Windows");
                                                                        logDebugSpecs("Ran Complete Windows");
                                                                        TimeUnit.SECONDS.sleep(1);
                                                                        System.exit(0);
                                                                    } catch (IOException | InterruptedException runCompleteWindowsException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("runCompleteWindowsException: " + runCompleteWindowsException);
                                                                        }
                                                                    }

                                                                } else {
                                                                    playAlertSound("beep");
                                                                }
                                                            } else if (successfullyUpdatedStatusDialogResponseString.equals("Shut Down")) {
                                                                if (isLinux) {
                                                                    try {
                                                                        while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                                                            TimeUnit.SECONDS.sleep(2);
                                                                        }

                                                                        Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "now"}).waitFor();
                                                                        TimeUnit.SECONDS.sleep(2);
                                                                    } catch (IOException | InterruptedException shutDownNowException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("shutDownNowException: " + shutDownNowException);
                                                                        }
                                                                    }
                                                                } else if (isWindows) {
                                                                    try {
                                                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Stop-Computer"}).waitFor();
                                                                        TimeUnit.SECONDS.sleep(2);
                                                                    } catch (IOException | InterruptedException stopComputerException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("stopComputerException: " + stopComputerException);
                                                                        }
                                                                    }
                                                                } else if (isMacOS) {
                                                                    try {
                                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to shut down with state saving preference"}).waitFor();
                                                                        TimeUnit.SECONDS.sleep(2);
                                                                    } catch (IOException | InterruptedException osascriptShutDownException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("osascriptShutDownException: " + osascriptShutDownException);
                                                                        }
                                                                    }
                                                                }

                                                                System.exit(0);
                                                            } else if (successfullyUpdatedStatusDialogResponseString.equals("Reboot")) {
                                                                if (isLinux) {
                                                                    try {
                                                                        while (!new CommandReader(new String[]{"/usr/bin/pgrep", "-fn", "/auto-scripts/.*\\+(user|root)\\.sh$"}).getFirstOutputLine().isEmpty()) {
                                                                            TimeUnit.SECONDS.sleep(2);
                                                                        }

                                                                        Runtime.getRuntime().exec(new String[]{"/sbin/shutdown", "-r", "now"}).waitFor();
                                                                        TimeUnit.SECONDS.sleep(2);
                                                                    } catch (IOException | InterruptedException rebootNowException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("rebootNowException: " + rebootNowException);
                                                                        }
                                                                    }
                                                                } else if (isWindows) {
                                                                    try {
                                                                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoLogo", "-NoProfile", "-NonInteractive", "-Command", "Restart-Computer"}).waitFor();
                                                                        TimeUnit.SECONDS.sleep(2);
                                                                    } catch (IOException | InterruptedException restartComputerException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("restartComputerException: " + restartComputerException);
                                                                        }
                                                                    }
                                                                } else if (isMacOS) {
                                                                    try {
                                                                        Runtime.getRuntime().exec(new String[]{"/usr/bin/osascript", "-e", "tell application id \"com.apple.systemevents\" to restart with state saving preference"}).waitFor();
                                                                        TimeUnit.SECONDS.sleep(2);
                                                                    } catch (IOException | InterruptedException osascriptRestartException) {
                                                                        if (isTestMode) {
                                                                            System.out.println("osascriptRestartException: " + osascriptRestartException);
                                                                        }
                                                                    }
                                                                }

                                                                System.exit(0);
                                                            }
                                                        } else if (returnValue.equals("update-failed")) {
                                                            loadingWindow.closeWindow();
                                                            playAlertSound("error");
                                                            JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>Failed to Log Specs and/or Update Status to <u>" + statusNames[12] + "</u></b></html>", "QA Helper  —  Update Status Error", JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    } catch (HeadlessException | InterruptedException | ExecutionException setStatusToQACompleteException) {
                                                        if (isTestMode) {
                                                            System.out.println("setStatusToQACompleteException: " + setStatusToQACompleteException);
                                                        }

                                                        sendErrorEmail("setStatusToQACompleteException: " + setStatusToQACompleteException);

                                                        playAlertSound("error");
                                                    }

                                                    if (!loadingWindow.getLoadingText().contains("Inventory Manager")) {
                                                        loadingWindow.closeWindow();
                                                        setActionsEnabled(true);
                                                    }

                                                    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                                                    loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                                                }
                                            }).execute();
                                        } else {
                                            loadingWindow.closeWindow();
                                            playAlertSound("error");

                                            if (isWindows) {
                                                if (dpkGmrlStickerConfirmed) {
                                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>This Computer Is Not Ready to Be Marked As <u>" + statusNames[12] + "</u></b><br/><br/><i>To be able to <u>" + statusNames[12] + "</u> this computer, you must correct the Windows Activation issues.</i></html>", "QA Helper  —  Not Ready for " + statusNames[12], JOptionPane.ERROR_MESSAGE, new TwemojiImage("NoEntry", qaHelperWindow).toImageIcon(32));
                                                    btnCheckWindowsActivationActionPerformed(new java.awt.event.ActionEvent(btnCheckWindowsActivation, java.awt.event.ActionEvent.ACTION_PERFORMED, statusNames[12] + " Activation Issue")); // Do not pass "null" evt since that indicates justSetProductKey.
                                                } else {
                                                    JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>This Computer Is Not Ready to Be Marked As <u>" + statusNames[12] + "</u></b><br/><br/><i>To be able to <u>" + statusNames[12] + "</u> this computer, you must confirm the \"Genuine Microsoft Refurbisher Label\" (GMRL) sticker has been affixed to this computer since a DPK has been applied.</i></html>", "QA Helper  —  Not Ready for " + statusNames[12], JOptionPane.ERROR_MESSAGE, new TwemojiImage("NoEntry", qaHelperWindow).toImageIcon(32));
                                                }
                                            } else if (isMacOS) {
                                                JOptionPane.showMessageDialog(qaHelperWindow, "<html><b>This Mac Is Not Ready to Be Marked As <u>" + statusNames[12] + "</u></b><br/><br/><i>To be able to <u>" + statusNames[12] + "</u> this Mac, <u>Free Geek Setup</u> must finish running.</i></html>", "QA Helper  —  Not Ready for " + statusNames[12], JOptionPane.ERROR_MESSAGE, new TwemojiImage("NoEntry", qaHelperWindow).toImageIcon(32));

                                                try {
                                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/open", "-na", "/Users/fg-demo/Applications/Free Geek Setup.app"});
                                                } catch (IOException launchFreeGeekSetupError) {
                                                    System.out.println("launchFreeGeekSetupError: " + launchFreeGeekSetupError);
                                                }
                                            }
                                        }
                                    } catch (HeadlessException | InterruptedException | ExecutionException confirmReadyForQACompleteException) {
                                        if (isTestMode) {
                                            System.out.println("confirmReadyForQACompleteException: " + confirmReadyForQACompleteException);
                                        }

                                        playAlertSound("error");
                                    }

                                    if (!qaCompleteAllowed || !dpkGmrlStickerConfirmed) {
                                        if (!loadingWindow.getLoadingText().contains("Checking Windows Activation")) {
                                            loadingWindow.closeWindow();
                                            setActionsEnabled(true);
                                        }

                                        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                                        loadingWindow.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
                                    }
                                }
                            }).execute();
                        } else {
                            setActionsEnabled(true);
                        }
                    } else {
                        System.exit(0);
                    }
                } else {
                    playAlertSound("beep");
                    setActionsEnabled(true);
                }
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_btnDoneTestingActionPerformed

    private void menForceShowScreenKeyboardAndMouseTestsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menForceShowScreenKeyboardAndMouseTestsActionPerformed
        if (actionsEnabled && isLoggedIn && !forceShowScreenKeyboardAndMouseTests) {
            forceShowScreenKeyboardAndMouseTests = true;

            displayComputerSpecs();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menForceShowScreenKeyboardAndMouseTestsActionPerformed

    private void menCopySpecValueActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menCopySpecValueActionPerformed
        JMenuItem clickedMenuItem = (JMenuItem) evt.getSource();
        JPopupMenu parentPopupMenu = (JPopupMenu) clickedMenuItem.getAccessibleContext().getAccessibleParent();
        JLabel clickedLabel = (JLabel) parentPopupMenu.getInvoker();

        if (clickedLabel != null) {
            String thisToolTipText = clickedLabel.getToolTipText();

            if (thisToolTipText != null) {
                if (thisToolTipText.contains("<br/>")) {
                    thisToolTipText = thisToolTipText.split("<br/>")[1];
                }

                Toolkit.getDefaultToolkit().getSystemClipboard().setContents(new StringSelection(thisToolTipText), null);
                playAlertSound("success");
            } else {
                playAlertSound("error");
            }
        } else {
            playAlertSound("error");
        }
    }//GEN-LAST:event_menCopySpecValueActionPerformed

    private void menSearchSpecValueActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menSearchSpecValueActionPerformed
        JMenuItem clickedMenuItem = (JMenuItem) evt.getSource();
        JPopupMenu parentPopupMenu = (JPopupMenu) clickedMenuItem.getAccessibleContext().getAccessibleParent();
        JLabel clickedLabel = (JLabel) parentPopupMenu.getInvoker();

        if (clickedLabel != null) {
            String thisToolTipText = clickedLabel.getToolTipText();

            if (thisToolTipText != null) {
                String thisSpecValue = thisToolTipText;
                boolean isSerialField = false;

                if (thisToolTipText.contains("<br/>")) {
                    String[] thisToolTipTextParts = thisToolTipText.split("<br/>");
                    thisSpecValue = thisToolTipTextParts[1];
                    if (thisToolTipTextParts[0].equals("<html><b>Serial:</b>")) {
                        isSerialField = true;
                    }
                }

                try {
                    String specSearchURL = ((isMacOS && isSerialField) ? "https://support.apple.com/specs/" : "https://google.com/search?q=") + URLEncoder.encode(thisSpecValue, StandardCharsets.UTF_8.toString());

                    if (isLinux) {
                        boolean didLaunchChrome = false;
                        if (new File("/usr/bin/google-chrome-stable").exists() && !isLinuxUbiquityMode) { // Do not try to launch Chrome and only use Firefox when in Ubiquity mode (even if it has been pre-installed) since Firefox is simpler to launch without the app showing prompts.
                            try {
                                Runtime.getRuntime().exec(new String[]{"/usr/bin/google-chrome-stable", "--password-store=basic", "--start-maximized", "--incognito", specSearchURL});
                                didLaunchChrome = true;
                            } catch (IOException chromeException) {
                                if (isTestMode) {
                                    System.out.println("chromeException: " + chromeException);
                                }
                            }
                        }

                        if (!didLaunchChrome) {
                            try {
                                if (isLinuxUbiquityMode) { // Sometimes Firefox hangs/freezes in Linux pre-install enviroment, so quit all Firefox instances before launching a new one.
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/pkill", "firefox"});
                                }

                                // Run Firefox as sudo in pre-install environment to fix an issue launching Firefox when java is not launched as sudo.
                                Runtime.getRuntime().exec(new String[]{"/bin/sh", "-c", (isLinuxUbiquityMode ? "printf '%s\\n' " + adminPasswordQuotedForShell + " | /usr/bin/sudo -Sk " : "") + "/usr/bin/firefox -private " + specSearchURL});
                            } catch (IOException firefoxException) {
                                if (isTestMode) {
                                    System.out.println("firefoxException: " + firefoxException);
                                }

                                try {
                                    Runtime.getRuntime().exec(new String[]{"/usr/bin/xdg-open", specSearchURL});
                                } catch (IOException xdgOpenException) {
                                    if (isTestMode) {
                                        System.out.println("xdgOpenException: " + xdgOpenException);
                                    }
                                    playAlertSound("error");
                                }
                            }
                        }
                    } else {
                        try {
                            Desktop.getDesktop().browse(new URI(specSearchURL));
                        } catch (IOException | URISyntaxException searchSpecValueException) {
                            if (isTestMode) {
                                System.out.println("searchSpecValueException: " + searchSpecValueException);
                            }
                            playAlertSound("error");
                        }
                    }
                } catch (UnsupportedEncodingException searchSpecValueURLEncodeException) {
                    if (isTestMode) {
                        System.out.println("searchSpecValueURLEncodeException: " + searchSpecValueURLEncodeException);
                    }
                    playAlertSound("error");
                }
            } else {
                playAlertSound("error");
            }
        } else {
            playAlertSound("error");
        }
    }//GEN-LAST:event_menSearchSpecValueActionPerformed

    private void menReRunSetupWindowsScriptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menReRunSetupWindowsScriptActionPerformed
        if (actionsEnabled && isLoggedIn && isWindows && !isWindowsPE && new File("\\Install\\Scripts\\Setup Windows.ps1").exists()) {
            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to re-run the \"Setup Windows\" script?</b></html>", "QA Helper  —  Confirm Re-Run \"Setup Windows\" Script", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE) == JOptionPane.YES_OPTION) {
                try {
                    new File(System.getProperty("user.home") + "\\Desktop\\QA Helper.lnk").delete();

                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -WindowStyle Maximized -ExecutionPolicy Unrestricted -File \"\\Install\\Scripts\\Setup Windows.ps1\""});
                    System.exit(0);
                } catch (IOException reRunSetupWindowsException) {
                    if (isTestMode) {
                        System.out.println("reRunSetupWindowsException: " + reRunSetupWindowsException);
                    }
                }
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menReRunSetupWindowsScriptActionPerformed

    private void menRunCompleteWindowsScriptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menRunCompleteWindowsScriptActionPerformed
        if (actionsEnabled && isLoggedIn && isWindows && !isWindowsPE && new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
            if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to run the \"Complete Windows\" script and shut down this computer?</b></html>", "QA Helper  —  Confirm Run \"Complete Windows\" Script", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("CheckMarkButton", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                try {
                    Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -WindowStyle Maximized -ExecutionPolicy Unrestricted -File \"\\Install\\Scripts\\Complete Windows.ps1\""});
                    TimeUnit.SECONDS.sleep(1);
                    writeToHelperLogFile("Ran Complete Windows (Manual)");
                    logDebugSpecs("Ran Complete Windows (Manual)");
                    TimeUnit.SECONDS.sleep(1);
                    System.exit(0);
                } catch (IOException | InterruptedException runCompleteWindowsException) {
                    if (isTestMode) {
                        System.out.println("runCompleteWindowsException: " + runCompleteWindowsException);
                    }
                }
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menRunCompleteWindowsScriptActionPerformed

    private void menCacheDriversWindowsScriptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menCacheDriversWindowsScriptActionPerformed
        if (actionsEnabled && isLoggedIn && isWindows && !isWindowsPE && new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
            boolean canManuallyCacheDrivers = false;

            if (new File("\\Install\\Scripts\\Complete Windows.ps1").exists()) {
                try {
                    List<String> completeWindowsScriptLine = Files.readAllLines(Paths.get("\\Install\\Scripts\\Complete Windows.ps1"), StandardCharsets.UTF_8);

                    for (String thisCompleteWindowsScriptLine : completeWindowsScriptLine) {
                        if (thisCompleteWindowsScriptLine.startsWith("$onlyCacheDriversMode =")) {
                            canManuallyCacheDrivers = true;
                            break;
                        } else if (thisCompleteWindowsScriptLine.startsWith("$Host.UI.RawUI.WindowTitle =")) {
                            // $onlyCacheDriversMode will be set before setting the script window title, so stop searching if we got that far to not bother searching the whole script.
                            break;
                        }
                    }
                } catch (IOException readCompleteWindowsScriptException) {
                    if (isTestMode) {
                        System.out.println("readCompleteWindowsScriptException: " + readCompleteWindowsScriptException);
                    }
                }
            }

            if (canManuallyCacheDrivers) {
                if (JOptionPane.showConfirmDialog(qaHelperWindow, "<html><b>Are you sure you want to cache the currently installed drivers for this computer model?</b></html>", "QA Helper  —  Confirm Cache Drivers", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new TwemojiImage("Toolbox", qaHelperWindow).toImageIcon(32)) == JOptionPane.YES_OPTION) {
                    try {
                        Runtime.getRuntime().exec(new String[]{"\\Windows\\System32\\cmd.exe", "/c", "START /MAX \\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoLogo -NoProfile -WindowStyle Maximized -ExecutionPolicy Unrestricted -File \"\\Install\\Scripts\\Complete Windows.ps1\" OnlyCacheDrivers"});
                    } catch (IOException runCacheDriversException) {
                        if (isTestMode) {
                            System.out.println("runCacheDriversException: " + runCacheDriversException);
                        }
                    }
                }
            } else {
                playAlertSound("error");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menCacheDriversWindowsScriptActionPerformed

    private void menOpenFileExplorerPEActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menOpenFileExplorerPEActionPerformed
        if (actionsEnabled && isWindows && isWindowsPE && new File("\\Install\\Diagnostic Tools\\File Explorer\\File Explorer (PE).exe").exists()) {
            try {
                Runtime.getRuntime().exec(new String[]{"\\Install\\Diagnostic Tools\\File Explorer\\File Explorer (PE).exe"});

                if (isWindowsPE) {
                    setState(Frame.ICONIFIED);
                }
            } catch (IOException openFileExplorereException) {
                if (isTestMode) {
                    System.out.println("openFileExplorereException: " + openFileExplorereException);
                }
                playAlertSound("error");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menOpenFileExplorerPEActionPerformed

    private void menIncreaseTextSizeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menIncreaseTextSizeActionPerformed
        // Based On: https://github.com/JFormDesigner/FlatLaf/blob/4f2256f713c37310111e831398e648737abe6eed/flatlaf-demo/src/main/java/com/formdev/flatlaf/demo/DemoFrame.java#L210
        if (actionsEnabled || (evt == null)) {
            if (evt != null) {
                setActionsEnabled(false);
            }

            Font defaultFont = UIManager.getFont("defaultFont");
            Font newDefaultFont = defaultFont.deriveFont((float) (defaultFont.getSize() + 1));
            UIManager.put("defaultFont", newDefaultFont);

            themeUpdated = true;

            displayComputerSpecs();

            if (evt != null) {
                (new SwingWorker<Void, String>() {
                    @Override
                    protected Void doInBackground() throws Exception {
                        while (themeUpdated) { // Wait in background until resize is completely finished before re-enabling actions.
                            TimeUnit.MILLISECONDS.sleep(10);
                        }

                        return null;
                    }

                    @Override
                    protected void done() {
                        setActionsEnabled(true);
                    }
                }).execute();
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menIncreaseTextSizeActionPerformed

    private void menDecreaseTextSizeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menDecreaseTextSizeActionPerformed
        // Based On: https://github.com/JFormDesigner/FlatLaf/blob/4f2256f713c37310111e831398e648737abe6eed/flatlaf-demo/src/main/java/com/formdev/flatlaf/demo/DemoFrame.java#L219
        if (actionsEnabled || (evt == null)) {
            Font defaultFont = UIManager.getFont("defaultFont");
            float newFontSize = (float) Math.max(defaultFont.getSize() - 1, 6);
            if (defaultFont.getSize() != newFontSize) {
                if (evt != null) {
                    setActionsEnabled(false);
                }

                Font newDefaultFont = defaultFont.deriveFont(newFontSize);
                UIManager.put("defaultFont", newDefaultFont);

                themeUpdated = true;

                displayComputerSpecs();

                if (evt != null) {
                    (new SwingWorker<Void, String>() {
                        @Override
                        protected Void doInBackground() throws Exception {
                            while (themeUpdated) { // Wait in background until resize is completely finished before re-enabling actions.
                                TimeUnit.MILLISECONDS.sleep(10);
                            }

                            return null;
                        }

                        @Override
                        protected void done() {
                            setActionsEnabled(true);
                        }
                    }).execute();
                }
            } else {
                playAlertSound("beep");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menDecreaseTextSizeActionPerformed

    private void menResetTextSizeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menResetTextSizeActionPerformed
        if (actionsEnabled || (evt == null)) {
            Font defaultFont = UIManager.getFont("defaultFont");
            if ((defaultFont.getSize() != defaultTextSize) || (evt == null)) {
                if (evt != null) {
                    setActionsEnabled(false);
                }

                Font newDefaultFont = defaultFont.deriveFont(defaultTextSize);
                UIManager.put("defaultFont", newDefaultFont);

                themeUpdated = true;

                displayComputerSpecs();

                if (evt != null) {
                    (new SwingWorker<Void, String>() {
                        @Override
                        protected Void doInBackground() throws Exception {
                            while (themeUpdated) { // Wait in background until resize is completely finished before re-enabling actions.
                                TimeUnit.MILLISECONDS.sleep(10);
                            }

                            return null;
                        }

                        @Override
                        protected void done() {
                            setActionsEnabled(true);
                        }
                    }).execute();
                }
            } else {
                playAlertSound("beep");
            }
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menResetTextSizeActionPerformed

    private void menMaxTextSizeForScreenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menMaxTextSizeForScreenActionPerformed
        if (actionsEnabled) {
            setActionsEnabled(false);

            if (windowMoved) {
                // If the window has been manually moved before, re-center the window before resizing and set "movedWindow" to false so that
                // the resize at the end of "displayComputerSpecs" will also re-center the window to be sure it's properly visible at the max screen size.
                windowMoved = false;
                ignoreWindowMovesUntilTime = System.currentTimeMillis() + 1500;
                setLocationRelativeTo(null);
            }

            (new SwingWorker<Void, String>() {
                @Override
                protected Void doInBackground() throws Exception {
                    while (themeUpdated) { // Make sure any previous display updates are fully done before resizing.
                        TimeUnit.MILLISECONDS.sleep(10);
                    }

                    if (contentScrollPane.getHorizontalScrollBar().isVisible() || contentScrollPane.getVerticalScrollBar().isVisible()) {
                        while ((UIManager.getFont("defaultFont").getSize() > 6) && (contentScrollPane.getHorizontalScrollBar().isVisible() || contentScrollPane.getVerticalScrollBar().isVisible())) {
                            themeUpdated = true; // Must set "themeUpdated" to "true" before calling "menDecreaseTextSizeActionPerformed" on the main thread since it might not get updated in this background thread immediately causing the wait loop would never get hit.

                            publish("decrease-text-size"); // The size change must happen on the main thread, but we want to wait for the display update in the background.

                            while (themeUpdated) { // Wait until the display update is completely finished before checking whether or not scrollbars are visible and decreasing again if necessary.
                                TimeUnit.MILLISECONDS.sleep(10);
                            }
                        }
                    } else {
                        while (!contentScrollPane.getHorizontalScrollBar().isVisible() && !contentScrollPane.getVerticalScrollBar().isVisible()) {
                            themeUpdated = true; // Must set "themeUpdated" to "true" before calling "menIncreaseTextSizeActionPerformed" on the main thread since it might not get updated in this background thread immediately causing the wait loop would never get hit.

                            publish("increase-text-size"); // The size change must happen on the main thread, but we want to wait for the display update in the background.

                            while (themeUpdated) { // Wait until the display update is completely finished before checking whether or not scrollbars are visible and increasing again if necessary.
                                TimeUnit.MILLISECONDS.sleep(10);
                            }
                        }

                        publish("decrease-text-size"); // The previous loop increased size until scroll bars were visible, so we need to go one step back down to the max size without scrollbars.

                        while (themeUpdated) { // Wait until the display update is completely finished before checking whether or not scrollbars are visible and increasing again if necessary.
                            TimeUnit.MILLISECONDS.sleep(10);
                        }
                    }

                    return null;
                }

                @Override
                protected void process(java.util.List<String> tasks) {
                    tasks.forEach((thisTask) -> {
                        switch (thisTask) {
                            case "decrease-text-size":
                                menDecreaseTextSizeActionPerformed(null);
                                break;
                            case "increase-text-size":
                                menIncreaseTextSizeActionPerformed(null);
                                break;
                            default:
                                break;
                        }
                    });
                }

                @Override
                protected void done() {
                    setActionsEnabled(true);
                }
            }).execute();
        } else {
            playAlertSound("beep");
        }
    }//GEN-LAST:event_menMaxTextSizeForScreenActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JSeparator bottomSeparator;
    private javax.swing.JButton btnCheckDrivers;
    private javax.swing.JButton btnCheckPID;
    private javax.swing.JButton btnCheckPorts;
    private javax.swing.JButton btnCheckRemoteManagement;
    private javax.swing.JButton btnCheckWindowsActivation;
    private javax.swing.JButton btnCredits;
    private javax.swing.JButton btnDoneTesting;
    private javax.swing.JButton btnDriveHealth;
    private javax.swing.JButton btnEjectDiscDrive;
    private javax.swing.JButton btnForgot;
    private javax.swing.JButton btnLogIn;
    private javax.swing.JButton btnPIDHistory;
    private javax.swing.JButton btnReloadSpecs;
    private javax.swing.JButton btnSaveSpecs;
    private javax.swing.JButton btnSetupBIOS;
    private javax.swing.JButton btnStressCPU;
    private javax.swing.JButton btnSystemInfo;
    private javax.swing.JButton btnSystemUpdates;
    private javax.swing.JButton btnTestAudio;
    private javax.swing.JButton btnTestCamera;
    private javax.swing.JButton btnTestInternet;
    private javax.swing.JButton btnTestKeyboard;
    private javax.swing.JButton btnTestMicrophone;
    private javax.swing.JButton btnTestMode;
    private javax.swing.JButton btnTestMouse;
    private javax.swing.JButton btnTestScreen;
    private javax.swing.JButton btnVerifyAudio;
    private javax.swing.JButton btnVerifyBIOS;
    private javax.swing.JButton btnVerifyCPU;
    private javax.swing.JButton btnVerifyCamera;
    private javax.swing.JButton btnVerifyDiscDrive;
    private javax.swing.JButton btnVerifyDriveHealth;
    private javax.swing.JButton btnVerifyDrivers;
    private javax.swing.JButton btnVerifyInternet;
    private javax.swing.JButton btnVerifyKeyboard;
    private javax.swing.JButton btnVerifyMicrophone;
    private javax.swing.JButton btnVerifyMouse;
    private javax.swing.JButton btnVerifyPorts;
    private javax.swing.JButton btnVerifyRemoteManagement;
    private javax.swing.JButton btnVerifyScreen;
    private javax.swing.JButton btnVerifySystemUpdates;
    private javax.swing.JButton btnVerifyWindowsActivation;
    private javax.swing.JPanel contentPane;
    private javax.swing.JScrollPane contentScrollPane;
    private javax.swing.JMenu installAppsMenu;
    private javax.swing.JPopupMenu.Separator installAppsMenuSeparator;
    private javax.swing.JLabel lblAudio;
    private javax.swing.JLabel lblAudioLabel;
    private javax.swing.JLabel lblBatteryCapacity;
    private javax.swing.JLabel lblCPU;
    private javax.swing.JLabel lblCPULabel;
    private javax.swing.JLabel lblDiscDrive;
    private javax.swing.JLabel lblDiscDriveLabel;
    private javax.swing.JLabel lblGPU;
    private javax.swing.JLabel lblGPULabel;
    private javax.swing.JLabel lblModel;
    private javax.swing.JLabel lblModelLabel;
    private javax.swing.JLabel lblMoreTests;
    private javax.swing.JLabel lblOS;
    private javax.swing.JLabel lblPID;
    private javax.swing.JLabel lblPassword;
    private javax.swing.JLabel lblRAM;
    private javax.swing.JLabel lblRAMLabel;
    private javax.swing.JLabel lblScreen;
    private javax.swing.JLabel lblScreenLabel;
    private javax.swing.JLabel lblSerial;
    private javax.swing.JLabel lblStatus;
    private javax.swing.JLabel lblStorage;
    private javax.swing.JLabel lblStorageLabel;
    private javax.swing.JLabel lblTasks;
    private javax.swing.JLabel lblTestModeD;
    private javax.swing.JLabel lblTestModeE;
    private javax.swing.JLabel lblTestModeE2;
    private javax.swing.JLabel lblTestModeM;
    private javax.swing.JLabel lblTestModeO;
    private javax.swing.JLabel lblTestModeS;
    private javax.swing.JLabel lblTestModeT;
    private javax.swing.JLabel lblTestModeT2;
    private javax.swing.JLabel lblUsername;
    private javax.swing.JLabel lblVersion;
    private javax.swing.JLabel lblWireless;
    private javax.swing.JLabel lblWirelessLabel;
    private javax.swing.JMenuBar mainMenubar;
    private javax.swing.JMenuItem menCacheDriversWindowsScript;
    private javax.swing.JMenuItem menCopySpecValue;
    private javax.swing.JMenuItem menDecreaseTextSize;
    private javax.swing.JMenuItem menForceShowScreenKeyboardAndMouseTests;
    private javax.swing.JMenuItem menIncreaseTextSize;
    private javax.swing.JMenuItem menInstallAllApps;
    private javax.swing.JMenuItem menInstallDropbox;
    private javax.swing.JMenuItem menInstallFBReader;
    private javax.swing.JMenuItem menInstallGoogleChrome;
    private javax.swing.JMenuItem menInstallSkype;
    private javax.swing.JMenuItem menInstallSpotify;
    private javax.swing.JMenuItem menInstallTeamViewer;
    private javax.swing.JMenuItem menInstallZoom;
    private javax.swing.JMenuItem menLogOut;
    private javax.swing.JMenuItem menLogSpecs;
    private javax.swing.JMenuItem menMaxTextSizeForScreen;
    private javax.swing.JMenuItem menOpenFileExplorerPE;
    private javax.swing.JMenuItem menOpenTerminalOrCommandPrompt;
    private javax.swing.JMenuItem menReRunSetupWindowsScript;
    private javax.swing.JMenuItem menReopenRepair;
    private javax.swing.JMenuItem menResetTextSize;
    private javax.swing.JMenuItem menRunCompleteWindowsScript;
    private javax.swing.JMenuItem menSearchSpecValue;
    private javax.swing.JMenuItem menSetDvdDriveRegion;
    private javax.swing.JSeparator middleSeparator1;
    private javax.swing.JSeparator middleSeparator2;
    private javax.swing.JMenu optionsMenu;
    private javax.swing.JPasswordField pswPassword;
    private javax.swing.JMenu scriptsMenu;
    private javax.swing.JPopupMenu.Separator scriptsMenuSeparator;
    private javax.swing.JPopupMenu specValueRightClickMenu;
    private javax.swing.JMenu testsMenu;
    private javax.swing.JMenu textSizeMenu;
    private javax.swing.JSeparator topSeparator;
    private javax.swing.JTextField txtPID;
    private javax.swing.JTextField txtUsername;
    private javax.swing.JMenu utilitiesMenu;
    // End of variables declaration//GEN-END:variables
}
